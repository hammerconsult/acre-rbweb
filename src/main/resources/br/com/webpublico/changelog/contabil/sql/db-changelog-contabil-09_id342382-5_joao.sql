DECLARE
texto CLOB := '{"consulta":"  select distinct\r\n      coalesce(pf.NOME,RAZAOSOCIAL) as nome,\r\n         o.FINALIDADEOBRA as descritivodaobra,\r\n         trunc(odc.DATARECEBIMENTO) as datainiciodoprocessolicitatorio,\r\n         trunc(ot.DATAEMISSAO) as datafimdoprocessolicitatorio,\r\n         pj.RAZAOSOCIAL as empresalicitadavencedora,\r\n         trunc(o.INICIOEXECUCAO) as inicioobra,\r\n         trunc(o.PRAZOENTREGA) as terminodaobra,\r\n         c.VALORTOTAL as custototal,\r\n         vw.DESCRICAO as secretariafiscalizadora,\r\n         pf.NOME as engenheiroresponsavel,\r\n         o.ALCANCESOCIAL as alcancesocial\r\n\r\nfrom OBRA o\r\n\r\n         left join contrato c on o.CONTRATO_ID = c.ID\r\n         left join cadastroimobiliario ci on o.CADASTROIMOBILIARIO_ID = ci.ID\r\n         left join cartorio ca on ci.CARTORIO_ID = ca.ID\r\n         left join acaoPPA ap on o.ACAOPPA_ID = ap.ID\r\n         left join acaoprincipal acp on ap.ACAOPRINCIPAL_ID = acp.ID\r\n         left join pessoajuridica pj on c.CONTRATADO_ID = pj.ID\r\n         left join pessoafisica pf on c.CONTRATADO_ID = pf.ID\r\n         left join OrdemDeServicoContrato odc on c.ID = odc.CONTRATO_ID\r\n         left join obratermo ot on  ot.obra_id = o.id\r\n         and ot.DEFINITIVO = 1\r\n         left join RESPONSAVELTECNICO rt on pf.ID = rt.PESSOAFISICA_ID\r\n         left join PESSOAFISICA pff on rt.PESSOAFISICA_ID = pff.ID\r\n         left join UNIDADECONTRATO uc on c.ID = uc.CONTRATO_ID and trunc(c.terminoVigencia) between trunc(uc.iniciovigencia) and coalesce(trunc(uc.fimvigencia), trunc(c.terminoVigencia))\r\n         left join vwhierarquiaadministrativa vw on vw.subordinada_id = uc.unidadeadministrativa_id and trunc(c.terminoVigencia) between trunc(vw.iniciovigencia) and coalesce(trunc(vw.fimvigencia), trunc(uc.fimvigencia))\r\n         $WHERE\r\n    ","count":"\r\nselect count(1)\r\nfrom OBRA o\r\n\r\n         left join contrato c on o.CONTRATO_ID = c.ID\r\n         left join cadastroimobiliario ci on o.CADASTROIMOBILIARIO_ID = ci.ID\r\n         left join cartorio ca on ci.CARTORIO_ID = ca.ID\r\n         left join acaoPPA ap on o.ACAOPPA_ID = ap.ID\r\n         left join acaoprincipal acp on ap.ACAOPRINCIPAL_ID = acp.ID\r\n         left join pessoajuridica pj on c.CONTRATADO_ID = pj.ID\r\n         left join pessoafisica pf on c.CONTRATADO_ID = pf.ID\r\n         left join OrdemDeServicoContrato odc on c.ID = odc.CONTRATO_ID\r\n         left join obratermo ot on  ot.obra_id = o.id\r\n                 left join RESPONSAVELTECNICO rt on pf.ID = rt.PESSOAFISICA_ID\r\n         left join PESSOAFISICA pff on rt.PESSOAFISICA_ID = pff.ID\r\n         left join UNIDADECONTRATO uc on c.ID = uc.CONTRATO_ID and trunc(c.terminoVigencia) between trunc(uc.iniciovigencia) and coalesce(trunc(uc.fimvigencia), trunc(c.terminoVigencia))\r\n         left join vwhierarquiaadministrativa vw on vw.subordinada_id = uc.unidadeadministrativa_id and trunc(c.terminoVigencia) between trunc(vw.iniciovigencia) and coalesce(trunc(vw.fimvigencia), trunc(uc.fimvigencia))\r\n         $WHERE\r\n     ","totalRegistros":28,"fields":[{"posicao":1,"descricao":"Nome","columnName":"NOME","columnValue":"NOME","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Descrição da Obra","columnName":"DESCRITIVODAOBRA","columnValue":"DESCRITIVODAOBRA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Data de Início de Processo","columnName":"DATAINICIODOPROCESSOLICITATORIO","columnValue":"DATAINICIODOPROCESSOLICITATORIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Data de Fim de Processo","columnName":"DATAFIMDOPROCESSOLICITATORIO","columnValue":"DATAFIMDOPROCESSOLICITATORIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"Empresa Licíta Vencedora","columnName":"EMPRESALICITADAVENCEDORA","columnValue":"EMPRESALICITADAVENCEDORA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"Início da Obra","columnName":"INICIOOBRA","columnValue":"INICIOOBRA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":7,"descricao":"Termino da Obra","columnName":"TERMINODAOBRA","columnValue":"TERMINODAOBRA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":8,"descricao":"Custo Total","columnName":"CUSTOTOTAL","columnValue":"CUSTOTOTAL","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":9,"descricao":"Secretária Fiscalizadora","columnName":"SECRETARIAFISCALIZADORA","columnValue":"SECRETARIAFISCALIZADORA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":10,"descricao":"Engenheiro Responsável","columnName":"ENGENHEIRORESPONSAVEL","columnValue":"ENGENHEIRORESPONSAVEL","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":11,"descricao":"Alcance Social","columnName":"ALCANCESOCIAL","columnValue":"ALCANCESOCIAL","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false}],"pesquisaveis":[],"tabs":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Detalhes da Obra';
END;
