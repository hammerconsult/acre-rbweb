DECLARE
texto CLOB := '{"consulta":"select \r\n        o.NOME as nome,\r\n       coalesce(pf.nome, pj.razaosocial) as empresalicitavencedora,\r\n       trunc (odc.DATARECEBIMENTO) as Datainiciodoprocesso,\r\n       trunc (ot.DATAEMISSAO) as datafimdoprocesso,\r\n       trunc (o.INICIOEXECUCAO) as iniciodaobra,\r\n       trunc (o.PRAZOENTREGA) as terminoobra,\r\n           o.id as id\r\n\r\n    from OBRA o\r\n\r\n    left join contrato c on o.CONTRATO_ID = c.ID\r\n    left join cadastroimobiliario ci on o.CADASTROIMOBILIARIO_ID = ci.ID\r\n    left join cartorio ca on ci.CARTORIO_ID = ca.ID\r\n    left join acaoPPA ap on o.ACAOPPA_ID = ap.ID\r\n    left join acaoprincipal acp on ap.ACAOPRINCIPAL_ID = acp.ID\r\n    left join pessoajuridica pj on c.CONTRATADO_ID = pj.ID\r\n    left join pessoafisica pf on c.CONTRATADO_ID = pf.ID\r\n    left join OrdemDeServicoContrato odc on c.ID = odc.CONTRATO_ID\r\n        and odc.ID = (select max(odsc.id) from ORDEMDESERVICOCONTRATO odsc where odsc.CONTRATO_ID = c.ID)\r\n    left join obratermo ot on  ot.obra_id = o.id\r\n        and ot.DEFINITIVO = 1\r\n        and ot.ID = (select max(obt.id) from OBRATERMO obt where obt.OBRA_ID = o.ID)\r\n$WHERE","count":"select count(1)\r\nfrom OBRA o\r\n\r\n    left join contrato c on o.CONTRATO_ID = c.ID\r\n    left join cadastroimobiliario ci on o.CADASTROIMOBILIARIO_ID = ci.ID\r\n    left join cartorio ca on ci.CARTORIO_ID = ca.ID\r\n    left join acaoPPA ap on o.ACAOPPA_ID = ap.ID\r\n    left join acaoprincipal acp on ap.ACAOPRINCIPAL_ID = acp.ID\r\n    left join pessoajuridica pj on c.CONTRATADO_ID = pj.ID\r\n    left join pessoafisica pf on c.CONTRATADO_ID = pf.ID\r\n    left join OrdemDeServicoContrato odc on c.ID = odc.CONTRATO_ID\r\n        and odc.ID = (select max(odsc.id) from ORDEMDESERVICOCONTRATO odsc where odsc.CONTRATO_ID = c.ID)\r\n    left join obratermo ot on  ot.obra_id = o.id\r\n        and ot.DEFINITIVO = 1\r\n        and ot.ID = (select max(obt.id) from OBRATERMO obt where obt.OBRA_ID = o.ID)\r\n$WHERE","totalRegistros":28,"fields":[{"posicao":1,"descricao":"Nome","columnName":"NOME","columnValue":"NOME","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"detalhe-obra","columnOrigem":"ID","columnDestino":"o.ID"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Empresa Lícita Vencedora","columnName":"EMPRESALICITAVENCEDORA","columnValue":"EMPRESALICITAVENCEDORA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"pessoa-ver","columnOrigem":"EMPRESALICITAVENCEDORA","columnDestino":"coalesce(pf.nome, pj.razaosocial)"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Data de Início de Processo","columnName":"DATAINICIODOPROCESSO","columnValue":"DATAINICIODOPROCESSO","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Data de Fim de Processo","columnName":"DATAFIMDOPROCESSO","columnValue":"DATAFIMDOPROCESSO","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"Início da Obra","columnName":"INICIODAOBRA","columnValue":"INICIODAOBRA","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"Término da Obra","columnName":"TERMINOOBRA","columnValue":"TERMINOOBRA","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":7,"descricao":"ID","columnName":"ID","columnValue":"ID","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":true}],"pesquisaveis":[],"tabs":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Obra';
END;
