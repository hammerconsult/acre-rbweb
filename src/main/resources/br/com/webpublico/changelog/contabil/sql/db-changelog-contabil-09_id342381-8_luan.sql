DECLARE
texto CLOB := '{"consulta":"select coalesce(lic.numeroLicitacao, dl.numeroDaDispensa) || ''/'' || exPl.ano || '' - '' || coalesce(lic.resumoDoObjeto, dl.resumoDoObjeto) as processoLicitatorio,\r\n                cot.numero,\r\n                trunc(cot.dataCotacao) as dataCotacao,\r\n                cot.descricao,\r\n                coalesce(lic.id, dl.id) as idProcessoLicitatorio\r\nFROM COTACAO COT\r\n         INNER JOIN SOLICITACAOMATERIAL SM ON SM.COTACAO_ID = COT.ID\r\n         INNER JOIN LOTESOLICITACAOMATERIAL LOTSOLMAT ON LOTSOLMAT.SOLICITACAOMATERIAL_ID = SM.ID\r\n         INNER JOIN ITEMSOLICITACAO ITSOL ON ITSOL.LOTESOLICITACAOMATERIAL_ID = LOTSOLMAT.ID\r\n         INNER JOIN ITEMPROCESSODECOMPRA ITPC ON ITPC.ITEMSOLICITACAOMATERIAL_ID = ITSOL.ID\r\n         INNER JOIN LOTEPROCESSODECOMPRA LOTEPC ON LOTEPC.ID = ITPC.LOTEPROCESSODECOMPRA_ID\r\n         INNER JOIN PROCESSODECOMPRA PROCOM ON PROCOM.ID = LOTEPC.PROCESSODECOMPRA_ID\r\n         LEFT JOIN LICITACAO LIC ON LIC.PROCESSODECOMPRA_ID = PROCOM.ID\r\n         LEFT JOIN DispensaDeLicitacao dl ON dl.PROCESSODECOMPRA_ID = PROCOM.ID\r\n         LEFT JOIN exercicio exPl ON exPl.id = coalesce(lic.exercicio_id, dl.exercicioDaDispensa_id)\r\n         $WHERE","count":"select count(1)\r\nFROM COTACAO COT\r\n         INNER JOIN SOLICITACAOMATERIAL SM ON SM.COTACAO_ID = COT.ID\r\n         INNER JOIN LOTESOLICITACAOMATERIAL LOTSOLMAT ON LOTSOLMAT.SOLICITACAOMATERIAL_ID = SM.ID\r\n         INNER JOIN ITEMSOLICITACAO ITSOL ON ITSOL.LOTESOLICITACAOMATERIAL_ID = LOTSOLMAT.ID\r\n         INNER JOIN ITEMPROCESSODECOMPRA ITPC ON ITPC.ITEMSOLICITACAOMATERIAL_ID = ITSOL.ID\r\n         INNER JOIN LOTEPROCESSODECOMPRA LOTEPC ON LOTEPC.ID = ITPC.LOTEPROCESSODECOMPRA_ID\r\n         INNER JOIN PROCESSODECOMPRA PROCOM ON PROCOM.ID = LOTEPC.PROCESSODECOMPRA_ID\r\n         LEFT JOIN LICITACAO LIC ON LIC.PROCESSODECOMPRA_ID = PROCOM.ID\r\n         LEFT JOIN DispensaDeLicitacao dl ON dl.PROCESSODECOMPRA_ID = PROCOM.ID\r\n         LEFT JOIN exercicio exPl ON exPl.id = coalesce(lic.exercicio_id, dl.exercicioDaDispensa_id)\r\n         $WHERE","totalRegistros":2363,"fields":[{"posicao":1,"descricao":"Processo Licitatório","columnName":"PROCESSOLICITATORIO","columnValue":"PROCESSOLICITATORIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"processo-licitatorio-ver","columnOrigem":"IDPROCESSOLICITATORIO","columnDestino":"dados.IDPROCESSOLICITATORIO"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Número","columnName":"NUMERO","columnValue":"NUMERO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Data","columnName":"DATACOTACAO","columnValue":"DATACOTACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Descrição","columnName":"DESCRICAO","columnValue":"DESCRICAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"IDPROCESSOLICITATORIO","columnName":"IDPROCESSOLICITATORIO","columnValue":"IDPROCESSOLICITATORIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":true}],"pesquisaveis":[],"tabs":[{"titulo":"Fornecedores","consulta":"select formatacpfcnpj(coalesce(pf.cpf, pj.cnpj)) || '' - '' || coalesce(pf.nome, pj.razaosocial) as fornecedor, coalesce(pf.nome, pj.razaosocial) as nomeForn\r\nfrom cotacao cot\r\n         inner join LoteCotacao lc on lc.cotacao_id = cot.id\r\n         inner join ItemCotacao ic on lc.id = ic.loteCotacao_id\r\n         inner join ValorCotacao vc on vc.itemCotacao_id = ic.id\r\n         inner join pessoa p on p.id = vc.fornecedor_id\r\n         left join pessoafisica pf on pf.id = p.id\r\n         left join pessoajuridica pj on pj.id = p.id\r\n$WHERE","count":"select COUNT(1)\r\nfrom cotacao cot\r\n         inner join LoteCotacao lc on lc.cotacao_id = cot.id\r\n         inner join ItemCotacao ic on lc.id = ic.loteCotacao_id\r\n         inner join ValorCotacao vc on vc.itemCotacao_id = ic.id\r\n         inner join pessoa p on p.id = vc.fornecedor_id\r\n         left join pessoafisica pf on pf.id = p.id\r\n         left join pessoajuridica pj on pj.id = p.id\r\n$WHERE","totalRegistros":null,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Fornecedor","columnName":"FORNECEDOR","columnValue":"FORNECEDOR","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"pessoa-ver","columnOrigem":"NOMEFORN","columnDestino":"coalesce(pf.nome, pj.razaosocial)"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"NOMEFORN","columnName":"NOMEFORN","columnValue":"NOMEFORN","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":true}]}]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Ver Cotação' and CHAVE = 'cotacao-ver';
END;
