DECLARE
texto CLOB := '{"consulta":"select e.numero,\r\n       e.descricaodetalhada as emendaParlamentar,\r\n       coalesce(pf.nome, pj.razaosocial) as autor,\r\n       coalesce(sum(se.VALOR), 0) as valor,\r\n       e.objetoresumido,\r\n       e.statuscamara as status,\r\n       listagg(vw.descricao, '', '')  within group (order by vw.descricao) as unidade,\r\n       ex.ano as exercicio,\r\n       e.dataemenda,\r\n       e.id as idEmenda\r\nfrom emenda e\r\n         inner join exercicio ex on ex.id = e.exercicio_id\r\n         inner join vereador v on e.vereador_id = v.id\r\n         left join pessoafisica pf on pf.id = v.pessoa_id\r\n         left join pessoajuridica pj on pj.id = v.pessoa_id\r\n         left join suplementacaoemenda se on se.emenda_id = e.id\r\n         left join vwhierarquiaorcamentaria vw on vw.subordinada_id = se.unidadeorganizacional_id\r\n               and trunc(coalesce(e.dataemenda, sysdate)) between vw.iniciovigencia and coalesce(vw.fimvigencia, trunc(coalesce(e.dataemenda, sysdate)))\r\nwhere ex.ano = $ANO\r\n$WHERE\r\ngroup by e.numero, e.descricaodetalhada, coalesce(pf.nome, pj.razaosocial), e.objetoresumido, e.statuscamara, ex.ano, e.dataemenda, e.id\r\norder by to_number(e.numero) desc","count":"select count(e.id)\r\nfrom emenda e\r\n         inner join exercicio ex on ex.id = e.exercicio_id\r\n         inner join vereador v on e.vereador_id = v.id\r\n         left join pessoafisica pf on pf.id = v.pessoa_id\r\n         left join pessoajuridica pj on pj.id = v.pessoa_id\r\n         left join suplementacaoemenda se on se.emenda_id = e.id\r\n         left join vwhierarquiaorcamentaria vw on vw.subordinada_id = se.unidadeorganizacional_id\r\n               and trunc(coalesce(e.dataemenda, sysdate)) between vw.iniciovigencia and coalesce(vw.fimvigencia, trunc(coalesce(e.dataemenda, sysdate)))\r\nwhere ex.ano = $ANO\r\n$WHERE","totalRegistros":145,"fields":[{"posicao":1,"descricao":"Número","columnName":"NUMERO","columnValue":"NUMERO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"emenda-ver","columnOrigem":"IDEMENDA","columnDestino":"e.id"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Emenda Parlamentar","columnName":"EMENDAPARLAMENTAR","columnValue":"EMENDAPARLAMENTAR","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Autor","columnName":"AUTOR","columnValue":"AUTOR","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Valor","columnName":"VALOR","columnValue":"VALOR","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"Objeto Resumido","columnName":"OBJETORESUMIDO","columnValue":"OBJETORESUMIDO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"Status","columnName":"STATUS","columnValue":"STATUS","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"ENUM","tipoEnum":"br.com.webpublico.enums.StatusEmenda","valorPadrao":[null,"ABERTO","APROVADO","REJEITADO"],"escondido":false},{"posicao":7,"descricao":"Unidade","columnName":"UNIDADE","columnValue":"UNIDADE","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":8,"descricao":"Exercício","columnName":"EXERCICIO","columnValue":"EXERCICIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":9,"descricao":"Data","columnName":"DATAEMENDA","columnValue":"DATAEMENDA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":11,"descricao":"IDEMENDA","columnName":"IDEMENDA","columnValue":"IDEMENDA","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":true}],"pesquisaveis":[{"descricao":"Unidade","columnName":"vw.subordinada_id","columnValue":null,"tipo":"MULTI_SELECT","operacaoPadrao":null,"tipoEnum":null,"valorPadrao":"","tipoMultiSelect":"UNIDADE_ORCAMENTARIA"}],"tabs":[],"paineis":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Emenda' and CHAVE = 'emenda';
END;
