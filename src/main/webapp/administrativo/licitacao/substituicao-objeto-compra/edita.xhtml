<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:ad="http://java.sun.com/jsf/composite/components/administrativo"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:o="http://java.sun.com/jsf/html" xmlns:H="http://java.sun.com/jsf/html"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">

        <script type="text/javascript">
            function scrollPanel() {
                window.scrollTo(0, 500);
            }
        </script>

        <h:form id="Formulario">
            <p:remoteCommand name="limparDados"
                             actionListener="#{substituicaoObjetoCompraControlador.limparDadosObjetoCompra()}"
                             update=":Formulario:gridDadosGerais :Formulario:tabela-oc :Formulario:panel-de-para"
                             process="@this"/>

            <p:remoteCommand name="limparDadosOCPara"
                             actionListener="#{substituicaoObjetoCompraControlador.limparDadosObjetoCompraPara()}"
                             update="group-especificacao panelGrupoContaDesd"
                             process="@this"/>

            <fc:cabecalhoPretty controlador="#{substituicaoObjetoCompraControlador}"
                                origem="#{substituicaoObjetoCompraControlador.caminhoPadrao}novo/"/>

            <p:panel header="Substituição do Objeto de Compra" id="panelPrincipal">
                <table>
                    <tr style="vertical-align: top !important;">
                        <td style="width: 65%">
                            <h:panelGrid columns="2" id="gridDadosGerais">
                                <h:outputLabel value="Número: "/>
                                <h:outputText
                                    value="#{substituicaoObjetoCompraControlador.selecionado.numero == null ? 'Gerado automaticamente' : substituicaoObjetoCompraControlador.selecionado.numero}"
                                    styleClass="negrito"/>

                                <h:outputLabel value="Data: "/>
                                <h:outputText
                                    value="#{substituicaoObjetoCompraControlador.selecionado.dataSubstituicao}"
                                    styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>

                                <h:outputLabel value="Usuário: "/>
                                <h:outputText value="#{substituicaoObjetoCompraControlador.selecionado.usuarioSistema}"
                                              styleClass="negrito"/>

                                <h:outputText value="Origem da Substituição: "/>
                                <h:selectOneRadio
                                    value="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao}"
                                    disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                    layout="pageDirection">
                                    <f:selectItems value="#{substituicaoObjetoCompraControlador.origensSubstituicao}"/>
                                    <p:ajax event="change"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            update=":Formulario:gridDadosGerais :Formulario:panel-de-para"
                                            listener="#{substituicaoObjetoCompraControlador.limparDadosObjetoCompra()}"
                                            process="@this"/>
                                </h:selectOneRadio>

                                <h:outputText value="IRP: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isIrp()}"/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{substituicaoObjetoCompraControlador.filtro.intencaoRegistroPreco}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarIRP}"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isIrp()}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="irp"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{irp}"
                                                itemValue="#{irp.id}"
                                                converter="#{intencaoRegistroPrecoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Formulário de Cotação: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isFormularioCotacao()}"/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{substituicaoObjetoCompraControlador.filtro.formularioCotacao}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarFormularioCotacao}"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isFormularioCotacao()}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="fc"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{fc}"
                                                itemValue="#{fc.id}"
                                                converter="#{formularioCotacaoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Cotação: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isCotacao()}"/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{substituicaoObjetoCompraControlador.filtro.cotacao}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarCotacao}"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isCotacao()}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="cot"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{cot}"
                                                itemValue="#{cot.id}"
                                                converter="#{cotacaoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Solicitação de Compra: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isSolicitacaoCompra()}"/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{substituicaoObjetoCompraControlador.filtro.solicitacaoCompra}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarSolicitacaoCompra}"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isSolicitacaoCompra()}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="sol"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{sol}"
                                                itemValue="#{sol.id}"
                                                converter="#{solicitacaoMaterialControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Licitação: "
                                              style="margin-right: 60px"
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isLicitacao()}"
                                              for="acLicitacao"/>
                                <p:autoComplete queryDelay="1000"
                                                id="acLicitacao"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isLicitacao()}"
                                                value="#{substituicaoObjetoCompraControlador.filtro.licitacao}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarLicitacao}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="lic"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{lic}"
                                                itemValue="#{lic.id}"
                                                converter="#{licitacaoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc :Formulario:panel-de-para"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Dispensa de Licitação: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isDispensa()}"
                                              for="acDispensa"/>
                                <p:autoComplete queryDelay="1000"
                                                id="acDispensa"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isDispensa()}"
                                                value="#{substituicaoObjetoCompraControlador.filtro.dispensaLicitacao}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarDispensaLicitacao}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="disp"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{disp.toStringAutoComplete()}"
                                                itemValue="#{disp.id}"
                                                converter="#{dispensaDeLicitacaoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Registro de Preço Externo: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isRegistroPrecoExterno()}"
                                              for="acRegExterno"/>
                                <p:autoComplete queryDelay="1000"
                                                id="acRegExterno"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isRegistroPrecoExterno()}"
                                                value="#{substituicaoObjetoCompraControlador.filtro.registroSolicitacaoMaterialExterno}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarRegistroPrecoExterno}"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                var="regExt"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{regExt}"
                                                itemValue="#{regExt.id}"
                                                converter="#{registroSolicitacaoMaterialExternoControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"/>
                                </p:autoComplete>

                                <h:outputText value="Contrato: "
                                              rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isContrato()}"
                                              for="acContrato"/>
                                <p:autoComplete queryDelay="1000"
                                                id="acContrato"
                                                disabled="#{substituicaoObjetoCompraControlador.hasObjetosCompraSelecionados()}"
                                                rendered="#{substituicaoObjetoCompraControlador.selecionado.origemSubstituicao.isContrato()}"
                                                value="#{substituicaoObjetoCompraControlador.filtro.contrato}"
                                                completeMethod="#{substituicaoObjetoCompraControlador.completarContrato}"
                                                var="cont"
                                                size="70"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 800px"
                                                onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                                maxResults="50"
                                                itemLabel="#{cont}"
                                                itemValue="#{cont.id}"
                                                converter="#{contratoAdmControlador.converterGenerico}">
                                    <p:ajax event="itemSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            process="@this"
                                            update="tabela-oc"
                                            listener="#{substituicaoObjetoCompraControlador.buscarObjetosCompraDoProcesso()}"
                                    />
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio value="Objeto de Compra: "/>
                                <p:dataTable
                                    style="overflow: scroll; max-height: 300px"
                                    id="tabela-oc"
                                    emptyMessage="Não foram localizados registros para serem apresentados"
                                    rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                    value="#{substituicaoObjetoCompraControlador.objetosCompraDoProcesso}"
                                    filteredValue="#{substituicaoObjetoCompraControlador.objetosCompraDoProcessoFilterBy}"
                                    selection="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado}"
                                    selectionMode="single"
                                    rowIndexVar="rowIx"
                                    rowKey="#{ocDisp}"
                                    var="ocDisp">
                                    <p:ajax event="rowSelect"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide();scrollPanel()"
                                            process="@this :Formulario:gridDadosGerais"
                                            update=":Formulario:panel-de-para"
                                            listener="#{substituicaoObjetoCompraControlador.onRowSelectObjetoCompra}"/>

                                    <p:column headerText="Lote" styleClass="alinhamentoCentralizado">
                                        <h:outputText value="#{ocDisp.numeroLote}"/>
                                    </p:column>
                                    <p:column headerText="Item" styleClass="alinhamentoCentralizado">
                                        <h:outputText value="#{ocDisp.numeroItem}"/>
                                    </p:column>
                                    <p:column headerText="Objeto de Compra"
                                              filterBy="#{ocDisp.objetoCompraDe}"
                                              filterMatchMode="contains"
                                              filterStyle="width: 70%; text-align: left !important;"
                                              styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{ocDisp.objetoCompraDe}"/>
                                    </p:column>
                                    <p:column headerText="Especif." styleClass="alinhamentoCentralizado">
                                        <ad:especificacao-objeto-compra
                                            styleClass="icone-20"
                                            especificacao="#{ocDisp.especificacaoDe}"/>
                                    </p:column>
                                </p:dataTable>
                            </h:panelGrid>
                        </td>

                        <td style="width: 1%"/>

                        <td style="width: 35%">
                            <h:panelGrid columns="1" id="gridHistorico">
                                <h:outputText value="Histórico: "/>
                                <p:editor id="historico"
                                          controls=""
                                          width="400"
                                          height="320"
                                          value="#{substituicaoObjetoCompraControlador.selecionado.historico}"/>
                            </h:panelGrid>
                        </td>
                    </tr>
                </table>

                <br/>
                <p:outputPanel id="panel-de-para">
                    <table
                        style="width: 100%; border-radius: 5px; display: #{substituicaoObjetoCompraControlador.hasObjetoCompraSelecionado() ? 'block' : 'none'}">
                        <tr style="vertical-align: top">

                            <td style="width: 60%">
                                <p:fieldset legend="De / Para">
                                    <h:panelGrid columns="2"
                                                 rendered="#{substituicaoObjetoCompraControlador.hasObjetoCompraSelecionado()}">
                                        <h:outputText value="Item: "
                                                      style="font-size: 14px"
                                                      styleClass="negrito"/>
                                        <h:outputText
                                            style="font-size: 14px"
                                            styleClass="negrito"
                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.numeroItem}"/>

                                        <h:outputText value="Objeto de Compra De: "
                                                      style="color: dimgrey"/>
                                        <h:panelGroup id="group-oc-de">
                                            <h:outputText
                                                value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraDe}"/>

                                            <div style="font-size: 11px; color: dimgrey"
                                                 class="mtop05">
                                                <h:outputText value="Tipo de Objeto: "/>
                                                <h:outputText
                                                    style="margin-left: 23px"
                                                    styleClass="negrito"
                                                    value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraDe.tipoObjetoCompra.descricao}"/>
                                            </div>

                                            <div style="font-size: 11px; color: dimgrey"
                                                 class="mtop05">
                                                <ad:grupo-conta-despesa
                                                    grupoContaDespesa="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.grupoContaDespesaDe}"/>
                                            </div>
                                        </h:panelGroup>

                                        <h:outputText value="Objeto de Compra Para: "
                                                      styleClass="negrito"/>
                                        <h:panelGroup id="group-oc-para">
                                            <p:autoComplete queryDelay="1000"
                                                            id="oc-para"
                                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara}"
                                                            completeMethod="#{substituicaoObjetoCompraControlador.completarObjetoCompra}"
                                                            var="acOb"
                                                            size="50"
                                                            dropdown="true"
                                                            panelStyle="max-height: 250px;max-width: 800px"
                                                            maxResults="50"
                                                            itemLabel="#{acOb}"
                                                            itemValue="#{acOb.id}"
                                                            onkeyup="if(keyUpCampoVazio(this)){limparDadosOCPara();}"
                                                            converter="#{objetoCompraControlador.converterGenerico}">
                                                <p:ajax event="itemSelect"
                                                        listener="#{substituicaoObjetoCompraControlador.listenerObjetoCompraPara()}"
                                                        onstart="aguarde.show()"
                                                        oncomplete="aguarde.hide()"
                                                        update="group-especificacao panelGrupoContaDesd"
                                                        process="@this :Formulario:panel-de-para"/>
                                            </p:autoComplete>

                                            <p:outputPanel id="panelGrupoContaDesd">
                                                <div style="font-size: 11px; color: dimgrey"
                                                     class="mtop05">
                                                    <h:outputText value="Tipo de Objeto: "
                                                                  styleClass="mlef03"
                                                                  rendered="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara ne null}"/>
                                                    <h:outputText
                                                        style="margin-left: 22px"
                                                        rendered="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara ne null}"
                                                        value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara.tipoObjetoCompra.descricao}"/>
                                                </div>

                                                <div style="font-size: 11px; color: dimgrey"
                                                     class="mtop05">
                                                    <ad:grupo-conta-despesa
                                                        grupoContaDespesa="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.grupoContaDespesaPara}"/>
                                                </div>
                                            </p:outputPanel>
                                        </h:panelGroup>

                                        <h:outputText value="Especificação De: "
                                                      style="color: dimgrey"/>
                                        <p:inputTextarea
                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.especificacaoDe}"
                                            readonly="true"
                                            autoResize="false"
                                            maxlength="3000"
                                            cols="48"
                                            rows="5"
                                            scrollHeight="50"/>

                                        <h:outputText value="Especificação Para:"
                                                      styleClass="negrito"/>
                                        <h:panelGroup id="group-especificacao">
                                            <p:inputTextarea id="editor"
                                                             title="Digite a descrição da complementar."
                                                             disabled="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara eq null}"
                                                             value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.especificacaoPara}"
                                                             autoResize="false"
                                                             maxlength="3000"
                                                             readonly="true"
                                                             cols="48"
                                                             rows="5"
                                                             scrollHeight="50"/>

                                            <p:outputPanel id="panel-especificacao" styleClass="mlef05">
                                                <ad:tabela-especificacoes-objeto-compra
                                                    update=":Formulario:panel-de-para"
                                                    limparEspecificacao="#{substituicaoObjetoCompraControlador.limparEspecificacao()}"
                                                    objetoCompra="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraPara}"
                                                    selecionarEspecificacao="#{substituicaoObjetoCompraControlador.selecionarEspecificacao}"/>
                                            </p:outputPanel>
                                        </h:panelGroup>

                                        <h:outputText value="Unidade Med. De: "
                                                      style="color: dimgrey"/>
                                        <h:outputText
                                            style="color: dimgrey"
                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.unidadeMedidaDe}"/>

                                        <h:outputText value="Unidade Med. Para: " styleClass="negrito"/>
                                        <ad:unidade-medida
                                            tipoObjetoCompra="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.objetoCompraDe.tipoObjetoCompra}"
                                            unidadeMedidaSelecionada="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.unidadeMedidaPara}"
                                            update=":Formulario:quantidade"/>

                                        <h:outputText value="Quantidade De: " style="color: dimgrey"/>
                                        <fc:output-mascara-unidade-medida
                                            style="color: dimgrey"
                                            tipoMascara="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.tipoMascaraUnidadeMedida}"
                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.quantidadeDe}"/>

                                        <h:outputText value="Quantidade Para: " styleClass="negrito"/>
                                        <p:outputPanel id="quantidade">
                                            <fc:input-mascara-unidade-medida
                                                styleClass="alinhamentoEsquerda"
                                                rendered="#{!substituicaoObjetoCompraControlador.hasMovimentoContrato()}"
                                                value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.quantidadePara}"
                                                tipoMascara="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.tipoMascaraUnidadeMedida}"/>

                                            <div class="alert alert-danger"
                                                 style="display: #{substituicaoObjetoCompraControlador.hasMovimentoContrato() ? 'block' : 'none'}">
                                                Alteração não permitida quando o processo possui contrato.
                                            </div>
                                            <div class="alert alert-danger"
                                                 style="display: #{substituicaoObjetoCompraControlador.hasProcessoComPregaoPorLote() ? 'block' : 'none'}">
                                                Alteração não permitida quando a licitação é do tipo apuração por lote.
                                            </div>
                                        </p:outputPanel>
                                    </h:panelGrid>
                                </p:fieldset>
                            </td>

                            <td style="width: 5%">

                            </td>

                            <td style="width: 40%">
                                <p:fieldset legend="Movimentos"
                                            style="overflow: scroll; max-height: 300px">
                                    <table class="table table-hover table-striped">
                                        <tr class="negrito alert alert-warning">
                                            <td>Movimento</td>
                                            <td>Número</td>
                                            <td>Data</td>
                                        </tr>
                                        <ui:repeat
                                            value="#{substituicaoObjetoCompraControlador.objetoCompraSelecionado.movimentos}"
                                            var="mov">

                                            <tr style="vertical-align: top">
                                                <td>
                                                    <a href="#{request.contextPath}#{mov.tipoMovimento.url}#{mov.id}/"
                                                       target="_blank"
                                                       style="color: dimgrey">
                                                        <h:outputText
                                                            title="#{mov.descricao}"
                                                            value="#{mov.tipoMovimento.descricao}"/>
                                                    </a>
                                                    <br/>
                                                    <h:outputText
                                                        style="color: dimgrey; font-size: 10px"
                                                        rendered="#{mov.tipoMovimento.isExecucaoContrato()}"
                                                        title="#{mov.contaDesdobrada.descricao}"
                                                        value="#{mov.contaDesdobrada.codigo}"/>
                                                </td>
                                                <td>
                                                    <h:outputText
                                                        value="#{mov.numero}"/>
                                                </td>
                                                <td>
                                                    <h:outputText value="#{mov.data}">
                                                        <f:convertDateTime type="date"/>
                                                    </h:outputText>
                                                </td>
                                            </tr>
                                        </ui:repeat>
                                    </table>
                                </p:fieldset>
                            </td>
                        </tr>
                    </table>
                </p:outputPanel>

                <p:commandButton id="btn-adicionar"
                                 styleClass="prioritario operacao mtop10"
                                 style="width: 150px"
                                 process="@this :Formulario:panel-de-para"
                                 update=":Formulario:panel-oc-substituicao :Formulario:panel-de-para
                                         :Formulario:gridDadosGerais :Formulario:tabela-oc :Formulario:gridHistorico"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 icon="ui-icon-plus"
                                 value="Adicionar"
                                 title="Clique para adicionar o objeto na lista de substituição."
                                 actionListener="#{substituicaoObjetoCompraControlador.adicionarObjetoCompra()}"/>

                <p:outputPanel id="panel-oc-substituicao">
                    <div class="alert alert-info" align="center" style="padding: 4px">
                        Objetos de Compra para Substituição
                    </div>
                    <p:dataTable
                        emptyMessage="Não foram localizados registros para serem apresentados"
                        rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                        value="#{substituicaoObjetoCompraControlador.objetosCompraSubstituicao}"
                        rowIndexVar="rowIx"
                        rowKey="#{ocSub}"
                        var="ocSub">
                        <p:column headerText="Ações" style="text-align: center; width: 8%;">
                            <p:commandButton icon="ui-icon-pencil"
                                             title="Clique para alterar este registro."
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide();"
                                             process="@this"
                                             actionListener="#{substituicaoObjetoCompraControlador.editarObjetoCompra(ocSub)}"
                                             update=":Formulario:panel-de-para :Formulario:gridDadosGerais :Formulario:tabela-oc"
                                             styleClass="mrig05"/>

                            <p:commandButton icon="ui-icon-trash"
                                             process="@this"
                                             onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{substituicaoObjetoCompraControlador.removerObjetoCompra(ocSub)}"
                                             update=":Formulario:gridDadosGerais :Formulario:panel-oc-substituicao :Formulario:gridHistorico"
                                             title="Clique para remover este registro."/>
                        </p:column>
                        <p:column headerText="De/Para" style="width: 3%">
                            <p:rowToggler/>
                        </p:column>
                        <p:column headerText="Lote" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{ocSub.numeroLote}"/>
                        </p:column>
                        <p:column headerText="Item" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{ocSub.numeroItem}"/>
                        </p:column>
                        <p:column headerText="Objeto de Compra De" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{ocSub.objetoCompraDe}"/>
                        </p:column>
                        <p:column headerText="Especif." styleClass="alinhamentoCentralizado">
                            <ad:especificacao-objeto-compra
                                especificacao="#{ocSub.especificacaoDe}"/>
                        </p:column>
                        <p:rowExpansion>
                            <table style="width: 100%" class="table table-hover table-striped mlef30">
                                <tr class="negrito">
                                    <td>Movimento</td>
                                    <td>Número</td>
                                    <td>Data</td>
                                    <td>Objeto De</td>
                                    <td>Objeto Para</td>
                                    <td>Especif. De</td>
                                    <td>Especif. Para</td>
                                    <td>Unidade De</td>
                                    <td>Unidade Para</td>
                                    <td>Quantidade De</td>
                                    <td>Quantidade Para</td>
                                </tr>
                                <ui:repeat
                                    emptyMessage="Não foram localizados registros para serem apresentados"
                                    value="#{ocSub.movimentos}"
                                    var="movOc">
                                    <tr>
                                        <td>
                                            <a href="#{request.contextPath}#{movOc.tipoMovimento.url}#{movOc.id}/"
                                               target="_blank"
                                               style="color: dimgrey">
                                                <h:outputText
                                                    value="#{movOc.tipoMovimento.descricao}"/>
                                            </a>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{movOc.numero}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{movOc.data}">
                                                <f:convertDateTime type="date"/>
                                            </h:outputText>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{ocSub.objetoCompraDe.codigo}"/>
                                        </td>
                                        <td>
                                            <h:outputText
                                                title="#{ocSub.objetoCompraPara.descricao}"
                                                value="#{ocSub.objetoCompraPara.codigo}"/>
                                        </td>
                                        <td>
                                            <ad:especificacao-objeto-compra
                                                styleClass="icone-20"
                                                especificacao="#{ocSub.especificacaoDe}"/>
                                        </td>
                                        <td>
                                            <ad:especificacao-objeto-compra
                                                styleClass="icone-20"
                                                especificacao="#{ocSub.especificacaoPara}"/>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{ocSub.unidadeMedidaDe}"/>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{ocSub.unidadeMedidaPara}"/>
                                        </td>
                                        <td>
                                            <fc:output-mascara-unidade-medida value="#{ocSub.quantidadeDe}"
                                                                              tipoMascara="#{ocSub.tipoMascaraUnidadeMedida}"/>

                                        </td>
                                        <td>
                                            <fc:output-mascara-unidade-medida value="#{ocSub.quantidadePara}"
                                                                              tipoMascara="#{ocSub.tipoMascaraUnidadeMedida}"/>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </table>
                        </p:rowExpansion>
                    </p:dataTable>
                </p:outputPanel>
            </p:panel>

            <fc:rodapePretty controlador="#{substituicaoObjetoCompraControlador}"/>
        </h:form>
    </ui:define>
</ui:composition>
</html>

