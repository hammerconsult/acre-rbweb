<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:ad="http://java.sun.com/jsf/composite/components/administrativo"
      xmlns:co="http://java.sun.com/jsf/composite/components/contabil"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">

        <script type="text/javascript">
            function expandirRowToggler() {
                $('.expandir-table').find('.ui-row-toggler').not('.ui-icon-circle-triangle-s').trigger('click');
            }
        </script>

        <h:form id="Formulario">
            <p:remoteCommand name="atribuirFalseJustificativaCotacao"
                             onstart="aguarde.show();"
                             process="@this"
                             actionListener="#{solicitacaoMaterialControlador.desabilitarAndRemoverJustificativaCotacao()}"
                             oncomplete="aguarde.hide();"
                             update=":Formulario:tb-view:justificativa-cotacao :Formulario:tb-view:justificativa-campo"/>

            <fc:cabecalhoPretty origem="#{solicitacaoMaterialControlador.caminhoPadrao}listar/"
                                controlador="#{solicitacaoMaterialControlador}"/>

            <p:panel header="Solicitação de Compra" id="panel-geral">
                <p:tabView id="tb-view" onTabShow="expandirRowToggler();" styleClass="mtop05">

                    <p:ajax event="tabChange"
                            listener="#{solicitacaoMaterialControlador.onTabChange}"
                            process="@this"
                            onstart="aguarde.show()"
                            oncomplete="aguarde.hide()"/>

                    <p:tab title="Dados da Solicitação de Compra">
                        <p:outputPanel id="panelcadastro">
                            <h:panelGrid id="gridcadastro" columns="2" cellpadding="2" cellspacing="2">
                                <h:outputLabel value="Criado Por: " style="margin-right: 130px"/>
                                <h:outputText
                                    value="#{solicitacaoMaterialControlador.selecionado.usuarioCriacao.pessoaFisica.nome}"
                                    styleClass="negrito"/>

                                <fc:outputLabelObrigatorio value="Número: "/>
                                <h:outputText
                                    value="#{solicitacaoMaterialControlador.selecionado.numero == null ? 'Gerado automaticamente ao salvar' : solicitacaoMaterialControlador.selecionado.numero}"
                                    styleClass="negrito"/>

                                <fc:outputLabelObrigatorio value="Exercício: "/>
                                <p:inputMask mask="9999"
                                             id="selectExercicio"
                                             value="#{solicitacaoMaterialControlador.selecionado.exercicio}"
                                             converter="#{exercicioControlador.converterExercicio}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             size="12">
                                    <p:ajax event="blur" process="@this" update="@this"/>
                                </p:inputMask>

                                <fc:outputLabelObrigatorio for="dataSol" value="Data da Solicitação: "/>
                                <p:calendar title="Digite a data da Solicitação de Compra"
                                            value="#{solicitacaoMaterialControlador.selecionado.dataSolicitacao}"
                                            disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                            id="dataSol"
                                            locale="pt_BR"
                                            navigator="true"
                                            pattern="dd/MM/yyyy"
                                            maxdate="#{solicitacaoMaterialControlador.dataOperacao}"
                                            onkeypress="mascara(this, mdata)"
                                            autocomplete="off"
                                            maxlength="10"
                                            size="12"/>

                                <h:outputText value="Status da Solicitação:"/>
                                <h:outputText value="#{solicitacaoMaterialControlador.statusAtualSolicitacao.descricao}"
                                              styleClass="negrito"/>

                                <h:outputText value="Motivo: "
                                              rendered="#{solicitacaoMaterialControlador.permiteExibirPanelMotivoStatus()}"/>
                                <p:inputTextarea title="Digite o Motivo"
                                                 value="#{solicitacaoMaterialControlador.selecionado.motivo}"
                                                 id="motivo"
                                                 cols="80"
                                                 rows="5"
                                                 rendered="#{solicitacaoMaterialControlador.permiteExibirPanelMotivoStatus()}"/>

                                <fc:outputLabelObrigatorio for="solicitante" value="Solicitante: "/>
                                <p:autoComplete queryDelay="1000" id="solicitante" title="Digite o nome do Solicitante"
                                                value="#{solicitacaoMaterialControlador.selecionado.solicitante}"
                                                completeMethod="#{solicitacaoMaterialControlador.completaSolicitante}"
                                                disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                var="s"
                                                size="70"
                                                itemLabel="#{s}"
                                                itemValue="#{s.id}"
                                                forceSelection="true"
                                                dropdown="true"
                                                panelStyle="max-height: 250px; max-width: 800px"
                                                maxResults="50"
                                                converter="#{solicitacaoMaterialControlador.converterSolicitante}">
                                    <p:ajax event="itemSelect"
                                            process="@this"
                                            onstart="aguarde.show();"
                                            oncomplete="aguarde.hide();"/>
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio value="Unidade Administrativa: "/>
                                <h:panelGroup id="panelUnidade">
                                    <p:autoComplete queryDelay="1000" id="unidadeorganizacional"
                                                    title="Informe a unidade administrativa."
                                                    value="#{solicitacaoMaterialControlador.hierarquiaOrganizacional}"
                                                    completeMethod="#{hierarquiaOrganizacionalControlador.buscarHierarquiaOrganizacionalAdministrativaOndeUsuarioLogadoEhGestorDeLicitacao}"
                                                    converter="#{hierarquiaOrganizacionalControlador.converterHierarquiaOrganizacional}"
                                                    disabled="#{solicitacaoMaterialControlador.processoIrp or solicitacaoMaterialControlador.bloquearEdicao}"
                                                    var="ho"
                                                    itemLabel="#{ho}"
                                                    itemValue="#{ho.id}"
                                                    forceSelection="true"
                                                    dropdown="true"
                                                    panelStyle="max-height: 250px; max-width: 800px"
                                                    maxResults="50"
                                                    size="70">
                                        <p:ajax event="itemSelect"
                                                process="@this"
                                                onstart="aguarde.show();"
                                                oncomplete="aguarde.hide();"/>
                                    </p:autoComplete>
                                    <fc:botaoInformacao id="bt-info-unidade"
                                                        styleInfo="width : 850px;"
                                                        resumo="Unidade Administrativa&lt;br/&gt;"
                                                        rendered="#{solicitacaoMaterialControlador.processoIrp}"
                                                        detalhes="Para processo de IRP a unidade da solicitação será a unidade gerenciadora do processo."/>
                                </h:panelGroup>

                                <fc:outputLabelObrigatorio value="Lei de Licitação: "/>
                                <h:selectOneMenu
                                    value="#{solicitacaoMaterialControlador.leiLicitacao}"
                                    disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                    id="leisLicitacao">
                                    <f:selectItems value="#{solicitacaoMaterialControlador.leisLicitacao}"/>
                                    <p:ajax event="change"
                                            listener="#{solicitacaoMaterialControlador.listenerLeiLicitacao()}"
                                            process="@this :Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"
                                            update=":Formulario:tb-view:tipoAvaliacao @this :Formulario:tb-view:amparoLegal :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio for="tipoSolicitacaoMaterial" value="Tipo de Solicitação: "/>
                                <h:selectOneMenu value="#{solicitacaoMaterialControlador.selecionado.tipoSolicitacao}"
                                                 title="Selecione um tipo de solicitação de compra"
                                                 id="tipoSolicitacaoMaterial"
                                                 disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}">
                                    <f:selectItems value="#{solicitacaoMaterialControlador.listaTipoSolicitacao}"/>
                                    <p:ajax event="change"
                                            process=":Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"
                                            update="tipo-objeto-compra :Formulario:tb-view:op-data-obra :Formulario:tb-view:ip-data-obra"
                                            onstart="aguarde.show();"
                                            listener="#{solicitacaoMaterialControlador.limparCotacaoPlanilhaOrcamentaria()}"
                                            oncomplete="aguarde.hide();"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Tipo de Objeto de Compra: "/>
                                <h:selectOneMenu
                                    id="tipo-objeto-compra"
                                    value="#{solicitacaoMaterialControlador.selecionado.tipoObjetoCompra}"
                                    disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}">
                                    <f:selectItems
                                        value="#{solicitacaoMaterialControlador.tiposObjetoCompra}"/>
                                    <p:ajax event="change"
                                            process="@this :Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"
                                            update=":Formulario:tb-view:subtipoObjetoCompra"
                                            onstart="aguarde.show();"
                                            listener="#{solicitacaoMaterialControlador.verificarSeExisteConfigurcaoObjetoCompra()}"
                                            oncomplete="aguarde.hide();"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Subtipo Objeto de Compra: "/>
                                <h:selectOneMenu
                                    value="#{solicitacaoMaterialControlador.selecionado.subTipoObjetoCompra}"
                                    title="Informe o subtipo de objeto de compra"
                                    disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                    id="subtipoObjetoCompra">
                                    <f:selectItems value="#{solicitacaoMaterialControlador.subtiposObjetoCompra}"/>
                                    <p:ajax event="change"
                                            process="@this"
                                            onstart="aguarde.show();"
                                            oncomplete="aguarde.hide();"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Grau de Prioridade: "/>
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0">
                                    <h:selectOneMenu
                                        value="#{solicitacaoMaterialControlador.selecionado.tipoGrauPrioridade}"
                                        title="Selecione um grau de prioridade."
                                        id="tipoGrauPrioridade">
                                        <f:selectItems value="#{solicitacaoMaterialControlador.grausDePrioridades}"/>
                                    </h:selectOneMenu>
                                    <fc:botaoInformacao id="btnInfoTipoGrauPrioridade"
                                                        styleInfo="width : 850px;"
                                                        styleClassBotao="mlef05"
                                                        resumo="Grau de Prioridade&lt;br/&gt;"
                                                        detalhes="Devemos indicar o grau de prioridade, de forma realista, levando em conta as efetivas necessidades desta contratação para o setor demandante.&lt;br/&gt;
                                                        A indicação orientará os agentes que atuam no processo de contratação quanto à urgência do processo, considerando o grau de prioridade de outras contratações.&lt;br/&gt;
                                                        Precisamos ter cuidado para não cair na armadilha de achar que tudo é de alta prioridade.&lt;br/&gt;
                                                        Priorizar significa separar aquilo que, sem a contratação, a nossa atividade principal será paralisada, daquilo que também é relevante, mas que pode aguardar um pouco.&lt;br/&gt;
                                                        Se colocamos que tudo é prioridade alta, nenhuma contratação poderá ser priorizada.&lt;br/&gt;
                                                        Estimamos que 20% daquilo que demandamos é de prioridade alta, 30% é de prioridade média e 50% é de prioridade baixa.&lt;br/&gt;
                                                        Vamos tentar utilizar esse critério para escalar o que é prioritário, da forma mais real possível e adequada ao nosso dia a dia."/>
                                </h:panelGrid>
                            </h:panelGrid>

                            <p:fieldset legend="Necessidade"
                                        id="fieldSetNecessidade"
                                        styleClass="mtop10">
                                <h:panelGrid columns="4" cellpadding="2" cellspacing="2">
                                    <fc:outputLabelObrigatorio value="Descrição da Necessidade: "/>
                                    <p:inputTextarea title="Digite a justificativa da Solicitação de Compra"
                                                     value="#{solicitacaoMaterialControlador.selecionado.descricaoNecessidade}"
                                                     id="descricaoNecessidade"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterDescricaoNecessidade"/>
                                    <h:outputText id="counterDescricaoNecessidade"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                    <fc:botaoInformacao id="btnInfoDescricaoNecessidade"
                                                        styleInfo="width : 850px;"
                                                        resumo="Descrição da Necessidade&lt;br/&gt;"
                                                        detalhes="Aqui, nós precisamos explicar qual é a necessidade existente ou o problema a ser resolvido.&lt;br/&gt;
                                                    Não devemos confundir necessidade com solução. A necessidade é um problema a ser resolvido. A solução é como nós vamos resolver esse problema.&lt;br/&gt;
                                                    Após a identificação da necessidade, iremos desenvolver uma pesquisa de mercado para buscar as possíveis soluções para o problema apontado.&lt;br/&gt;
                                                    A necessidade deve ser indicada de forma clara e objetiva, para que seja possível avaliarmos, durante a elaboração do estudo técnico preliminar, a solução mais adequada para o seu atendimento.&lt;br/&gt;
                                                    EXEMPLO: &lt;br/&gt;
                                                    Ex.: Controlar os contratos do Município por meio de ferramenta de tecnologia da informação.&lt;br/&gt;
                                                    Ex.: Substituir carteiras escolares danificadas durante o ano letivo.&lt;br/&gt;
                                                    Ex.: Prover alimentação para os alunos das escolas da rede municipal de ensino durante o período de permanência na escola."/>

                                    <fc:outputLabelObrigatorio for="justificativa"
                                                               value="Justificativa da Necessidade: "/>
                                    <p:inputTextarea title="Digite a justificativa da Solicitação de Compra"
                                                     value="#{solicitacaoMaterialControlador.selecionado.justificativa}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="justificativa"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterJustificativa"/>
                                    <h:outputText id="counterJustificativa"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                    <fc:botaoInformacao id="btnInfoJustificativa"
                                                        styleInfo="width : 850px;"
                                                        resumo="Justificativa da Necessidade&lt;br/&gt;"
                                                        detalhes="Nosso Município irá desembolsar recursos para suprir a necessidade que estamos apontando.&lt;br/&gt;
                                                    Precisamos explicar porque o Município deve gastar recursos públicos com a solução desse problema, sempre demonstrando a relação entre a necessidade da Administração e a sua importância para o desenvolvimento das atividades do setor demandante.&lt;br/&gt;
                                                    É importante descrevermos a situação atual vivenciada e os motivos que justificam a contratação, considerando as atividades desenvolvidas pelo setor demandante.&lt;br/&gt;
                                                    Também é interessante descrevermos o que acontecerá, quais as consequências e os eventuais impactos, caso o problema que estamos apresentando não seja resolvido.&lt;br/&gt;
                                                    EXEMPLO:&lt;br/&gt;
                                                    Ex.: Embora a Secretaria Municipal de Infraestrutura e Mobilidade Urbana tenha a missão de acompanhar a execução das obras e serviços de engenharia contratados pelo Município, a Secretaria não dispõe, atualmente, de veículos para que os seus servidores possam se deslocar até o local das obras, resultando, muitas vezes, no uso de veículos próprios dos servidores, no uso de aplicativos, no empréstimo de veículos de outras secretarias ou, até mesmo, em pedidos de carona para o local das obras, o que implica em perda de eficiência, necessidade de reembolso de valores e falhas de acompanhamento e fiscalização. Como se trata de uma necessidade permanente desta Secretaria, é imperioso que se encontre uma solução adequada e confiável para que os servidores possam se deslocar, sempre que for preciso, com a agilidade necessária.&lt;br/&gt;
                                                    Ex.: No prédio da Prefeitura, todas as portas e janelas das salas são em vidro temperado e necessitam constantemente de manutenção, em razão do intenso fluxo nas salas, tais como, lubrificação, regulagens, troca de peças dentre outros. Em 2021, foi elaborado termo de referência para contratar a manutenção preventiva mensal, que não chegou a resultar em uma licitação, pois verificamos que essa forma de contratação seria muito dispendiosa, considerando as demandas atendidas em exercícios anteriores. O Município permanece, desde então, sem uma solução “oficial” para esse problema, realizando contratações conforme a ocorrência de necessidades, sem garantia de economicidade.&lt;br/&gt;
                                                    Ex.: A necessidade decorre do risco de desabastecimento da rede municipal de saúde em relação a medicamentos e insumos básicos e de urgência para manutenção dos serviços de pronto atendimento. Em razão do crescimento exponencial, nos meses de junho a agosto, dos atendimentos em geral e, em especial, dos casos de síndromes respiratórias das mais diversas espécies, os estoques previstos para o exercício já se encontram em níveis críticos, ultrapassando 70% de itens consumidos, sendo que os restantes 30% são suficientes para suprir com segurança as unidades por apenas mais 120 (cento e vinte) dias.&lt;br/&gt;
                                                    Ex.: Aquisição ou locação do caminhão basculante se faz necessária para substituir o caminhão que se envolveu em um sinistro com perda total. O caminhão é utilizado para atender às necessidades de transporte de materiais da Secretaria Municipal de Infraestrutura e Mobilidade Urbana para os locais em que são feitas intervenções pela própria equipe do Município."/>

                                    <fc:outputLabelObrigatorio for="solucaoSugerida" value="Solução Sugerida: "/>
                                    <p:inputTextarea title="Digite a solução sugerida da Solicitação de Compra."
                                                     value="#{solicitacaoMaterialControlador.selecionado.descricao}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="solucaoSugerida"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterSolucaoSugerida"/>
                                    <h:outputText id="counterSolucaoSugerida"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                    <fc:botaoInformacao id="btnInfoSolucaoSugerida"
                                                        styleInfo="width : 850px;"
                                                        resumo="Solução Sugerida&lt;br/&gt;"
                                                        detalhes="Como vimos, a necessidade é um problema a ser resolvido, já identificado no item 2.&lt;br/&gt;
                                                    Quando temos um problema, é comum que tenhamos uma hipótese de solução para esse problema, seja porque é a atual solução utilizada pelo Município, ou porque nosso demandante acredita que essa seria a solução mais eficiente.&lt;br/&gt;
                                                    Aqui, nós devemos apresentar qual é a nossa hipótese de solução, se houver, utilizando aquela que já está em uso no Município ou que o próprio setor já tiver identificado como uma solução eficiente para a sua necessidade.&lt;br/&gt;
                                                    Caso não seja possível identificarmos prontamente a solução com precisão, é possível apresentar uma ideia inicial, que será elaborada e discutida quando da elaboração do estudo técnico preliminar.&lt;br/&gt;
                                                    EXEMPLO:&lt;br/&gt;
                                                    Ex.: Contratação de empresa para prestação de serviços de limpeza e conservação predial, com fornecimento de materiais, equipamentos, ferramentas e utensílios.&lt;br/&gt;
                                                    O Município vem utilizando esta solução há vários anos, de forma satisfatória. O contrato mais recente celebrado é o contrato 32/2019, que poderá ser acessado para identificação dos valores e das características da contratação que vem atendendo às nossas necessidades.&lt;br/&gt;
                                                    Ex.: Contratação de fornecimento de insumos, para preparo da merenda escolar pelas merendeiras do Município.&lt;br/&gt;
                                                    A solução permite maior controle sobre a qualidade, com o preparo a partir de insumos frescos e de boa qualidade e a elaboração supervisionada por nutricionista. Ademais, o Município possui servidoras ocupando o cargo de merendeiras e desempenhando a função de forma satisfatória, com aceitação da merenda pelos alunos.&lt;br/&gt;
                                                    Ex.: Aquisição dos medicamentos junto a fornecedores, conforme indicado na estimativa de quantidades.&lt;br/&gt;
                                                    Ex.: Acreditamos que a alteração do sistema atual de frota própria para um sistema de transporte por aplicativo possa ser mais eficiente, reduzindo os custos fixos e a ociosidade dos veículos atuais, que gira em torno de 40%."/>
                                </h:panelGrid>
                            </p:fieldset>

                            <p:fieldset legend="Previsão de Procedimento Legal"
                                        id="fieldSetPrevisaoProcedimentoLegal"
                                        styleClass="mtop10">
                                <h:panelGrid columns="2" cellpadding="2" cellspacing="2">
                                    <h:outputText value="Instrumento Convocatório: "/>
                                    <p:outputPanel id="op-instrumento-conv">
                                        <h:outputText
                                            value="#{solicitacaoMaterialControlador.selecionado.instrumentoConvocatorio.descricao}"
                                            styleClass="negrito"/>
                                    </p:outputPanel>

                                    <fc:outputLabelObrigatorio for="modo-solicitacao" value="Modo da Solicitação: "/>
                                    <h:selectOneMenu
                                        value="#{solicitacaoMaterialControlador.selecionado.modoSolicitacao}"
                                        disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                        id="modo-solicitacao">
                                        <f:selectItems value="#{solicitacaoMaterialControlador.modosSolicitacao}"/>
                                        <p:ajax event="change"
                                                process="@this"
                                                listener="#{solicitacaoMaterialControlador.buscarModalidades()}"
                                                update="modalidade"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"/>
                                    </h:selectOneMenu>

                                    <fc:outputLabelObrigatorio for="modalidade" value="Modalidade: "/>
                                    <h:selectOneMenu
                                        value="#{solicitacaoMaterialControlador.selecionado.modalidadeLicitacao}"
                                        disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada() or solicitacaoMaterialControlador.isSolicitacaoAprovada()}"
                                        id="modalidade">
                                        <f:selectItems value="#{solicitacaoMaterialControlador.modalidades}"/>
                                        <p:ajax event="change"
                                                listener="#{solicitacaoMaterialControlador.listenerModalidade()}"
                                                process="@this :Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"
                                                update="op-natureza amparoLegal ip-natureza tipoAvaliacao :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal modalidade op-instrumento-conv"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"/>
                                    </h:selectOneMenu>

                                    <p:outputPanel id="op-natureza">
                                        <fc:outputLabelObrigatorio
                                            value="#{solicitacaoMaterialControlador.selecionado.modalidadeLicitacao.labelTipoModalidade}:"
                                            rendered="#{solicitacaoMaterialControlador.selecionado.hasNaturezaProcecimento()}"/>
                                    </p:outputPanel>
                                    <p:outputPanel id="ip-natureza">
                                        <h:selectOneMenu
                                            value="#{solicitacaoMaterialControlador.selecionado.tipoNaturezaDoProcedimento}"
                                            disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                            rendered="#{solicitacaoMaterialControlador.selecionado.hasNaturezaProcecimento()}">
                                            <f:selectItems
                                                value="#{solicitacaoMaterialControlador.naturezasProcedimento}"/>
                                            <p:ajax event="change"
                                                    listener="#{solicitacaoMaterialControlador.listenerNaturezaProcedimento()}"
                                                    process="@this :Formulario:tb-view:gridcadastro
                                                :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                                :Formulario:tb-view:fieldSetNecessidade
                                                :Formulario:tb-view:gridValor
                                                :Formulario:tb-view:fieldSetInicioEDuracao"
                                                    onstart="aguarde.show()"
                                                    oncomplete="aguarde.hide()"/>
                                        </h:selectOneMenu>
                                    </p:outputPanel>

                                    <fc:outputLabelObrigatorio value="Amparo Legal: "/>
                                    <h:panelGroup>
                                        <p:autoComplete queryDelay="1000"
                                                        id="amparoLegal"
                                                        title="Digite o nome do amparo legal que deseja pesquisar."
                                                        value="#{solicitacaoMaterialControlador.selecionado.amparoLegal}"
                                                        completeMethod="#{solicitacaoMaterialControlador.completarAmparoLegal}"
                                                        converter="#{amparoLegalControlador.converterGenerico}"
                                                        disabled="#{solicitacaoMaterialControlador.leiLicitacao.isLei8666() or solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                                        var="al"
                                                        maxResults="50"
                                                        panelStyle="max-height: 230px;max-width: 700px"
                                                        dropdown="true"
                                                        itemValue="#{al.id}"
                                                        itemLabel="#{al}"
                                                        size="70">
                                            <p:ajax process="@this"
                                                    event="itemSelect"
                                                    update="panel-detalhes-amparo"/>
                                        </p:autoComplete>

                                        <p:outputPanel id="panel-detalhes-amparo">
                                            <fc:visualizarCampos
                                                styleClass="icone-30 mlef05"
                                                objeto="#{solicitacaoMaterialControlador.selecionado.amparoLegal}"/>
                                        </p:outputPanel>
                                    </h:panelGroup>

                                    <h:panelGroup style="display: flex; flex-direction:#{solicitacaoMaterialControlador.isLei14133ModalidadeDispensa() ? 'column-reverse' : 'column'}">
                                        <div style="display: flex; margin-bottom: 8px;">
                                            <fc:outputLabelObrigatorio value="Tipo de Avaliação: "/>
                                            <h:selectOneMenu value="#{solicitacaoMaterialControlador.selecionado.tipoAvaliacao}"
                                                             disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                                             id="tipoAvaliacao"
                                                             style="position: absolute; margin-left: 185px;"
                                                             title="Informe o Tipo de Avaliação">
                                                <f:selectItems value="#{solicitacaoMaterialControlador.tiposAvaliacao}"/>
                                                <p:ajax event="change"
                                                        update="#{solicitacaoMaterialControlador.isLei14133ModalidadeDispensa() ? '' : ':Formulario:tb-view:modo-disputa'}"
                                                        process="@this :Formulario:tb-view:gridcadastro
                                                    :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                                    :Formulario:tb-view:fieldSetNecessidade
                                                    :Formulario:tb-view:gridValor
                                                    :Formulario:tb-view:fieldSetInicioEDuracao"
                                                        listener="#{solicitacaoMaterialControlador.instanciarCriterios()}"
                                                        onstart="aguarde.show()"
                                                        oncomplete="aguarde.hide()"/>
                                            </h:selectOneMenu>
                                        </div>

                                        <div style="display: flex; margin-bottom: 8px;">
                                            <fc:outputLabelObrigatorio value="Modo de Disputa: "/>
                                            <h:selectOneMenu
                                                value="#{solicitacaoMaterialControlador.selecionado.modoDisputa}"
                                                id="modo-disputa"
                                                style="position: absolute; margin-left: 185px;">
                                                <f:selectItems value="#{solicitacaoMaterialControlador.modosDisputa}"/>
                                                <p:ajax event="change"
                                                        listener="#{solicitacaoMaterialControlador.definirInstrumentoConvocatorio}"
                                                        update="#{solicitacaoMaterialControlador.isLei14133ModalidadeDispensa() ? 'op-instrumento-conv :Formulario:tb-view:tipoAvaliacao' : 'op-instrumento-conv'}"
                                                        process="@this"/>
                                            </h:selectOneMenu>
                                        </div>
                                    </h:panelGroup>
                                    <h:outputText></h:outputText>

                                    <fc:outputLabelObrigatorio value="Tipo de Apuração: "/>
                                    <h:selectOneMenu value="#{solicitacaoMaterialControlador.selecionado.tipoApuracao}"
                                                     disabled="#{solicitacaoMaterialControlador.hasCotacaoSelecionada()}"
                                                     id="tipoApuracao" title="Informe o Tipo de Apuração"
                                                     style="width: 250px;">
                                        <f:selectItems value="#{solicitacaoMaterialControlador.tiposApuracao}"/>
                                        <p:ajax event="change"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"
                                                process="@this :Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"/>
                                    </h:selectOneMenu>

                                    <fc:outputLabelObrigatorio value="Justificativa Presencial: "
                                                               rendered="#{solicitacaoMaterialControlador.mostrarCampoJustificativaPresencial()}"/>
                                    <h:panelGrid columns="3" style="margin-left: -3px;"
                                                 rendered="#{solicitacaoMaterialControlador.mostrarCampoJustificativaPresencial()}">
                                        <p:inputTextarea title="Digite a justificativa presencial."
                                                         value="#{solicitacaoMaterialControlador.selecionado.justificativaPresencial}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         id="justificativaPresencial"
                                                         cols="80"
                                                         rows="5"
                                                         maxlength="3000"
                                                         autoResize="true"
                                                         counterTemplate="{0} Caracteres Restantes."
                                                         counter="counterJustificativaPresencial"/>
                                        <h:outputText id="counterJustificativaPresencial"
                                                      style="color: #497692"
                                                      styleClass="mlef05"/>
                                    </h:panelGrid>

                                    <h:outputText value="Justificativa da Apuração: " style="margin-right: 30px"/>
                                    <h:panelGrid columns="2" style="margin-left: -3px;">
                                        <p:inputTextarea title="Digite a justificativa da apuração."
                                                         value="#{solicitacaoMaterialControlador.selecionado.justificativaApuracao}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         id="justificativaApuracao"
                                                         cols="80"
                                                         rows="5"
                                                         maxlength="3000"
                                                         autoResize="true"
                                                         counterTemplate="{0} Caracteres Restantes."
                                                         counter="counterJustificativaApuracao"/>
                                        <h:outputText id="counterJustificativaApuracao"
                                                      style="color: #497692"
                                                      styleClass="mlef05"/>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </p:fieldset>

                            <p:fieldset legend="Previsão de Inicio e Duração Pretendidos para a Contratação"
                                        id="fieldSetInicioEDuracao"
                                        styleClass="mtop10">
                                <h:panelGrid columns="2" cellpadding="2" cellspacing="2">
                                    <fc:outputLabelObrigatorio value="Início da Execução: "/>
                                    <h:panelGroup>
                                        <p:calendar title="Digite a data de inicio da execução."
                                                    value="#{solicitacaoMaterialControlador.selecionado.inicioExecucao}"
                                                    id="inicioExecucao"
                                                    navigator="true"
                                                    pattern="dd/MM/yyyy"
                                                    onkeypress="mascara(this, mdata)"
                                                    autocomplete="off"
                                                    maxlength="10"
                                                    size="12"/>
                                        <fc:botaoInformacao id="btnInfoPrevisao"
                                                            styleClassBotao="icone-30"
                                                            styleInfo="width : 850px;"
                                                            resumo="Previsão de Inicio e Duração Pretendidos para a Contratação&lt;br/&gt;"
                                                            detalhes="Temos que informar qual é o momento pretendido para início da execução e por quanto tempo o contrato será necessário.&lt;br/&gt;
                                                    Observar que, nos contratos de escopo, como, por exemplo, uma obra, devemos indicar a data pretendida para a conclusão, vinculada à necessidade da Administração.&lt;br/&gt;
                                                    EXEMPLO:&lt;br/&gt;
                                                    Ex.: Período pretendido para o início da execução: junho de 2023, coincidindo com o início do inverno.&lt;br/&gt;
                                                    Duração pretendida para o contrato: 90 (noventa) dias.&lt;br/&gt;
                                                    Ex.: Data pretendida para o início do contrato: 7 de março de 2023, correspondente ao dia seguinte ao vencimento do contrato atual.&lt;br/&gt;
                                                    Duração pretendida para o contrato: 12 (doze) meses, prorrogável, sucessivamente, até o máximo de 10 (dez) anos.&lt;br/&gt;
                                                    Ex.: A reforma deverá ser finalizada até o final do mês de janeiro de 2023, antes, portanto, do início do ano letivo.&lt;br/&gt;
                                                    A duração do contrato dependerá do prazo de execução necessário à realização da reforma, estimada em três meses."/>
                                    </h:panelGroup>

                                    <fc:outputLabelObrigatorio value="Prazo de Execução: "/>
                                    <h:panelGroup>
                                        <p:inputText title="Digite o Prazo de Execução"
                                                     value="#{solicitacaoMaterialControlador.selecionado.prazoExecucao}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="prazoExecucao"
                                                     styleClass="mrig05" size="5"
                                                     style="text-align: right"/>

                                        <h:selectOneMenu title="Selecione o Tipo Prazo de Execução da Licitação"
                                                         value="#{solicitacaoMaterialControlador.selecionado.tipoPrazoDeExecucao}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         id="tipoPrazoExecucao">
                                            <f:selectItems value="#{solicitacaoMaterialControlador.tipoPrazo}"/>
                                        </h:selectOneMenu>
                                    </h:panelGroup>

                                    <fc:outputLabelObrigatorio value="Prazo de Vigência: "/>
                                    <h:panelGroup>
                                        <p:inputText title="Digite o Prazo de Vigência"
                                                     value="#{solicitacaoMaterialControlador.selecionado.vigencia}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="prazoVigencia"
                                                     styleClass="mrig05" size="5"
                                                     style="text-align: right"/>

                                        <h:selectOneMenu title="Selecione o Tipo Prazo de Vigência da Licitação"
                                                         value="#{solicitacaoMaterialControlador.selecionado.tipoPrazoDeVigencia}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         id="tipoPrazoVigencia">
                                            <f:selectItems value="#{solicitacaoMaterialControlador.tipoPrazo}"/>
                                        </h:selectOneMenu>
                                    </h:panelGroup>

                                    <fc:outputLabelObrigatorio for="prazoDeEntrega" value="Prazo de Entrega: "/>
                                    <h:panelGroup>
                                        <p:inputText title="Digite o Prazo de Entrega da Solicitação de Compra"
                                                     styleClass="mrig05" size="5"
                                                     value="#{solicitacaoMaterialControlador.selecionado.prazoDeEntrega}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="prazoDeEntrega" style="text-align: right"/>

                                        <h:selectOneMenu
                                            title="Selecione o Tipo Prazo de Entrega da Solicitação de Compra"
                                            value="#{solicitacaoMaterialControlador.selecionado.tipoPrazoEntrega}"
                                            disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                            id="tipoPrazoEntrega">
                                            <f:selectItems value="#{solicitacaoMaterialControlador.tipoPrazo}"/>
                                        </h:selectOneMenu>
                                    </h:panelGroup>

                                    <h:outputText value="Descrição Complementar: " style="margin-right: 30px"/>
                                    <h:panelGrid columns="2" style="margin-left: -3px;">
                                        <p:inputTextarea title="Digite a descrição complementar."
                                                         value="#{solicitacaoMaterialControlador.selecionado.descricaoComplementarPrazo}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         id="descricaoComplementarPrazo"
                                                         cols="80"
                                                         rows="5"
                                                         maxlength="3000"
                                                         autoResize="true"
                                                         counterTemplate="{0} Caracteres Restantes."
                                                         counter="counterDescricaoComplementarPrazo"/>
                                        <h:outputText id="counterDescricaoComplementarPrazo"
                                                      style="color: #497692"
                                                      styleClass="mlef05"/>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </p:fieldset>

                            <h:panelGrid id="gridValor" columns="2" cellpadding="2" cellspacing="2">
                                <fc:outputLabelObrigatorio value="Contratações Correlatas: "/>
                                <h:panelGrid columns="3" style="margin-left: -3px;">
                                    <p:inputTextarea title="Digite as contratações correlatas."
                                                     value="#{solicitacaoMaterialControlador.selecionado.contratacoesCorrelatas}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="contratacoesCorrelatas"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterContratacoesCorrelatas"/>
                                    <h:outputText id="counterContratacoesCorrelatas"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                    <fc:botaoInformacao id="btnInfoContratacoesCorrelatas"
                                                        styleInfo="width : 850px;"
                                                        resumo="Contratações Correlatas&lt;br/&gt;"
                                                        detalhes="Contratações correlatas são as outras contratações que devem ser realizadas conjuntamente, quando da realização dos processos licitatórios.&lt;br/&gt;
                                                        Aqui, nós apontaremos as licitações que podem ser realizadas em conjunto, otimizando tempo e recursos, porque possuem alguma relação e/ou vinculação entre os objetos pretendidos.&lt;br/&gt;
                                                        EXEMPLO:&lt;br/&gt;
                                                        Ex.: A necessidade de aquisição de armários para alunos e professores mostra-se correlata à necessidade de aquisição das carteiras escolares.&lt;br/&gt;
                                                        Ex.: Não há necessidade de aquisições correlatas.&lt;br/&gt;
                                                        Ex.: A contratação de cimento é correlata à de materiais de construção civil, utilizados pela Secretaria Municipal de Infraestrutura e Mobilidade Urbana."/>
                                </h:panelGrid>

                                <fc:outputLabelObrigatorio value="Contratações Interdependentes: "/>
                                <h:panelGrid columns="3" style="margin-left: -3px;">
                                    <p:inputTextarea title="Digite as contratações interdependentes."
                                                     value="#{solicitacaoMaterialControlador.selecionado.contratacoesIndependentes}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="contratacoesIndependentes"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterContratacoesIndependentes"/>
                                    <h:outputText id="counterContratacoesIndependentes"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                    <fc:botaoInformacao id="btnInfoContratacoesIndependentes"
                                                        styleInfo="width : 850px;"
                                                        resumo="Contratações Interdependentes&lt;br/&gt;"
                                                        detalhes="Contratações interdependentes são as outras contratações que são necessárias para que esta contratação surta os resultados desejados.&lt;br/&gt;
                                                        Devemos indicar, se for o caso:&lt;br/&gt;
                                                        a) contratações que precisem ser realizadas para que a necessidade seja plenamente atendida; e&lt;br/&gt;
                                                        b) contratações já realizadas, ou a realizar, que tenham relação indireta com a contratação objeto do DFD.&lt;br/&gt;
                                                        Precisamos trazer uma “visão do todo” e das providências a serem tomadas, considerando a relação entre as contratações.&lt;br/&gt;
                                                        Nossa principal função é garantir que o objeto não seja frustrado em razão da fata da contratação de outro elemento essencial para sua execução.&lt;br/&gt;
                                                        EXEMPLO:&lt;br/&gt;
                                                        Ex.: Caso a opção seja a compra de bebedouros elétricos, deverá ser providenciada a instalação elétrica e hidráulica próxima aos pontos em que serão colocados os bebedouros.&lt;br/&gt;
                                                        Ex.: Caso a solução adotada seja a aquisição ou locação dos equipamentos de Raio X, haverá necessidade de aquisição de filmes para sua utilização, compatíveis com o equipamento."/>
                                </h:panelGrid>

                                <fc:outputLabelObrigatorio value="Forma de Pagamento: "/>
                                <h:panelGrid columns="2" style="margin-left: -3px;">
                                    <p:inputTextarea title="Digite a forma de pagamento"
                                                     value="#{solicitacaoMaterialControlador.selecionado.formaDePagamento}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="formaDePagamento"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true" counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterFormaDePagamento"/>
                                    <h:outputText id="counterFormaDePagamento"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                </h:panelGrid>

                                <fc:outputLabelObrigatorio for="localDeEntrega" value="Local de Entrega/Execução: "/>
                                <p:inputText title="Digite o localDeEntrega da Solicitação de Compra"
                                             value="#{solicitacaoMaterialControlador.selecionado.localDeEntrega}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             id="localDeEntrega"
                                             maxlength="70"
                                             size="82"/>

                                <h:outputText value="Valor: "/>
                                <p:inputText title="Este valor é recuperado automaticamente pelo sistema."
                                             value="#{solicitacaoMaterialControlador.selecionado.valor}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             tabindex="-1"
                                             id="valor" maxlength="15" size="21" readonly="true"
                                             style="text-align: right; left: -10px">
                                    <f:convertNumber type="currency"/>
                                </p:inputText>

                                <fc:outputLabelObrigatorio value="Orçamento Sigiloso? "/>
                                <h:selectOneRadio required="true"
                                                  value="#{solicitacaoMaterialControlador.selecionado.orcamentoSigiloso}"
                                                  disabled="#{solicitacaoMaterialControlador.bloquearEdicao}">
                                    <f:selectItem itemValue="true" itemLabel="Sim"/>
                                    <f:selectItem itemValue="false" itemLabel="Não"/>
                                    <p:ajax event="valueChange"
                                            process=":Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"
                                            update=":Formulario:tb-view:gridcadastro
                                            :Formulario:tb-view:fieldSetPrevisaoProcedimentoLegal
                                            :Formulario:tb-view:fieldSetNecessidade
                                            :Formulario:tb-view:gridValor
                                            :Formulario:tb-view:fieldSetInicioEDuracao"/>
                                </h:selectOneRadio>

                                <h:outputText
                                    rendered="#{solicitacaoMaterialControlador.selecionado.orcamentoSigiloso}"
                                    id="op-jus-sigilo"
                                    value="Justificativa do Sigilo: "/>
                                <h:panelGrid id="ip-jus-sigilo" columns="2" style="margin-left: -3px;"
                                             rendered="#{solicitacaoMaterialControlador.selecionado.orcamentoSigiloso}">
                                    <p:inputTextarea title="Digite a justificativa do Sigilo"
                                                     value="#{solicitacaoMaterialControlador.selecionado.justificativaSigilo}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="justificativaSigilo"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true" counterTemplate="{0} Caracteres Restantes."
                                                     counter="counterJustificativaSigilo"/>
                                    <h:outputText id="counterJustificativaSigilo"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                </h:panelGrid>

                                <h:outputText value="Observações: "/>
                                <h:panelGrid columns="2" style="margin-left: -3px;">
                                    <p:inputTextarea title="Digite a Observação da Solicitação de Compra"
                                                     value="#{solicitacaoMaterialControlador.selecionado.observacoes}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     id="observacao"
                                                     cols="80"
                                                     rows="5"
                                                     maxlength="3000"
                                                     autoResize="true" counterTemplate="{0} Caracteres Restantes."
                                                     counter="counter"/>
                                    <h:outputText id="counter"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                </h:panelGrid>
                            </h:panelGrid>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab id="tabLoteServicoMaterial" title="Cotação/Planilha Orçamentária">
                        <h:panelGrid columns="2" id="grid-cotacao">
                            <fc:outputLabelObrigatorio value="Cotação/Planilha Orçamentária: "/>
                            <h:panelGrid columns="5">
                                <p:autoComplete id="auto-complete-cotacao"
                                                value="#{solicitacaoMaterialControlador.selecionado.cotacao}"
                                                completeMethod="#{solicitacaoMaterialControlador.completarCotacao}"
                                                converter="#{cotacaoControlador.converterGenerico}"
                                                var="cot"
                                                disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                dropdown="true"
                                                panelStyle="max-width: 800px; max-height: 250px"
                                                itemLabel="#{cot}"
                                                itemValue="#{cot.id}"
                                                size="70"
                                                maxResults="10">
                                    <p:ajax event="itemSelect"
                                            process=":Formulario:panel-geral @this"
                                            update=":Formulario:panel-geral"
                                            onstart="aguarde.show()"
                                            listener="#{solicitacaoMaterialControlador.iniciarCriterioAvaliacaoPrecoItem()}"
                                            oncomplete="aguarde.hide(); expandirRowToggler();"
                                    />
                                </p:autoComplete>

                                <p:watermark for="auto-complete-cotacao"
                                             value="Selecione o Tipo da Solicitação e Tipo de Apuração."
                                             id="watermark"/>

                                <co:botao_informacao
                                    descricao="São exibidas somente cotações do tipo da solicitação e que estejam vigentes."/>

                                <p:commandButton process="@this :Formulario:tb-view:grid-cotacao"
                                                 update=":Formulario:tb-view:panelcadastro :Formulario:tb-view:grid-cotacao :Formulario:tb-view:tbLotes"
                                                 id="bt-limpar-cotacao"
                                                 styleClass="icone-30"
                                                 onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                                 actionListener="#{solicitacaoMaterialControlador.limparCotacao()}"
                                                 disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                 icon="ui-icon-clear"/>
                            </h:panelGrid>

                            <p:outputPanel id="op-data-obra">
                                <fc:outputLabelObrigatorio value="Data do Orçamento da Obra: "
                                                           rendered="#{solicitacaoMaterialControlador.habilitarTipoObra()}"/>
                            </p:outputPanel>
                            <p:outputPanel id="ip-data-obra">
                                <h:panelGroup rendered="#{solicitacaoMaterialControlador.habilitarTipoObra()}">
                                    <p:inputMask mask="99/9999"
                                                 title="Informe o Mês/Ano da Data do Orçamento da Obra."
                                                 value="#{solicitacaoMaterialControlador.dataObra}"
                                                 disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                 maxlength="7" size="7">
                                        <p:ajax event="valueChange"
                                                process="@this"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"
                                                update="@this"
                                                listener="#{solicitacaoMaterialControlador.montarDataOrcamentoObra()}"/>
                                    </p:inputMask>

                                    <h:outputText value="Mês / Ano" styleClass="mlef05 cinzaEscuro"/>
                                </h:panelGroup>
                            </p:outputPanel>

                            <fc:outputLabelObrigatorio value="Justificativa da Cotação:" id="justificativa-campo"
                                                       rendered="#{solicitacaoMaterialControlador.isObrigatorioJustificarCotacao()}"/>
                            <h:panelGrid columns="2" style="margin-left: -3px;" id="justificativa-cotacao"
                                         rendered="#{solicitacaoMaterialControlador.isObrigatorioJustificarCotacao()}">
                                <p:inputTextarea title="Digite a justificativa da Solicitação de Compra"
                                                 value="#{solicitacaoMaterialControlador.selecionado.justificativaCotacao}"
                                                 disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                 cols="70"
                                                 maxlength="255"
                                                 autoResize="true" counterTemplate="{0} Caracteres Restantes."
                                                 counter="counterJustificativaCotacao"/>
                                <h:outputText id="counterJustificativaCotacao"
                                              style="color: #497692"
                                              styleClass="mlef05"/>
                            </h:panelGrid>

                            <h:outputLabel value="Critério de Processamento de Preço: "
                                           rendered="#{solicitacaoMaterialControlador.selecionado.tipoSolicitacao.isCompraServico()}"/>
                            <h:outputText value="#{solicitacaoMaterialControlador.selecionado.criterio.descricao}"
                                          styleClass="negrito"/>
                        </h:panelGrid>

                        <p:dataTable id="tbLotes"
                                     var="lote"
                                     value="#{solicitacaoMaterialControlador.selecionado.loteSolicitacaoMaterials}"
                                     paginator="true"
                                     rows="10"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05 expandir-table"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>LOTES DA SOLICITAÇÃO DE COMPRA&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,30,50"
                                     emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">
                            <p:column style="width:16px" headerText="Itens">
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="Ações" style="width: 60px;" styleClass="alinhamentoCentralizado">
                                <p:commandButton title="Clique para remover este lote."
                                                 actionListener="#{solicitacaoMaterialControlador.removerLote}"
                                                 disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                 icon="ui-icon-trash"
                                                 onclick="if(!confirm('Tem certeza que deseja remover este registro?')) return false; aguarde.show()"
                                                 update="tbLotes :Formulario:tb-view:panelcadastro"
                                                 process="@this"
                                                 styleClass="mlef05"
                                                 onstart="aguarde.show();"
                                                 oncomplete="aguarde.hide(); aguarde.hide()">
                                    <f:attribute value="#{lote}" name="lote" id="lote"/>
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="Número" style="width: 30px;" styleClass="alinhamentoDireita">
                                <h:outputText value="#{lote.numero}"/>
                            </p:column>
                            <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{lote.descricao}"/>
                            </p:column>
                            <p:column headerText="Valor (R$)" style="width: 150px;" styleClass="alinhamentoDireita">
                                <h:outputText value="#{lote.valor}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Desconto Mínimo (%)" style="width: 150px;"
                                      styleClass="alinhamentoDireita"
                                      rendered="#{solicitacaoMaterialControlador.selecionado.tipoAvaliacao.maiorDesconto and
                                      solicitacaoMaterialControlador.selecionado.cotacao.formularioCotacao.tipoApuracaoPorLote}">
                                <p:inputText styleClass="alinhamentoDireita"
                                             value="#{lote.percentualDescontoMinimo}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             onkeypress="mascaraMonetariaDinamica(this, 3, 3)"
                                             maxlength="8">
                                    <f:convertNumber pattern="#,##0.000"/>
                                </p:inputText>
                            </p:column>

                            <p:rowExpansion>
                                <p:dataTable paginator="true"
                                             id="tabela-itens-do-lote"
                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                             rowIndexVar="rowIx"
                                             style="margin-left: 25px;"
                                             styleClass="mtop05 mbot05"
                                             emptyMessage="Não foram localizados registros para serem apresentados"
                                             value="#{lote.itensSolicitacao}"
                                             rows="20"
                                             paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITENS ADICIONADOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                             rowsPerPageTemplate="20,50,100"
                                             var="item"
                                             rowKey="#{item.id}">
                                    <p:column headerText="Ações" style="width: 90px;"
                                              styleClass="alinhamentoCentralizado">
                                        <p:commandButton title="Clique para remover este item."
                                                         actionListener="#{solicitacaoMaterialControlador.removerItemLote(lote, item)}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         icon="ui-icon-trash"
                                                         onclick="if(!confirm('Tem certeza que deseja remover este registro?')) return false;"
                                                         update=":Formulario:tb-view:tbLotes :Formulario:tb-view:panelcadastro"
                                                         process="@this"
                                                         styleClass="mlef05"
                                                         onstart="aguarde.show();"
                                                         oncomplete="aguarde.hide();"/>
                                    </p:column>
                                    <p:column headerText="Nº" styleClass="alinhamentoCentralizado">
                                        <h:outputText value="#{item.numero}"/>
                                    </p:column>
                                    <p:column headerText="Objeto Compra" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{item.objetoCompra}"/>
                                    </p:column>
                                    <p:column headerText="Unid. Med." styleClass="alinhamentoCentralizado">
                                        <h:outputText value="#{item.unidadeMedida}"/>
                                    </p:column>
                                    <p:column
                                        headerText="Grupo"
                                        style="text-align: left; width: 50px; ">
                                        <h:outputText
                                            value="#{item.objetoCompra.grupoContaDespesa.grupo}"/>
                                    </p:column>
                                    <p:column
                                        headerText="Conta" styleClass="alinhamentoEsquerda">
                                        <ad:conta-desdobrada-por-grupo
                                            styleClass="default"
                                            grupoContaDespesa="#{item.objetoCompra.grupoContaDespesa}"/>
                                    </p:column>
                                    <p:column headerText="Qtde" styleClass="alinhamentoCentralizado">
                                        <fc:output-mascara-unidade-medida value="#{item.quantidade}"
                                                                          tipoMascara="#{item.unidadeMedida.mascaraQuantidade}"/>
                                    </p:column>
                                    <p:column headerText="Preço Unit. (R$)" styleClass="alinhamentoDireita">
                                        <fc:output-mascara-unidade-medida value="#{item.preco}"
                                                                          tipoMascara="#{item.unidadeMedida.mascaraValorUnitario}"/>
                                    </p:column>
                                    <p:column headerText="Preço Total (R$)" styleClass="alinhamentoDireita">
                                        <h:outputText value="#{item.precoTotal}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Desconto Mínimo (%)" style="width: 150px;"
                                              styleClass="alinhamentoDireita"
                                              rendered="#{solicitacaoMaterialControlador.selecionado.tipoAvaliacao.maiorDesconto and
                                      solicitacaoMaterialControlador.selecionado.cotacao.formularioCotacao.tipoApuracaoPorItem}">
                                        <p:inputText styleClass="alinhamentoDireita"
                                                     value="#{item.percentualDescontoMinimo}"
                                                     size="12"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     onkeypress="mascaraMonetariaDinamica(this, 3, 3)"
                                                     maxlength="8">
                                            <f:convertNumber pattern="#,##0.000"/>
                                        </p:inputText>
                                    </p:column>
                                    <p:column styleClass="alinhamentoEsquerda">
                                        <f:facet name="header">
                                            <h:outputText value="Item do PCA"/>
                                            <co:botao_informacao styleClass="mlef05 vinteLarguraVinteAltura"
                                                                 styleOverlayPanel="background-color: #BDE5F8 !important; border-color: #00529B !important; color: #00529B !important"
                                                                 descricao="&lt;b>Item do Plano de Contratações Anual&lt;/b>&lt;br/&gt;
                                                                Aqui, devemos indicar se há previsão desta contratação no Plano de Contratações Anual - PCA.&lt;br/&gt;
                                                                Caso não haja previsão no Plano de Contratações Anual, devemos enviar o este DFD para autorização conjunta do&lt;br/&gt;
                                                                Secretário Municipal de Gestão Administrativa e do Secretário Municipal da Casa Civil, com pedido expresso de inserção da demanda.&lt;br/&gt;
                                                                Enquanto o Município não tiver o Plano de Contratações Anual, devemos escrever “não se aplica”.&lt;br/&gt;
                                                                EXEMPLO:&lt;br/&gt;
                                                                Ex.: Item 27 do PCA 2023."/>
                                        </f:facet>
                                        <p:autoComplete queryDelay="1000" id="pacOc"
                                                        title="Informe o item do PAC."
                                                        value="#{item.pcaObjetoCompra}"
                                                        completeMethod="#{solicitacaoMaterialControlador.completarPcaObjetosComprasPorExercicioEUndiadeAdm}"
                                                        converter="#{planoContratacaoAnualControlador.converterPlanoContratacaoAnualObjetoCompra}"
                                                        disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                        forceSelection="true"
                                                        var="pacObjC"
                                                        itemLabel="#{pacObjC}"
                                                        itemValue="#{pacObjC.id}"
                                                        maxResults="10"
                                                        size="20"/>
                                    </p:column>
                                </p:dataTable>
                            </p:rowExpansion>
                        </p:dataTable>
                    </p:tab>

                    <p:tab id="tab-dotacao" title="Dotação Orçamentária">
                        <p:outputPanel id="panel-dotacao">
                            <p:commandButton value="Nova Dotação"
                                             icon="ui-icon-circle-plus"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{solicitacaoMaterialControlador.novaDotacao()}"
                                             rendered="#{!solicitacaoMaterialControlador.hasSolicitacaoDotacao()}"
                                             process="@this"
                                             update=":Formulario:tb-view:panel-dotacao"
                                             styleClass="mtop05"/>

                            <h:panelGrid columns="2" id="grid-dotacao"
                                         rendered="#{solicitacaoMaterialControlador.hasSolicitacaoDotacao()}">

                                <fc:outputLabelObrigatorio value="Unidade Organizacional: "
                                                           rendered="#{solicitacaoMaterialControlador.isProcessoIrpComMaisDeUmaUnidade()}"/>
                                <p:autoComplete queryDelay="1000"
                                                id="unidade-partIrp"
                                                title="Selecione a unidade participante da intenção de registro de preço."
                                                value="#{solicitacaoMaterialControlador.participanteIRP}"
                                                rendered="#{solicitacaoMaterialControlador.isProcessoIrpComMaisDeUmaUnidade()}"
                                                completeMethod="#{solicitacaoMaterialControlador.completarUnidadeParticipanteIrp}"
                                                converter="#{participanteIRPControlador.converterGenerico}"
                                                var="part"
                                                dropdown="true"
                                                panelStyle="max-height: 230px;max-width: 800px"
                                                itemValue="#{part.id}"
                                                itemLabel="#{part}"
                                                maxResults="50"
                                                size="90">
                                    <p:ajax event="itemSelect"
                                            update="consultar-despesa"
                                            process="@this :Formulario:tb-view:grid-dotacao"
                                            onstart="aguarde.show();"
                                            oncomplete="aguarde.hide();"/>
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio value="Dotação Orçamentária: "/>
                                <p:outputPanel id="consultar-despesa">
                                    <co:consultar-despesa-orcamentaria-na-tela
                                        value="#{solicitacaoMaterialControlador.despesaORC}"
                                        mostrarArvoreExpandida="true"
                                        recuperarSomenteUnidadeLogada="true"
                                        update=":Formulario:tb-view:conta-dest :Formulario:tb-view:tabela-itens-dot"
                                        showInfo="false"
                                        showBorda="true"
                                        actionListener="#{solicitacaoMaterialControlador.criarItemDotacao()}"
                                        unidadeAdministrativa="#{solicitacaoMaterialControlador.unidadeDotacao}"
                                        subTipoObjetoCompra="#{solicitacaoMaterialControlador.selecionado.subTipoObjetoCompra}"
                                        tiposObjetoCompra="#{solicitacaoMaterialControlador.tiposObjetoCompraConfiguracao}"/>
                                </p:outputPanel>

                                <fc:outputLabelObrigatorio
                                    value="Conta de Destinação de Recurso: "/>
                                <h:selectOneMenu
                                    id="conta-dest"
                                    value="#{solicitacaoMaterialControlador.dotacao.fonteDespesaORC}"
                                    title="Informe a conta de destinação de recurso."
                                    converter="#{solicitacaoMaterialControlador.converterFonteDespesaORC}">
                                    <f:selectItems
                                        value="#{solicitacaoMaterialControlador.fonteDespesaOrcamentaria}"
                                        var="fo"
                                        itemValue="#{fo.id}"
                                        itemLabel="#{fo}"/>
                                    <p:ajax event="change"
                                            process="@this"/>
                                </h:selectOneMenu>
                            </h:panelGrid>

                            <p:commandButton
                                value="Adicionar"
                                update=":Formulario:tb-view:panel-dotacao"
                                process=":Formulario:tb-view:grid-dotacao @this"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                styleClass="prioritario"
                                title="Clique para adicionar a dotação orçamentária."
                                rendered="#{solicitacaoMaterialControlador.hasSolicitacaoDotacao()}"
                                actionListener="#{solicitacaoMaterialControlador.adicionarDotacao()}"
                                icon="ui-icon-plus"/>

                            <p:commandButton
                                value="Cancelar"
                                styleClass="mlef05 operacao"
                                update=":Formulario:tb-view:panel-dotacao"
                                process="@this"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                title="Clique para cancelar dotação orçamentária."
                                rendered="#{solicitacaoMaterialControlador.hasSolicitacaoDotacao()}"
                                actionListener="#{solicitacaoMaterialControlador.cancelarDotacao()}"
                                icon="ui-icon-cancel"/>

                            <p:dataTable paginator="true"
                                         id="tabela-itens-dot"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05 mbot05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         rendered="#{solicitacaoMaterialControlador.hasSolicitacaoDotacao()}"
                                         value="#{solicitacaoMaterialControlador.dotacao.itens}"
                                         rows="20"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITENS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="20,50,100"
                                         var="itemDot"
                                         rowKey="#{item.id}">
                                <p:column headerText="Lote" styleClass="alinhamentoCentralizado">
                                    <h:outputText value="#{itemDot.itemSolicitacao.loteSolicitacaoMaterial.numero}"/>
                                </p:column>
                                <p:column headerText="Item" styleClass="alinhamentoCentralizado">
                                    <h:outputText value="#{itemDot.itemSolicitacao.numero}"/>
                                </p:column>
                                <p:column headerText="Objeto de Compra" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{itemDot.itemSolicitacao.objetoCompra}"/>
                                </p:column>
                                <p:column headerText="Qtde Solicitada" styleClass="alinhamentoDireita">
                                    <fc:output-mascara-unidade-medida
                                        value="#{itemDot.itemSolicitacao.quantidade}"
                                        tipoMascara="#{itemDot.itemSolicitacao.unidadeMedida.mascaraQuantidade}"/>
                                </p:column>
                                <p:column headerText="Qtde Disponível" styleClass="alinhamentoDireita">
                                    <p:outputPanel id="qtde-disponivel-itemDot">
                                        <fc:output-mascara-unidade-medida
                                            value="#{solicitacaoMaterialControlador.getQuantidadeDisponivelItemDotacao(itemDot)}"
                                            tipoMascara="#{itemDot.itemSolicitacao.unidadeMedida.mascaraQuantidade}"/>
                                    </p:outputPanel>
                                </p:column>
                                <p:column headerText="Quantidade" styleClass="alinhamentoDireita">
                                    <p:outputPanel id="qtde-itemDot">
                                        <fc:input-mascara-unidade-medida
                                            tipoMascara="#{itemDot.itemSolicitacao.unidadeMedida.mascaraQuantidade}"
                                            size="15"
                                            value="#{itemDot.quantidade}"
                                            update=":Formulario:tb-view:tabela-itens-dot:qtde-itemDot
                                                    :Formulario:tb-view:tabela-itens-dot:qtde-disponivel-itemDot
                                                    :Formulario:tb-view:tabela-itens-dot:vl-total-itemDot"
                                            process="@this"
                                            listener="#{solicitacaoMaterialControlador.processarQuantidadeItemDotacao(itemDot)}"/>
                                    </p:outputPanel>
                                </p:column>
                                <p:column headerText="Valor Unitário (R$)" styleClass="alinhamentoDireita">
                                    <fc:output-mascara-unidade-medida
                                        value="#{itemDot.itemSolicitacao.preco}"
                                        tipoMascara="#{itemDot.itemSolicitacao.unidadeMedida.mascaraValorUnitario}"/>
                                </p:column>
                                <p:column headerText="Valor Total (R$)" styleClass="alinhamentoDireita">
                                    <p:outputPanel id="vl-total-itemDot">
                                        <h:outputText value="#{itemDot.valorTotal}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </p:outputPanel>
                                </p:column>
                            </p:dataTable>

                            <p:dataTable emptyMessage="Não foram localizados registros para serem apresentados"
                                         value="#{solicitacaoMaterialControlador.selecionado.dotacoes}"
                                         rendered="#{!solicitacaoMaterialControlador.hasSolicitacaoDotacao()}"
                                         id="tabela-dotacao"
                                         var="dot">
                                <p:column headerText="Itens" style="width: 5%">
                                    <p:rowToggler/>
                                </p:column>
                                <p:column headerText="Ações"
                                          style="width: 9%"
                                          styleClass="alinhamentoCentralizado">
                                    <p:commandButton
                                        process="@this"
                                        update=":Formulario:tb-view:panel-dotacao"
                                        onstart="aguarde.show()"
                                        oncomplete="aguarde.hide()"
                                        title="Clique para adicionar fonte de despesa a reserva da execução."
                                        actionListener="#{solicitacaoMaterialControlador.editarDotacao(dot)}"
                                        disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                        icon="ui-icon-pencil"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     process="@this"
                                                     styleClass="mlef05"
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{solicitacaoMaterialControlador.removerDotacao(dot)}"
                                                     disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                     title="Clique para remover este registro."
                                                     update=":Formulario:tb-view:tabela-dotacao"/>
                                </p:column>
                                <p:column headerText="Fonte Despesa Orçamentária"
                                          styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{dot.fonteDespesaORC}"/>
                                </p:column>

                                <p:rowExpansion>
                                    <p:dataTable paginator="true"
                                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                 rowIndexVar="rowIx"
                                                 style="margin-left: 30px;"
                                                 styleClass="mtop05 mbot05"
                                                 emptyMessage="Não foram localizados registros para serem apresentados"
                                                 value="#{dot.itens}"
                                                 rows="20"
                                                 paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITENS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                 currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                                 rowsPerPageTemplate="20,50,100"
                                                 var="itemDotSol"
                                                 rowKey="#{item.id}">
                                        <p:column headerText="Lote" styleClass="alinhamentoCentralizado">
                                            <h:outputText
                                                value="#{itemDotSol.itemSolicitacao.loteSolicitacaoMaterial.numero}"/>
                                        </p:column>
                                        <p:column headerText="Item" styleClass="alinhamentoCentralizado">
                                            <h:outputText value="#{itemDotSol.itemSolicitacao.numero}"/>
                                        </p:column>
                                        <p:column headerText="Objeto de Compra" styleClass="alinhamentoEsquerda">
                                            <h:outputText value="#{itemDotSol.itemSolicitacao.objetoCompra}"/>
                                        </p:column>
                                        <p:column headerText="Quantidade" styleClass="alinhamentoDireita">
                                            <fc:output-mascara-unidade-medida value="#{itemDotSol.quantidade}"
                                                                              tipoMascara="#{itemDotSol.itemSolicitacao.unidadeMedida.mascaraQuantidade}"/>
                                        </p:column>
                                        <p:column headerText="Valor Unitário (R$)" styleClass="alinhamentoDireita">
                                            <fc:output-mascara-unidade-medida
                                                value="#{itemDotSol.itemSolicitacao.preco}"
                                                tipoMascara="#{itemDotSol.itemSolicitacao.unidadeMedida.mascaraValorUnitario}"/>
                                        </p:column>
                                        <p:column headerText="Valor Total (R$)" styleClass="alinhamentoDireita">
                                            <h:outputText value="#{itemDotSol.valorTotal}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </p:column>
                                    </p:dataTable>
                                </p:rowExpansion>
                            </p:dataTable>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Órgão/Entidade Participante"
                           rendered="#{solicitacaoMaterialControlador.selecionado.isRegistroDePrecos()}">
                        <p:outputPanel id="panel-unidade-participante">
                            <p:commandButton value="Novo Órgão/Entidade Participante"
                                             icon="ui-icon-circle-plus"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             disabled="#{solicitacaoMaterialControlador.processoIrp or solicitacaoMaterialControlador.bloquearEdicao}"
                                             actionListener="#{solicitacaoMaterialControlador.novaUnidadeParticipante()}"
                                             process="@this"
                                             update=":Formulario:tb-view:panel-unidade-participante"
                                             styleClass="mtop05"/>

                            <p:panel id="panel-nova-unidade-participante"
                                     header="Novo Órgão/Entidade Participante"
                                     rendered="#{solicitacaoMaterialControlador.unidadeSolicitacaoMaterialSelecionada ne null}"
                                     styleClass="mtop05 mbot05">
                                <h:panelGrid columns="2"
                                             styleClass="mbot05">

                                    <fc:outputLabelObrigatorio value="Órgão/Entidade Participante:"/>
                                    <p:autoComplete queryDelay="1000" id="unidade-participante"
                                                    title="Informe a unidade participante da solicitação de compra."
                                                    value="#{solicitacaoMaterialControlador.unidadeSolicitacaoMaterialSelecionada.unidadeGestora}"
                                                    completeMethod="#{solicitacaoMaterialControlador.completaUnidadeGestora}"
                                                    converter="#{unidadeGestoraControlador.converterGenerico}"
                                                    forceSelection="true"
                                                    var="unidade"
                                                    itemLabel="#{unidade.descricao}"
                                                    itemValue="#{unidade.id}"
                                                    maxResults="10"
                                                    size="70">
                                        <p:ajax event="itemSelect" update="@this" process="@this"
                                                onstart="aguarde.show();" oncomplete="aguarde.hide();"/>
                                    </p:autoComplete>
                                </h:panelGrid>

                                <p:commandButton value="Confirmar"
                                                 styleClass="mrig05"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 process="panel-nova-unidade-participante"
                                                 title="Clique para confirmar esta unidade participante."
                                                 update=":Formulario:tb-view:panel-unidade-participante"
                                                 actionListener="#{solicitacaoMaterialControlador.confirmarUnidadeParticipante()}"
                                                 icon="ui-icon-check"/>

                                <p:commandButton value="Cancelar"
                                                 process="@this"
                                                 onclick="aguarde.show();"
                                                 oncomplete="aguarde.hide()"
                                                 title="Clique para cancelar esta unidade participante."
                                                 actionListener="#{solicitacaoMaterialControlador.cancelarUnidadeParticipante()}"
                                                 update=":Formulario:tb-view:panel-unidade-participante"
                                                 icon="ui-icon-cancel"/>
                            </p:panel>

                            <p:dataTable paginator="true"
                                         id="tabela-unidades-participantes"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         value="#{solicitacaoMaterialControlador.selecionado.unidadesParticipantes}"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ÓRGÃOS/ENTIDADES PARTICIPANTES&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,25,50,100"
                                         var="unid">

                                <c:if
                                    test="#{!solicitacaoMaterialControlador.processoIrp}">
                                    <p:column headerText="Ações" style="text-align: center; width: 90px;">
                                        <p:commandButton icon="ui-icon-pencil"
                                                         title="Clique para alterar este registro."
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide();"
                                                         process="@this"
                                                         actionListener="#{solicitacaoMaterialControlador.selecionarUnidadeParticipante(unid)}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         update=":Formulario:tb-view:panel-unidade-participante"
                                                         styleClass="mrig05"/>

                                        <p:commandButton icon="ui-icon-trash"
                                                         process="@this"
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         oncomplete="aguarde.hide()"
                                                         actionListener="#{solicitacaoMaterialControlador.removerUnidadeParticipante(unid)}"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         title="Clique para remover este registro."
                                                         update="tabela-unidades-participantes"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{unid.unidadeGestora.descricao}"/>
                                    </p:column>
                                </c:if>


                                <c:if
                                    test="#{solicitacaoMaterialControlador.processoIrp}">
                                    <p:column headerText="Itens" style="width: 5%; text-align: center">
                                        <p:commandButton icon="ui-icon-search"
                                                         title="Clique para visualizar os itens do participante."
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide();dlgItemParticipante.show()"
                                                         process="@this"
                                                         actionListener="#{solicitacaoMaterialControlador.selecionarParticipanteIrp(unid.participanteIRP)}"
                                                         update=":formItemParticipante"
                                                         styleClass="mrig05"/>
                                    </p:column>

                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{unid.participanteIRP.hierarquiaOrganizacional}"/>
                                    </p:column>
                                    <p:column headerText="Situação" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{unid.participanteIRP.situacao.descricao}"/>
                                    </p:column>
                                </c:if>

                            </p:dataTable>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Critério Técnica"
                           rendered="#{solicitacaoMaterialControlador.selecionado.isTecnicaEPreco()}">
                        <p:outputPanel id="panel-criterio-tecnica">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="Valor para Habilitação:"/>
                                <p:inputText id="valor-para-habilitacao"
                                             title="Digite o valor que será usado no cálculo para habilitação do fornecedor."
                                             value="#{solicitacaoMaterialControlador.selecionado.criterioTecnicaSolicitacao.valorHabilitacao}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             size="10"/>
                            </h:panelGrid>

                            <div style="text-align: left;" class="mtop05">
                                <p:commandButton
                                    actionListener="#{solicitacaoMaterialControlador.novoItemCriterioTecnicaQuantitativo()}"
                                    value="Novo Item Quantitativo"
                                    id="novoItemCriterioQuantitativo"
                                    icon="ui-icon-circle-plus"
                                    title="Clique para adicionar novo item do critério quantitativo."
                                    styleClass="padrao mrig10"
                                    update=":form-item-criterio-tecnica:panel-novo-item-criterio-tecnica"
                                    process="@this"
                                    disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                    onclick="aguarde.show();"
                                    oncomplete="aguarde.hide(); dialogItemCriterioTecnica.show();"/>

                                <p:commandButton
                                    actionListener="#{solicitacaoMaterialControlador.novoItemCriterioTecnicaQualitativo()}"
                                    value="Novo Item Qualitativo"
                                    id="novoItemCriterioQualitativo"
                                    icon="ui-icon-circle-plus"
                                    title="Clique para adicionar novo item do critério qualitativo."
                                    styleClass="padrao"
                                    update=":form-item-criterio-tecnica:panel-novo-item-criterio-tecnica"
                                    process="@this"
                                    disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                    onclick="aguarde.show();"
                                    oncomplete="aguarde.hide(); dialogItemCriterioTecnica.show();"/>
                            </div>

                            <p:dataTable id="tabela-item-criterio"
                                         var="item"
                                         value="#{solicitacaoMaterialControlador.selecionado.criterioTecnicaSolicitacao.itens}"
                                         paginator="true"
                                         rows="10"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITENS CRITÉRIO TÉCNICA&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,30,50"
                                         emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">

                                <p:column headerText="Ações" style="text-align: center; width: 90px;">
                                    <div style="display: flex; flex-direction: row">
                                        <p:commandButton icon="ui-icon-pencil"
                                                         title="Clique para alterar este registro."
                                                         onclick="aguarde.show();"
                                                         oncomplete="aguarde.hide(); dialogItemCriterioTecnica.show();"
                                                         process="@this"
                                                         actionListener="#{solicitacaoMaterialControlador.editarItemCriterioTecnica(item)}"
                                                         update=":form-item-criterio-tecnica:panel-novo-item-criterio-tecnica"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                                         styleClass="mrig05"/>

                                        <p:commandButton icon="ui-icon-trash"
                                                         process="@this"
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         oncomplete="aguarde.hide()"
                                                         actionListener="#{solicitacaoMaterialControlador.removerItemCriterioTecnica(item)}"
                                                         title="Clique para remover este registro."
                                                         update="tabela-item-criterio"
                                                         disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"/>
                                    </div>
                                </p:column>
                                <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{item.descricao}"/>
                                </p:column>

                                <p:column headerText="Tipo" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{item.tipoItemCriterioTecnica.descricao}"/>
                                </p:column>
                            </p:dataTable>

                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Critério Preço"
                           rendered="#{solicitacaoMaterialControlador.selecionado.isTecnicaEPreco()}">
                        <p:outputPanel id="panel-criterio-preco">
                            <h:panelGrid columns="2"
                                         styleClass="mbot05">

                                <fc:outputLabelObrigatorio value="Nota da Menor Proposta:"/>
                                <p:inputText id="nota-criterio-preco"
                                             title="Digite a nota de referência para a menor proposta."
                                             value="#{solicitacaoMaterialControlador.selecionado.criterioPrecoSolicitacao.nota}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             size="10"/>

                            </h:panelGrid>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Classificação Final"
                           rendered="#{solicitacaoMaterialControlador.selecionado.isTecnicaEPreco()}">
                        <p:outputPanel id="panel-classificacao-final">
                            <h:panelGrid columns="2"
                                         styleClass="mbot05">

                                <fc:outputLabelObrigatorio value="Peso Critério Técnica:"/>
                                <p:inputText id="peso-criterio-tecnica"
                                             title="Digite o peso para o critério técnica."
                                             value="#{solicitacaoMaterialControlador.selecionado.classificacaoFinalSolicitacao.pesoTecnica}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             size="5"/>

                                <fc:outputLabelObrigatorio value="Peso Critério Preço:"/>
                                <p:inputText id="peso-criterio-preco"
                                             title="Digite o peso para o critério preço."
                                             value="#{solicitacaoMaterialControlador.selecionado.classificacaoFinalSolicitacao.pesoPreco}"
                                             disabled="#{solicitacaoMaterialControlador.bloquearEdicao}"
                                             size="5"/>

                            </h:panelGrid>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab id="tabDocumentosOficiais" title="Documentos Oficiais"
                           rendered="#{solicitacaoMaterialControlador.operacaoEditar}">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Tipo de Documento Oficial: "/>
                            <p:autoComplete queryDelay="1000"
                                            title="Selecione o Tipo de Documento Oficial de Notificação para Cadastro Econômico"
                                            size="70"
                                            var="tdo"
                                            dropdown="true"
                                            completeMethod="#{solicitacaoMaterialControlador.completarTiposDoctosOficiais}"
                                            itemValue="#{tdo.id}"
                                            itemLabel="#{tdo.descricao}"
                                            value="#{solicitacaoMaterialControlador.tipoDoctoOficial}"
                                            converter="#{tipoDoctoOficialControlador.converterGenerico}"/>
                        </h:panelGrid>

                        <p:commandButton value="Adicionar"
                                         icon="ui-icon-circle-plus"
                                         styleClass="mtop10 mrig05"
                                         onclick="aguarde.show()"
                                         onsuccess="aguarde.hide()"
                                         title="Clique para gerar e adicionar o documento oficial."
                                         update=":Formulario:tb-view:tableVoDocumentosOficiais"
                                         actionListener="#{solicitacaoMaterialControlador.adicionarDocumentoOficial()}"/>

                        <p:dataTable id="tableVoDocumentosOficiais"
                                     var="voSmdo"
                                     value="#{solicitacaoMaterialControlador.voDocumentosOficiais}"
                                     paginator="true"
                                     rows="10"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>DOCUMENTOS OFICIAIS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,30,50"
                                     emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">
                            <p:column style="width: 3%" styleClass="alinhamentoCentralizado">
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="Tipo de Documento Ofícial" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{voSmdo.tipoDoctoOficial}"/>
                            </p:column>
                            <p:column headerText="Versão Atual" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{voSmdo.documentosOficiais.size()}"/>
                            </p:column>
                            <p:rowExpansion>
                                <p:dataTable id="tableDocumentosOficiais"
                                             var="smdo"
                                             value="#{voSmdo.documentosOficiais}"
                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                             rowIndexVar="rowIx"
                                             styleClass="mtop10"
                                             paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>&lt;/span>"
                                             emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">

                                    <p:column headerText="Ações" style="text-align: center; width: 15%;">
                                        <fc:botaoTargetBlank
                                            title="Clique para imprimir o documento ofícial."
                                            icon="ui-icon-print"
                                            styleClass="icone-30 mrig05"
                                            imprimeNoDialog="true"
                                            actionListener="#{solicitacaoMaterialControlador.imprimirDocumentoOficial(smdo)}"/>

                                        <p:commandButton icon="ui-icon-pencil"
                                                         title="Clique para editar o conteudo do documento oficial."
                                                         onclick="aguarde.show();"
                                                         oncomplete="aguarde.hide(); dialogEditarConteudoDocumentoOficial.show()"
                                                         disabled="#{solicitacaoMaterialControlador.isSolicitacaoAprovada() or !solicitacaoMaterialControlador.isUltimaVersaoDocumentoOficial(smdo)}"
                                                         actionListener="#{solicitacaoMaterialControlador.editarDocumentoOficial(smdo)}"
                                                         styleClass="icone-30 mrig05"/>

                                        <p:commandButton icon="ui-icon-trash"
                                                         styleClass="icone-30 mrig05"
                                                         process="@this"
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{solicitacaoMaterialControlador.isSolicitacaoAprovada() or !solicitacaoMaterialControlador.isUltimaVersaoDocumentoOficial(smdo)}"
                                                         actionListener="#{solicitacaoMaterialControlador.removerDocumentoOficial(smdo)}"
                                                         title="Clique para remover este registro."
                                                         update="tableDocumentosOficiais"/>
                                    </p:column>
                                    <p:column headerText="Número" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{smdo.documentoOficial.numero}"/>
                                    </p:column>
                                    <p:column headerText="Data Emissão" styleClass="alinhamentoCentralizado">
                                        <h:outputText value="#{smdo.documentoOficial.dataEmissao}">
                                            <f:convertDateTime type="both"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Versão" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{smdo.versao}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:rowExpansion>
                        </p:dataTable>
                    </p:tab>

                    <p:tab title="Histórico do Processo"
                           rendered="#{solicitacaoMaterialControlador.isOperacaoEditar()}"
                           titleStyle="background: #d9edf7" id="tab-historico">
                        <ad:historico-processo-licitatorio
                            filtroProcesso="#{solicitacaoMaterialControlador.filtroHistoricoProcesso}"/>
                    </p:tab>

                    <p:tab id="tabAnexo" title="Anexos">
                        <fc:detentorDocumentoLicitacao selecionado="#{solicitacaoMaterialControlador.selecionado}"/>
                    </p:tab>
                </p:tabView>
            </p:panel>

            <fc:rodapePretty controlador="#{solicitacaoMaterialControlador}"/>
        </h:form>

        <p:dialog modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="false"
                  resizable="false"
                  showHeader="false"
                  widgetVar="dialogItemCriterioTecnica"
                  closable="false">
            <h:form id="form-item-criterio-tecnica">
                <p:outputPanel id="panel-novo-item-criterio-tecnica"
                               styleClass="mtop10 mbot05">
                    <table>
                        <tr>
                            <td><h:outputLabel
                                value="Item #{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica.descricao}"
                                styleClass="azulnegrito" style="font-size: 14px;"/></td>
                            <td width="500"><p:separator style="width: 100%; margin: 0!important"/></td>
                        </tr>
                    </table>

                    <h:panelGrid columns="3">
                        <fc:outputLabelObrigatorio value="Descrição:"/>
                        <p:inputTextarea id="descricao-item-criterio-tecnica"
                                         style="margin-left: 43px;"
                                         maxlength="255"
                                         counterTemplate="{0} Caracteres Restantes."
                                         counter="counter-objeto-do-contrato"
                                         title="Digite a descrição do item."
                                         value="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.descricao}"
                                         cols="60"/>
                        <h:outputText id="counter-objeto-do-contrato"
                                      style="color: #497692"
                                      styleClass="mlef05"/>
                    </h:panelGrid>

                    <table class="mtop10">
                        <tr>
                            <td><h:outputLabel
                                value="Pontuação"
                                styleClass="azulnegrito" style="font-size: 14px;"/></td>
                            <td width="550"><p:separator style="width: 100%; margin: 0!important"/></td>
                        </tr>
                    </table>

                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio
                            value="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO' ? 'Quantidade Inicial:' : 'Pontuação Mínima:'}"/>
                        <p:inputText id="quantidade-inicial-item-criterio-tecnica"
                                     title="Digite a quantidade incial."
                                     size="10"
                                     onkeypress="somenteNumeros(event, this, false, true, true)"
                                     autocomplete="off"
                                     value="#{solicitacaoMaterialControlador.pontuacaoTecnicaSelecionado.quantidadeInicial}"/>

                        <fc:outputLabelObrigatorio
                            value="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO' ? 'Quantidade Final:' : 'Pontuação Máxima:'}"/>
                        <p:inputText id="quantidade-final-item-criterio-tecnica"
                                     title="Digite a quantidade final."
                                     size="10"
                                     onkeypress="somenteNumeros(event, this, false, true, true)"
                                     autocomplete="off"
                                     value="#{solicitacaoMaterialControlador.pontuacaoTecnicaSelecionado.quantidadeFinal}"/>

                        <fc:outputLabelObrigatorio value="Ponto:"
                                                   rendered="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO'}"/>
                        <p:inputText id="ponto-item-criterio-tecnica"
                                     rendered="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO'}"
                                     title="Digite o número de pontos do item."
                                     size="10"
                                     onkeypress="somenteNumeros(event, this, false, true, true)"
                                     autocomplete="off"
                                     value="#{solicitacaoMaterialControlador.pontuacaoTecnicaSelecionado.ponto}"/>
                    </h:panelGrid>


                    <p:commandButton value="Confirmar Pontuação"
                                     styleClass="padrao mtop10"
                                     onclick="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     process="panel-novo-item-criterio-tecnica"
                                     title="Clique para confirmar esta pontuação."
                                     update=":form-item-criterio-tecnica:panel-novo-item-criterio-tecnica"
                                     actionListener="#{solicitacaoMaterialControlador.confirmarPontuacaoTecnica()}"
                                     icon="ui-icon-check"/>

                    <p:dataTable id="tabela-pontuacao-item-criterio"
                                 var="ponto"
                                 value="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.pontos}"
                                 paginator="true"
                                 rows="10"
                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                 rowIndexVar="rowIx"
                                 styleClass="mtop10"
                                 paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>PONTUAÇÃO ITEM&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                                 rowsPerPageTemplate="10,30,50"
                                 emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">

                        <p:column headerText="Ações" style="text-align: center; width: 90px;">
                            <p:commandButton icon="ui-icon-pencil"
                                             title="Clique para alterar este registro."
                                             onclick="aguarde.show();"
                                             oncomplete="aguarde.hide();"
                                             process="@this"
                                             actionListener="#{solicitacaoMaterialControlador.selecionarPontuacaoTecnica(ponto)}"
                                             update=":form-item-criterio-tecnica:panel-novo-item-criterio-tecnica"
                                             styleClass="mrig05"/>

                            <p:commandButton icon="ui-icon-trash"
                                             process="@this"
                                             onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{solicitacaoMaterialControlador.removerPontuacaoTecnica(ponto)}"
                                             title="Clique para remover este registro."
                                             update="tabela-pontuacao-item-criterio
                                                     :form-item-criterio-tecnica:btn-confirmar-item"/>
                        </p:column>
                        <p:column
                            headerText="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO' ? 'Quantidade Inicial' : 'Pontuação Mínima'}"
                            styleClass="alinhamentoDireita">
                            <h:outputText value="#{ponto.quantidadeInicial}"/>
                        </p:column>
                        <p:column
                            headerText="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO' ? 'Quantidade Final' : 'Pontuação Máxima'}"
                            styleClass="alinhamentoDireita">
                            <h:outputText value="#{ponto.quantidadeFinal}"/>
                        </p:column>
                        <p:column headerText="Ponto"
                                  rendered="#{solicitacaoMaterialControlador.itemCriterioTecnicaSelecionado.tipoItemCriterioTecnica eq 'QUANTITATIVO'}"
                                  styleClass="alinhamentoDireita">
                            <h:outputText value="#{ponto.ponto}"/>
                        </p:column>

                    </p:dataTable>

                    <div align="center" class="mtop05">
                        <p:commandButton id="btn-confirmar-item"
                                         value="Confirmar"
                                         styleClass="padrao mrig05"
                                         onclick="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                                         process="panel-novo-item-criterio-tecnica"
                                         title="Clique para confirmar este item."
                                         update=":Formulario:tb-view:tabela-item-criterio @form"
                                         disabled="#{solicitacaoMaterialControlador.nenhumaPontuacaoAdicionadaAoItem()}"
                                         actionListener="#{solicitacaoMaterialControlador.confirmarItemCriterioTecnica}"
                                         icon="ui-icon-check"/>

                        <p:commandButton value="Fechar"
                                         styleClass="padrao"
                                         onclick="aguarde.show();"
                                         oncomplete="aguarde.hide();"
                                         title="Clique para fechar."
                                         actionListener="#{solicitacaoMaterialControlador.fecharDialogItemCriterioTecnica()}"
                                         process="@this"
                                         update="@none"
                                         icon="ui-icon-cancel"/>
                    </div>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog showHeader="false"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="false"
                  resizable="false"
                  widgetVar="dialogCriterioProcessamentoPrecoItens"
                  closable="false">
            <h:form id="formulario-criterio-processamento-preco-item">

                <p:panel header="Critério para Processamento de Preço dos Itens" styleClass="mtop05">
                    <div align="center">
                        <div class="mtop05 alert alert-info">
                            <h:outputText value="Qual critério será utilizado para processar o preço dos itens?"
                                          style="font-size: 15px;"/>


                            <h:panelGrid columns="2" cellpadding="3" cellspacing="3">
                                <fc:outputLabelObrigatorio value="Critério:" style="font-size: 15px"
                                                           styleClass="negrito"/>
                                <h:selectOneListbox id="criterio"
                                                    style="font-size: 15px"
                                                    value="#{solicitacaoMaterialControlador.selecionado.criterio}">
                                    <f:selectItems value="#{solicitacaoMaterialControlador.criteriosProcessamento}"/>
                                </h:selectOneListbox>
                            </h:panelGrid>
                        </div>

                        <p:commandButton id="btn-processar-valor-item"
                                         icon="ui-icon-check"
                                         value="Processar Itens"
                                         styleClass="padrao mtop10"
                                         process="@this :formulario-criterio-processamento-preco-item"
                                         actionListener="#{solicitacaoMaterialControlador.processarItensCotacao()}"
                                         onclick="aguarde.show()"
                                         oncomplete="aguarde.hide(); expandirRowToggler();"/>
                    </div>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog header="Justificativa da Cotação"
                  modal="true"
                  dynamic="true"
                  position="center"
                  max-height="430"
                  style="position: fixed !important"
                  resizable="false"
                  width="1000"
                  widgetVar="dlgJustificativa"
                  closable="false">
            <h:form id="formulario-justificativa">

                <div class="mtop05 mbot05 alinhamentoCentralizado alert alert-alert">
                    <strong>Atenção!</strong> Para utilizar esta cotação será necessário justifica-lá. O que deseja fazer?
                    <br/>
                    Ao continuar, será habilitado o campo 'Justificativa da Cotação' para realizar a justificativa.
                </div>

                <p:outputPanel id="fornecedor" rendered="#{solicitacaoMaterialControlador.quantidadeMinimaFornecedor}">
                    <h:outputText value="  &#10004; " styleClass="verdenegrito"/>
                    <h:outputText
                        value="Esta cotação possui menos que três fornecedores, será necessário justificar. "/>
                </p:outputPanel>

                <p:outputPanel id="item" rendered="#{solicitacaoMaterialControlador.quantidadeMinimaProposta}">
                    <br/>
                    <h:outputText style="font-size: 12px!important;"
                                  value="&#10004;" styleClass="verdenegrito"/>
                    <h:outputText style="font-size: 12px!important;"
                                  value=" O(s) Item(ns) a baixo possuem menos que três propostas será necessário justificar. "/>

                    <p:dataTable
                        var="item"
                        value="#{solicitacaoMaterialControlador.itensCotacaoJustificaveis}"
                        paginator="true"
                        rows="10"
                        id="tabela-justificativa"
                        styleClass="mtop05"
                        rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                        rowIndexVar="rowIx"
                        paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITEM(NS) PARA JUSITIFICAR&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        currentPageReportTemplate="({startRecord}-{endRecord} de {totalRecords} | Página: {currentPage}/{totalPages})"
                        rowsPerPageTemplate="5"
                        emptyMessage="Não foi adicionado nenhum registro para ser apresentado.">
                        <p:column headerText="Itens"
                                  styleClass="alinhamentoEsquerda"
                                  style="width: auto!important;">
                            <h:outputText value="#{item.toString()}"/>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>

                <div class="alinhamentoCentralizado mtop10 mbot05">
                    <p:commandButton
                        icon="ui-icon-check"
                        value="Continuar e Justificar"
                        styleClass="padrao"
                        process="formulario-justificativa"
                        update="@none"
                        onclick="aguarde.show()"
                        oncomplete="dlgJustificativa.hide(); aguarde.hide(); dialogCriterioProcessamentoPrecoItens.show();"
                    />

                    <p:commandButton
                        icon="ui-icon-cancel"
                        value="Cancelar e selecionar outra cotação."
                        styleClass="padrao mlef05"
                        process="@this"
                        update=":Formulario:panel-geral"
                        actionListener="#{solicitacaoMaterialControlador.limparCotacaoPlanilhaOrcamentaria()}"
                        onclick="aguarde.show()"
                        oncomplete="aguarde.hide(); dlgJustificativa.hide();"
                    />
                </div>
            </h:form>
        </p:dialog>

        <p:dialog
            modal="true"
            dynamic="true"
            position="center"
            showHeader="false"
            style="position: fixed !important; width: auto!important; height: auto!important;"
            draggable="false"
            resizable="false"
            width="1100"
            widgetVar="dlgItemParticipante"
            closable="false">

            <h:form id="formItemParticipante">
                <legend
                    class="legenda azul">Participante: #{solicitacaoMaterialControlador.participanteIRP.hierarquiaOrganizacional}

                    <p:commandButton icon="ui-icon-close"
                                     title="Clique para fechar."
                                     process="@this"
                                     style="float: right !important;"
                                     styleClass="mtop10 botao-transparente icone-20"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide();dlgItemParticipante.hide();"/>
                </legend>

                <ad:detalhes-itens-irp participanteIRP="#{solicitacaoMaterialControlador.participanteIRP}"/>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
</html>
