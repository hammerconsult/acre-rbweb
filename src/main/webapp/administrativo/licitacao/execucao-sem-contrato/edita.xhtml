<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:ad="http://java.sun.com/jsf/composite/components/administrativo"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fcc="http://java.sun.com/jsf/composite/components/contabil">
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <script type="text/javascript">
            function scrollPanel() {
                window.scrollTo(0, 500);
            }
        </script>

        <h:form id="Formulario">

            <p:remoteCommand name="limparDados"
                             process="@this"
                             actionListener="#{execucaoProcessoControlador.limparDadosProcesso()}"
                             update=":Formulario:tab-view-geral:panel-wizard :Formulario:panelSaldo
                                     :Formulario:tab-view-geral:grid-execucao btnVerAta btnVerDispensa"/>

            <fc:cabecalhoPretty origem="#{execucaoProcessoControlador.caminhoPadrao}listar/"
                                controlador="#{execucaoProcessoControlador}"/>

            <p:panel header="Execução Sem Contrato">

                <h:panelGrid columns="2" id="gridProcesso">
                    <fc:outputLabelObrigatorio value="Tipo de Execução: "/>
                    <h:selectOneMenu
                        disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                        value="#{execucaoProcessoControlador.selecionado.tipoExecucao}"
                        title="Selecione o tipo de execução para iniciar o processo.">
                        <f:selectItems
                            value="#{execucaoProcessoControlador.tiposExecucao}"/>
                        <p:ajax event="change"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                listener="#{execucaoProcessoControlador.listenerTipoExecucao()}"
                                update="gridProcesso :Formulario:tab-view-geral:panel-wizard :Formulario:tab-view-geral:grid-execucao :Formulario:panelSaldo"
                                process="@this"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Ata Registro de Preço: "
                                               rendered="#{execucaoProcessoControlador.selecionado.isExecucaoAta()}"/>
                    <h:panelGroup rendered="#{execucaoProcessoControlador.selecionado.isExecucaoAta()}">
                        <p:autoComplete queryDelay="1000"
                                        id="ac-ata"
                                        size="70"
                                        title="Selecione uma ata registro de preço"
                                        value="#{execucaoProcessoControlador.ataRegistroPreco}"
                                        completeMethod="#{execucaoProcessoControlador.completarAtaRegistroPreco}"
                                        converter="#{ataRegistroPrecoControlador.converterGenerico}"
                                        disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                        maxResults="50"
                                        dropdown="true"
                                        panelStyle="max-height: 250px;max-width: 1000px"
                                        onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                        var="ata"
                                        itemValue="#{ata.id}"
                                        itemLabel="#{ata}">
                            <p:ajax event="itemSelect"
                                    onstart="aguarde.show()"
                                    oncomplete="aguarde.hide()"
                                    listener="#{execucaoProcessoControlador.listenerProcesso()}"
                                    update=":Formulario:tab-view-geral:panel-wizard :Formulario:panelSaldo
                                            :Formulario:tab-view-geral:grid-execucao btnVerAta"
                                    process="@this"/>
                        </p:autoComplete>

                        <p:commandButton process="@none"
                                         styleClass="mlef05"
                                         id="btnVerAta"
                                         icon="ui-icon-search"
                                         disabled="#{execucaoProcessoControlador.ataRegistroPreco eq null}"
                                         update="@none"
                                         onclick="window.open('#{request.contextPath}/ata-registro-preco/ver/#{execucaoProcessoControlador.ataRegistroPreco.id}/','_blank');"/>
                    </h:panelGroup>

                    <fc:outputLabelObrigatorio value="Dispensa/Inexigibilidade: "
                                               rendered="#{execucaoProcessoControlador.selecionado.isExecucaoDispensa()}"/>
                    <h:panelGroup rendered="#{execucaoProcessoControlador.selecionado.isExecucaoDispensa()}">
                        <p:autoComplete queryDelay="1000"
                                        id="ac-dispensa"
                                        size="70"
                                        title="Selecione uma dispensa/inexigibilidade"
                                        value="#{execucaoProcessoControlador.dispensaDeLicitacao}"
                                        completeMethod="#{execucaoProcessoControlador.completarDispensaLicitacao}"
                                        converter="#{dispensaDeLicitacaoControlador.converterGenerico}"
                                        disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                        maxResults="50"
                                        dropdown="true"
                                        panelStyle="max-height: 250px;max-width: 1000px"
                                        onkeyup="if(keyUpCampoVazio(this)){limparDados();}"
                                        var="disp"
                                        itemValue="#{disp.id}"
                                        itemLabel="#{disp.toStringAutoComplete()}">
                            <p:ajax event="itemSelect"
                                    onstart="aguarde.show()"
                                    oncomplete="aguarde.hide()"
                                    listener="#{execucaoProcessoControlador.listenerProcesso()}"
                                    update=":Formulario:tab-view-geral:panel-wizard :Formulario:tab-view-geral:grid-execucao btnVerDispensa :Formulario:panelSaldo"
                                    process="@this"/>
                        </p:autoComplete>

                        <p:commandButton process="@none"
                                         styleClass="mlef05"
                                         id="btnVerDispensa"
                                         icon="ui-icon-search"
                                         disabled="#{execucaoProcessoControlador.dispensaDeLicitacao eq null}"
                                         update="@none"
                                         onclick="window.open('#{request.contextPath}/dispensa-licitacao/ver/#{execucaoProcessoControlador.dispensaDeLicitacao.id}/','_blank');"/>
                    </h:panelGroup>
                </h:panelGrid>

                <p:outputPanel id="panelSaldo">
                    <ad:detalhes-saldo-processo
                        rendered="#{execucaoProcessoControlador.ataRegistroPreco ne null
                                    or execucaoProcessoControlador.dispensaDeLicitacao ne null}"
                        saldoProcesso="#{execucaoProcessoControlador.saldoProcesso}"/>
                </p:outputPanel>

                <p:tabView id="tab-view-geral" styleClass="mtop10">
                    <p:tab title="Dados da Execução" id="tabExecucao">
                        <p:outputPanel id="grid-execucao">
                            <h:panelGrid cellpadding="2" cellspacing="2"
                                         id="gridExecucao"
                                         rendered="#{execucaoProcessoControlador.hasProcessoInformado()}"
                                         columns="2">
                                <h:outputText value="Número: "/>
                                <h:outputText
                                    value="#{execucaoProcessoControlador.selecionado.numero}"
                                    styleClass="negrito"/>

                                <h:outputText value="Data de Lançamento: "/>
                                <h:outputText
                                    value="#{execucaoProcessoControlador.selecionado.dataLancamento}"
                                    styleClass="negrito">
                                    <f:convertDateTime type="date"/>
                                </h:outputText>

                                <fc:outputLabelObrigatorio value="Unidade Orçamentária: "/>
                                <p:autoComplete queryDelay="1000"
                                                id="unidadeOrc"
                                                size="70"
                                                title="Informe uma hierarquia orçamentária."
                                                value="#{execucaoProcessoControlador.hierarquiaOrcamentaria}"
                                                completeMethod="#{execucaoProcessoControlador.completarHierarquiaOrcamentaria}"
                                                converter="#{hierarquiaOrganizacionalControlador.converterHierarquiaOrganizacional}"
                                                disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                                maxResults="50"
                                                dropdown="true"
                                                panelStyle="max-height: 250px;max-width: 1000px"
                                                var="hoOrc"
                                                itemValue="#{hoOrc.id}"
                                                itemLabel="#{hoOrc}">
                                    <p:ajax event="itemSelect"
                                            process="@this"/>
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio value="Forma de Entrega: "/>
                                <h:panelGrid columns="3">
                                    <h:selectOneMenu
                                        disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                        value="#{execucaoProcessoControlador.selecionado.formaEntrega}"
                                        title="Informe a forma de entrega da execução.">
                                        <f:selectItems
                                            value="#{execucaoProcessoControlador.formasEntrega}"/>
                                        <p:ajax event="change"
                                                process="@this"
                                                update="panel-info-fe"/>
                                    </h:selectOneMenu>

                                    <p:outputPanel id="panel-info-fe">
                                        <div class="label label-info"
                                             style="padding: 0.5%; margin-left: 5px; font-weight: normal;
                                         display: #{execucaoProcessoControlador.selecionado.formaEntrega.isParcelada() ? 'block' : 'none'}">
                                            Permite empenho do tipo 'GLOBAL' ou 'ESTIMATIVO'
                                        </div>

                                        <div class="label label-info"
                                             style="padding: 0.5%; margin-left: 5px; font-weight: normal;
                                         display: #{execucaoProcessoControlador.selecionado.formaEntrega.isUnica() ? 'block' : 'none'}">
                                            Permite empenho do tipo 'ORDINÁRIO'
                                        </div>
                                    </p:outputPanel>
                                </h:panelGrid>

                                <fc:outputLabelObrigatorio value="Fornecedor: "/>
                                <p:selectOneMenu
                                    panelStyle="min-width: 900px"
                                    style="min-width: 600px"
                                    value="#{execucaoProcessoControlador.selecionado.fornecedor}"
                                    converter="#{pessoaContabilControlador.converterGenerico}"
                                    disabled="#{execucaoProcessoControlador.hasReservaDotacao()}">
                                    <f:selectItems value="#{execucaoProcessoControlador.fornecedores}"/>
                                    <p:ajax event="change"
                                            listener="#{execucaoProcessoControlador.confirmarSelecaoFornecedor()}"
                                            process="@this"
                                            onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            update=":Formulario:tab-view-geral:panel-execucao :Formulario:tab-view-geral:vl-execucao :Formulario:panelSaldo"/>
                                </p:selectOneMenu>

                                <h:outputText value="Valor Total: "/>
                                <h:outputText
                                    id="vl-execucao"
                                    value="#{execucaoProcessoControlador.selecionado.valor}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </p:outputPanel>

                        <p:outputPanel
                            id="panel-wizard">
                            <p:outputPanel
                                rendered="#{execucaoProcessoControlador.hasProcessoInformado()}">
                                <p:wizard showNavBar="true"
                                          styleClass="mtop05"
                                          backLabel="Voltar"
                                          nextLabel="Próximo"
                                          showStepStatus="true"
                                          flowListener="#{execucaoProcessoControlador.onFlowProcess}">
                                    <p:tab title="Itens da Execução" id="execucao">
                                        <p:panel id="panel-execucao">
                                            <p:dataTable paginator="true"
                                                         id="table-itens-execucao-qtde"
                                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                         rowIndexVar="rowIx"
                                                         styleClass="mtop05"
                                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                                         value="#{execucaoProcessoControlador.itensQuantidade}"
                                                         rendered="#{execucaoProcessoControlador.hasItensExecucaoQuantidade()}"
                                                         paginatorPosition="top"
                                                         rows="10"
                                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>ITENS EXECUÇÃO POR QUANTIDADE&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                         rowsPerPageTemplate="10,25,50,100"
                                                         var="itemExecQtde">
                                                <p:column headerText="Remover" style="text-align: center; width: 5%">
                                                    <p:commandButton icon="ui-icon-trash"
                                                                     process="@this"
                                                                     disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                     oncomplete="aguarde.hide()"
                                                                     actionListener="#{execucaoProcessoControlador.removerItemQuantidade(itemExecQtde)}"
                                                                     title="Clique para remover este registro."
                                                                     update=":Formulario:tab-view-geral:panel-execucao
                                                                     :Formulario:tab-view-geral:vl-execucao"/>
                                                </p:column>
                                                <p:column headerText="Lote" style="text-align: left; width: 5%">
                                                    <h:outputText
                                                        value="#{itemExecQtde.itemProcessoCompra.loteProcessoDeCompra.numero}"/>
                                                </p:column>
                                                <p:column headerText="Item" style="text-align: left; width: 40%">
                                                    <h:outputText value="#{itemExecQtde.numeroDescricao}"/>
                                                </p:column>
                                                <p:column headerText="Especif." style="text-align: left">
                                                    <ad:especificacao-objeto-compra
                                                        exibirTexto="true"
                                                        especificacao="#{itemExecQtde.itemProcessoCompra.descricaoComplementar}"/>
                                                </p:column>
                                                <p:column
                                                    headerText="Grupo"
                                                    style="text-align: left; width: 50px; ">
                                                    <h:outputText
                                                        value="#{itemExecQtde.objetoCompra.grupoContaDespesa.grupo}"/>
                                                </p:column>
                                                <p:column
                                                    headerText="Conta" styleClass="alinhamentoEsquerda">
                                                    <ad:conta-desdobrada-por-grupo
                                                        styleClass="default"
                                                        grupoContaDespesa="#{itemExecQtde.objetoCompra.grupoContaDespesa}"/>
                                                </p:column>
                                                <p:column headerText="Qtde Disponível" style="text-align: right;">
                                                    <p:commandLink
                                                        actionListener="#{execucaoProcessoControlador.selecionarExecucaoProcessoItem(itemExecQtde)}"
                                                        onstart="aguarde.show()"
                                                        oncomplete="aguarde.hide();dlgSaldoDisponivel.show()"
                                                        process="@this"
                                                        update=":form-saldo-disponivel"
                                                        title="Clique para detalhar os valores que compõe a quantidade disponível.">
                                                        <fc:output-mascara-unidade-medida
                                                            tipoMascara="#{itemExecQtde.mascaraQuantidade}"
                                                            value="#{itemExecQtde.itemSaldoVO.quantidadeDisponivel}"/>
                                                    </p:commandLink>

                                                </p:column>
                                                <p:column headerText="Qtde da Execução"
                                                          style="text-align: right;">
                                                    <p:outputPanel id="qtde-utilizada">
                                                        <fc:input-mascara-unidade-medida
                                                            size="15"
                                                            value="#{itemExecQtde.quantidade}"
                                                            disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                                            update=":Formulario:tab-view-geral:table-itens-execucao-qtde:valorTotalQtde
                                                                :Formulario:tab-view-geral:table-itens-execucao-qtde:qtde-utilizada
                                                                :Formulario:tab-view-geral:gridExecucao"
                                                            listener="#{execucaoProcessoControlador.processarQuantidadeItem(itemExecQtde)}"
                                                            tipoMascara="#{itemExecQtde.mascaraQuantidade}"/>
                                                    </p:outputPanel>
                                                </p:column>
                                                <p:column headerText="Valor Unitário (R$)" style="text-align: right;">
                                                    <fc:output-mascara-unidade-medida
                                                        tipoMascara="#{itemExecQtde.mascaraValorUnitario}"
                                                        value="#{itemExecQtde.valorUnitario}"/>
                                                </p:column>
                                                <p:column headerText="Valor Total (R$)" style="text-align: right">
                                                    <p:outputPanel id="valorTotalQtde">
                                                        <h:outputText value="#{itemExecQtde.valorTotal}">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </p:outputPanel>
                                                </p:column>
                                            </p:dataTable>

                                            <p:dataTable paginator="true"
                                                         id="table-itens-execucao-valor"
                                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                         rowIndexVar="rowIx"
                                                         styleClass="mtop20 mbot05"
                                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                                         value="#{execucaoProcessoControlador.itensValor}"
                                                         rendered="#{execucaoProcessoControlador.hasItensExecucaoValor()}"
                                                         rows="10"
                                                         paginatorPosition="top"
                                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>ITENS EXECUÇÃO POR VALOR&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                         rowsPerPageTemplate="10,25,50,100"
                                                         var="itemExecValor">
                                                <p:column headerText="Remover" style="text-align: center; width: 5%">
                                                    <p:commandButton icon="ui-icon-trash"
                                                                     process="@this"
                                                                     disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                     oncomplete="aguarde.hide()"
                                                                     actionListener="#{execucaoProcessoControlador.removerItemValor(itemExecValor)}"
                                                                     title="Clique para remover este registro."
                                                                     update=":Formulario:tab-view-geral:panel-execucao
                                                                     :Formulario:tab-view-geral:vl-execucao"/>
                                                </p:column>
                                                <p:column headerText="Lote" style="text-align: left; width: 5%">
                                                    <h:outputText
                                                        value="#{itemExecValor.itemProcessoCompra.loteProcessoDeCompra.numero}"/>
                                                </p:column>
                                                <p:column headerText="Item" style="text-align: left; width: 40%">
                                                    <h:outputText value="#{itemExecValor.numeroDescricao}"/>
                                                </p:column>
                                                <p:column headerText="Especif." style="text-align: left">
                                                    <ad:especificacao-objeto-compra
                                                        exibirTexto="true"
                                                        especificacao="#{itemExecValor.itemProcessoCompra.descricaoComplementar}"/>
                                                </p:column>
                                                <p:column
                                                    headerText="Grupo"
                                                    style="text-align: left; width: 50px; ">
                                                    <h:outputText
                                                        value="#{itemExecValor.objetoCompra.grupoContaDespesa.grupo}"/>
                                                </p:column>
                                                <p:column
                                                    headerText="Conta" styleClass="alinhamentoEsquerda">
                                                    <ad:conta-desdobrada-por-grupo
                                                        styleClass="default"
                                                        grupoContaDespesa="#{itemExecValor.objetoCompra.grupoContaDespesa}"/>
                                                </p:column>
                                                <p:column headerText="Valor Disponível (R$)"
                                                          style="text-align: right; width: 15%">
                                                    <p:commandLink
                                                        actionListener="#{execucaoProcessoControlador.selecionarExecucaoProcessoItem(itemExecValor)}"
                                                        onstart="aguarde.show()"
                                                        oncomplete="aguarde.hide();dlgSaldoDisponivel.show()"
                                                        process="@this"
                                                        update=":form-saldo-disponivel"
                                                        title="Clique para detalhar os valores que compõe o saldo disponível.">
                                                        <h:outputText
                                                            value="#{itemExecValor.itemSaldoVO.saldoDisponivel}">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </p:commandLink>
                                                </p:column>
                                                <p:column headerText="Valor Total (R$)"
                                                          style="text-align: right; width: 15%">
                                                    <p:outputPanel id="valorTotal">
                                                        <p:inputText title="Digite o valor"
                                                                     value="#{itemExecValor.valorTotal}"
                                                                     disabled="#{execucaoProcessoControlador.hasReservaDotacao()}"
                                                                     size="20"
                                                                     onkeypress="mascara(this, mvalor)"
                                                                     styleClass="alinhamentoDireita">
                                                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                                                            <p:ajax event="blur"
                                                                    update="@this :Formulario:tab-view-geral:gridExecucao"
                                                                    process="@this"
                                                                    listener="#{execucaoProcessoControlador.processarValorTotalItem(itemExecValor)}"/>
                                                        </p:inputText>
                                                    </p:outputPanel>
                                                </p:column>
                                            </p:dataTable>
                                        </p:panel>
                                    </p:tab>

                                    <p:tab title="Dotação Orçamentária" id="dotacao">
                                        <p:panel id="panelReservas">
                                            <p:dataTable value="#{execucaoProcessoControlador.selecionado.reservas}"
                                                         var="reserva">
                                                <f:facet name="header">
                                                    <div align="center">
                                                        <h:outputText value="RESERVAS DA EXECUÇÃO"/>
                                                    </div>
                                                </f:facet>
                                                <p:column headerText="Remover" styleClass="alinhamentoCentralizado"
                                                          style="width: 5%">
                                                    <p:commandButton icon="ui-icon-trash"
                                                                     process="@this"
                                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                     oncomplete="aguarde.hide()"
                                                                     disabled="#{execucaoProcessoControlador.hasReservaSelecionada()}"
                                                                     actionListener="#{execucaoProcessoControlador.removerReserva(reserva)}"
                                                                     title="Clique para remover este registro."
                                                                     update=":Formulario:tab-view-geral:panelReservas :Formulario:tab-view-geral:grid-execucao"/>
                                                </p:column>
                                                <p:column
                                                    headerText="#{reserva.hasFontes() ? 'Editar Dotação' : 'Adicionar Dotação'}"
                                                    styleClass="alinhamentoCentralizado"
                                                    style="width: 5%">
                                                    <p:commandButton
                                                        onstart="aguarde.show()"
                                                        oncomplete="aguarde.hide()"
                                                        styleClass="#{reserva.hasFontes() ? 'prioritario' : ''}"
                                                        title="Clique para adicionar fonte de despesa a reserva da execução."
                                                        disabled="#{execucaoProcessoControlador.hasReservaSelecionada()}"
                                                        actionListener="#{execucaoProcessoControlador.selecionarExecucaoReserva(reserva)}"
                                                        icon="#{reserva.hasFontes() ? 'ui-icon-pencil' : 'ui-icon-circle-plus'}"/>
                                                </p:column>
                                                <p:column headerText="Tipo de Objeto Compra"
                                                          styleClass="alinhamentoEsquerda">
                                                    <h:outputText value="#{reserva.tipoObjetoCompra.descricao}"/>
                                                </p:column>
                                                <p:column headerText="Classe Credor" styleClass="alinhamentoEsquerda">
                                                    <h:selectOneMenu value="#{reserva.classeCredor}"
                                                                     id="classeCredor"
                                                                     disabled="#{execucaoProcessoControlador.hasReservaSelecionada()}"
                                                                     title="Informe a classe credor."
                                                                     converter="#{classeCredorControlador.converterGenerico}">
                                                        <f:selectItems
                                                            value="#{execucaoProcessoControlador.classesCredor}"
                                                            var="cc"
                                                            itemValue="#{cc.id}"
                                                            itemLabel="#{cc}"/>
                                                        <p:ajax event="change"
                                                                process="@this"/>
                                                    </h:selectOneMenu>
                                                </p:column>
                                                <p:column headerText="Valor (R$)" styleClass="alinhamentoDireita">
                                                    <h:outputText value="#{reserva.valor}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <div align="right">
                                                            <h:outputText
                                                                styleClass="negrito"
                                                                value="#{execucaoProcessoControlador.selecionado.valorTotalReservas}">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                        </div>
                                                    </f:facet>
                                                </p:column>
                                            </p:dataTable>


                                            <p:panel header="Fonte da Execução" id="panelDotacao"
                                                     rendered="#{execucaoProcessoControlador.execucaoProcessoReserva ne null}"
                                                     styleClass="mtop20">
                                                <p:dataTable paginator="true"
                                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                             rowIndexVar="rowIx"
                                                             styleClass="mtop02 mbot10"
                                                             paginatorPosition="top"
                                                             emptyMessage="Não foram localizados registros para serem apresentados"
                                                             rendered="#{execucaoProcessoControlador.hasFonteSelecionada() and execucaoProcessoControlador.hasItensFontePorQuantidade()}"
                                                             value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.itensQuantidade}"
                                                             rows="10"
                                                             paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>ITENS DOTAÇÃO POR QUANTIDADE&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                             rowsPerPageTemplate="10,25,50,100"
                                                             id="table-item-dotacao-qtde"
                                                             var="itemDotQtde">
                                                    <p:column headerText="Remover"
                                                              style="text-align: center; width: 50px;">
                                                        <p:commandButton icon="ui-icon-trash"
                                                                         process="@this"
                                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                         oncomplete="aguarde.hide()"
                                                                         title="Clique para remover este registro."
                                                                         actionListener="#{execucaoProcessoControlador.removerItemDotacaoQuantidade(itemDotQtde)}"
                                                                         update=":Formulario:tab-view-geral:panelDotacao"/>
                                                    </p:column>
                                                    <p:column headerText="Item" style="text-align: left;">
                                                        <h:outputText
                                                            value="#{itemDotQtde.execucaoProcessoItem.numeroDescricao}"/>
                                                    </p:column>
                                                    <c:if
                                                        test="#{execucaoProcessoControlador.isObjetoCompraConsumoOrPermanenteMovel()}">
                                                        <p:column headerText="Grupo"
                                                                  style="text-align: left;">
                                                            <h:outputText
                                                                value="#{itemDotQtde.execucaoProcessoItem.objetoCompra.grupoContaDespesa.grupo}"/>
                                                        </p:column>
                                                    </c:if>
                                                    <p:column headerText="Qtde na Execução"
                                                              style="text-align: right">
                                                        <fc:output-mascara-unidade-medida
                                                            tipoMascara="#{itemDotQtde.execucaoProcessoItem.mascaraQuantidade}"
                                                            value="#{itemDotQtde.execucaoProcessoItem.quantidade}"/>
                                                    </p:column>
                                                    <p:column headerText="Qtde Reservada"
                                                              style="text-align: right">
                                                        <fc:output-mascara-unidade-medida
                                                            tipoMascara="#{itemDotQtde.execucaoProcessoItem.mascaraQuantidade}"
                                                            value="#{itemDotQtde.quantidadeReservada}"/>
                                                    </p:column>
                                                    <p:column headerText="Qtde Disponível"
                                                              style="text-align: right">
                                                        <fc:output-mascara-unidade-medida
                                                            tipoMascara="#{itemDotQtde.execucaoProcessoItem.mascaraQuantidade}"
                                                            value="#{itemDotQtde.quantidadeDisponivel}"/>
                                                    </p:column>
                                                    <p:column headerText="Quantidade"
                                                              style="text-align: right">
                                                        <p:outputPanel id="qtdeItemDotacao">
                                                            <fc:input-mascara-unidade-medida
                                                                tipoMascara="#{itemDotQtde.execucaoProcessoItem.mascaraQuantidade}"
                                                                size="15"
                                                                update=":Formulario:tab-view-geral:valorReserva
                                                                        :Formulario:tab-view-geral:table-item-dotacao-qtde:vlItenDotQtde
                                                                        :Formulario:tab-view-geral:table-item-dotacao-qtde:vlTotalItenDotQtde
                                                                        :Formulario:tab-view-geral:table-item-dotacao-qtde:qtdeItemDotacao"
                                                                process="@this"
                                                                listener="#{execucaoProcessoControlador.processarQuantidadeItemDotacao(itemDotQtde)}"
                                                                value="#{itemDotQtde.quantidade}"/>
                                                        </p:outputPanel>
                                                    </p:column>
                                                    <p:column headerText="Valor Unitário (R$)"
                                                              style="text-align: right">
                                                        <fc:output-mascara-unidade-medida
                                                            tipoMascara="#{itemDotQtde.execucaoProcessoItem.mascaraValorUnitario}"
                                                            value="#{itemDotQtde.valorUnitario}"/>
                                                    </p:column>
                                                    <p:column headerText="Valor Total (R$)"
                                                              style="text-align: right">
                                                        <p:outputPanel>
                                                            <h:outputText value="#{itemDotQtde.valorTotal}"
                                                                          id="vlItenDotQtde">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                        </p:outputPanel>
                                                    </p:column>
                                                    <f:facet name="footer">
                                                        <div align="right">
                                                            <h:outputText
                                                                styleClass="negrito"
                                                                id="vlTotalItenDotQtde"
                                                                value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.valorTotalItemQuantidade}">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                        </div>
                                                    </f:facet>
                                                </p:dataTable>

                                                <p:dataTable paginator="true"
                                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                             rowIndexVar="rowIx"
                                                             styleClass="mtop02 mbot10"
                                                             paginatorPosition="top"
                                                             emptyMessage="Não foram localizados registros para serem apresentados"
                                                             rendered="#{execucaoProcessoControlador.hasFonteSelecionada() and execucaoProcessoControlador.hasItensFontePorValor()}"
                                                             value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.itensValor}"
                                                             rows="10"
                                                             paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>ITENS DOTAÇÃO POR VALOR&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                             rowsPerPageTemplate="10,25,50,100"
                                                             var="itemDotValor">
                                                    <p:column headerText="Remover"
                                                              style="text-align: center; width: 50px;">
                                                        <p:commandButton icon="ui-icon-trash"
                                                                         process="@this"
                                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                         oncomplete="aguarde.hide()"
                                                                         title="Clique para remover este registro."
                                                                         actionListener="#{execucaoProcessoControlador.removerItemDotacaoValor(itemDotValor)}"
                                                                         update=":Formulario:tab-view-geral:panelDotacao"/>
                                                    </p:column>
                                                    <p:column headerText="Item" style="text-align: left;">
                                                        <h:outputText
                                                            value="#{itemDotValor.execucaoProcessoItem.numeroDescricao}"/>
                                                    </p:column>
                                                    <c:if
                                                        test="#{execucaoProcessoControlador.isObjetoCompraConsumoOrPermanenteMovel()}">
                                                        <p:column headerText="Grupo"
                                                                  style="text-align: left;">
                                                            <h:outputText
                                                                value="#{itemDotValor.execucaoProcessoItem.objetoCompra.grupoContaDespesa.grupo}"/>
                                                        </p:column>
                                                    </c:if>
                                                    <p:column headerText="Valor na Execução (R$)"
                                                              style="text-align: right">
                                                        <h:outputText
                                                            value="#{itemDotValor.execucaoProcessoItem.valorTotal}">
                                                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Valor Reservado (R$)"
                                                              style="text-align: right">
                                                        <h:outputText value="#{itemDotValor.valorReservado}">
                                                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Valor Disponível (R$)"
                                                              style="text-align: right">
                                                        <h:outputText value="#{itemDotValor.valorDisponivel}">
                                                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Valor Total (R$)"
                                                              style="text-align: right">
                                                        <p:inputText title="Digite o valor"
                                                                     value="#{itemDotValor.valorTotal}"
                                                                     size="20"
                                                                     id="vlTotalItemDotacao"
                                                                     onkeypress="mascara(this, mvalor)"
                                                                     styleClass="alinhamentoDireita">
                                                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                                                            <p:ajax event="blur"
                                                                    update=":Formulario:tab-view-geral:valorReserva vlTotalItemDotacao vlTotalItensDotValor"
                                                                    process="@this"
                                                                    onstart="aguarde.show()"
                                                                    oncomplete="aguarde.hide()"
                                                                    listener="#{execucaoProcessoControlador.processarValorItemFonte(itemDotValor)}"/>
                                                        </p:inputText>
                                                    </p:column>
                                                    <f:facet name="footer">
                                                        <div align="right">
                                                            <h:outputText
                                                                id="vlTotalItensDotValor"
                                                                styleClass="negrito"
                                                                value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.valorTotalItemValor}">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                        </div>
                                                    </f:facet>
                                                </p:dataTable>


                                                <div class="thumbnail"
                                                     style="display: #{execucaoProcessoControlador.hasFonteSelecionada() ? 'block' : 'none'}">
                                                    <c:if
                                                        test="#{execucaoProcessoControlador.isGeraReservaExecucao()}">
                                                        <fcc:consultar-despesa-orcamentaria-na-tela
                                                            value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.despesaORC}"
                                                            mostrarArvoreExpandida="true"
                                                            styleElementoDespesa="margin-right: 75px"
                                                            update=":Formulario:tab-view-geral:gridFonteDespesa :Formulario:tab-view-geral:gridFonte"
                                                            actionListener="#{execucaoProcessoControlador.limparCamposDespesa()}"
                                                            unidadeAdministrativa="#{execucaoProcessoControlador.selecionado.unidadeAdministrativa}"
                                                            unidadeOrcamentaria="#{execucaoProcessoControlador.selecionado.unidadeOrcamentaria}"
                                                            subTipoObjetoCompra="#{execucaoProcessoControlador.selecionado.subTipoObjetoCompra}"
                                                            tiposObjetoCompra="#{consultarDespesaOrcamentariaNaTelaControlador.tipoObjetoCompraPorDescricao(execucaoProcessoControlador.execucaoProcessoReserva.tipoObjetoCompra.name())}"/>

                                                        <h:panelGrid columns="2" id="gridFonte">
                                                            <fc:outputLabelObrigatorio
                                                                value="Conta de Destinação de Recurso: "/>
                                                            <h:selectOneMenu
                                                                value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.fonteDespesaORC}"
                                                                title="Informe a Classe da Pessoa."
                                                                converter="#{execucaoProcessoControlador.converterFonteDespesaORC}">
                                                                <f:selectItems
                                                                    value="#{execucaoProcessoControlador.fonteDespesaOrcamentaria}"
                                                                    var="fo"
                                                                    itemValue="#{fo.id}"
                                                                    itemLabel="#{fo.provisaoPPAFonte.destinacaoDeRecursos}"/>
                                                                <p:ajax event="change"
                                                                        process="@this"
                                                                        update=":Formulario:tab-view-geral:gridFonteDespesa"
                                                                        onstart="aguarde.show()"
                                                                        oncomplete="aguarde.hide()"
                                                                        listener="#{execucaoProcessoControlador.buscarSaldoFonteDespesaORC()}"/>
                                                            </h:selectOneMenu>
                                                        </h:panelGrid>
                                                    </c:if>

                                                    <c:if
                                                        test="#{!execucaoProcessoControlador.isGeraReservaExecucao()}">
                                                        <p:dataTable id="tabela-fontes-reservadas2"
                                                                     value="#{execucaoProcessoControlador.reservasDotacaoProcessoCompra}"
                                                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                                                     var="vo"
                                                                     styleClass="mbot10"
                                                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                                     rowIndexVar="rowIx"
                                                                     rowKey="#{vo.fonteDespesaORC}"
                                                                     selection="#{execucaoProcessoControlador.execucaoProcessoFonteVOSelecionada}">
                                                            <f:facet name="header">
                                                                RESERVAS DE DOTAÇÃO DO PROCESSO DE COMPRA
                                                            </f:facet>
                                                            <p:column selectionMode="single"
                                                                      disabledSelection="#{!vo.hasSaldoDisponivel()}"/>
                                                            <p:column headerText="Fonte Despesa Orçamentária"
                                                                      styleClass="alinhamentoEsquerda">
                                                                <h:outputText value="#{vo.descricaoExercicioComFonteDespesa}"/>
                                                            </p:column>
                                                            <p:column headerText="Vl Reservado (R$)"
                                                                      styleClass="alinhamentoDireita">
                                                                <h:outputText value="#{vo.valorReservado}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputText>
                                                            </p:column>
                                                            <p:column headerText="Vl Estorno Reservado (R$)"
                                                                      styleClass="alinhamentoDireita">
                                                                <h:outputText value="#{vo.valorEstornoReservado}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputText>
                                                            </p:column>
                                                            <p:column headerText="Vl Executado (R$)"
                                                                      styleClass="alinhamentoDireita">
                                                                <h:outputLabel value="#{vo.valorExecutado}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputLabel>
                                                            </p:column>
                                                            <p:column headerText="Vl Estorno Executado (R$)"
                                                                      styleClass="alinhamentoDireita">
                                                                <h:outputLabel value="#{vo.valorEstornoExecutado}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputLabel>
                                                            </p:column>
                                                            <p:column headerText="Saldo Disponível (R$)"
                                                                      styleClass="alinhamentoDireita">
                                                                <h:outputText value="#{vo.saldoDisponivel}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputText>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </c:if>

                                                    <h:panelGrid columns="2" id="gridFonteDespesa"
                                                                 cellpadding="3"
                                                                 cellspacing="3">
                                                        <h:outputLabel value="Saldo Fonte de Despesa (R$): "
                                                                       rendered="#{execucaoProcessoControlador.isGeraReservaExecucao()}"/>
                                                        <h:outputText
                                                            id="opt-saldo"
                                                            style="margin-left: 25px"
                                                            rendered="#{execucaoProcessoControlador.isGeraReservaExecucao()}"
                                                            value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.saldoFonteDespesaORC}"
                                                            styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>

                                                        <h:outputText value="Diferença a Reservar (R$)"
                                                                      rendered="#{execucaoProcessoControlador.execucaoProcessoFonteVO.hasValorReservaNaExecucao()}"/>
                                                        <h:outputText
                                                            style="margin-left: 25px"
                                                            rendered="#{execucaoProcessoControlador.execucaoProcessoFonteVO.hasValorReservaNaExecucao()}"
                                                            value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.valorReservaExecucao}"
                                                            styleClass="negrito">
                                                            <f:convertNumber pattern="###,##0.00"/>
                                                        </h:outputText>

                                                        <h:outputText value="Valor da Reserva (R$): "
                                                                      style="font-size: 14px"/>
                                                        <h:outputText
                                                            style="margin-left: 25px; font-size: 14px"
                                                            id="valorReserva"
                                                            styleClass="negrito"
                                                            value="#{execucaoProcessoControlador.execucaoProcessoFonteVO.valor}">
                                                            <f:convertNumber pattern="###,##0.00"/>
                                                        </h:outputText>
                                                    </h:panelGrid>


                                                    <p:commandButton value="Adicionar Fonte"
                                                                     icon="ui-icon-check"
                                                                     style="width: 160px"
                                                                     styleClass="prioritario mtop10"
                                                                     title="Clique para confirmar os itens para a fonte de despesa."
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"
                                                                     process="@this :Formulario:tab-view-geral:panelReservas"
                                                                     update=":Formulario:tab-view-geral:panelReservas"
                                                                     actionListener="#{execucaoProcessoControlador.adicionarFonte()}"/>

                                                    <p:commandButton value="Confirmar/Fechar"
                                                                     style="width: 160px"
                                                                     icon="ui-icon-arrowthick-1-e"
                                                                     styleClass="padrao mtop10 mlef05"
                                                                     title="Clique para confirmar e voltar para lista de reservas de dotação."
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"
                                                                     process="@this"
                                                                     update=":Formulario:tab-view-geral:panelReservas"
                                                                     actionListener="#{execucaoProcessoControlador.cancelarFonte()}"/>


                                                    <div style="padding: 5px" align="center" class="fundoAzul mtop02">
                                                        <h:outputText value="FONTES DA EXECUÇÃO"
                                                                      style="color: white"/>
                                                    </div>
                                                    <p:dataTable id="tabela-fonte"
                                                                 emptyMessage="Não foram localizados registros para serem apresentados"
                                                                 value="#{execucaoProcessoControlador.execucaoProcessoReserva.fontesVO}"
                                                                 var="fonte">
                                                        <p:column headerText="Itens" style="width: 3%;"
                                                                  styleClass="alinhamentoCentralizado">
                                                            <p:rowToggler/>
                                                        </p:column>
                                                        <p:column headerText="Remover"
                                                                  styleClass="width100 alinhamentoCentralizado">
                                                            <p:commandButton icon="ui-icon-trash"
                                                                             onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                                             oncomplete="aguarde.hide()"
                                                                             actionListener="#{execucaoProcessoControlador.removerFonte(fonte)}"
                                                                             title="Clique para remover este registro."
                                                                             process=":Formulario:tab-view-geral:panelReservas"
                                                                             update=":Formulario:tab-view-geral:panelReservas"/>
                                                        </p:column>
                                                        <p:column headerText="Dotação Orçamentária"
                                                                  styleClass="alinhamentoEsquerda">
                                                            <h:outputText value="#{fonte.fonteDespesaORC}"/>
                                                            <f:facet name="footer">
                                                                <div align="right">
                                                                    <h:outputText
                                                                        styleClass="negrito"
                                                                        value="Total Reservado"/>
                                                                </div>
                                                            </f:facet>
                                                        </p:column>
                                                        <p:column headerText="Valor (R$)"
                                                                  styleClass="alinhamentoDireita"
                                                                  style="width: 10%">
                                                            <h:outputText value="#{fonte.valor}">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                            <f:facet name="footer">
                                                                <div align="right">
                                                                    <h:outputText
                                                                        styleClass="negrito"
                                                                        value="#{execucaoProcessoControlador.execucaoProcessoReserva.valorTotalReservado}">
                                                                        <f:convertNumber pattern="#,##0.00"/>
                                                                    </h:outputText>
                                                                </div>
                                                            </f:facet>
                                                        </p:column>

                                                        <p:rowExpansion>
                                                            <p:dataTable paginator="true"
                                                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                                         rowIndexVar="rowIx"
                                                                         styleClass="mtop02 mbot10 mlef20"
                                                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                                                         value="#{fonte.itens}"
                                                                         paginatorPosition="top"
                                                                         rows="10"
                                                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>ITENS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                                         rowsPerPageTemplate="10,25,50,100"
                                                                         var="itemFonte">
                                                                <p:column headerText="Item"
                                                                          style="text-align: left;">
                                                                    <h:outputText
                                                                        value="#{itemFonte.execucaoProcessoItem.numeroDescricao}"/>
                                                                </p:column>
                                                                <c:if
                                                                    test="#{execucaoProcessoControlador.isObjetoCompraConsumoOrPermanenteMovel()}">
                                                                    <p:column headerText="Grupo"
                                                                              style="text-align: left;">
                                                                        <h:outputText
                                                                            value="#{itemFonte.execucaoProcessoItem.objetoCompra.grupoContaDespesa.grupo}"/>
                                                                    </p:column>
                                                                    <p:column headerText="Conta"
                                                                              style="text-align: left;">
                                                                        <ad:conta-desdobrada-por-grupo
                                                                            styleClass="default"
                                                                            grupoContaDespesa="#{itemFonte.execucaoProcessoItem.objetoCompra.grupoContaDespesa}"/>
                                                                    </p:column>
                                                                </c:if>
                                                                <p:column headerText="Controle"
                                                                          style="text-align: left;">
                                                                    <h:outputText
                                                                        value="#{itemFonte.execucaoProcessoItem.itemProcessoCompra.itemSolicitacaoMaterial.itemCotacao.tipoControle.descricao}"/>
                                                                </p:column>
                                                                <p:column headerText="Quantidade"
                                                                          style="text-align: right; width: 10%">
                                                                    <fc:output-mascara-unidade-medida
                                                                        tipoMascara="#{itemFonte.execucaoProcessoItem.mascaraQuantidade}"
                                                                        value="#{itemFonte.quantidade}"/>
                                                                </p:column>
                                                                <p:column headerText="Valor Unitário (R$)"
                                                                          style="text-align: right; width: 10%">
                                                                    <fc:output-mascara-unidade-medida
                                                                        tipoMascara="#{itemFonte.execucaoProcessoItem.mascaraValorUnitario}"
                                                                        value="#{itemFonte.valorUnitario}"/>
                                                                </p:column>
                                                                <f:facet name="footer">
                                                                    <div align="right">
                                                                        Total dos Itens
                                                                    </div>
                                                                </f:facet>
                                                                <p:column headerText="Valor Total (R$)"
                                                                          style="text-align: right; width: 10%">
                                                                    <h:outputText value="#{itemFonte.valorTotal}">
                                                                        <f:convertNumber pattern="#,##0.00"/>
                                                                    </h:outputText>
                                                                    <f:facet name="footer">
                                                                        <div align="right">
                                                                            <h:outputText
                                                                                styleClass="negrito"
                                                                                value="#{fonte.valorTotalItemQuantidade}">
                                                                                <f:convertNumber
                                                                                    pattern="#,##0.00"/>
                                                                            </h:outputText>
                                                                        </div>
                                                                    </f:facet>
                                                                </p:column>
                                                            </p:dataTable>
                                                        </p:rowExpansion>
                                                    </p:dataTable>
                                                </div>
                                            </p:panel>
                                        </p:panel>
                                    </p:tab>

                                    <p:tab
                                        title="Solicitação de Empenho"
                                        id="agrupador">
                                        <p:outputPanel id="panelAgrupador">
                                            <p:panel>
                                                <div style="padding: 5px" align="center" class="fundoAzul">
                                                    <h:outputText value="AGRUPADORES SOLICITAÇÃO DE EMPENHO"
                                                                  style="color: white"/>
                                                </div>
                                                <p:dataTable
                                                    emptyMessage="Não foram localizados registros para serem apresentados"
                                                    value="#{execucaoProcessoControlador.agrupadorSolicitacoesEmpenho}"
                                                    var="agrup">
                                                    <p:column headerText="Itens" style="width: 3%;"
                                                              styleClass="alinhamentoCentralizado">
                                                        <p:rowToggler/>
                                                    </p:column>
                                                    <p:column headerText="Sol. Empenho" style="width: 3%;"
                                                              styleClass="alinhamentoCentralizado">
                                                        <ad:detalhes-solicitacao-empenho
                                                            id="componenteDetalhesSolicitacao"
                                                            update=":Formulario:tab-view-geral:panelAgrupador"
                                                            solicitacaoEmpenho="#{agrup.solicitacaoEmpenho}"/>
                                                    </p:column>
                                                    <p:column headerText="Dotação Orçamentária"
                                                              styleClass="alinhamentoEsquerda">
                                                        <h:outputText value="#{agrup.fonteDespesaORC}"/>
                                                    </p:column>
                                                    <p:column headerText="Tipo"
                                                              styleClass="alinhamentoEsquerda">
                                                        <h:outputText value="#{agrup.tipoObjetoCompra.descricao}"/>
                                                    </p:column>
                                                    <p:column
                                                        headerText="Grupo"
                                                        styleClass="alinhamentoEsquerda">
                                                        <h:outputText value="#{agrup.grupoMaterial}"/>
                                                        <h:outputText value="#{agrup.grupoBem}"/>
                                                    </p:column>
                                                    <p:column headerText="Conta de Despesa"
                                                              styleClass="alinhamentoEsquerda">
                                                        <h:outputText value="#{agrup.contaDesdobrada}"/>
                                                    </p:column>
                                                    <p:column headerText="Valor (R$)" styleClass="alinhamentoDireita"
                                                              style="width: 10%">
                                                        <h:outputText value="#{agrup.valor}">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                        <f:facet name="footer">
                                                            <div align="right">
                                                                <h:outputText
                                                                    styleClass="negrito"
                                                                    value="#{execucaoProcessoControlador.valorTotalAgrupador}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputText>
                                                            </div>
                                                        </f:facet>
                                                    </p:column>
                                                    <p:rowExpansion>
                                                        <p:dataTable paginator="true"
                                                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                                                     rowIndexVar="rowIx"
                                                                     rendered="#{!empty agrup.itensDotacaoExecucaoProcesso}"
                                                                     styleClass="mtop02 mbot10 mlef50"
                                                                     paginatorPosition="top"
                                                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                                                     value="#{agrup.itensDotacaoExecucaoProcesso}"
                                                                     rows="10"
                                                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ITENS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                                     rowsPerPageTemplate="10,25,50,100"
                                                                     var="itemAgrup">
                                                            <p:column headerText="Item" style="text-align: left;">
                                                                <h:outputText
                                                                    value="#{itemAgrup.execucaoProcessoItem.numeroDescricao}"/>
                                                            </p:column>
                                                            <p:column headerText="Quantidade"
                                                                      style="text-align: right; width: 10%">
                                                                <fc:output-mascara-unidade-medida
                                                                    tipoMascara="#{itemAgrup.execucaoProcessoItem.mascaraQuantidade}"
                                                                    value="#{itemAgrup.quantidade}"/>
                                                            </p:column>
                                                            <p:column headerText="Valor Unitário (R$)"
                                                                      style="text-align: right; width: 10%">
                                                                <fc:output-mascara-unidade-medida
                                                                    tipoMascara="#{itemAgrup.execucaoProcessoItem.mascaraValorUnitario}"
                                                                    value="#{itemAgrup.valorUnitario}"/>
                                                            </p:column>
                                                            <p:column headerText="Valor Total (R$)"
                                                                      style="text-align: right; width: 10%">
                                                                <h:outputText value="#{itemAgrup.valorTotal}">
                                                                    <f:convertNumber pattern="#,##0.00"/>
                                                                </h:outputText>
                                                            </p:column>
                                                        </p:dataTable>
                                                    </p:rowExpansion>
                                                </p:dataTable>
                                            </p:panel>
                                        </p:outputPanel>
                                    </p:tab>
                                </p:wizard>
                            </p:outputPanel>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Anexos">
                        <p:outputPanel id="panelAnexos">
                            <fc:detentorDocumentoLicitacao
                                selecionado="#{execucaoProcessoControlador.selecionado}"/>
                        </p:outputPanel>
                    </p:tab>
                </p:tabView>
            </p:panel>

            <fc:rodapePretty controlador="#{execucaoProcessoControlador}"/>
        </h:form>


        <p:dialog modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  width="1000"
                  max-height="450"
                  widgetVar="dlgSaldoDisponivel">
            <h:form id="form-saldo-disponivel">
                <div style="overflow: scroll; max-height: 400px">
                    <div class="alert alert-info col-lg-12 negrito">
                        <table style="width: 100%">
                            <tr>
                                <td class="alinhamentoEsquerda">
                                    Item da Execução
                                </td>
                                <td class="alinhamentoDireita">
                                    <h:outputText
                                        value="#{execucaoProcessoControlador.execucaoProcessoItemVO.isExecucaoPorQuantidade() ?'Quantidade Disponível': 'Valor Disponível (R$)'}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </td>
                            </tr>
                            <tr style="font-size: 14px;" class="negrito">
                                <td class="alinhamentoEsquerda">
                                    #{execucaoProcessoControlador.execucaoProcessoItemVO.numeroDescricao}
                                </td>
                                <td class="alinhamentoDireita">
                                    <h:outputText
                                        rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.isExecucaoPorQuantidade()}"
                                        value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeDisponivel}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>

                                    <h:outputText
                                        rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.isExecucaoPorValor()}"
                                        value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.saldoDisponivel}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <div class="thumbnail">
                        <table style="width: 100%">
                            <tr style="vertical-align: top">
                                <td style="display: #{execucaoProcessoControlador.execucaoProcessoItemVO.isExecucaoPorQuantidade() ? 'block' : 'none'};">
                                    <p:fieldset
                                        styleClass="mtop10"
                                        legend="Composição Saldo por Quantidade - Natureza #{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.naturezaSaldo.descricao}">
                                        <h:panelGrid columns="3"
                                                     rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.origemSaldo.isAtaOrDispensa()}">
                                            <h:outputText value="Quantidade no Processo: "/>
                                            <strong style="color: grey">( + )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeProcesso}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade na Ata: "
                                                          rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"/>
                                            <h:outputText style="color: grey"
                                                          value="( + )"
                                                          styleClass="negrito"
                                                          rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"/>
                                            <fc:output-mascara-unidade-medida
                                                rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeAta}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Contratada: "/>
                                            <strong style="color: grey">( - )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeContratada}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Executada: "/>
                                            <strong style="color: grey">( - )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeExecutada}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Estornada: "/>
                                            <strong style="color: grey">( + )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeEstornada}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Disponível: "/>
                                            <strong style="color: grey">( = )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeDisponivel}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>
                                        </h:panelGrid>


                                        <h:panelGrid columns="3"
                                                     rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.origemSaldo.isAditovoOrApostilamento()}">
                                            <h:outputText value="Quantidade Acréscimo: "/>
                                            <strong style="color: grey">( - )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeAcrescimo}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Executada: "/>
                                            <strong style="color: grey">( - )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeExecutada}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Estornada: "/>
                                            <strong style="color: grey">( + )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeEstornada}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>

                                            <h:outputText value="Quantidade Disponível: "/>
                                            <strong style="color: grey">( = )</strong>
                                            <fc:output-mascara-unidade-medida
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.quantidadeDisponivel}"
                                                tipoMascara="#{execucaoProcessoControlador.execucaoProcessoItemVO.mascaraQuantidade}"
                                                styleClass="negrito"/>
                                        </h:panelGrid>
                                    </p:fieldset>
                                </td>

                                <td>
                                    <p:fieldset
                                        styleClass="mtop10"
                                        legend="Composição do Saldo por Valor - Natureza #{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.naturezaSaldo.descricao}">
                                        <h:panelGrid columns="3"
                                                     rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.origemSaldo.isAtaOrDispensa()}">
                                            <h:outputText value="Valor no Processo (R$): "/>
                                            <strong style="color: grey">( + )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorlHomologado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor na Ata (R$): "
                                                          rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"/>
                                            <h:outputText style="color: grey"
                                                          value="( + )"
                                                          styleClass="negrito"
                                                          rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"/>
                                            <h:outputText
                                                rendered="#{execucaoProcessoControlador.selecionado.tipoExecucao.isAta()}"
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorAta}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Contratado (R$): "/>
                                            <strong style="color: grey">( - )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorContratado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Executado (R$): "/>
                                            <strong style="color: grey">( - )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorExecutado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Estornado (R$): "/>
                                            <strong style="color: grey">( + )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorEstornado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Disponível (R$): "/>
                                            <strong style="color: grey">( = )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.saldoDisponivelComAcrescimo}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </h:panelGrid>

                                        <h:panelGrid columns="3"
                                                     rendered="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.origemSaldo.isAditovoOrApostilamento()}">
                                            <h:outputText value="Valor Acréscimo (R$): "/>
                                            <strong style="color: grey">( - )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorAcrescimo}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Executado (R$): "/>
                                            <strong style="color: grey">( - )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorExecutado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Estornado (R$): "/>
                                            <strong style="color: grey">( + )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.valorEstornado}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>

                                            <h:outputText value="Valor Disponível (R$): "/>
                                            <strong style="color: grey">( = )</strong>
                                            <h:outputText
                                                value="#{execucaoProcessoControlador.execucaoProcessoItemVO.itemSaldoVO.saldoDisponivelComAcrescimo}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </h:panelGrid>
                                    </p:fieldset>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="true"
                  width="1000"
                  resizable="false"
                  widgetVar="dlgOrigemSaldoExecucao"
                  closable="false">
            <h:form id="formOrigemSaldoExecucao">
                <legend class="legenda">
                    Saldos Disponíveis para Execução
                </legend>
                <div class="alert alert-info" align="center" style="font-size: 13px">
                    Selecione a origem do saldo para executar a #{execucaoProcessoControlador.selecionado.tipoExecucao.descricao}
                </div>

                <p:dataTable emptyMessage="Não foram localizados registros para serem apresentados"
                             value="#{execucaoProcessoControlador.saldoProcesso.saldosAgrupadosPorOrigem}"
                             selection="#{execucaoProcessoControlador.saldoProcesso.saldoOrigemSelecionado}"
                             var="saldoOrig"
                             style="overflow: scroll; max-height: 400px; width: auto"
                             rowKey="#{saldoOrig.criadoEm}">
                    <p:column selectionMode="single" style="width:35px;"/>
                    <p:column headerText="Item" styleClass="alinhamentoCentralizado" style="width: 7px">
                        <p:rowToggler/>
                    </p:column>
                    <p:column headerText="Origem" style="text-align: left;">
                        <h:outputText value="#{saldoOrig.origem.descricao}"/>
                    </p:column>
                    <p:column headerText="Movimento" style="text-align: left;">
                        <h:outputText value="#{saldoOrig.descricaoMovimento}"/>
                    </p:column>
                    <p:column headerText="Saldo (R$)" style="text-align: right;">
                        <h:outputText value="#{saldoOrig.saldoDisponivel}">
                            <f:convertNumber type="currency" pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:rowExpansion>
                        <p:dataTable emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{saldoOrig.itens}"
                                     styleClass="mlef50 mbot20"
                                     var="itemSaldo"
                                     style="overflow: scroll; max-height: 300px; width: auto"
                                     rowKey="#{itemSaldo.id}">
                            <p:column headerText="Lote" style="text-align: left;">
                                <h:outputText
                                    value="#{itemSaldo.itemProcessoCompra.numeroLote}"/>
                            </p:column>
                            <p:column headerText="Item" style="text-align: left;">
                                <h:outputText
                                    value="#{itemSaldo.itemProcessoCompra.numero}"/>
                            </p:column>
                            <p:column headerText="Objeto de Compra" style="text-align: left;">
                                <h:outputText
                                    value="#{itemSaldo.itemProcessoCompra.objetoCompra}"/>
                            </p:column>
                            <p:column headerText="Saldo (R$)" style="text-align: right">
                                <h:outputText value="#{itemSaldo.saldoDisponivel}">
                                    <f:convertNumber type="currency" pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:rowExpansion>
                </p:dataTable>

                <div style="text-align: center" class="mtop05">
                    <p:commandButton icon="ui-icon-check"
                                     value="Confirmar"
                                     process="@this :formOrigemSaldoExecucao"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     actionListener="#{execucaoProcessoControlador.confirmarOrigemSaldoExecucao()}"
                                     styleClass="mtop05 prioritario"/>

                    <p:commandButton icon="ui-icon-cancel"
                                     value="Cancelar"
                                     process="@this :formOrigemSaldoExecucao"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     actionListener="#{execucaoProcessoControlador.cancelarOrigemSaldoExecucao()}"
                                     styleClass="mtop05 mlef05 padrao"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>

