<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
    >
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <fc:cabecalhoPretty origem="#{fornecedorControlador.caminhoPadrao}listar/"
                                controlador="#{fornecedorControlador}"/>

            <p:tabView id="tab-view-geral">
                <p:tab title="Fornecedor">
                    <p:outputPanel id="panel-fornecedor">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Data Operação:"/>
                            <p:inputText value="#{fornecedorControlador.selecionado.alteradoEm}"
                                         size="10"
                                         readonly="true">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </p:inputText>

                            <h:outputLabel value="Inscrição no SICARB:" style="margin-right: 60px;"/>
                            <h:outputText id="inscricao-sicarb"
                                          value="Inscrição gerada automaticamente ao salvar."
                                          styleClass="negrito"/>

                            <fc:outputLabelObrigatorio value="Fornecedor:"/>
                            <h:panelGrid columns="4"
                                         cellpadding="0"
                                         cellspacing="0">
                                <p:autoComplete queryDelay="1000" id="fornecedor"
                                                title="Informe o fornecedor."
                                                value="#{fornecedorControlador.selecionado.pessoa}"
                                                completeMethod="#{fornecedorControlador.completaPessoaFornecedor}"
                                                converter="#{fornecedorControlador.converterPessoaFornecedor}"
                                                var="fo"
                                                forceSelection="true"
                                                itemLabel="#{fo}"
                                                itemValue="#{fo.id}"
                                                maxResults="10"
                                                size="70"
                                                styleClass="mrig05">
                                    <p:ajax event="itemSelect"
                                            process="@this"
                                            update=":Formulario:tab-view-geral:panel-fornecedor :Formulario:tab-view-geral:painelCnae :Formulario:tab-view-geral:panelsocios"
                                            listener="#{fornecedorControlador.validaDadosFornecedor}"
                                            onstart="aguarde.show();"
                                            oncomplete="aguarde.hide();"/>
                                </p:autoComplete>

                                <fc:novoParente label="PF"
                                                styleClass="mrig05"
                                                title="Cadastrar uma Nova Pessoa Física"
                                                selecionado="#{fornecedorControlador.selecionado}"
                                                destino="/tributario/configuracoes/pessoa/novapessoafisica/"
                                                origem="#{fornecedorControlador.urlAtual}"/>
                                <h:panelGroup styleClass="mlef05">
                                    <fc:novoParente label="PJ"
                                                    title="Cadastrar uma Nova Pessoa Jurídica"
                                                    selecionado="#{fornecedorControlador.selecionado}"
                                                    destino="/tributario/configuracoes/pessoa/novapessoajuridica/"
                                                    origem="#{fornecedorControlador.urlAtual}"/>
                                </h:panelGroup>
                            </h:panelGrid>
                        </h:panelGrid>

                            <h:panelGrid columns="2"
                                         rendered="#{!fornecedorControlador.pessoaFornecedorIsNull()}">
                                <h:outputText value="CPF/CNPJ:"
                                              styleClass="mtop10"
                                              style="margin-right: 110px;"/>
                                <h:outputText value="#{fornecedorControlador.selecionado.pessoa.cpf_Cnpj}"
                                              styleClass="negrito mtop10"/>

                                <h:outputText value="Endereço:"/>
                                <h:outputText value="#{fornecedorControlador.selecionado.pessoa.enderecoPrincipal}"
                                              styleClass="negrito"/>

                                <h:outputText value="Telefone:"/>
                                <h:outputText value="#{fornecedorControlador.selecionado.pessoa.telefoneValido}"
                                              styleClass="negrito"/>
                            </h:panelGrid>

                        <h:panelGrid columns="2">
                            <h:outputLabel value="Inscrição Municipal:"/>
                            <p:inputText id="inscricao-municipal"
                                         title="Digite a inscrição municipal do fornecedor."
                                         value="#{fornecedorControlador.selecionado.inscricaoMunicipal}"
                                         size="70"/>

                            <h:outputLabel value="Registro do Ato Constitutivo:"/>
                            <p:inputText id="registro-ato-constitutivo"
                                         title="Digite o registro do fornecedor."
                                         value="#{fornecedorControlador.selecionado.registroDoAtoConstitutivo}"
                                         size="70"/>

                            <h:outputLabel value="Registro na Entidade Profissional:"/>
                            <p:inputText id="registro-entidade-profissional"
                                         title="Digite o registro do fornecedor."
                                         value="#{fornecedorControlador.selecionado.registroNaEntidadeProfissional}"
                                         size="70"/>

                            <h:outputLabel value="Capital Registrado:"/>
                            <p:inputText id="capital-registrado"
                                         title="Digite o capital do fornecedor."
                                         onkeydown="mascaraMonetaria(this);"
                                         value="#{fornecedorControlador.selecionado.capitalRegistrado}"
                                         converter="moneyConverter"
                                         size="10"/>

                            <h:outputLabel value="Patrimônio Líquido:"/>
                            <p:inputText id="patrimonio-liquido"
                                         title="Digite o patrimônio líquido do fornecedor."
                                         onkeydown="mascaraMonetaria(this);"
                                         value="#{fornecedorControlador.selecionado.patrimonioLiquido}"
                                         converter="moneyConverter"
                                         size="10"/>
                        </h:panelGrid>

                        <h:panelGrid columns="3"
                                     cellpadding="0"
                                     cellspacing="0">
                            <h:outputLabel value="Observações:"
                                           style="margin-right: 100px;"/>
                            <p:inputTextarea title="Digite as observações do fornecedor"
                                             value="#{fornecedorControlador.selecionado.observacoes}"
                                             cols="70"
                                             maxlength="3000"
                                             autoResize="true"
                                             counterTemplate="{0} Caracteres Restantes."
                                             counter="counter-observacoes"/>
                            <h:outputText id="counter-observacoes"
                                          style="color: #497692"
                                          styleClass="mlef05"/>
                        </h:panelGrid>
                    </p:outputPanel>
                </p:tab>

                <p:tab title="Sócios">
                    <p:outputPanel id="panelsocios">
                        <p:commandButton value="Novo Sócio"  onclick="aguarde.show();"
                                         oncomplete="aguarde.hide();" icon="ui-icon-plus" actionListener="#{fornecedorControlador.redirecionarEditarPessoaFornecedor()}"/>
                        <p:dataTable var="socio"
                                     id="tabelasocios"
                                     editable="true"
                                     value="#{fornecedorControlador.sociedadePessoaJuridica}"
                                     paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Sócios&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100">

                            <p:column headerText="Sócio" style="text-align: left;">
                                #{socio.socio}
                            </p:column>
                            <p:column headerText="Proporção (%)" style="text-align: center; width: 10%">
                                <h:outputText value="#{socio.proporcao}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Data Inicial" style="text-align: center">
                                <h:outputText value="#{socio.dataInicio}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Data Final" style="text-align: center">
                                <h:outputText value="#{socio.dataFim}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <f:facet id="rodaPeSocios" name="footer">
                                Proporção Total:
                                <h:outputText value="#{fornecedorControlador.totalSociedadePessoaJuridica}"
                                              id="totalSocios"
                                              style="color:#{fornecedorControlador.totalSociedadePessoaJuridica eq 100 ? 'seagreen':'tomato'}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>%
                            </f:facet>
                        </p:dataTable>
                    </p:outputPanel>
                </p:tab>

                <p:tab title="Documentos">
                    <p:outputPanel id="panel-documento">
                        <p:commandButton value="Novo Documento"
                                         icon="ui-icon-circle-plus"
                                         styleClass="padrao"
                                         onclick="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                                         rendered="#{!fornecedorControlador.isVisualizar()}"
                                         immediate="true"
                                         actionListener="#{fornecedorControlador.novoDocumento()}"
                                         process="@this"
                                         update=":Formulario:tab-view-geral:panel-documento"/>

                        <p:panel header="Novo/Editar Documento"
                                 id="panel-novo-documento"
                                 rendered="#{fornecedorControlador.documentoFornecedorSelecionado ne null}"
                                 styleClass="mtop05 mbot05">

                            <h:panelGrid columns="2" styleClass="mbot05">
                                <fc:outputLabelObrigatorio value="Exercício:"/>
                                <h:selectOneMenu id="exercicio"
                                                 title="Informe o exercício."
                                                 styleClass="mrig05"
                                                 value="#{fornecedorControlador.selecionado.exercicio}"
                                                 converter="#{exercicioControlador.converterExercicio}">
                                    <f:selectItems value="#{fornecedorControlador.getExercicio()}"/>
                                    <p:ajax event="valueChange" process="@this"/>
                                </h:selectOneMenu>
                                <fc:outputLabelObrigatorio value="Documento:"/>
                                <h:panelGroup style="margin-left: -3px">
                                    <h:selectOneMenu id="documento"
                                                     title="Informe o documento."
                                                     styleClass="mrig05"
                                                     style="margin-left: 2px;"
                                                     value="#{fornecedorControlador.documentoFornecedorSelecionado.documentoHabilitacao}"
                                                     converter="#{doctoHabilitacaoControlador.converterGenerico}">
                                        <f:selectItems value="#{fornecedorControlador.documentoHabilitacao}"/>
                                        <p:ajax event="change"
                                                listener="#{fornecedorControlador.habilitaCamposDocumentoSelecionado}"
                                                process="@this"
                                                update=":Formulario:tab-view-geral:panel-novo-documento"/>
                                    </h:selectOneMenu>
                                    <fc:novoParente destino="#{doctoHabilitacaoControlador.caminhoDestinoNovoCadastro}"
                                                    origem="#{fornecedorControlador.caminhoOrigem}"
                                                    selecionado="#{fornecedorControlador.selecionado}"/>
                                </h:panelGroup>

                                <fc:outputLabelObrigatorio value="Número:"
                                                           rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoNumero()}"/>
                                <h:panelGroup
                                    rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoNumero()}">
                                    <p:inputText id="numero"
                                                 title="Digite o número."
                                                 size="10"
                                                 styleClass="mrig05"
                                                 value="#{fornecedorControlador.documentoFornecedorSelecionado.numero}"/>

                                    <p:commandButton id="bt-informacao-numero"
                                                     icon="ui-icon-info"
                                                     process="@none"
                                                     update="@none"
                                                     styleClass="icone-20"/>
                                    <p:overlayPanel for="bt-informacao-numero"
                                                    appendToBody="true"
                                                    style="border : solid black 2px;"
                                                    showEvent="mouseover"
                                                    hideEvent="mouseout">
                                        <h:outputText
                                            value="&lt;b>Obs. O campo número será habilitado somente se o documento selecionado requerer o preenchimento do mesmo.&lt;b/>"
                                            escape="false"/>
                                    </p:overlayPanel>
                                </h:panelGroup>

                                <fc:outputLabelObrigatorio value="Data de Emissão:"
                                                           rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoDataDeEmissao()}"/>
                                <h:panelGroup
                                    rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoDataDeEmissao()}">
                                    <p:calendar id="dataDeEmissao"
                                                title="Informe a data de emissão."
                                                value="#{fornecedorControlador.documentoFornecedorSelecionado.dataDeEmissao}"
                                                onkeypress="mascara(this, Data)"
                                                maxlength="10"
                                                style="text-align: right"
                                                autocomplete="off"
                                                locale="pt_BR" navigator="true" pattern="dd/MM/yyyy"
                                                size="10"
                                                styleClass="mrig05"/>

                                    <p:commandButton id="bt-informacao-data-de-emissao"
                                                     icon="ui-icon-info"
                                                     process="@none"
                                                     update="@none"
                                                     styleClass="icone-20"/>
                                    <p:overlayPanel for="bt-informacao-data-de-emissao"
                                                    appendToBody="true"
                                                    style="border : solid black 2px;"
                                                    showEvent="mouseover"
                                                    hideEvent="mouseout">
                                        <h:outputText
                                            value="&lt;b>Obs. O campo data de emissão será habilitado somente se o documento selecionado requerer o preenchimento do mesmo.&lt;b/>"
                                            escape="false"/>
                                    </p:overlayPanel>
                                </h:panelGroup>

                                <fc:outputLabelObrigatorio value="Data de Validade:"
                                                           rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoDataDeValidade()}"/>
                                <h:panelGroup
                                    rendered="#{fornecedorControlador.documentoSelecionadoRequerCampoDataDeValidade()}">
                                    <p:calendar id="dataDeValidade"
                                                title="Informe a data de validade."
                                                value="#{fornecedorControlador.documentoFornecedorSelecionado.dataDeValidade}"
                                                onkeypress="mascara(this, Data)"
                                                maxlength="10"
                                                style="text-align: right"
                                                styleClass="mrig05"
                                                autocomplete="off"
                                                locale="pt_BR" navigator="true" pattern="dd/MM/yyyy"
                                                size="10"/>

                                    <p:commandButton id="bt-informacao-data-de-validade"
                                                     icon="ui-icon-info"
                                                     process="@none"
                                                     update="@none"
                                                     styleClass="icone-20"/>
                                    <p:overlayPanel for="bt-informacao-data-de-validade"
                                                    appendToBody="true"
                                                    style="border : solid black 2px;"
                                                    showEvent="mouseover"
                                                    hideEvent="mouseout">
                                        <h:outputText
                                            value="&lt;b>Obs. O campo data de validade será habilitado somente se o documento selecionado requerer o preenchimento do mesmo.&lt;b/>"
                                            escape="false"/>
                                    </p:overlayPanel>
                                </h:panelGroup>
                            </h:panelGrid>

                            <p:commandButton value="Confirmar"
                                             styleClass="mrig05"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             process="panel-novo-documento"
                                             update=":Formulario:tab-view-geral:panel-documento"
                                             actionListener="#{fornecedorControlador.confirmarDocumento}"
                                             icon="ui-icon-check"/>

                            <p:commandButton value="Cancelar"
                                             process="@this"
                                             onclick="aguarde.show(); "
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{fornecedorControlador.cancelarDocumento}"
                                             update=":Formulario:tab-view-geral:panel-documento"
                                             icon="ui-icon-cancel"/>
                        </p:panel>

                        <p:dataTable paginator="true"
                                     id="tabela-documento"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{fornecedorControlador.selecionado.documentosFornecedor}"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>DOCUMENTOS DO FORNECEDOR&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     var="doc">

                            <p:column headerText="Ações"
                                      rendered="#{!fornecedorControlador.isVisualizar()}"
                                      style="text-align: center; width: 90px;">
                                <p:commandButton icon="ui-icon-pencil"
                                                 title="Clique para alterar este registro."
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide();"
                                                 process="@this"
                                                 actionListener="#{fornecedorControlador.selecionarDocumento(doc)}"
                                                 update=":Formulario:tab-view-geral:panel-documento"
                                                 styleClass="mrig05"/>

                                <p:commandButton icon="ui-icon-trash"
                                                 process="@this"
                                                 onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                 oncomplete="aguarde.hide()"
                                                 actionListener="#{fornecedorControlador.removerDocumento(doc)}"
                                                 title="Clique para remover este registro."
                                                 update="tabela-documento"
                                                 styleClass="mrig05"/>
                            </p:column>

                            <p:column headerText="Documento Habilitação" style="text-align: left;">
                                <h:outputText value="#{doc.documentoHabilitacao}"/>
                            </p:column>
                            <p:column headerText="Número" style="text-align: right;">
                                <h:outputText value="#{doc.numero}"/>
                            </p:column>
                            <p:column headerText="Data de Emissão" style="text-align: center;">
                                <h:outputText value="#{doc.dataDeEmissao}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Data de Validade" style="text-align: center;">
                                <h:outputText value="#{doc.dataDeValidade}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:outputPanel>
                </p:tab>
                <p:tab title="Ramos de Atividade (CNAE's)">
                    <p:outputPanel id="painelCnae" >
                        <p:commandButton value="Novo CNAE"
                                         onclick="aguarde.show();"
                                         oncomplete="aguarde.hide();"
                                         icon="ui-icon-plus" actionListener="#{fornecedorControlador.redirecionarEditarPessoaFornecedor()}"/>
                        <p:dataTable id="cnaeTabelaVigente"
                                     value="#{fornecedorControlador.cnaes}"
                                     var="c"
                                     paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>CNAE's&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100">

                            <p:column>
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="CNAE" style="text-align: left;">
                                <h:outputText value="#{c.cnae.codigoCnae} "/>
                            </p:column>
                            <p:column headerText="Descrição Detalhada" style="text-align: left;">
                                <h:outputText value="#{c.cnae.descricaoDetalhada} "/>
                            </p:column>
                            <p:column style="text-align: center" headerText="Data Inicial">
                                <h:outputText value="#{c.inicio}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column style="text-align: center" headerText="Data Final">
                                <h:outputText value="#{c.fim}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column style="text-align: center" headerText="Tipo">
                                <h:outputText value="#{c.tipo}"/>
                            </p:column>
                            <p:column style="text-align: center" headerText="Situação">
                                <h:outputText value="#{c.cnae.situacao.descricao}"/>
                            </p:column>
                            <p:column style="text-align: center" headerText="Sanitário">
                                <h:outputText value="#{c.cnae.fiscalizacaoSanitaria ? 'Sim' : 'Não'}"/>
                            </p:column>
                            <p:rowExpansion>
                                <p:dataTable rendered="#{c.horarioFuncionamento != null}"
                                             value="#{cadastroEconomicoControlador.itensHorarios(c.horarioFuncionamento)}"
                                             var="item">
                                    <f:facet name="header">
                                        <p:panel header="Horário de Funcionamento"
                                                 rendered="#{c.horarioFuncionamento != null}">
                                            <h:panelGrid columns="2">
                                                <h:outputText value="Código: "/>
                                                <h:outputText
                                                        value="#{c.horarioFuncionamento.codigo}"
                                                        styleClass="azulnegrito"/>
                                                <h:outputText value="Descrição: "/>
                                                <h:outputText
                                                        value="#{c.horarioFuncionamento.descricao}"
                                                        styleClass="azulnegrito"/>
                                            </h:panelGrid>
                                        </p:panel>
                                    </f:facet>
                                    <p:column headerText="Dia (Entrada)">
                                        <h:outputText value="#{item.diaEntrada.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Entrada">
                                        <h:outputText value="#{item.horarioEntrada}">
                                            <f:convertDateTime pattern="HH:mm"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Dia (Saída)">
                                        <h:outputText value="#{item.diaSaida.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Saída">
                                        <h:outputText value="#{item.horarioSaida}">
                                            <f:convertDateTime pattern="HH:mm"/>
                                        </h:outputText>
                                    </p:column>
                                </p:dataTable>
                                <p:panel rendered="#{c.horarioFuncionamento == null}">
                                    <h:outputText value="Nenhum Horário de Funcionamento"/>
                                </p:panel>
                            </p:rowExpansion>
                        </p:dataTable>
                    </p:outputPanel>
                </p:tab>

                <p:tab title="Anexos">
                    <p:outputPanel id="panel-anexos">
                        <h:panelGrid columns="2">
                            <h:outputText value="Arquivo:"
                                          rendered="#{!fornecedorControlador.isVisualizar()}"/>
                            <p:fileUpload mode="advanced"
                                          auto="true"
                                          update="tabela-anexos"
                                          rendered="#{!fornecedorControlador.isVisualizar()}"
                                          label="Selecionar"
                                          id="bt-upload-arquivo"
                                          styleClass="somenteBotao mrig02"
                                          sizeLimit="15728640"
                                          multiple="true"
                                          invalidSizeMessage="O tamanho do arquivo é inválido, o tamanho do arquivo não pode ser superior a 10Mb."
                                          invalidFileMessage="O tipo do arquivo é inválido."
                                          style="z-index : 0;"
                                          fileUploadListener="#{fornecedorControlador.assistenteDetentorArquivoComposicao.handleFileUpload}">
                            </p:fileUpload>
                        </h:panelGrid>
                        <span></span>
                        <p:dataTable paginator="true"
                                     id="tabela-anexos"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{fornecedorControlador.selecionado.detentorArquivoComposicao.arquivosComposicao}"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ARQUIVOS ANEXADOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     var="arquivoComposicao">
                            <p:column headerText="Ações" style="text-align: center; width: 80px;">
                                <p:commandButton icon="ui-icon-download"
                                                 ajax="false"
                                                 title="Clique para fazer o download do arquivo indicado."
                                                 immediate="true"
                                                 onclick="PrimeFaces.monitorDownload(start, stop)"
                                                 styleClass="mrig05"
                                                 rendered="#{arquivoComposicao.arquivo.id eq null}">
                                    <p:fileDownload
                                        value="#{fornecedorControlador.assistenteDetentorArquivoComposicao.getStream(arquivoComposicao)}"/>
                                </p:commandButton>

                                <p:commandButton icon="ui-icon-download"
                                                 ajax="false"
                                                 title="Clique para fazer o download do arquivo indicado."
                                                 immediate="true"
                                                 onclick="PrimeFaces.monitorDownload(start, stop)"
                                                 styleClass="mrig05"
                                                 rendered="#{arquivoComposicao.arquivo.id ne null}">
                                    <p:fileDownload
                                        value="#{fornecedorControlador.recuperarArquivoParaDownload(arquivoComposicao)}"/>
                                </p:commandButton>

                                <p:commandButton icon="ui-icon-trash"
                                                 id="bt-remover"
                                                 rendered="#{!fornecedorControlador.isVisualizar()}"
                                                 title="Clique para remover o arquivo indicado."
                                                 process="@this"
                                                 update=":Formulario:tab-view-geral:tabela-anexos"
                                                 actionListener="#{fornecedorControlador.assistenteDetentorArquivoComposicao.removerArquivo(arquivoComposicao)}"
                                                 onclick="if (!confirm('Tem certeza que deseja remover este arquivo da lista de anexos do fornecedor selecionado?')) {return false; } else {aguarde.show();}"
                                                 oncomplete="aguarde.hide()">
                                </p:commandButton>
                            </p:column>

                            <p:column headerText="Nome do Arquivo" style="text-align: left;">
                                <h:outputText
                                    value="#{arquivoComposicao.arquivo.descricao}"/>
                            </p:column>
                        </p:dataTable>
                    </p:outputPanel>
                </p:tab>
            </p:tabView>

            <fc:rodapePretty id="rodapeEdita" controlador="#{fornecedorControlador}"/>
        </h:form>

        <p:dialog header="Fornecedor"
                  widgetVar="dialogEditaFornecedor"
                  modal="true"
                  closable="false">
            <h:form id="form-edita-fornecedor">
                <div class="ui-message-info" style="padding: 4px; font-size: 12px; margin: 0px!important;">
                    <h:outputText
                        value="O Fornecedor selecionado não tem Endereço ou Telefone. Deseja atualizar o cadastro agora?"/>
                </div>

                <div style="text-align: center" class="mtop10">
                    <p:commandButton icon="ui-icon-check"
                                     value="Sim"
                                     actionListener="#{fornecedorControlador.redirecionarEditarPessoaFornecedor()}"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide(); dialogEditaFornecedor.hide();"
                                     process="form-edita-fornecedor"
                                     styleClass="mrig05"/>
                    <p:commandButton icon="ui-icon-close"
                                     process="@none"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide(); dialogEditaFornecedor.hide();"
                                     value="Não"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog header="Sócio"
                  widgetVar="dialogEditaSocio"
                  modal="true"
                  closable="false">
            <h:form id="form-edita-socio">
                <div class="ui-message-info" style="padding: 4px; font-size: 12px; margin: 0px!important;">
                    <h:outputText
                        value="O Sócio selecionado não tem Endereço ou Telefone. Deseja atualizar o cadastro agora?"/>
                </div>

                <div style="text-align: center" class="mtop10">
                    <p:commandButton icon="ui-icon-check"
                                     value="Sim"
                                     actionListener="#{fornecedorControlador.redirecionarEditarPessoaSocio()}"
                                     oncomplete="dialogEditaSocio.hide()"
                                     process="form-edita-socio"
                                     styleClass="mrig05"/>
                    <p:commandButton icon="ui-icon-close"
                                     process="@none"
                                     onclick="dialogEditaSocio.hide()"
                                     value="Não"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
