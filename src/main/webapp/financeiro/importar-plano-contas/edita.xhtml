<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:co="http://java.sun.com/jsf/composite/components/contabil"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <script type="text/javascript">
            var timer;

            function iniciarImportacao() {
                dialogProgressBar.show();
                timer = setInterval(function () {
                    verificarImportacao();
                }, 1000);
            }

            function terminarImportacao() {
                clearInterval(timer);
                dialogProgressBar.hide();
            }
        </script>
        <h:form id="Formulario">
            <p:remoteCommand name="verificarImportacao"
                             process="@this"
                             update=":formDialogProgressBar"
                             actionListener="#{importarPlanoDeContasControlador.finalizarImportacao}"/>

            <p:tabView id="tabView">
                <p:tab title="Importação de plano de contas">
                    <p:outputPanel styleClass="mtop10">

                        <co:titulo-panel titulo="Dados do plano de contas"/>
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Exercício: "/>
                            <h:outputText value="#{importarPlanoDeContasControlador.selecionado.exercicio}"
                                          styleClass="negrito"/>

                            <fc:outputLabelObrigatorio value="Data: "/>
                            <p:calendar id="data"
                                        disabled="true"
                                        value="#{importarPlanoDeContasControlador.selecionado.dataOperacao}"
                                        onkeyup="mascara(this, mdata)"
                                        size="10"
                                        readonly="true"
                                        pattern="dd/MM/yyyy" locale="pt_BR" navigator="true"/>

                            <fc:outputLabelObrigatorio value="Tipo da Conta: "
                                                       title="Selecione a Tipo da Conta"/>
                            <h:selectOneMenu
                                value="#{importarPlanoDeContasControlador.selecionado.tipoConta}"
                                id="tipoConta"
                                converter="#{tipoContaControlador.converterGenerico}"
                                title="Selecione o tipo da conta">
                                <f:selectItems value="#{importarPlanoDeContasControlador.tiposConta}"/>
                                <p:ajax event="valueChange" update=":Formulario" process=":Formulario"
                                        listener="#{importarPlanoDeContasControlador.definirPosicoes}"/>
                            </h:selectOneMenu>
                        </h:panelGrid>

                        <co:titulo-panel titulo="Dados da planilha"/>
                        <h:panelGrid columns="2" id="griDadosPlanilha">
                            <fc:outputLabelObrigatorio value="Número da linha do primeiro registro: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.linhaPrimeiroRegistro}"
                                title="Informe o número da linha do primeiro registro"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio value="Posição da coluna código da conta: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaCodigoConta}"
                                title="Informe a posição da coluna código da conta"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio value="Posição da coluna descrição da conta: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaDescricaoConta}"
                                title="Informe a posição da coluna descrição da conta"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <h:panelGroup
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                <fc:outputLabelObrigatorio
                                    value="Posição da coluna Subsistema: "/>
                            </h:panelGroup>
                            <p:inputText
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}"
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaSubsistema}"
                                title="Informe a posição da coluna Subsistema"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <h:panelGroup
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                <fc:outputLabelObrigatorio
                                    value="Posição da coluna Natureza do Saldo: "/>
                            </h:panelGroup>
                            <p:inputText
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}"
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaNaturezaSaldo}"
                                title="Informe a posição da coluna Natureza do Saldo"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <h:panelGroup
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                <fc:outputLabelObrigatorio
                                    value="Posição da coluna Natureza da Informação: "/>
                            </h:panelGroup>
                            <p:inputText
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}"
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaNaturezaInformacao}"
                                title="Informe a posição da coluna Natureza da informação"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio
                                value="Posição da coluna Operação: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaOperacao}"
                                title="Informe a posição da coluna Operação"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <h:panelGroup
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                <fc:outputLabelObrigatorio
                                    value="Posição da coluna Natureza da Conta: "/>
                            </h:panelGroup>
                            <h:panelGroup
                                rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                <p:inputText
                                    value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaNaturezaDaConta}"
                                    title="Informe a posição da coluna natureza da conta"
                                    size="10"
                                    maxlength="10">
                                    <p:ajax event="blur" process="@this"/>
                                </p:inputText>
                                <co:botao_informacao
                                    descricao="A informação contida na coluna 'Natureza da Conta' deve ser: &lt;br/>
                                                                * Ativo&lt;br/>
                                                                * Passivo&lt;br/>
                                                                * Patrimônio Líquido&lt;br/>
                                                                * Variação Patrimonial Diminutiva&lt;br/>
                                                                * Variação Patrimonial Aumentativa&lt;br/>
                                                                * Controles da Aprovação do Planejamento e Orçamento&lt;br/>
                                                                * Controles da Execução do Planejamento e Orçamento&lt;br/>
                                                                * Controles Devedores&lt;br/>
                                                                * Controles Credores&lt;br/>
                                                                * Demais Controles"/>
                            </h:panelGroup>

                            <fc:outputLabelObrigatorio
                                value="Posição da coluna Categoria: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaCategoriaConta}"
                                title="Informe a posição da coluna categoria"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio value="Posição da coluna código da conta (De/Para) origem: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaCodigoContaDepara}"
                                title="Informe a posição da coluna código da conta"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio
                                value="Posição da coluna descrição da conta (De/Para) origem: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaDescricaoContaDepara}"
                                title="Informe a posição da coluna descrição da conta"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>


                            <fc:outputLabelObrigatorio
                                value="Posição da coluna Código SICONFI: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaCodigoSiconfi}"
                                title="Informe a posição da coluna Código SICONFI"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio
                                value="Posição da coluna Código TCE: "/>
                            <p:inputText
                                value="#{importarPlanoDeContasControlador.selecionado.posicaoColunaCodigoTCE}"
                                title="Informe a posição da coluna Código TCE"
                                size="10"
                                maxlength="10">
                                <p:ajax event="blur" process="@this"/>
                            </p:inputText>

                        </h:panelGrid>

                        <co:titulo-panel titulo="Upload da planilha"/>
                        <p:fileUpload multiple="false"
                                      cancelLabel="Cancelar"
                                      label="Selecione"
                                      id="botaoUpload"
                                      auto="true"
                                      onstart="aguarde.show()"
                                      oncomplete="aguarde.hide()"
                                      styleClass="mtop10"
                                      update=":Formulario:tabView:panelGeral"
                                      process=":Formulario:tabView:panelGeral"
                                      fileUploadListener="#{importarPlanoDeContasControlador.importar}"/>

                        <h:outputText value="Situação: #{importarPlanoDeContasControlador.selecionado.situacao}"/>

                        <table style="width: 100%">
                            <tr>
                                <td style="width: 100%">
                                    <h:panelGrid columns="6">
                                        <p:commandButton value="Processar"
                                                         actionListener="#{importarPlanoDeContasControlador.inicializarImportacaoDoPlanoDeContas}"
                                                         icon="ui-icon-refresh"
                                                         title="Clique para processar as contas importadas."
                                                         style="height: 30px; width: 150px"
                                                         styleClass="mtop10"
                                                         update="@this btnFinalizar"
                                                         process="@this :Formulario"/>

                                        <p:commandButton id="btnValidar"
                                                         value="Validar"
                                                         disabled="#{!importarPlanoDeContasControlador.selecionado.importado and !importarPlanoDeContasControlador.selecionado.validado}"
                                                         actionListener="#{importarPlanoDeContasControlador.validarContas}"
                                                         icon="ui-icon-check"
                                                         title="Clique para validar todas as contas importadas."
                                                         style="height: 30px; width: 150px"
                                                         styleClass="mtop10 prioritario"
                                                         update="@this btnAplicar"
                                                         process="@this :Formulario"/>

                                        <p:commandButton id="btnFinalizar"
                                                         value="Finalizar"
                                                         disabled="#{!importarPlanoDeContasControlador.selecionado.importado and !importarPlanoDeContasControlador.selecionado.validado}"
                                                         actionListener="#{importarPlanoDeContasControlador.salvarContas}"
                                                         icon="ui-icon-disk"
                                                         title="Clique para salvar as contas importadas."
                                                         style="height: 30px; width: 150px"
                                                         styleClass="mtop10 prioritario"
                                                         update="@this btnValidar"
                                                         process="@this :Formulario"/>

                                        <p:commandButton id="btnAplicar"
                                                         value="Aplicar"
                                                         disabled="#{!importarPlanoDeContasControlador.selecionado.importado and !importarPlanoDeContasControlador.selecionado.validado and !importarPlanoDeContasControlador.selecionado.finalizado}"
                                                         actionListener="#{importarPlanoDeContasControlador.aplicarAtributosConta}"
                                                         icon="ui-icon-check"
                                                         title="Clique para aplicar atributos das todas as contas do plano de contas selecionado."
                                                         style="height: 30px; width: 150px"
                                                         styleClass="mtop10 prioritario"
                                                         update="@this"
                                                         process="@this :Formulario"/>

                                        <p:commandButton ajax="false"
                                                         icon="ui-icon-print"
                                                         id="exportar"
                                                         styleClass="mtop10 "
                                                         style="height: 30px"
                                                         action="#{importarPlanoDeContasControlador.gerarPDFLog()}"
                                                         value="Imprimir Log de erros"/>
                                    </h:panelGrid>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <p:panel styleClass="mtop30">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                <h:outputText value="Legenda"
                                                              escape="false"
                                                              style="font-weight: bold; margin-left: 7px"/>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td><h:outputText value="PROCESSAR" escape="false"
                                                                      style="font-weight: bold"/></td>
                                                    <td><h:outputText value="Recuperar as contas da planilha no sistema"
                                                                      escape="false"/></td>
                                                </tr>
                                                <tr>
                                                    <td><h:outputText value="VALIDAR" escape="false"
                                                                      style="font-weight: bold"/></td>
                                                    <td><h:outputText
                                                        value="Recuperar/Validar todas as contas TCE"
                                                        escape="false"/></td>
                                                </tr>
                                                <tr>
                                                    <td><h:outputText value="FINALIZAR" escape="false"
                                                                      style="font-weight: bold"/></td>
                                                    <td><h:outputText
                                                        value="Salvar as contas(novas, alteradas, excluidas, de/para) importadas"
                                                        escape="false"/></td>
                                                </tr>
                                                <tr>
                                                    <td><h:outputText value="APLICAR" escape="false"
                                                                      style="font-weight: bold"/></td>
                                                    <td><h:outputText
                                                        value="Atualizar os campos(descrição, tipo de controle, natureza do saldo) das contas"
                                                        escape="false"/></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </p:panel>

                                </td>
                            </tr>

                        </table>

                    </p:outputPanel>

                    <p:outputPanel id="panelGeral">
                        <p:tabView styleClass="mtop10">
                            <p:tab title="Todas do TCE"
                                   rendered="#{importarPlanoDeContasControlador.selecionado.validado}">

                                <h:panelGrid columns="2">
                                    <h:outputLabel value="Mostrar contas não encontradas? "/>
                                    <p:selectBooleanCheckbox
                                        value="#{importarPlanoDeContasControlador.selecionado.mostrarContasNaoEncontrada}">
                                        <p:ajax event="change" update="tableTodasContasTCE" process="@this"/>
                                    </p:selectBooleanCheckbox>
                                </h:panelGrid>

                                <p:dataTable id="tableTodasContasTCE"
                                             value="#{importarPlanoDeContasControlador.selecionado.todasContas}"
                                             var="conta"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>Todas contas (#{importarPlanoDeContasControlador.selecionado.exercicio}) &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Código" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigo}">
                                        <h:outputText value="#{conta.codigo}"
                                                      styleClass="#{conta.contaRecuperada eq null ? 'vermelhonegrito' : ''}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.descricao}">
                                        <h:outputText value="#{conta.descricao}"
                                                      styleClass="#{conta.contaRecuperada eq null ? 'vermelhonegrito' : ''}"/>
                                    </p:column>
                                    <p:column headerText="Conta Recuperada" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.contaRecuperada.toString()}">
                                        <h:outputText value="#{conta.contaRecuperada}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Todas do WebPúblico"
                                   rendered="#{importarPlanoDeContasControlador.selecionado.validado}">

                                <co:mensagem mensagem="Contas do sistema não encontrada nas contas do TCE"/>

                                <p:dataTable id="tableTodasContasWeb"
                                             value="#{importarPlanoDeContasControlador.selecionado.contasNaoEncontradaTCE}"
                                             var="conta"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>Todas contas (#{importarPlanoDeContasControlador.selecionado.exercicio}) &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Código" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigo}">
                                        <h:outputText value="#{conta.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.descricao}">
                                        <h:outputText value="#{conta.descricao}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Incluidas">
                                <h:panelGrid columns="3">
                                    <fc:outputLabelObrigatorio value="Planos de Contas do exercício anterior: "/>
                                    <h:selectOneMenu title="Selecione o plano de contas"
                                                     value="#{importarPlanoDeContasControlador.selecionado.planoDeContasExercicioAnterior}"
                                                     id="planodeContas"
                                                     converter="#{planoDeContasWizardControlador.converterPlanos}">
                                        <f:selectItems
                                            value="#{importarPlanoDeContasControlador.planosExercicioAnterior}"/>
                                        <p:ajax update="tableContasIncluidas" event="change"/>
                                    </h:selectOneMenu>
                                </h:panelGrid>

                                <p:dataTable id="tableContasIncluidas"
                                             value="#{importarPlanoDeContasControlador.selecionado.contasImportadas}"
                                             var="conta"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>CONTAS INCLUIDAS #{importarPlanoDeContasControlador.selecionado.exercicio} &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Ação" style="width: 5%; text-align: center">
                                        <p:commandButton icon="ui-icon-trash"
                                                         onstart="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         title="Clique para remover este registro."
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         update="tableContasIncluidas"
                                                         process="@this"
                                                         actionListener="#{importarPlanoDeContasControlador.removerConta(conta)}">
                                        </p:commandButton>
                                    </p:column>
                                    <p:column headerText="Código" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigo}">
                                        <h:outputText value="#{conta.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.descricao}">
                                        <h:outputText value="#{conta.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Natureza do Saldo" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaSaldo}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaSaldo}"/>
                                    </p:column>
                                    <p:column headerText="Natureza da Conta" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaConta}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaConta}"/>
                                    </p:column>
                                    <p:column headerText="Natureza Informação" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaInformacao}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaInformacao}"/>
                                    </p:column>
                                    <p:column headerText="Subsistema" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.subSistema}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.subSistema}"/>
                                    </p:column>
                                    <p:column headerText="Código SICONFI" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigoSiconfi}">
                                        <h:outputText value="#{conta.codigoSiconfi}"/>
                                    </p:column>
                                    <p:column headerText="Código TCE" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigoTCE}">
                                        <h:outputText value="#{conta.codigoTCE}"/>
                                    </p:column>
                                    <p:column headerText="Conta Equivalente do exercício anterior"
                                              styleClass="alinhamentoEsquerda">
                                        <p:autoComplete queryDelay="1000"
                                                        id="contaDestino"
                                                        size="70"
                                                        var="equi"
                                                        value="#{conta.contaEquivalente}"
                                                        converter="#{planoDeContasWizardControlador.converterConta}"
                                                        disabled="#{importarPlanoDeContasControlador.selecionado.planoDeContasExercicioAnterior eq null}"
                                                        completeMethod="#{importarPlanoDeContasControlador.completarContasEquivalentes}"
                                                        title="Informe uma Conta de Origem"
                                                        itemValue="#{equi.id}"
                                                        itemLabel="#{equi}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Alteradas">
                                <p:dataTable id="tableContasAlteradas"
                                             value="#{importarPlanoDeContasControlador.selecionado.contasAlteradas}"
                                             var="conta"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>CONTAS ALTERADAS #{importarPlanoDeContasControlador.selecionado.exercicio} &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Ação" style="width: 5%; text-align: center">
                                        <p:commandButton icon="ui-icon-trash"
                                                         onstart="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         title="Clique para remover este registro."
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         update="tableContasAlteradas"
                                                         process="@this"
                                                         actionListener="#{importarPlanoDeContasControlador.removerConta(conta)}">
                                        </p:commandButton>
                                    </p:column>
                                    <p:column headerText="Código" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigo}">
                                        <h:outputText value="#{conta.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.descricao}">
                                        <h:outputText value="#{conta.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Natureza do Saldo" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaSaldo}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaSaldo}"/>
                                    </p:column>
                                    <p:column headerText="Natureza da Conta" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaConta}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaConta}"/>
                                    </p:column>
                                    <p:column headerText="Natureza da Informação"
                                              styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.naturezaInformacao}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.naturezaInformacao}"/>
                                    </p:column>
                                    <p:column headerText="Subsistema"
                                              styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.subSistema}"
                                              rendered="#{importarPlanoDeContasControlador.selecionado.tipoConta.classeDaConta.isClasseContabil()}">
                                        <h:outputText value="#{conta.subSistema}"/>
                                    </p:column>
                                    <p:column headerText="Código SICONFI" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigoSiconfi}">
                                        <h:outputText value="#{conta.codigoSiconfi}"/>
                                    </p:column>
                                    <p:column headerText="Código TCE" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigoTCE}">
                                        <h:outputText value="#{conta.codigoTCE}"/>
                                    </p:column>
                                    <p:column headerText="Conta recuperada do plano de contas"
                                              styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{conta.contaRecuperada}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Excluidas">
                                <p:dataTable id="tableContasExcluidas"
                                             value="#{importarPlanoDeContasControlador.selecionado.contasExcluidas}"
                                             var="conta"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>CONTAS EXCLUIDAS #{importarPlanoDeContasControlador.selecionado.exercicio} &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Ação" style="width: 5%; text-align: center">
                                        <p:commandButton icon="ui-icon-trash"
                                                         onstart="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         title="Clique para remover este registro."
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         update="tableContasExcluidas"
                                                         process="@this"
                                                         actionListener="#{importarPlanoDeContasControlador.removerConta(conta)}">
                                        </p:commandButton>
                                    </p:column>
                                    <p:column headerText="Código" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.codigo}">
                                        <h:outputText value="#{conta.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{conta.descricao}">
                                        <h:outputText value="#{conta.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Conta recuperada do plano de contas"
                                              styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{conta.contaRecuperada}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="De/Para">
                                <p:dataTable id="tableContasDepara"
                                             value="#{importarPlanoDeContasControlador.selecionado.deparaContas}"
                                             var="depara"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula>CONTAS DE/PARA #{importarPlanoDeContasControlador.selecionado.exercicio} &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Ação" style="width: 5%; text-align: center">
                                        <p:commandButton id="btnExcluirConta"
                                                         icon="ui-icon-trash"
                                                         onstart="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         title="Clique para remover este registro."
                                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                         update="tableContasDepara"
                                                         process="@this"
                                                         actionListener="#{importarPlanoDeContasControlador.removerContaDepara(depara)}">
                                        </p:commandButton>
                                    </p:column>
                                    <p:column headerText="Exercício Origem" styleClass="alinhamentoEsquerda">
                                        <h:outputText
                                            value="#{importarPlanoDeContasControlador.selecionado.exercicioAnterior}"/>
                                    </p:column>
                                    <p:column headerText="Conta" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{depara.contaOrigem.codigo}">
                                        <h:outputText value="#{depara.contaOrigem.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{depara.contaOrigem.descricao}">
                                        <h:outputText value="#{depara.contaOrigem.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Exercício Destino" styleClass="alinhamentoEsquerda">
                                        <h:outputText
                                            value="#{importarPlanoDeContasControlador.selecionado.exercicio}"/>
                                    </p:column>
                                    <p:column headerText="Conta" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{depara.contaDestino.codigo}">
                                        <h:outputText value="#{depara.contaDestino.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda"
                                              filterMatchMode="contains"
                                              filterBy="#{depara.contaDestino.descricao}">
                                        <h:outputText value="#{depara.contaDestino.descricao}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Log de erros">
                                <p:dataTable value="#{importarPlanoDeContasControlador.selecionado.mensagens}"
                                             var="mensagem"
                                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             paginator="true"
                                             styleClass="mtop02"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10' maiuscula> MENSAGENS &lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                             emptyMessage="Não foram localizados registros para serem apresentados."
                                             rowIndexVar="rowlx">
                                    <p:column headerText="Mensagem" styleClass="alinhamentoEsquerda">
                                        <h:outputText value="#{mensagem}" escape="false"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>

                        </p:tabView>
                    </p:outputPanel>
                </p:tab>
            </p:tabView>


        </h:form>


        <p:dialog widgetVar="dialogProgressBar"
                  width="800"
                  closable="false"
                  showHeader="false"
                  modal="true"
                  hideEffect="clip"
                  resizable="false"
                  position="center"
                  dynamic="true">
            <h:form id="formDialogProgressBar">
                <div class="alert alert-success centralizado mtop05">
                    <strong>Aguarde, </strong> o processo de importação do plano de contas está sendo executado...
                </div>

                <p:panel style="text-align: center; width: 100%; border: 0px;"
                         visible="#{importarPlanoDeContasControlador.selecionado.barraProgressoItens.calculando}"
                         id="panelBarra">

                    <h:outputText
                        value="#{importarPlanoDeContasControlador.selecionado.barraProgressoItens.mensagens}"
                        escape="false"/>

                    <br/>
                    <h:outputText
                        value="Total: #{importarPlanoDeContasControlador.selecionado.barraProgressoItens.total}"
                        styleClass="negrito"/>
                    <br/>
                    <h:outputText
                        value="Processados: #{importarPlanoDeContasControlador.selecionado.barraProgressoItens.processados}"
                        styleClass="negrito"/>


                    <div class="progress progress-striped active" id="barraProgresso">
                        <div class="bar"
                             style="width: #{importarPlanoDeContasControlador.selecionado.barraProgressoItens.porcentagemDoCalculo}%;">
                            <h:outputText
                                value="#{importarPlanoDeContasControlador.selecionado.barraProgressoItens.porcentagemDoCalculo}"
                                styleClass="negrito">
                                <f:convertNumber type="number" maxFractionDigits="2"/>
                            </h:outputText>
                            <h:outputText value="%"/>
                        </div>
                    </div>


                    <br/>
                    <h:outputText
                        value="Tempo Decorrido: #{importarPlanoDeContasControlador.selecionado.barraProgressoItens.tempoDecorrido}"
                        styleClass="negrito"/>

                    <br/>
                    <h:outputText
                        value="Tempo Estimado: #{importarPlanoDeContasControlador.selecionado.barraProgressoItens.tempoEstimado}"
                        styleClass="negrito"/>

                    <br/>
                    <p:commandButton icon="ui-icon-cancel"
                                     styleClass="operacao prioritario"
                                     value="Abortar"
                                     update="@this"
                                     process="@this"
                                     immediate="true"
                                     rendered="#{importarPlanoDeContasControlador.selecionado.barraProgressoItens.calculando}"
                                     actionListener="#{importarPlanoDeContasControlador.abortar()}"/>
                </p:panel>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
</html>
