<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
        >
<ui:composition template="/corpo.xhtml">
<ui:define name="body">

<h:form id="Formulario">
    <p:remoteCommand name="limparContrato"
                     process="@this"
                     update="Formulario:contrato">
        <f:setPropertyActionListener value="#{null}"
                                     target="#{arquivoRemessaBancoControlador.selecionado.contratoObn}"/>
    </p:remoteCommand>

    <p:remoteCommand name="limparTabelaInformativa"
                     process="@this"
                     actionListener="#{arquivoRemessaBancoControlador.limparTabelaInformativaUnidade()}"
                     update=":formUnidade">
        <f:setPropertyActionListener value="#{null}"
                                     target="#{arquivoRemessaBancoControlador.selecionado.contratoObn}"/>
    </p:remoteCommand>
    <p:remoteCommand name="limparUnidade"
                     process="@this"
                     update="Formulario:contrato">
        <f:setPropertyActionListener value="#{null}"
                                     target="#{arquivoRemessaBancoControlador.organizacional}"/>
    </p:remoteCommand>

    <fc:cabecalhoPretty controlador="#{arquivoRemessaBancoControlador}"
                        origem="#{arquivoRemessaBancoControlador.caminhoPadrao}listar/"/>

    <p:panel id="panel" header="Gerar Arquivo OBN600">
        <h:panelGrid columns="2" cellpadding="1">
            <h:outputText value="Número:"/>
            <h:panelGrid columns="2" cellpadding="0" cellspacing="0">
                <p:inputText value="#{arquivoRemessaBancoControlador.selecionado.numero}" id="numero"
                             readonly="true" size="21"
                             disabled="true"
                             title="Número é Gerado automaticamento pelo sistema ao salvar o Arquivo OBN600"/>
                <p:watermark value="Gerado Automaticamente" for="numero"/>
            </h:panelGrid>

            <h:outputText value="Data de Geração: "/>
            <p:calendar value="#{arquivoRemessaBancoControlador.selecionado.dataGeracao}"
                        pattern="dd/MM/yyyy"
                        size="21"
                        disabled="true"/>

            <h:outputText value="Transmitido: "/>
            <h:outputText value="#{arquivoRemessaBancoControlador.selecionado.transmitido ? 'Sim' : 'Não'}"/>

            <fc:outputLabelObrigatorio value="Banco: "/>
            <h:panelGrid columns="2">
                <p:autoComplete queryDelay="1000" id="banco" size="70" title="Informe o Banco"
                                completeMethod="#{arquivoRemessaBancoControlador.completaBanco}"
                                converter="#{arquivoRemessaBancoControlador.converterBanco}"
                                style="margin-left: -4px"
                                onkeyup="if(keyUpCampoVazio(this)){limparContrato();}"
                                value="#{arquivoRemessaBancoControlador.selecionado.banco}"
                                disabled="#{arquivoRemessaBancoControlador.desabilitarCampos()}"
                                var="b" itemLabel="#{b}" itemValue="#{b.id}" forceSelection="true">
                    <p:ajax event="itemSelect" update="btnAdd Formulario:contrato" process="@this"
                            listener="#{arquivoRemessaBancoControlador.definirContratoBanco()}"/>
                </p:autoComplete>


                <p:commandButton id="bt-informacao-disponivel-solicitar"
                                 icon="ui-icon-info"
                                 process="@none"
                                 update="@none"
                                 styleClass="icone-25 mlef02"/>
                <p:overlayPanel for="bt-informacao-disponivel-solicitar"
                                appendToBody="true"
                                style="border : solid black 2px;"
                                showEvent="mouseover"
                                hideEvent="mouseout">
                    <h:outputText
                            value="&lt;b>Banco: &lt;/b>&lt;br/>&lt;br/>
                            Lista todos os Bancos &lt;b>Conveniados&lt;/b> a Prefeitua Municipal de Rio Branco."
                            escape="false"/>
                </p:overlayPanel>

            </h:panelGrid>

            <fc:outputLabelObrigatorio value="Contrato:" />
            <h:panelGrid columns="2">
            <p:autoComplete queryDelay="1000"
                            size="70"
                            id="contrato"
                            title="Informe o contrato"
                            value="#{arquivoRemessaBancoControlador.selecionado.contratoObn}"
                            completeMethod="#{arquivoRemessaBancoControlador.completarContrato}"
                            converter="#{arquivoRemessaBancoControlador.converterContrato}"
                            var="contrato"
                            disabled="#{arquivoRemessaBancoControlador.desabilitarCampos()}"
                            onkeyup="if(keyUpCampoVazio(this)){limparTabelaInformativa();}"
                            style="margin-left: -5px;"
                            itemLabel="#{contrato.numeroContrato}"
                            itemValue="#{contrato}">
                <p:ajax event="itemSelect" process="@this" update="@this" onstart="aguarde.show()" oncomplete="aguarde.hide()" />
            </p:autoComplete>

                <p:commandButton id="bt-informacao-unidades-contrato"
                                 icon="ui-icon-info"
                                 actionListener="#{arquivoRemessaBancoControlador.visualizarInformativoUnidadePorContrato()}"
                                 process="@this"
                                 update=":formUnidade:tabela-informatica-unidade"
                                 onclick="aguarde.show();"
                                 style="margin-left: 3px"
                                 styleClass="icone-25 "/>
            </h:panelGrid>
        </h:panelGrid>



        <p:commandButton value="Pesquisar Ordem Bancária"
                         id="btnAdd"
                         title="Clique para pesquisar."
                         actionListener="#{arquivoRemessaBancoControlador.pesquisarOrdemBancaria()}"
                         disabled="#{arquivoRemessaBancoControlador.selecionado.transmitido eq true}"
                         icon="ui-icon-search"
                         styleClass="mtop10 mrig05 prioritario"
                         update=":Formulario2"
                         process="@this"
                         onstart="aguarde.show()"/>


        <p:dataTable value="#{arquivoRemessaBancoControlador.selecionado.arquivoRemBancoBorderos}"
                     id="tabelaBordero"
                     var="b"
                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                     rowIndexVar="rowIx"
                     styleClass="mtop03"
                     paginator="true"
                     emptyMessage="Não foram localizados registros para serem apresentados"
                     rows="5"
                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ORDENS BANCÁRIAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                     rowsPerPageTemplate="5,10,25,50,100">

            <p:column headerText="Ações" style="text-align: center; width: 8%">
                <p:commandButton icon="ui-icon-trash"
                                 actionListener="#{arquivoRemessaBancoControlador.removerBordero(b)}"
                                 styleClass="mrig03"
                                 disabled="#{arquivoRemessaBancoControlador.desabilitarBtRemoverOB(b)}"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                 title="Clique para remover a ordem bancária da lista."
                                 style="width: 30px!important;min-width: 30px!important;height: 25px!important;min-height: 25px!important;"
                                 id="btnRemoveBordero"
                                 update=":Formulario:tabelaBordero :Formulario:banco :Formulario:contrato"/>
                <fc:botaoTargetBlank
                        actionListener="#{arquivoRemessaBancoControlador.visualizarBordero(b.bordero)}"
                        icon="ui-icon-search"
                        styleClass="mrig03 ui-button-icon-left ui-icon"
                        style="width: 30px!important;min-width: 30px!important;height: 25px!important;min-height: 25px!important;"
                        title="Clique para visualizar a ordem bancária ."/>
            </p:column>
            <p:column headerText="Número" styleClass="alinhamentoDireita">
                <h:outputText value="#{b.bordero.sequenciaArquivo}"/>
            </p:column>
            <p:column headerText="Data de Geração" styleClass="alinhamentoCentralizado">
                <h:outputText value="#{b.bordero.dataGeracao}">
                    <f:convertDateTime type="date"/>
                </h:outputText>
            </p:column>
            <p:column headerText="Unidade Organizacional" styleClass="alinhamentoEsquerda">
                <h:outputText value="#{b.bordero.unidadeOrganizacional}"/>
            </p:column>
            <p:column headerText="Conta Financeira" styleClass="alinhamentoEsquerda">
                <h:outputText value="#{b.bordero.subConta}"/>
            </p:column>
            <p:column headerText="Situação" styleClass="alinhamentoEsquerda">
                <h:outputText value="#{b.bordero.situacao.descricao}"/>
            </p:column>
            <p:column headerText="Qtde" styleClass="alinhamentoDireita">
                <h:outputText value="#{b.bordero.qntdPagamentos}"/>
            </p:column>
            <p:column headerText="Valor (R$)" styleClass="alinhamentoDireita">
                <h:outputText value="#{b.bordero.valor}"
                              converter="#{arquivoRemessaBancoControlador.moneyConverter}"/>
                <f:facet name="footer">
                    <h:outputText value="Total: " styleClass="negrito"/>
                    <h:outputText styleClass="negrito"
                                  converter="#{arquivoRemessaBancoControlador.moneyConverter}"
                                  value="#{arquivoRemessaBancoControlador.valorTotalBorderosAdicionados}"/>
                </f:facet>
            </p:column>

        </p:dataTable>

    </p:panel>

    <fc:rodapePretty controlador="#{arquivoRemessaBancoControlador}"/>

</h:form>


<p:dialog widgetVar="dialogDownloadArquivo"
          modal="true"
          closable="false"
          resizable="false"
          dynamic="true"
          showHeader="false"
          position="center"
          style="position: fixed !important;">
    <h:form id="formImprimirRelatorio">
        <center>
            <p:panel id="panelGerarArquivo" header="Gerar Arquivo OBN600" styleClass="mtop05 mbot05">

                <p:outputPanel rendered="#{arquivoRemessaBancoControlador.possuiDiferencaNoValidador()}">
                    <div class="alert alert-error mtop03">
                        <strong>Atenção!</strong>
                        <h:outputText value=" Arquivo com inconsistência de valores."/>
                    </div>
                </p:outputPanel>

                <p:outputPanel rendered="#{!arquivoRemessaBancoControlador.possuiDiferencaNoValidador()}">
                    <div class="alert alert-success">
                        <strong>Validado!</strong>
                        <h:outputText value=" Arquivo sem inconsistência de valores."/>
                    </div>
                </p:outputPanel>

                <br/>
                <h:outputText value="Deseja Gerar o Arquivo OBN600?"/>
                <h:panelGrid columns="3" styleClass="mtop20">

                    <p:commandButton ajax="false"
                                     value="Download"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     title="Clique para fazer o download do arquivo OBN600."
                                     styleClass="padrao prioritario"
                                     icon="ui-icon-download"
                                     actionListener="#{arquivoRemessaBancoControlador.gerarArquivoOBN600()}">
                        <p:fileDownload value="#{arquivoRemessaBancoControlador.file}"/>
                    </p:commandButton>

                    <p:commandButton value="Verificar Valores"
                                     onstart="aguarde.show()"
                                     rendered="#{arquivoRemessaBancoControlador.possuiDiferencaNoValidador()}"
                                     oncomplete="aguarde.hide();validador.show();"
                                     title="Clique para verificar valores."
                                     styleClass="prioritario"
                                     icon="ui-icon-gear"/>

                    <p:commandButton value="OK"
                                     icon="ui-icon-check"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     styleClass="padrao"
                                     title="Clique voltar a lista de arquivos bancários."
                                     actionListener="#{arquivoRemessaBancoControlador.redirecionarParaLista()}"/>

                </h:panelGrid>
            </p:panel>
        </center>
    </h:form>
</p:dialog>

<p:dialog position="center"
          id="dialogoId"
          header="Ordens Bancárias a Serem Selecionadas"
          modal="true"
          closable="false"
          width="1000"
          height="500"
          dynamic="true"
          widgetVar="dialogo"
        >
    <h:form id="Formulario2">
        <p:panel styleClass="mtop05">
            <h:panelGrid columns="2">
                <h:outputText value="Filtros" styleClass="azulnegrito"
                              style="font-size: 14px; font-style: italic"/>
            </h:panelGrid>

            <p:tabView id="tabView" styleClass="mtop05">
                <p:tab id="tabDatas" title="Data">
                    <h:panelGrid columns="2" id="gridFiltros" cellpadding="2">
                        <fc:outputLabelObrigatorio value="Data Inicial: "/>
                        <p:calendar title="Selecione a data inicial"
                                    id="dataInicial"
                                    navigator="true"
                                    value="#{arquivoRemessaBancoControlador.dtInicial}"
                                    pattern="dd/MM/yyyy"
                                    onkeypress="mascara(this, mdata)"/>

                        <fc:outputLabelObrigatorio value="Data Final: "/>
                        <p:calendar title="Selecione a data final"
                                    id="dataFinal"
                                    navigator="true"
                                    value="#{arquivoRemessaBancoControlador.dtFinal}"
                                    pattern="dd/MM/yyyy"
                                    onkeypress="mascara(this, mdata)"/>
                    </h:panelGrid>
                </p:tab>
                <p:tab id="tabUnidades" title="Unidade">
                    <h:panelGrid columns="2" styleClass="mbot05 mtop05">
                    <h:outputText value="Unidade Organizacional:" />
                    <p:autoComplete value="#{arquivoRemessaBancoControlador.organizacional}"
                                    completeMethod="#{arquivoRemessaBancoControlador.completarUnidades}"
                                    converter="#{arquivoRemessaBancoControlador.converterHierarquia}"
                                    style="margin-left: 5px; margin-top: 5px; margin-bottom: 10px;"
                                    maxResults="10"
                                    var="un"
                                    onkeyup="if(keyUpCampoVazio(this)){limparUnidade();}"
                                    id="completar-unidade"
                                    itemValue="#{un}"
                                    itemLabel="#{un.codigo}  #{un.subordinada.descricao}"
                                    size="70">
                        <p:ajax event="itemSelect"  process="@this" update="@none" onstart="aguarde.show()" oncomplete="aguarde.hide()"/>
                    </p:autoComplete>

                        <p:commandButton value="Adicionar"
                                         actionListener="#{arquivoRemessaBancoControlador.addUnidade()}"
                                         icon="ui-icon-check"
                                         process="@this"
                                         onclick="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                                         update=":Formulario2:tabView:tabelaUnidades completar-unidade"
                                         style="margin-top: 5px; margin-bottom: 5px"/>

                    </h:panelGrid>
                        <p:dataTable id="tabelaUnidades"
                                     value="#{arquivoRemessaBancoControlador.listaUnidades}"
                                     var="unid"
                                     rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     paginator="true"
                                     styleClass="mtop05"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>UNIDADES ORGANIZACIONAIS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                     emptyMessage="Não foram localizados registros para serem apresentados."
                                     rowIndexVar="rowlx">
                            <p:column headerText="Ação" style="width: 5%; text-align: center">
                                <p:commandButton icon="ui-icon-trash"
                                                 onstart="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 process="@this"
                                                 actionListener="#{arquivoRemessaBancoControlador.removerUnidade(unid)}"
                                                 title="Clique para remover este registro."
                                                 onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                 update=":Formulario2:tabView:tabelaUnidades" />

                            </p:column>
                            <p:column headerText="Código" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{unid.codigo}" styleClass="alinhamentoEsquerda"/>
                            </p:column>
                            <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{unid.descricaoSubordinadaConcatenada}" styleClass="alinhamentoEsquerda" />
                            </p:column>
                        </p:dataTable>


                </p:tab>
                <p:tab id="tabContasFinanceiras" title="Contas Financeira">
                    <h:panelGrid columns="2" cellpadding="2">
                        <h:outputText value="Conta Financeira Inicial:"/>
                        <p:autoComplete queryDelay="1000" value="#{arquivoRemessaBancoControlador.contaFinanceiraIni}"
                                        converter="#{arquivoRemessaBancoControlador.converterContaFinanceiraIni}"
                                        completeMethod="#{arquivoRemessaBancoControlador.completaContaFinanceiraIni}"
                                        var="conta"
                                        itemLabel="#{conta}"
                                        itemValue="#{conta.id}"
                                        forceSelection="true"
                                        size="70"
                                        title="Selecione a Conta Financeira Inicial"
                                        maxResults="10"/>

                        <h:outputText value="Conta Financeira Final:"/>
                        <p:autoComplete queryDelay="1000" value="#{arquivoRemessaBancoControlador.contaFinanceiraFim}"
                                        converter="#{arquivoRemessaBancoControlador.converterContaFinanceiraFim}"
                                        completeMethod="#{arquivoRemessaBancoControlador.completaContaFinanceiraFim}"
                                        var="conta"
                                        itemLabel="#{conta}"
                                        itemValue="#{conta.id}"
                                        forceSelection="true"
                                        size="70"
                                        title="Selecione a Conta Financeira Final"
                                        maxResults="10"/>
                    </h:panelGrid>
                </p:tab>
            </p:tabView>

            <h:panelGrid columns="4">
                <p:commandButton value="Pesquisar"
                                 id="btnPesquisa"
                                 disabled="#{arquivoRemessaBancoControlador.selecionado.banco.id eq null}"
                                 title="Clique para adicionar a ordem bancária."
                                 icon="ui-icon-search"
                                 actionListener="#{arquivoRemessaBancoControlador.listaBorderosBancoStatus()}"
                                 styleClass="mtop10 mrig05 prioritario padrao"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide();"
                                 update=":Formulario2"
                                 process=":Formulario2"/>

                <p:commandButton value="Limpar Filtros"
                                 id="btnLimpar"
                                 disabled="#{arquivoRemessaBancoControlador.selecionado.banco.id eq null}"
                                 title="Clique para limpar os filtros."
                                 icon="ui-icon-clear"
                                 actionListener="#{arquivoRemessaBancoControlador.limparFiltros()}"
                                 styleClass="mtop10 mrig05 padrao"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide();"
                                 update=":Formulario2:tabelaOB"
                                 process=":Formulario2:tabelaOB"/>

                <p:commandButton value="Confirmar"
                                 icon="ui-icon-check"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide();"
                                 update=":Formulario:tabelaBordero"
                                 title="Clique para confirmar a(s) ordem(ns) bancária(s) selecionada(s)."
                                 styleClass="botao_azul icone_branco mtop10 prioridade mrig05 padrao"
                                 actionListener="#{arquivoRemessaBancoControlador.adicionaBorderos()}"/>

                <p:commandButton value="Fechar"
                                 icon="ui-icon-close"
                                 onclick="aguarde.show()"
                                 title="Clique para fechar a janela."
                                 styleClass="botao_azul icone_branco mtop10 padrao"
                                 update="@this :Formulario:panel"
                                 process="@this"
                                 oncomplete="dialogo.hide();aguarde.hide()"/>
            </h:panelGrid>

            <p:dataTable value="#{arquivoRemessaBancoControlador.listaBordero}"
                         id="tabelaOB"
                         var="b"
                         selection="#{arquivoRemessaBancoControlador.arrayBordero}"
                         rowKey="#{b.id}"
                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                         rowIndexVar="rowIx"
                         styleClass="mtop05"
                         paginator="true"
                         emptyMessage="Não foram localizados registros para serem apresentados"
                         rows="10"
                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ORDENS BANCÁRIAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                         rowsPerPageTemplate="10,25,50,100">
                <p:column selectionMode="multiple" style="width:18px"/>
                <p:column headerText="Número"
                          filterBy="#{b.sequenciaArquivo}"
                          sortBy="#{b.sequenciaArquivo}"
                          filterMatchMode="contains">
                    <h:outputText value="#{b.sequenciaArquivo}" styleClass="alinhamentoDireita"/>
                </p:column>
                <p:column headerText="Data de Geração" styleClass="alinhamentoCentralizado">
                    <h:outputText value="#{b.dataGeracao}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="Unidade Organizacional"
                          filterBy="#{b.unidadeOrganizacional}"
                          sortBy="#{b.unidadeOrganizacional}"
                          filterMatchMode="contains"
                          styleClass="alinhamentoEsquerda">
                    <h:outputText value="#{b.unidadeOrganizacional}"/>
                </p:column>
                <p:column headerText="Conta Financeira"
                          filterBy="#{b.subConta}"
                          sortBy="#{b.subConta}"
                          filterMatchMode="contains"
                          styleClass="alinhamentoEsquerda">
                    <h:outputText value="#{b.subConta}"/>
                </p:column>
                <p:column headerText="Situação" styleClass="alinhamentoEsquerda">
                    <h:outputText value="#{b.situacao.descricao}"/>
                </p:column>
                <p:column headerText="Qtde" styleClass="alinhamentoDireita">
                    <h:outputText value="#{b.qntdPagamentos}"/>
                </p:column>
                <p:column headerText="Valor (R$)" styleClass="alinhamentoDireita">
                    <h:outputText value="#{b.valor}"
                                  converter="#{arquivoRemessaBancoControlador.moneyConverter}"
                                  style="text-align: center;"/>
                    <f:facet name="footer">
                        <h:outputText value="Total: " styleClass="negrito"/>
                        <h:outputText styleClass="negrito"
                                      converter="#{arquivoRemessaBancoControlador.moneyConverter}"
                                      value="#{arquivoRemessaBancoControlador.valorTotalBorderos}"/>
                    </f:facet>
                </p:column>
            </p:dataTable>
        </p:panel>
    </h:form>
</p:dialog>

<p:dialog widgetVar="validador"
          position="center"
          id="dialogoValidador"
          header="Validador de Valores"
          modal="true"
          width="1000"
          height="500"
          dynamic="true">

    <h:form id="Formulario-validador">
        <p:dataTable value="#{arquivoRemessaBancoControlador.validadores}"
                     id="tabelaValidador"
                     var="b"
                     rowKey="#{b.id}"
                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                     rowIndexVar="rowIx"
                     styleClass="mtop05"
                     paginator="true"
                     emptyMessage="Não foram localizados registros para serem apresentados"
                     rows="10"
                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ORDENS BANCÁRIAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                     rowsPerPageTemplate="10,25,50,100">

            <p:column headerText="Número"
                      filterBy="#{b.bordero}"
                      sortBy="#{b.bordero}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.bordero}" styleClass="alinhamentoDireita"/>
            </p:column>
            <p:column headerText="Total de Pagamento"
                      filterBy="#{b.pagamento}"
                      sortBy="#{b.pagamento}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.pagamento}" styleClass="alinhamentoDireita"
                              converter="moneyConverter"/>
            </p:column>
            <p:column headerText="Total de Despesa Extra"
                      filterBy="#{b.despesaExtra}"
                      sortBy="#{b.despesaExtra}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.despesaExtra}" styleClass="alinhamentoDireita"
                              converter="moneyConverter"/>
            </p:column>
            <p:column headerText="Total dos Movimentos"
                      filterBy="#{b.totalMovimentos}"
                      sortBy="#{b.totalMovimentos}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.totalMovimentos}" styleClass="alinhamentoDireita"
                              converter="moneyConverter"/>
            </p:column>
            <p:column headerText="Total Item O. B."
                      filterBy="#{b.valorItemBordero}"
                      sortBy="#{b.valorItemBordero}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.valorItemBordero}" styleClass="alinhamentoDireita"
                              converter="moneyConverter"/>
            </p:column>
            <p:column headerText="Total da O. B."
                      filterBy="#{b.totalBordero}"
                      sortBy="#{b.totalBordero}"
                      filterMatchMode="contains">
                <h:outputText value="#{b.totalBordero}" styleClass="alinhamentoDireita"
                              converter="moneyConverter"/>
            </p:column>
            <p:column headerText="Possui Diferença"
                      filterBy="#{utilBean.converterBooleanSimOuNao(b.possuiDiferenca)}"
                      sortBy="#{utilBean.converterBooleanSimOuNao(b.possuiDiferenca)}"
                      filterMatchMode="contains">
                <h:outputText value="#{utilBean.converterBooleanSimOuNao(b.possuiDiferenca)}"
                              styleClass="#{b.possuiDiferenca ? 'alinhamentoCentralizado vermelhonegrito' : 'alinhamentoCentralizado'}"/>
            </p:column>
        </p:dataTable>
    </h:form>
</p:dialog>


    <p:dialog widgetVar="dialogMsgErro"
              modal="true"
              closable="false"
              resizable="false"
              dynamic="true"
              showHeader="false"
              position="center"
              style="position: fixed !important;">
        <h:form id="formDialogErro">
            <center>
                <p:panel id="panelDialogErro" styleClass="mtop05 mbot05">
                    <div class="alert alert-error">
                        <h:outputText
                            value="A(s) guia(s) relacionada(s) abaixo, possuem data de pagamento(D+1) menor que a data do arquivo obn600."/>
                    </div>

                    <p:scrollPanel mode="native" style="height: 300px; border: 0px">

                        <p:outputPanel rendered="#{!empty arquivoRemessaBancoControlador.listaGuiasPagamentos}">
                            <div align="left" class="mtop05 negrito">
                                <h:outputText value="GUIA DE PAGAMENTO"/>
                            </div>
                            <table id="guiaPagamento" class="table table-hover table-condensed"
                                   style="border-radius: 0px">
                                <tr>
                                    <th>
                                        <h:outputText value="Tipo de Guia"/>
                                    </th>
                                    <th>
                                        <h:outputText value="Data de Pagamento"/>
                                    </th>
                                    <th>
                                        <h:outputText value="Unidade"/>
                                    </th>
                                    <th>
                                        <h:outputText value="N° Pagamento"/>
                                    </th>
                                    <th>
                                        <h:outputText value="N° O.B."/>
                                    </th>
                                    <th>
                                        <h:outputText value="Valor"/>
                                    </th>
                                </tr>
                                <ui:repeat value="#{arquivoRemessaBancoControlador.listaGuiasPagamentos}"
                                           var="guiaPag">
                                    <tr class="#{arquivoRemessaBancoControlador.verificarGuiaEmergencial(guiaPag.dataPagamento) ? 'fundo-verde' : ''}"
                                        title="Esta guia pode ser paga como emergencial.">
                                        <td>
                                            <h:outputText value="#{guiaPag.getTipoDeGuia(guiaPag.pagamento)}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaPag.dataPagamento}">
                                                <f:convertDateTime type="date"/>
                                            </h:outputText>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{arquivoRemessaBancoControlador.getCodigoHierarquia(guiaPag)}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaPag.pagamento.numeroPagamento}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaPag.pagamento.numDocumento}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaPag.valorTotalPorGuia}">
                                                <f:convertNumber type="currency"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </table>
                        </p:outputPanel>

                        <p:outputPanel rendered="#{!empty arquivoRemessaBancoControlador.listaGuiasDespesaExtra}">
                            <div align="left" class="mtop10 negrito">
                                <h:outputText value="GUIA DE DESPESA EXTRA"/>
                            </div>
                            <table id="guiaPagamentoExtra" class="table table-hover table-condensed"
                                   style="border-radius: 0px">
                                <tr>
                                    <th>
                                        <h:outputText value="Tipo de Guia"/>
                                    </th>
                                    <th>
                                        <h:outputText value="Data de Pagamento"/>
                                    </th>
                                    <th>
                                        <h:outputText value="Unidade"/>
                                    </th>
                                    <th>
                                        <h:outputText value="N° Despesa"/>
                                    </th>
                                    <th>
                                        <h:outputText value="N° O.B."/>
                                    </th>
                                    <th>
                                        <h:outputText value="Valor"/>
                                    </th>
                                </tr>
                                <ui:repeat value="#{arquivoRemessaBancoControlador.listaGuiasDespesaExtra}"
                                           var="guiaDesp">
                                    <tr class="#{arquivoRemessaBancoControlador.verificarGuiaEmergencial(guiaDesp.dataPagamento) ? 'fundo-verde' : ''}"
                                        title="Esta guia pode ser paga como emergencial.">
                                        <td>
                                            <h:outputText value="#{guiaDesp.getTipoDeGuia(guiaDesp.pagamentoExtra)}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaDesp.dataPagamento}">
                                                <f:convertDateTime type="date"/>
                                            </h:outputText>
                                        </td>
                                        <td>
                                            <h:outputText
                                                value="#{arquivoRemessaBancoControlador.getCodigoHierarquia(guiaDesp)}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaDesp.pagamentoExtra.numero}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaDesp.pagamentoExtra.numeroPagamento}"/>
                                        </td>
                                        <td>
                                            <h:outputText value="#{guiaDesp.valorTotalPorGuia}">
                                                <f:convertNumber type="currency"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </table>
                        </p:outputPanel>
                    </p:scrollPanel>

                    <h:panelGrid columns="3" styleClass="mtop10">

                        <p:commandButton value="Voltar p/ Lista"
                                         icon="ui-icon-voltar"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                                         styleClass="padrao mrig05"
                                         title="Clique voltar a lista de arquivos bancários."
                                         actionListener="#{arquivoRemessaBancoControlador.redireciona()}"/>

                        <fc:botaoTargetBlank id="btImprimir"
                                             label="Imprimir"
                                             styleClass="padrao mrig05"
                                             title="Clique para gerar pdf."
                                             actionListener="#{arquivoRemessaBancoControlador.gerarPDFGuia()}"/>

                        <p:commandButton value="Fechar"
                                         icon="ui-icon-close"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide();dialogMsgErro.hide()"
                                         actionListener="#{arquivoRemessaBancoControlador.limparListaGuias()}"
                                         styleClass="padrao"
                                         title="Clique para fehcar a janela."/>


                    </h:panelGrid>
                </p:panel>
            </center>
        </h:form>
    </p:dialog>
    <p:dialog widgetVar="dlgUnidade"
              modal="false"
              closable="false"
              resizable="false"
              dynamic="false"
              showHeader="false"
              position="center"
              style="position: fixed !important;">
        <h:form id="formUnidade">
            <p:panel header="Informativo de Unidades do Contrato">
                <p:dataTable id="tabela-informatica-unidade"
                             value="#{arquivoRemessaBancoControlador.informativoUnidades}"
                             var="unid"
                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                             paginator="true"
                             styleClass="mtop05"
                             rows="5"
                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>UNIDADES ORGANIZACIONAIS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                             emptyMessage="Não foram localizados registros para serem apresentados."
                             rowIndexVar="rowlx">

                    <p:column headerText="Código" styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{unid.codigo}" styleClass="alinhamentoEsquerda"/>
                    </p:column>
                    <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{unid.descricaoSubordinadaConcatenada}" styleClass="alinhamentoEsquerda" />
                    </p:column>
                </p:dataTable>
            <p:commandButton value="Fechar"
                             icon="ui-icon-cancel"
                             actionListener="#{arquivoRemessaBancoControlador.limparTabelaInformativaUnidade()}"
                             styleClass="alinhamentoCentralizado"
                             style="margin-top: 5px; text-align: center;!important; margin-bottom: 5px;"
                             onclick="aguarde.show();"
                             oncomplete="aguarde.hide(); dlgUnidade.hide();"/>
            </p:panel>
        </h:form>
    </p:dialog>
</ui:define>
</ui:composition>
</html>
