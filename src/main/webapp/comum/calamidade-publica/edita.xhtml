<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:co="http://java.sun.com/jsf/composite/components/contabil"
      xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">

        <h:form id="Formulario">
            <fc:cabecalhoPretty controlador="#{calamidadePublicaControlador}"
                                origem="#{calamidadePublicaControlador.caminhoPadrao}listar/"/>

            <p:panel header="Cadastro de Calamidade Pública">
                <h:panelGrid columns="2">
                    <fc:outputLabelObrigatorio value="Descrição: "/>
                    <p:inputText title="Informe a descrição."
                                 value="#{calamidadePublicaControlador.selecionado.descricao}"
                                 id="desc"
                                 maxlength="70"
                                 size="70"/>

                    <fc:outputLabelObrigatorio value="Tipo: "/>
                    <h:selectOneMenu title="Informe a abreviação."
                                     value="#{calamidadePublicaControlador.selecionado.abreviacao}">
                        <f:selectItems value="#{calamidadePublicaControlador.tipos}"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Início de Vigência: "/>
                    <fc:calendar value="#{calamidadePublicaControlador.selecionado.inicioVigencia}"
                                 title="Informe o Início de Vigência."/>

                    <h:outputText value="Final de Vigência: "/>
                    <fc:calendar value="#{calamidadePublicaControlador.selecionado.finalVigencia}"
                                 title="Informe o Final de Vigência."/>
                </h:panelGrid>
                <p:tabView id="tabViewGeral">
                    <p:tab title="Contratos">
                        <p:panel id="painelCont"
                                 styleClass="mtop10"
                                 header="Contrato">
                            <p:commandButton value="Novo"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.instanciarContrato()}"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaContrato eq null}"
                                             update=":Formulario:tabViewGeral:painelCont"
                                             process="@this"
                                             id="btnNovoCont"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="padrao"
                                             title="Clique para adicionar um novo contrato."/>

                            <h:panelGrid columns="3"
                                         rendered="#{calamidadePublicaControlador.calamidadePublicaContrato ne null}">
                                <fc:outputLabelObrigatorio for="cont" value="Contrato: "/>
                                <fc:autoComplete completeMethod="#{calamidadePublicaControlador.completarContratos}"
                                                 maxResults="50"
                                                 value="#{calamidadePublicaControlador.calamidadePublicaContrato.contrato}"
                                                 id="cont"
                                                 converter="#{contratoAdmControlador.converterGenerico}"/>

                                <p:commandButton update="@this"
                                                 onstart="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 process=":Formulario"
                                                 onclick="dialogContrato.show()"
                                                 icon="ui-icon-search"
                                                 title="Clique para selecionar um Contrato"/>

                                <fc:outputLabelObrigatorio for="status" value="Status: "/>
                                <h:selectOneMenu id="status"
                                                 value="#{calamidadePublicaControlador.calamidadePublicaContrato.situacao}">
                                    <f:selectItems value="#{calamidadePublicaControlador.situacoesContrato}"/>
                                </h:selectOneMenu>

                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.adicionarContrato()}"
                                             update=":Formulario:tabViewGeral:painelCont"
                                             process="@this :Formulario:tabViewGeral:painelCont"
                                             styleClass="padrao mtop10"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaContrato ne null}"
                                             title="Clique para adicionar o Contrato"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             actionListener="#{calamidadePublicaControlador.cancelarContrato()}"
                                             update=":Formulario:tabViewGeral:painelCont"
                                             process="@this"
                                             styleClass="mlef05 mtop10 padrao"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaContrato ne null}"
                                             title="Clique para cancelar"/>

                            <p:dataTable id="tabelaContratos"
                                         value="#{calamidadePublicaControlador.selecionado.contratos}"
                                         var="c"
                                         styleClass="mtop02"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>CONTRATOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="rowlx">
                                <p:column headerText="Ações" style="text-align: center; width: 7%">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     styleClass="mrig05"
                                                     actionListener="#{calamidadePublicaControlador.editarContrato(c)}"
                                                     title="Clique para alterar este registro."
                                                     id="btEditarCOnt"
                                                     update=":Formulario:tabViewGeral:painelCont"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{calamidadePublicaControlador.removerContrato(c)}"
                                                     title="Clique para remover este registro."
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     id="btRemoveCont"
                                                     process="@this"
                                                     update=":Formulario:tabViewGeral:painelCont"/>
                                </p:column>
                                <p:column headerText="Contrato" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{c.contrato}"/>
                                </p:column>
                                <p:column headerText="Status da Contratação" styleClass="alinhamentoEsquerda">
                                    <h:selectOneMenu value="#{c.situacao}">
                                        <f:selectItems value="#{calamidadePublicaControlador.situacoesContrato}"/>
                                    </h:selectOneMenu>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="Atos Legais">
                        <p:panel id="painelAto"
                                 styleClass="mtop10"
                                 header="Ato Legal">
                            <p:commandButton value="Novo"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.instanciarAtoLegal()}"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaAtoLegal eq null}"
                                             update=":Formulario:tabViewGeral:painelAto"
                                             process="@this"
                                             id="btnNovoAto"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="padrao"
                                             title="Clique para adicionar um novo ato legal."/>

                            <h:panelGrid columns="3"
                                         rendered="#{calamidadePublicaControlador.calamidadePublicaAtoLegal ne null}">
                                <fc:outputLabelObrigatorio for="at" value="Ato Legal: "/>
                                <fc:autoComplete completeMethod="#{calamidadePublicaControlador.completarAtosLegais}"
                                                 value="#{calamidadePublicaControlador.calamidadePublicaAtoLegal.atoLegal}"
                                                 id="at"
                                                 converter="#{atoLegalControlador.converterGenerico}"/>

                                <p:commandButton update="@this"
                                                 onstart="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 process=":Formulario"
                                                 onclick="dialogAtoLegal.show()"
                                                 icon="ui-icon-search"
                                                 title="Clique para selecionar um Ato Legal"/>
                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.adicionarAtoLegal()}"
                                             update=":Formulario:tabViewGeral:painelAto"
                                             process="@this :Formulario:tabViewGeral:painelAto"
                                             styleClass="padrao mtop10"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaAtoLegal ne null}"
                                             title="Clique para adicionar o Ato Legal"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             actionListener="#{calamidadePublicaControlador.cancelarAtoLegal()}"
                                             update=":Formulario:tabViewGeral:painelAto"
                                             process="@this"
                                             styleClass="mlef05 mtop10 padrao"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaAtoLegal ne null}"
                                             title="Clique para cancelar"/>

                            <p:dataTable id="tabelaAto"
                                         value="#{calamidadePublicaControlador.selecionado.atosLegais}"
                                         var="a"
                                         styleClass="mtop02"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>ATOS LEGAIS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="rowlx">
                                <p:column headerText="Ações" style="text-align: center; width: 7%">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     styleClass="mrig05"
                                                     actionListener="#{calamidadePublicaControlador.editarAtoLegal(a)}"
                                                     title="Clique para alterar este registro."
                                                     id="btEditarAto"
                                                     update=":Formulario:tabViewGeral:painelAto"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{calamidadePublicaControlador.removerAtoLegal(a)}"
                                                     title="Clique para remover este registro."
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     id="btRemoveAto"
                                                     process="@this"
                                                     update=":Formulario:tabViewGeral:painelAto"/>
                                </p:column>
                                <p:column headerText="Ato Legal" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{a.atoLegal}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Recursos Recebidos">
                        <p:panel id="painelRecurso"
                                 styleClass="mtop10"
                                 header="Ato Legal">
                            <p:commandButton value="Novo"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.instanciarRecurso()}"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso eq null}"
                                             update=":Formulario:tabViewGeral:painelRecurso"
                                             process="@this"
                                             id="btnNovoRecurso"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="padrao"
                                             title="Clique para adicionar um novo ato legal."/>

                            <h:panelGrid columns="2"
                                         rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso ne null}">
                                <fc:outputLabelObrigatorio for="tipoAtoLegalUnidade" value="Tipo: "/>
                                <h:selectOneMenu title="Informe o tipo unidade para o ato legal."
                                                 value="#{calamidadePublicaControlador.calamidadePublicaRecurso.tipo}"
                                                 id="tipoAtoLegalUnidade">
                                    <f:selectItems value="#{calamidadePublicaControlador.tipoUnidade}"/>
                                    <p:ajax onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()"
                                            listener="#{calamidadePublicaControlador.atribuirCamposAutoCompleteNull}"
                                            update=":Formulario:tabViewGeral:painelRecurso"
                                            process=":Formulario:tabViewGeral:painelRecurso"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Orgão/Entidade Transferidor Interno: "
                                                           rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso.isInterna()}"/>
                                <p:autoComplete queryDelay="1000" id="unidade"
                                                value="#{calamidadePublicaControlador.hierarquiaOrganizacional}"
                                                completeMethod="#{calamidadePublicaControlador.completarUnidadeOrganizacional}"
                                                converter="#{hierarquiaOrganizacionalControlador.converterHierarquiaOrganizacional}"
                                                rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso.isInterna()}"
                                                var="unid"
                                                forceSelection="true"
                                                size="70"
                                                maxResults="10"
                                                itemLabel="#{unid}"
                                                itemValue="#{unid.id}"
                                                title="Selecione uma unidade organizacional."/>

                                <fc:outputLabelObrigatorio value="Orgão/Entidade Transferidor Externo: "
                                                           rendered="#{!calamidadePublicaControlador.calamidadePublicaRecurso.isInterna()}"/>
                                <p:autoComplete queryDelay="1000" id="unidadeExterna"
                                                value="#{calamidadePublicaControlador.calamidadePublicaRecurso.unidadeExterna}"
                                                completeMethod="#{calamidadePublicaControlador.completarUnidadeExterna}"
                                                converter="#{unidadeExternaControlador.converterGenerico}"
                                                rendered="#{!calamidadePublicaControlador.calamidadePublicaRecurso.isInterna()}"
                                                var="unidExt"
                                                forceSelection="true"
                                                size="70"
                                                maxResults="10"
                                                itemLabel="#{unidExt}"
                                                itemValue="#{unidExt.id}"
                                                title="Selecione uma unidade externa para o ato legal.">
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio for="fonteDeRecursos" value="Fonte de Recurso: "/>
                                <fc:autoComplete
                                    completeMethod="#{calamidadePublicaControlador.completarFonteDeRecurso}"
                                    value="#{calamidadePublicaControlador.calamidadePublicaRecurso.fonteDeRecursos}"
                                    id="fonteDeRecursos"
                                    converter="#{fonteDeRecursosControlador.converterGenerico}"/>

                                <fc:outputLabelObrigatorio value="Valor:"/>
                                <fc:inputMoeda
                                    value="#{calamidadePublicaControlador.calamidadePublicaRecurso.valor}"
                                    id="valor"/>

                                <fc:outputLabelObrigatorio value="Data do Recebimento:"/>
                                <p:calendar title="Informe a data do Recebimento"
                                            value="#{calamidadePublicaControlador.calamidadePublicaRecurso.dataRecebimento}"
                                            id="dataRecebimento" navigator="true"
                                            pattern="dd/MM/yyyy" locale="pt_BR"
                                            onkeyup="mascara(this, mdata)"/>

                                <fc:outputLabelObrigatorio value="Banco:"/>
                                <p:inputText title="Informe o banco."
                                             value="#{calamidadePublicaControlador.calamidadePublicaRecurso.banco}"
                                             maxlength="70"
                                             size="70"/>

                                <fc:outputLabelObrigatorio value="Agência:"/>
                                <p:inputText title="Informe a agência."
                                             value="#{calamidadePublicaControlador.calamidadePublicaRecurso.agencia}"
                                             maxlength="70"
                                             size="70"/>

                                <fc:outputLabelObrigatorio value="Conta Corrente:"/>
                                <p:inputText title="Informe a Conta corrente."
                                             value="#{calamidadePublicaControlador.calamidadePublicaRecurso.contaCorrente}"
                                             maxlength="70"
                                             size="70"/>

                                <fc:outputLabelObrigatorio value="Data da Transferência:"/>
                                <p:calendar title="Informe a data da transferência"
                                            value="#{calamidadePublicaControlador.calamidadePublicaRecurso.dataTransferencia}"
                                            id="dataTransferencia" navigator="true"
                                            pattern="dd/MM/yyyy" locale="pt_BR"
                                            onkeyup="mascara(this, mdata)"/>

                                <fc:outputLabelObrigatorio value="Valor Disponibilizado:"/>
                                <fc:inputMoeda
                                    value="#{calamidadePublicaControlador.calamidadePublicaRecurso.valorDisponibilizado}"
                                    id="valorDisponibilizado"/>

                                <fc:outputLabelObrigatorio value="Valor Bloqueado:"/>
                                <fc:inputMoeda
                                    value="#{calamidadePublicaControlador.calamidadePublicaRecurso.valorBloqueado}"
                                    id="valorBloqueado"/>


                                <fc:outputLabelObrigatorio value="Tipo da Conta:"/>
                                <p:inputText title="Informe o Tipo da Conta."
                                             value="#{calamidadePublicaControlador.calamidadePublicaRecurso.tipoConta}"
                                             maxlength="70"
                                             size="70"/>
                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.adicionarRecurso()}"
                                             update=":Formulario:tabViewGeral:painelRecurso"
                                             process="@this :Formulario:tabViewGeral:painelRecurso"
                                             styleClass="padrao mtop10"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso ne null}"
                                             title="Clique para adicionar o Recurso"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             actionListener="#{calamidadePublicaControlador.cancelarRecurso()}"
                                             update=":Formulario:tabViewGeral:painelRecurso"
                                             process="@this"
                                             styleClass="mlef05 mtop10 padrao"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaRecurso ne null}"
                                             title="Clique para cancelar"/>

                            <p:dataTable id="tabelaRecurso"
                                         value="#{calamidadePublicaControlador.selecionado.recursos}"
                                         var="rec"
                                         styleClass="mtop02"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>RECURSOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="rowlx">
                                <p:column headerText="Ações" style="text-align: center; width: 7%">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     styleClass="mrig05"
                                                     actionListener="#{calamidadePublicaControlador.editarRecurso(rec)}"
                                                     title="Clique para alterar este registro."
                                                     update=":Formulario:tabViewGeral:painelRecurso"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{calamidadePublicaControlador.removerRecurso(rec)}"
                                                     title="Clique para remover este registro."
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     process="@this"
                                                     update=":Formulario:tabViewGeral:painelRecurso"/>
                                </p:column>
                                <p:column headerText="Orgão/Entidade Transferidor" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.unidadeAsString}"/>
                                </p:column>
                                <p:column headerText="Fonte de Recursos" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.fonteDeRecursos}"/>
                                </p:column>
                                <p:column headerText="Valor Recebido" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.valor}" converter="moneyConverter"/>
                                </p:column>
                                <p:column headerText="Data do Recebido" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.dataRecebimento}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Banco" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.banco}"/>
                                </p:column>
                                <p:column headerText="Agência" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.agencia}"/>
                                </p:column>
                                <p:column headerText="Conta Corrente" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{rec.contaCorrente}"/>
                                </p:column>
                                <p:column headerText="Valor Disponibilizado" styleClass="alinhamentoDireita">
                                    <h:outputText value="#{rec.valorDisponibilizado}" converter="moneyConverter"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Bens e Serviços Recebidos">
                        <p:panel id="painelItens"
                                 styleClass="mtop10"
                                 header="Bens e Serviços Recebidos">
                            <p:commandButton value="Novo"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.instanciarBemServico()}"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemServico eq null}"
                                             update=":Formulario:tabViewGeral:painelItens"
                                             process="@this"
                                             id="btnNovoItem"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="padrao"
                                             title="Clique para adicionar um novo Item."/>

                            <h:panelGrid columns="2"
                                         rendered="#{calamidadePublicaControlador.calamidadePublicaBemServico ne null}">
                                <fc:outputLabelObrigatorio value="Descrição: "/>
                                <p:inputText title="Informe a descrição."
                                             value="#{calamidadePublicaControlador.calamidadePublicaBemServico.descricao}"
                                             maxlength="70"
                                             size="70"/>
                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.adicionarBemServico()}"
                                             update=":Formulario:tabViewGeral:painelItens"
                                             process="@this :Formulario:tabViewGeral:painelItens"
                                             styleClass="padrao mtop10"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemServico ne null}"
                                             title="Clique para adicionar o item"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             actionListener="#{calamidadePublicaControlador.cancelarBemServico()}"
                                             update=":Formulario:tabViewGeral:painelItens"
                                             process="@this"
                                             styleClass="mlef05 mtop10 padrao"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemServico ne null}"
                                             title="Clique para cancelar"/>

                            <p:dataTable id="tabelaItens"
                                         value="#{calamidadePublicaControlador.selecionado.bensServicosRecebidos}"
                                         var="it"
                                         styleClass="mtop02"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>Bens e Serviços Recebidos&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="rowlx">
                                <p:column headerText="Ações" style="text-align: center; width: 7%">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     styleClass="mrig05"
                                                     actionListener="#{calamidadePublicaControlador.editarBemServico(it)}"
                                                     title="Clique para alterar este registro."
                                                     update=":Formulario:tabViewGeral:painelItens"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{calamidadePublicaControlador.removerBemServico(it)}"
                                                     title="Clique para remover este registro."
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     process="@this"
                                                     update=":Formulario:tabViewGeral:painelItens"/>
                                </p:column>
                                <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{it.descricao}"/>
                                </p:column>
                                <p:column headerText="Unidade" styleClass="alinhamentoEsquerda">
                                    <p:autoComplete queryDelay="1000" id="unidadeMedida"
                                                    value="#{it.unidadeMedida}"
                                                    completeMethod="#{calamidadePublicaControlador.completarUnidadesMedida}"
                                                    converter="#{unidadeMedidaControlador.converterGenerico}"
                                                    var="unidMed"
                                                    forceSelection="true"
                                                    size="50"
                                                    maxResults="10"
                                                    itemLabel="#{unidMed}"
                                                    itemValue="#{unidMed.id}"
                                                    title="Selecione uma unidade de medida.">
                                        <p:ajax event="itemSelect" process="@this"/>
                                    </p:autoComplete>
                                </p:column>
                                <p:column headerText="Quantidade" styleClass="alinhamentoEsquerda">
                                    <p:inputText value="#{it.quantidade}"
                                                 onkeypress="mascara(this, soNumeros)"
                                                 size="10"
                                                 maxlength="10"/>
                                </p:column>
                                <p:column headerText="Órgão">
                                    <p:autoComplete queryDelay="1000" id="hie"
                                                    value="#{it.hierarquiaOrganizacional}"
                                                    completeMethod="#{calamidadePublicaControlador.completarUnidadeOrcamentaria}"
                                                    converter="#{hierarquiaOrganizacionalControlador.converterHierarquiaOrganizacional}"
                                                    var="und"
                                                    forceSelection="true"
                                                    size="40"
                                                    maxResults="10"
                                                    itemLabel="#{und}"
                                                    itemValue="#{und.id}"
                                                    title="Selecione um órgão.">
                                        <p:ajax event="itemSelect" process="@this"/>
                                    </p:autoComplete>
                                </p:column>
                                <p:column headerText="Entidade Transferidor" styleClass="alinhamentoEsquerda">
                                    <p:inputText value="#{it.pessoa}"
                                                 size="40"
                                                 maxlength="255"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Bens Doados Pelo Município">
                        <p:panel id="painelItensDoados"
                                 styleClass="mtop10"
                                 header="Bens Doados Pelo Município">
                            <p:commandButton value="Novo"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.instanciarBemDoado()}"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemDoado eq null}"
                                             update=":Formulario:tabViewGeral:painelItensDoados"
                                             process="@this"
                                             id="btnNovoItemDoado"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="padrao"
                                             title="Clique para adicionar um novo Item."/>

                            <h:panelGrid columns="2"
                                         rendered="#{calamidadePublicaControlador.calamidadePublicaBemDoado ne null}">
                                <fc:outputLabelObrigatorio value="Descrição: "/>
                                <p:inputText title="Informe a descrição."
                                             value="#{calamidadePublicaControlador.calamidadePublicaBemDoado.descricao}"
                                             maxlength="70"
                                             size="70"/>

                                <fc:outputLabelObrigatorio value="Unidade De Medida: "/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{calamidadePublicaControlador.calamidadePublicaBemDoado.unidadeMedida}"
                                                completeMethod="#{calamidadePublicaControlador.completarUnidadesMedida}"
                                                converter="#{unidadeMedidaControlador.converterGenerico}"
                                                var="unidMed"
                                                forceSelection="true"
                                                size="50"
                                                maxResults="10"
                                                itemLabel="#{unidMed}"
                                                itemValue="#{unidMed.id}"
                                                title="Selecione uma unidade de medida.">
                                    <p:ajax event="itemSelect" process="@this"/>
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio value="Quantidade: "/>
                                <p:inputText
                                    value="#{calamidadePublicaControlador.calamidadePublicaBemDoado.quantidade}"
                                    onkeypress="mascara(this, soNumeros)"
                                    size="10"
                                    maxlength="10"/>

                                <fc:outputLabelObrigatorio value="Donatário(s): "/>
                                <p:inputText value="#{calamidadePublicaControlador.calamidadePublicaBemDoado.donatario}"
                                             size="70"
                                             maxlength="70"/>

                                <fc:outputLabelObrigatorio value="Órgão/Entidade pela entrega: "/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{calamidadePublicaControlador.calamidadePublicaBemDoado.hierarquiaOrganizacional}"
                                                completeMethod="#{calamidadePublicaControlador.completarUnidadeOrcamentaria}"
                                                converter="#{hierarquiaOrganizacionalControlador.converterHierarquiaOrganizacional}"
                                                var="und"
                                                forceSelection="true"
                                                size="50"
                                                maxResults="10"
                                                itemLabel="#{und}"
                                                itemValue="#{und.id}"
                                                title="Selecione um órgão.">
                                    <p:ajax event="itemSelect" process="@this"/>
                                </p:autoComplete>
                            </h:panelGrid>

                            <fc:filesUploadWP
                                rendered="#{calamidadePublicaControlador.calamidadePublicaBemDoado ne null}"
                                selecionado="#{calamidadePublicaControlador.calamidadePublicaBemDoado}"/>

                            <p:commandButton value="Adicionar"
                                             icon="ui-icon-circle-plus"
                                             actionListener="#{calamidadePublicaControlador.adicionarBemDoado()}"
                                             update=":Formulario:tabViewGeral:painelItensDoados"
                                             process="@this :Formulario:tabViewGeral:painelItensDoados"
                                             styleClass="padrao mtop10"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemDoado ne null}"
                                             title="Clique para adicionar o item"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             actionListener="#{calamidadePublicaControlador.cancelarBemDoado()}"
                                             update=":Formulario:tabViewGeral:painelItensDoados"
                                             process="@this"
                                             styleClass="mlef05 mtop10 padrao"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             rendered="#{calamidadePublicaControlador.calamidadePublicaBemDoado ne null}"
                                             title="Clique para cancelar"/>

                            <p:dataTable id="tabelaItensDoados"
                                         value="#{calamidadePublicaControlador.selecionado.bensDoados}"
                                         var="it"
                                         styleClass="mtop02"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>Bens Doados Pelo Município&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="rowlx">
                                <p:column headerText="Ações" style="text-align: center; width: 7%">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     styleClass="mrig05"
                                                     actionListener="#{calamidadePublicaControlador.editarBemDoado(it)}"
                                                     title="Clique para alterar este registro."
                                                     update=":Formulario:tabViewGeral:painelItensDoados"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{calamidadePublicaControlador.removerBemDoado(it)}"
                                                     title="Clique para remover este registro."
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     process="@this"
                                                     update=":Formulario:tabViewGeral:painelItensDoados"/>
                                </p:column>
                                <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{it.descricao}"/>
                                </p:column>
                                <p:column headerText="Unidade" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{it.unidadeMedida}"/>
                                </p:column>
                                <p:column headerText="Quantidade" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{it.quantidade}"/>
                                </p:column>
                                <p:column headerText="Donatário" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{it.donatario}"/>
                                </p:column>
                                <p:column headerText="Órgão/Entidade pela entrega">
                                    <c:if test="#{it.hierarquiaOrganizacional ne null}">
                                        <h:outputText value="#{it.hierarquiaOrganizacional}"/>
                                    </c:if>
                                    <c:if test="#{it.hierarquiaOrganizacional eq null}">
                                        <fc:codigo-descricao-hierarquia styleClass=""
                                                                        unidadeOrganizacional="#{it.unidadeOrganizacional}"
                                                                        dataMovimento="#{calamidadePublicaControlador.getDataOperacao()}"
                                                                        tipoHierarquia="ORCAMENTARIA"/>
                                    </c:if>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                </p:tabView>
            </p:panel>
            <fc:rodapePretty id="rodapeCabecalho"
                             controlador="#{calamidadePublicaControlador}"/>
        </h:form>


        <p:dialog widgetVar="dialogContrato"
                  modal="true"
                  resizable="false"
                  onShow="redimensionarLadosDialog(this.id);redimensionarAlturaDialog(this.id)"
                  width="1000"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;">
            <h:form id="FormularioContrato">

                <co:titulo-panel titulo="Filtros"/>
                <h:panelGrid columns="2" styleClass="mtop10">
                    <h:outputText value="Filtro: "/>
                    <p:inputText value="#{calamidadePublicaControlador.filtroContrato}"
                                 id="inputContrato"
                                 title="Informe o número do Contrato para pesquisar."
                                 size="70">
                        <p:watermark value="Pesquisa por número do Contrato."
                                     for="inputContrato"/>
                    </p:inputText>
                </h:panelGrid>

                <p:commandButton value="Pesquisar"
                                 id="btnPesquisa"
                                 title="Clique para Pesquisar os Contratos."
                                 icon="ui-icon-search"
                                 actionListener="#{calamidadePublicaControlador.buscarContratos()}"
                                 styleClass="mtop10 mrig05 prioritario padrao"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide();"
                                 update=":FormularioContrato"
                                 process=":FormularioContrato"/>

                <p:commandButton value="Adicionar Todos"
                                 icon="ui-icon-check"
                                 styleClass="prioritario mtop10"
                                 title="Clique para adicionar todos Contrato."
                                 update=":Formulario: :FormularioContrato"
                                 process=":FormularioContrato"
                                 onstart="aguarde.show()"
                                 oncomplete="dialogContrato.hide();aguarde.hide();"
                                 actionListener="#{calamidadePublicaControlador.adicionarContratoFiltro()}"/>

                <p:dataTable value="#{calamidadePublicaControlador.contratos}"
                             var="contrato"
                             styleClass="mtop02"
                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                             paginator="true"
                             rows="10"
                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>CONTRATOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                             emptyMessage="Não foram localizados registros para serem apresentados."
                             rowIndexVar="rowlx">
                    <p:column headerText="Remover" style="text-align: center; width: 5%">
                        <p:commandButton icon="ui-icon-trash"
                                         styleClass="botao-transparente"
                                         title="Clique para remover este Contrato."
                                         update=":Formulario: :FormularioContrato"
                                         process=":FormularioContrato"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide();"
                                         actionListener="#{calamidadePublicaControlador.removerContratoFiltro(contrato)}"/>
                    </p:column>
                    <p:column headerText="Número"
                              styleClass="alinhamentoDireita"
                              filterBy="#{contrato.numeroContrato}"
                              filterMatchMode="contains">
                        <h:outputText value="#{contrato.numeroContrato}"/>
                    </p:column>
                    <p:column headerText="Número do Termo"
                              filterBy="#{contrato.numeroTermo}"
                              filterMatchMode="contains"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{contrato.numeroTermo}"/>
                    </p:column>
                    <p:column headerText="Objeto"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText
                            value="#{contrato.objeto}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:dialog>


        <p:dialog widgetVar="dialogAtoLegal"
                  modal="true"
                  resizable="false"
                  onShow="redimensionarLadosDialog(this.id);redimensionarAlturaDialog(this.id)"
                  width="1000"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;">
            <h:form id="FormularioAtoLegal">

                <co:titulo-panel titulo="Filtros"/>
                <h:panelGrid columns="2" styleClass="mtop10">
                    <h:outputText value="Filtro: "/>
                    <p:inputText value="#{calamidadePublicaControlador.filtroAtoLegal}"
                                 id="inputAtoLegal"
                                 title="Informe o número do Ato Legal para pesquisar."
                                 size="70">
                        <p:watermark value="Pesquisa por número do Ato Legal."
                                     for="inputAtoLegal"/>
                    </p:inputText>
                </h:panelGrid>

                <p:commandButton value="Pesquisar"
                                 id="btnPesquisaAtoLegal"
                                 title="Clique para Pesquisar os Contratos."
                                 icon="ui-icon-search"
                                 actionListener="#{calamidadePublicaControlador.buscarAtosLegais()}"
                                 styleClass="mtop10 mrig05 prioritario padrao"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide();"
                                 update=":FormularioAtoLegal"
                                 process=":FormularioAtoLegal"/>

                <p:commandButton value="Adicionar Todos"
                                 icon="ui-icon-check"
                                 styleClass="prioritario mtop10"
                                 title="Clique para adicionar todos Atos Legais."
                                 update=":Formulario: :FormularioAtoLegal"
                                 process=":FormularioAtoLegal"
                                 onstart="aguarde.show()"
                                 oncomplete="dialogAtoLegal.hide();aguarde.hide();"
                                 actionListener="#{calamidadePublicaControlador.adicionarAtoLegalFiltro()}"/>

                <p:dataTable value="#{calamidadePublicaControlador.atosLegais}"
                             var="atoLegal"
                             styleClass="mtop02"
                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                             paginator="true"
                             rows="10"
                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>ATOS LEGAIS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                             emptyMessage="Não foram localizados registros para serem apresentados."
                             rowIndexVar="rowlx">
                    <p:column headerText="Remover" style="text-align: center; width: 5%">
                        <p:commandButton icon="ui-icon-trash"
                                         styleClass="botao-transparente"
                                         title="Clique para remover este Ato Legal."
                                         update=":Formulario: :FormularioAtoLegal"
                                         process=":FormularioAtoLegal"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide();"
                                         actionListener="#{calamidadePublicaControlador.removerAtoLegalFiltro(atoLegal)}"/>
                    </p:column>
                    <p:column headerText="Número"
                              styleClass="alinhamentoDireita"
                              filterBy="#{atoLegal.numero}"
                              filterMatchMode="contains">
                        <h:outputText value="#{atoLegal.numero}"/>
                    </p:column>
                    <p:column headerText="Tipo"
                              filterBy="#{atoLegal.tipoAtoLegal.descricao}"
                              filterMatchMode="contains"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{atoLegal.tipoAtoLegal.descricao}"/>
                    </p:column>
                    <p:column headerText="Propósito"
                              filterBy="#{atoLegal.propositoAtoLegal.descricao}"
                              filterMatchMode="contains"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{atoLegal.propositoAtoLegal.descricao}"/>
                    </p:column>
                    <p:column headerText="Nome"
                              filterBy="#{atoLegal.nome}"
                              filterMatchMode="contains"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{atoLegal.nome}"/>
                    </p:column>
                    <p:column headerText="Esfera"
                              filterBy="#{atoLegal.esferaGoverno.nome}"
                              filterMatchMode="contains"
                              styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{atoLegal.esferaGoverno.nome}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
</html>
