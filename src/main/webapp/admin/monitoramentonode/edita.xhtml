<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">


        <p:tabView dynamic="true" id="tabView">
            <p:tab title="Métricas">
                <h:form id="Formulario1">
                    <div class="row">
                        <div class="col-md-6">
                            <p:panel header="Memória">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h:panelGrid style="width: 100%" columns="2" styleClass="table-striped"
                                                     columnClasses="alinhamentoEsquerda, alinhamentoDireita">
                                            <h:outputLabel value="Memória Utilizada:"/>
                                            <h:outputLabel
                                                value="#{monitoramentoNodeServerControlador.metricaMemoria.usedMemory}"
                                                styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                            <h:outputLabel value="Memória Livre:"/>
                                            <h:outputLabel
                                                value="#{monitoramentoNodeServerControlador.metricaMemoria.freeMemory}"
                                                styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                            <h:outputLabel value="Memória Total Disponível:"/>
                                            <h:outputLabel
                                                value="#{monitoramentoNodeServerControlador.metricaMemoria.totalMemory}"
                                                styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                            <h:outputLabel value="Memória Máxima Disponível:"/>
                                            <h:outputLabel
                                                value="#{monitoramentoNodeServerControlador.metricaMemoria.maxMemory}"
                                                styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                        </h:panelGrid>
                                        <div class="progress progress-success progress-striped active mtop20"
                                             id="barraMemoria">
                                            <div class="bar"
                                                 style="width: #{monitoramentoNodeServerControlador.percentualMemoria}%;">
                                                <h:outputText
                                                    value="#{monitoramentoNodeServerControlador.percentualMemoria}"
                                                    styleClass="negrito">
                                                    <f:convertNumber pattern="###,##0.00"/>
                                                </h:outputText>%

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </p:panel>
                        </div>
                        <div class="col-md-6">
                            <p:panel header="Threads">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h:panelGrid style="width: 100%" columns="2" styleClass="table-striped"
                                                     columnClasses="alinhamentoEsquerda, alinhamentoDireita">
                                            <h:outputLabel value="Total Threads:"/>
                                            <h:outputLabel value="#{monitoramentoNodeServerControlador.totalThreads}"
                                                           styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                            <h:outputLabel value="Threads Rodando:"/>
                                            <h:outputLabel value="#{monitoramentoNodeServerControlador.runningThreads}"
                                                           styleClass="negrito">
                                                <f:convertNumber type="number"/>
                                            </h:outputLabel>
                                        </h:panelGrid>


                                        <div class="progress progress-striped active mtop20" id="barraThreads">
                                            <div class="bar"
                                                 style="width: #{monitoramentoNodeServerControlador.percentualThreads}%;">
                                                <h:outputText
                                                    value="#{monitoramentoNodeServerControlador.percentualThreads}"
                                                    styleClass="negrito">
                                                    <f:convertNumber pattern="###,##0.00"/>
                                                </h:outputText>%

                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </p:panel>
                        </div>
                    </div>
                    <div class="row mtop20">
                        <div class="col-md-6">
                            <p:panel header="Garbage">
                                <div class="row">
                                    <div class="col-md-12">
                                        <table class="table table-striped">
                                            <ui:repeat value="#{monitoramentoNodeServerControlador.garbages}"
                                                       var="garbage">
                                                <tr>
                                                    <td>#{garbage.name} Count</td>
                                                    <td class="alinhamentoDireita">#{garbage.collectionCount}</td>
                                                </tr>
                                                <tr>
                                                    <td>#{garbage.name} Time</td>
                                                    <td class="alinhamentoDireita">#{garbage.collectionTime}ms</td>
                                                </tr>
                                            </ui:repeat>
                                        </table>

                                    </div>
                                </div>
                            </p:panel>
                        </div>
                        <div class="col-md-6">
                            <p:panel header="Diagnósticos ">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h:panelGrid columns="2" styleClass="table-striped" style="width: 100%"
                                                     columnClasses="alinhamentoEsquerda, alinhamentoDireita">

                                            <h:outputLabel value="Latência de Rede Usuário - Servidor: "/>
                                            <h:outputLabel styleClass="negrito usuarioServidor"/>

                                            <h:outputLabel value="Performance da JVM: "/>
                                            <h:outputLabel styleClass="negrito"
                                                           value="#{diagnosticoControlador.executarDiagnosticoPerformanceJVM()}ms"/>

                                            <h:outputLabel value="Latência de Rede Servidor - Banco de Dados: "/>
                                            <h:outputLabel styleClass="negrito"
                                                           value="#{diagnosticoControlador.executarDiagnosticoLatenciaServidorBanco()}ms"/>

                                            <h:outputLabel value="Performance do Banco de Dados: "/>
                                            <h:outputLabel styleClass="negrito"
                                                           value="#{diagnosticoControlador.executarDiagnosticoPerformanceBanco()}ms"/>
                                        </h:panelGrid>

                                    </div>
                                </div>
                            </p:panel>
                        </div>
                    </div>
                    <div class="row mtop20">
                        <div class="col-md-12">
                            <p:panel header="JBoss">
                                <table class="table table-striped">
                                    <tr>
                                        <td>
                                            ActiveCount
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.activeCount}
                                        </td>
                                        <td>
                                            AvailableCount
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.availableCount}
                                        </td>
                                        <td>
                                            AverageBlockingTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.averageBlockingTime}
                                        </td>
                                        <td>
                                            AverageCreationTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.averageCreationTime}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            CreatedCount
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.createdCount}
                                        </td>
                                        <td>
                                            DestroyedCount
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.destroyedCount}
                                        </td>
                                        <td>
                                            MaxCreationTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.maxCreationTime}
                                        </td>
                                        <td>
                                            MaxUsedCount
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.maxUsedCount}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            MaxWaitTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.maxWaitTime}
                                        </td>
                                        <td>
                                            TimedOut
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.timedOut}
                                        </td>
                                        <td>
                                            TotalBlockingTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.totalBlockingTime}
                                        </td>
                                        <td>
                                            TotalCreationTime
                                        </td>
                                        <td>
                                            #{monitoramentoNodeServerControlador.jbossConnections.totalCreationTime}
                                        </td>
                                    </tr>
                                </table>
                            </p:panel>
                        </div>
                    </div>
                    <div class="row mtop20">
                        <div class="col-md-12">
                            <p:panel header="SQL em atividade">
                                <table class="table table-striped">
                                    <tr>
                                        <th>USERNAME</th>
                                        <th>SID</th>
                                        <th>SERIAL#</th>
                                        <th>MACHINE</th>
                                        <th>STMT</th>
                                        <th>RUNT</th>
                                    </tr>
                                    <ui:repeat value="#{monitoramentoNodeServerControlador.sqlsEmExecucao}"
                                               var="sql">
                                        <th>#{sql['USERNAME']}</th>
                                        <th>#{sql['SID']}</th>
                                        <th>#{sql['SERIAL']}</th>
                                        <th>#{sql['MACHINE']}</th>
                                        <th>#{sql['STMT']}</th>
                                        <th>#{sql['RUNT']}</th>
                                    </ui:repeat>

                                </table>
                            </p:panel>
                        </div>
                    </div>
                    <div class="row mtop20">
                        <div class="col-md-12">
                            <p:panel header="Configurações">
                                <h:panelGrid columns="2">
                                    <p:outputLabel for="ligado" value="Monitoramento Ativo:"/>
                                    <p:selectBooleanCheckbox id="ligado"
                                                             value="#{monitoramentoNodeServerControlador.configuracaoMetrica.ligado}"/>
                                    <p:outputLabel for="cron" value="Cron:"/>
                                    <p:inputText id="cron"
                                                 value="#{monitoramentoNodeServerControlador.configuracaoMetrica.cron}"/>
                                    <p:outputLabel for="user" value="Jboss User:"/>
                                    <p:inputText id="user"
                                                 value="#{monitoramentoNodeServerControlador.configuracaoMetrica.usuarioJboss}"/>
                                    <p:outputLabel for="password" value="Jboss Password:"/>
                                    <p:password id="password"
                                                value="#{monitoramentoNodeServerControlador.configuracaoMetrica.senhaJboss}"/>
                                    <p:outputLabel for="timeout" value="Verificar Timeout:"/>
                                    <p:selectBooleanCheckbox id="timeout"
                                                             value="#{monitoramentoNodeServerControlador.configuracaoMetrica.verificarTimeout}"/>
                                    <p:commandButton value="Salvar"
                                                     styleClass="prioritario"
                                                     icon="ui-icon-refresh"
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{monitoramentoNodeServerControlador.salvarConfiguracao}"
                                                     update="@form"/>

                                    <h:outputText
                                        value="Alterado por: #{monitoramentoNodeServerControlador.configuracaoMetrica.ultimoUsuario}"/>

                                </h:panelGrid>
                                <h:panelGrid columns="2">
                                    <p:commandButton value="Perform Gargabe Collector"
                                                     icon="ui-icon-alert"
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{monitoramentoNodeServerControlador.processarGarbageCollectorManual}"
                                                     update="@form"/>

                                    <p:commandButton
                                        value="${monitoramentoNodeServerControlador.garbageCollectorStatus eq true ? 'Desativar' : 'Ativar'} Gargabe Collector"
                                        icon="ui-icon-refresh"
                                        onclick="aguarde.show()"
                                        oncomplete="aguarde.hide()"
                                        actionListener="#{monitoramentoNodeServerControlador.alterarStatusGarbageCollector(!monitoramentoNodeServerControlador.garbageCollectorStatus)}"
                                        update="@form"/>
                                </h:panelGrid>
                            </p:panel>
                        </div>
                    </div>

                </h:form>
            </p:tab>
            <p:tab title="Usuários">
                <h:form id="Formulario2">
                    <p:panel header="Usuários Conectados: #{monitoramentoNodeServerControlador.totalUsuariosAtivos}">
                        <p:dataTable value="#{monitoramentoNodeServerControlador.lista}"
                                     var="usuarioNode"
                                     paginator="true" rows="25"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     rowIndexVar="idx">
                            <p:column headerText="#" style="width: 2%;
                                                    text-align: right;">
                                <h:outputText value="#{idx + 1}"/>
                            </p:column>
                            <p:column headerText="Data/hora do Login" style="width: 10%; text-align: center">
                                <h:outputText value="#{usuarioNode.dataHoraLogin}">
                                    <f:convertDateTime pattern="dd/MM/yyyy 'às' HH:mm"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Node Server" style="text-align: center">
                                <h:outputText value="#{usuarioNode.nodeServer}"/>
                            </p:column>
                            <p:column headerText="Login" style="text-align: center">
                                <h:outputText value="#{usuarioNode.usuario.login}"/>
                            </p:column>
                            <p:column headerText="Nome do Usuário">
                                <h:outputText value="#{usuarioNode.usuario.pessoaFisica.nome}"/>
                            </p:column>
                            <p:column headerText="Último Acesso">
                                <h:outputText value="#{usuarioNode.ultimaPagina}"/>
                            </p:column>
                            <p:column headerText="Ativo" styleClass="centralizado">
                                <h:outputText value="#{usuarioNode.ativo ? 'Sim' : 'Não'}"/>
                            </p:column>
                            <p:column headerText="Deslogar" styleClass="centralizado">
                                <p:commandButton icon="ui-icon-close"
                                                 actionListener="#{monitoramentoNodeServerControlador.deslogar(usuarioNode)}"
                                                 rendered="#{usuarioNode.ativo}" update="@form"/>
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                </h:form>
            </p:tab>
            <p:tab title="Processos">
                <h:form>
                    <p:remoteCommand name="atualizarTela" update="@form"/>

                    <div class="row">
                        <div class="col-md-12 mtop20">
                    <span class="azulnegrito" style="font-size: 20px;font-style: italic ">
                         Processos em Segundo Plano
                    </span>
                        </div>
                        <div class="col-md-12 mtop20">
                            <p:outputPanel
                                rendered="#{monitoramentoNodeServerControlador.singletonAgendamentoTarefas.processos.size() == 0}">
                                <div class="alert alert-info centralizado">
                                    Nenhum processo sendo executado em segundo plano
                                </div>
                            </p:outputPanel>
                            <p:outputPanel
                                rendered="#{monitoramentoNodeServerControlador.singletonAgendamentoTarefas.processos.size() > 0}">
                                <table class="table">
                                    <tr>
                                        <th>Processo</th>
                                        <th>Usuário</th>
                                        <th class="centralizado">Andamento</th>
                                    </tr>
                                    <ui:repeat
                                        value="#{monitoramentoNodeServerControlador.singletonAgendamentoTarefas.processos}"
                                        var="processo">
                                        <tr>
                                            <td>
                                                #{processo.descricaoProcesso}
                                            </td>
                                            <td>
                                                #{processo.usuarioSistema ne null ? processo.usuarioSistema : 'Webpublico'}
                                            </td>
                                            <td class="centralizado" style="width: 40%">
                                                <div style="display: #{processo.total le 1 ? 'block' : 'none'}">
                                                    <h:graphicImage
                                                        value="/img/ajaxloading.gif"
                                                        styleClass="mtop05"/>
                                                </div>
                                                <div style="display: #{processo.total gt 1 ? 'block' : 'none'}">
                                                    <div class="progress progress-striped active"
                                                         id="barraProgresso">
                                                        <div class="bar"
                                                             style="width: #{processo.porcentagemDoCalculo}%;"></div>
                                                    </div>
                                                    #{processo.porcentagemDoCalculo}%
                                                </div>
                                            </td>
                                        </tr>
                                    </ui:repeat>
                                </table>
                            </p:outputPanel>
                        </div>
                    </div>
                </h:form>
            </p:tab>
            <p:tab title="Dashboard Relatórios">
                <h:form id="formRelatorios">
                    <h:panelGrid columns="3">
                        <h:outputLabel value="Data:"/>
                        <fc:calendar value="#{monitoramentoNodeServerControlador.dataOperacao}"/>

                        <p:commandButton value="Atualizar"
                                         process="@form"
                                         update="@form"
                                         icon="ui-icon-refresh"
                                         styleClass="operacao mbot10 mtop10"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{monitoramentoNodeServerControlador.atualizarDashboarRelatorios()}"/>
                    </h:panelGrid>

                    <div class="row">
                        <div class="col-md-3">
                            <p:panel header="Quantidade de Usuários">
                                <div class="centralizado">
                                    <h2>#{monitoramentoNodeServerControlador.dashboarWebReportDTO.quantidadeUsuarios}</h2>
                                </div>
                            </p:panel>
                        </div>
                        <div class="col-md-3">
                            <p:panel header="Relatórios Utilizados">
                                <div class="centralizado">
                                    <h2>#{monitoramentoNodeServerControlador.dashboarWebReportDTO.quantidadeRelatorios}</h2>
                                </div>
                            </p:panel>
                        </div>
                        <div class="col-md-3">
                            <p:panel header="Tempo Médio">
                                <div class="centralizado">
                                    <h2>#{monitoramentoNodeServerControlador.dashboarWebReportDTO.tempoMedioAsString}</h2>
                                </div>
                            </p:panel>
                        </div>
                        <div class="col-md-3">
                            <p:panel header="Maior Tempo">
                                <div class="centralizado">
                                    <h2>#{monitoramentoNodeServerControlador.dashboarWebReportDTO.tempoMaiorAsString}</h2>
                                </div>
                            </p:panel>
                        </div>
                    </div>

                    <p:panel header="Acompanhamento dos Relatórios" styleClass="mtop10">
                        <h:panelGrid columns="2">
                            <h:outputLabel value="Usuário:"/>
                            <p:inputText value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.usuario}"/>
                            <h:outputLabel value="Nome do Relatório:"/>
                            <p:inputText value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.nomeRelatorio}"/>
                            <h:outputLabel value="Status:"/>
                            <p:selectOneMenu value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.status}">
                                <f:selectItem itemValue="" itemLabel=""/>
                                <f:selectItem itemValue="GERANDO" itemLabel="GERANDO"/>
                                <f:selectItem itemValue="CANCELADO" itemLabel="CANCELADO"/>
                                <f:selectItem itemValue="FALHADO" itemLabel="FALHADO"/>
                                <f:selectItem itemValue="GERADO" itemLabel="GERADO"/>
                            </p:selectOneMenu>
                        </h:panelGrid>
                        <p:commandButton value="Pesquisar"
                                         styleClass="operacao prioritario mtop02 mbot05 mrig03"
                                         icon="ui-icon-search"
                                         process="@form" update="@form"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{monitoramentoNodeServerControlador.buscarRelatorios()}"/>
                        <p:commandButton value="Limpar Campos"
                                         styleClass="operacao mtop02 mbot05 mrig03"
                                         icon="ui-icon-clear"
                                         process="@form" update="@form"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{monitoramentoNodeServerControlador.limparCamposRelatorios()}"/>

                        <p:dataTable
                            value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.relatorios}"
                            var="relatorio"
                            emptyMessage="Nenhum registro encontrado.">
                            <f:facet name="header">
                                <div style="display: flex; justify-content: space-between; align-items: center; ">
                                    <div style="text-align: left;">
                                        <p:commandButton id="botaoQtd10"
                                                         update="@form"
                                                         value="10"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.quantidade eq 10}"
                                                         actionListener="#{monitoramentoNodeServerControlador.alterarQuantidade(10)}"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton id="botaoQtd20"
                                                         update="@form"
                                                         value="20"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.quantidade eq 20}"
                                                         actionListener="#{monitoramentoNodeServerControlador.alterarQuantidade(20)}"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton id="botaoQtd50"
                                                         update="@form"
                                                         value="50"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.quantidade eq 50}"
                                                         actionListener="#{monitoramentoNodeServerControlador.alterarQuantidade(50)}"/>
                                    </div>
                                    <div style="text-align: left;">
                                        <p:commandButton id="botaoPrimeira" icon="ui-icon-seek-first"
                                                         update="@form"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.pagina eq 1}"
                                                         actionListener="#{monitoramentoNodeServerControlador.primeiraPaginaRelatorios()}"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton id="botaoAnterior" icon="ui-icon-seek-prev"
                                                         update="@form"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.pagina eq 1}"
                                                         actionListener="#{monitoramentoNodeServerControlador.paginaAnteriorRelatorios()}"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton id="botaoProximo" icon="ui-icon-seek-next"
                                                         update="@form"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.totalPaginas eq 0 or monitoramentoNodeServerControlador.dashboarWebReportDTO.pagina eq monitoramentoNodeServerControlador.dashboarWebReportDTO.totalPaginas}"
                                                         actionListener="#{monitoramentoNodeServerControlador.proximaPaginaRelatorios()}"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton id="botaoUltima" icon="ui-icon-seek-end"
                                                         update="@form"
                                                         onclick="aguarde.show()"
                                                         oncomplete="aguarde.hide()"
                                                         disabled="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.totalPaginas eq 0 or monitoramentoNodeServerControlador.dashboarWebReportDTO.pagina eq monitoramentoNodeServerControlador.dashboarWebReportDTO.totalPaginas}"
                                                         actionListener="#{monitoramentoNodeServerControlador.ultimaPaginaRelatorios()}"/>
                                    </div>
                                    <div>
                                        <h:outputText
                                            value="Página (#{monitoramentoNodeServerControlador.dashboarWebReportDTO.pagina} de #{monitoramentoNodeServerControlador.dashboarWebReportDTO.totalPaginas})"/>
                                    </div>
                                </div>
                            </f:facet>
                            <p:column headerText="Expandir" style="width: 8%" styleClass="alinhamentoCentralizado">
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="Nome" styleClass="alinhamentoEsquerda">
                                #{relatorio.nome}
                            </p:column>
                            <p:column headerText="Usuário" styleClass="alinhamentoEsquerda">
                                #{relatorio.usuario}
                            </p:column>
                            <p:column headerText="Início" styleClass="centralizado">
                                #{utilBean.getMillisecondsAsString(relatorio.inicio)}
                            </p:column>
                            <p:column headerText="Fim" styleClass="centralizado">
                                #{utilBean.getMillisecondsAsString(relatorio.fim)}
                            </p:column>
                            <p:column headerText="Porcentagem" styleClass="centralizado">
                                #{relatorio.porcentagem}%
                            </p:column>
                            <p:column headerText="Tempo" styleClass="centralizado">
                                #{utilBean.getTempoAsString(relatorio.timeInSeconds)}
                            </p:column>
                            <p:column headerText="Status">
                                #{relatorio.status}
                            </p:column>
                            <p:column headerText="Ações" styleClass="centralizado">
                                <p:commandButton icon="ui-icon-cancel"
                                                 title="Clique aqui para cancelar a geração do relatório."
                                                 onclick="if (confirm('Tem certeza que deseja cancelar a geração do relatório?')){aguarde.show()}else{return false}"
                                                 disabled="#{relatorio.status ne 'GERANDO'}"
                                                 actionListener="#{monitoramentoNodeServerControlador.cancelarGeracaoRelatorio(relatorio, true)}"
                                                 oncomplete="aguarde.hide()"/>

                                <p:commandButton ajax="false"
                                                 icon="ui-icon-circle-arrow-s"
                                                 disabled="#{relatorio.status ne 'GERADO'}"
                                                 title="Clique para fazer o download do relatório gerado.">
                                    <p:fileDownload
                                        value="#{monitoramentoNodeServerControlador.baixarRelatorio(relatorio)}"/>
                                </p:commandButton>
                            </p:column>
                            <p:rowExpansion>
                                <dl>
                                    <dt class="p-sm negrito">UUID</dt>
                                    <dd>- #{relatorio.uuid}</dd>
                                    <dt class="p-sm negrito">Thread ID</dt>
                                    <dd>- #{relatorio.threadId}</dd>
                                    <dt class="p-sm negrito">Container Name</dt>
                                    <dd>- #{relatorio.containerName}</dd>
                                    <dt class="p-sm negrito">Observação</dt>
                                    <dd>- #{relatorio.observacao}</dd>
                                </dl>
                            </p:rowExpansion>
                        </p:dataTable>
                    </p:panel>

                    <div class="row">
                        <div class="col-md-6">
                            <p:panel header="Usuários" styleClass="mtop10">
                                <p:dataTable
                                    value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.relatoriosPorUsuario}"
                                    var="usuario"
                                    paginator="true"
                                    paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>USUÁRIOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                    currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                    emptyMessage="Nenhum registro encontrado.">
                                    <p:column headerText="Usuário" styleClass="alinhamentoEsquerda">
                                        #{usuario.usuario}
                                    </p:column>
                                    <p:column headerText="Quantidade" styleClass="alinhamentoDireita">
                                        #{usuario.quantidade}
                                    </p:column>
                                </p:dataTable>
                            </p:panel>
                        </div>
                        <div class="col-md-6">
                            <p:panel header="Relatórios" styleClass="mtop10">
                                <p:dataTable
                                    value="#{monitoramentoNodeServerControlador.dashboarWebReportDTO.relatoriosPorRelatorio}"
                                    var="rel"
                                    paginator="true"
                                    paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>RELATÓRIOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                    currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                    emptyMessage="Nenhum registro encontrado.">
                                    <p:column headerText="Nome" styleClass="alinhamentoEsquerda">
                                        #{rel.nome}
                                    </p:column>
                                    <p:column headerText="Quantidade" styleClass="alinhamentoDireita">
                                        #{rel.quantidade}
                                    </p:column>
                                </p:dataTable>
                            </p:panel>
                        </div>
                    </div>

                    <p:panel header="Acompanhamento Diário dos Relatórios" styleClass="mtop10">
                        <p:barChart
                            value="#{monitoramentoNodeServerControlador.graficoAcompanhamentoRelatorioDiario}"
                            rendered="#{monitoramentoNodeServerControlador.graficoAcompanhamentoRelatorioDiario ne null}"
                            legendPosition="nw"
                            title="Gráfico de Acompanhamento Diário dos Relatórios"
                            animate="true"/>
                    </p:panel>
                </h:form>
            </p:tab>
        </p:tabView>


        <script type="text/javascript">
            var timer;

            function iniciaAcompanhamento() {
                timer = setInterval(function () {
                    atualizarTela();
                }, 3000);
            }

            function terminaAcompanhamento() {
                clearInterval(timer);
            }

            $(document).ready(function () {
                iniciaAcompanhamento();
            });

        </script>

    </ui:define>
</ui:composition>
</html>
