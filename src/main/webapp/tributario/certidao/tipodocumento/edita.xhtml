<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
    >
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <script language="javascript" type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/resources/js/tinymce/tinymce.min.js"></script>
        <script type="text/javascript">
            tinymce.init({
                selector: '#mytextarea',
                plugins: 'code print preview importcss fullpage searchreplace autolink directionality visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern help',
                height: 600,
                content_css: "#{facesContext.externalContext.requestContextPath}/resources/css/edit_area.css",
                importcss_append: true,
                automatic_uploads: true,
                file_picker_types: 'image',
                file_picker_callback: function (cb, value, meta) {
                    var input = document.createElement('input');
                    input.setAttribute('type', 'file');
                    input.setAttribute('accept', 'image/*');
                    input.onchange = function () {
                        var file = this.files[0];

                        var reader = new FileReader();
                        reader.onload = function () {
                            var id = 'blobid' + (new Date()).getTime();
                            var blobCache = tinymce.activeEditor.editorUpload.blobCache;
                            var base64 = reader.result.split(',')[1];
                            var blobInfo = blobCache.create(id, file, base64);
                            blobCache.add(blobInfo);

                            cb(blobInfo.blobUri(), {title: file.name});
                        };
                        reader.readAsDataURL(file);
                    };

                    input.click();
                }
            });
        </script>

        <script type="text/javascript">
            function insertAtCursor(valor) {
                try {
                    tinyMCE.execCommand('mceInsertContent', false, valor);
                    tinyMCE.focus();
                } catch (err) {
                }
            }

            function transferirConteudo() {
                var conteudo = tinyMCE.get('mytextarea').getContent();
                document.getElementById('Formulario:tabView:inputEscondido').value = conteudo;
            }
        </script>

        <p:dialog modal="true" widgetVar="dialogExcluirAtributo" header="Excluindo...."
                  draggable="false" closable="false" resizable="true">
            <p:graphicImage value="/img/ajaxloadingbar.gif"/>
        </p:dialog>
        <p:dialog modal="true" widgetVar="dialogAdicionarAtributo" header="Adicionando...."
                  draggable="false" closable="false" resizable="true">
            <p:graphicImage value="/img/ajaxloadingbar.gif"/>
        </p:dialog>
        <h:form id="Formulario">
            <p:messages showDetail="true"/>
            <p:panel id="painelPrincipal" header="Cadastro de Tipo de Documento Oficial">
                <h:panelGrid columns="2" id="panelTipoDocumento">
                    <fc:outputLabelObrigatorio value="Código: "/>
                    <p:inputText title="Digite o Código"
                                 value="#{tipoDoctoOficialControlador.selecionado.codigo}"
                                 id="codigo" maxlength="20" size="20"/>

                    <fc:outputLabelObrigatorio value="Descrição: "/>
                    <p:inputText title="Digite a Descrição"
                                 value="#{tipoDoctoOficialControlador.selecionado.descricao}"
                                 id="descricao" maxlength="100" size="70"/>

                    <fc:outputLabelObrigatorio value="Tipo de Sequência: "/>
                    <h:selectOneMenu title="Selecione o Tipo de Sequência"
                                     value="#{tipoDoctoOficialControlador.selecionado.tipoSequencia}"
                                     id="tipoSequencia"
                                     disabled="#{tipoDoctoOficialControlador.selecionado.id ne null}">
                        <f:selectItems value="#{tipoDoctoOficialControlador.tiposSequencia}"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Tipo de Validação: "/>
                    <h:selectOneMenu title="Selecione o Tipo de Validação"
                                     value="#{tipoDoctoOficialControlador.selecionado.tipoValidacaoDoctoOficial}"
                                     id="tipoValidacao">
                        <f:selectItems value="#{tipoDoctoOficialControlador.tiposValidacoes}"/>
                        <p:ajax listener="#{tipoDoctoOficialControlador.recuperaTags()}" event="change"
                                update=":Formulario:tabView:tabelaTags"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Tipo de Cadastro: "/>
                    <h:selectOneMenu title="Selecione o Tipo de Cadastro"
                                     value="#{tipoDoctoOficialControlador.selecionado.tipoCadastroDoctoOficial}"
                                     id="tipoCadastro"
                                     disabled="#{tipoDoctoOficialControlador.selecionado.id ne null}">
                        <f:selectItems value="#{tipoDoctoOficialControlador.tiposCadastro}"/>
                        <p:ajax listener="#{tipoDoctoOficialControlador.recuperaTags()}" event="change"
                                update=":Formulario:tabView:tabelaTags"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Tipo do Documento: "/>
                    <h:selectOneMenu title="Selecione o Tipo do Documento"
                                     value="#{tipoDoctoOficialControlador.selecionado.moduloTipoDoctoOficial}"
                                     id="modulo"
                                     disabled="#{tipoDoctoOficialControlador.selecionado.id ne null}">
                        <f:selectItems value="#{tipoDoctoOficialControlador.modulosTiposDoctoOficial}"/>
                        <p:ajax listener="#{tipoDoctoOficialControlador.recuperaTags()}" event="change"
                                update=":Formulario:tabView:tabelaTags"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Grupo: "/>
                    <p:autoComplete queryDelay="1000" title="Selecione o Grupo de Documento Oficial"
                                    id="grupo" var="g" size="70" dropdown="true"
                                    completeMethod="#{tipoDoctoOficialControlador.completaGrupoDoctoOficial}"
                                    itemValue="#{g.id}" itemLabel="#{g.descricao}"
                                    value="#{tipoDoctoOficialControlador.selecionado.grupoDoctoOficial}"
                                    converter="#{tipoDoctoOficialControlador.converterGrupo}"
                                    disabled="#{tipoDoctoOficialControlador.selecionado.id ne null}"/>

                    <fc:outputLabelObrigatorio value="Validade em Dias do Documento Oficial: "/>
                    <p:inputText title="Digite a Validade do Documento"
                                 value="#{tipoDoctoOficialControlador.selecionado.validadeDocto}"
                                 id="validadeDocto" maxlength="6" size="10" onkeypress="mascara(this, soNumeros);"/>

                    <h:outputText value="Tributo para Emissão do DAM: "/>
                    <p:autoComplete queryDelay="1000"
                                    title="Selecione o Tributo referente à taxa de emissão do Documento Oficial"
                                    id="tributo" var="t" size="70" dropdown="true"
                                    completeMethod="#{tipoDoctoOficialControlador.completaTributo}"
                                    itemValue="#{t.id}" itemLabel="#{t.descricao}"
                                    value="#{tipoDoctoOficialControlador.selecionado.tributo}"
                                    converter="#{tipoDoctoOficialControlador.converterTributo}">
                        <p:ajax event="itemSelect" listener="#{tipoDoctoOficialControlador.recuperaTributo}"
                                update="panelValoresTributo"
                                process="@form"/>
                    </p:autoComplete>

                    <h:outputText id="controle" value="Controle de Envio e Recebimento ? "/>
                    <h:selectBooleanCheckbox id="controleenvio"
                                             value="#{tipoDoctoOficialControlador.selecionado.controleEnvioRecebimento}"/>

                    <h:outputText value="Impressão Direto em PDF ? "/>
                    <h:selectBooleanCheckbox id="imprimirDireto"
                                             value="#{tipoDoctoOficialControlador.selecionado.imprimirDiretoPDF}"/>
                    <h:outputText value="Permite Solicitação via Portal Web? "/>
                    <h:selectBooleanCheckbox id="solicitaWeb"
                                             value="#{tipoDoctoOficialControlador.selecionado.disponivelSolicitacaoWeb}"/>

                    <h:outputText value="Exigir Assinatura Digital ?"/>
                    <h:selectBooleanCheckbox value="#{tipoDoctoOficialControlador.selecionado.exigirAssinatura}">
                        <p:ajax event="change" update="idPermitirImpressao" process="@this"/>
                    </h:selectBooleanCheckbox>

                    <h:outputText value="Permitir impressão sem assinatura ?"/>
                    <h:selectBooleanCheckbox id="idPermitirImpressao" value="#{tipoDoctoOficialControlador.selecionado.permitirImpressaoSemAssinatura}"
                                             disabled="#{!tipoDoctoOficialControlador.selecionado.exigirAssinatura}"/>
                </h:panelGrid>

                <p:panel header="Valores do Tributo" id="panelValoresTributo" width="100%"
                         visible="#{tipoDoctoOficialControlador.selecionado.tributo ne null}">
                    <h:panelGrid columns="3">
                        <fc:outputLabelObrigatorio value="Valor (R$) do Tributo para Emissão do DAM: "/>
                        <p:inputText title="Digite o valor do Tributo referente à taxa de emissão do Documento Oficial"
                                     value="#{tipoDoctoOficialControlador.selecionado.valor}"
                                     id="valorDAM" maxlength="10" size="10">
                            <f:convertNumber pattern="##,##0.00"/>
                        </p:inputText>
                        <p:message for="valorDAM" showDetail="true"/>
                        <fc:outputLabelObrigatorio value="Validade em Dias do DAM: "/>
                        <p:inputText title="Digite a validade do DAM"
                                     value="#{tipoDoctoOficialControlador.selecionado.validadeDam}"
                                     id="validadeDAM" maxlength="6" size="10" onkeypress="mascara(this, soNumeros);"/>
                        <p:message for="validadeDAM" showDetail="true"/>
                    </h:panelGrid>
                </p:panel>
                <br/>
                <p:tabView id="tabView">

                    <p:tab title="Finalidades" id="tabFinalidade">
                        <p:panel header="Finalidades" id="panelFinalidades">
                            <h:panelGrid columns="3" id="gridFinalidades">
                                <h:outputText value="Finalidade: "/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{tipoDoctoOficialControlador.tipoDoctoFinalidade.finalidade}"
                                                completeMethod="#{tipoDoctoOficialControlador.completaFinalidade}"
                                                converter="#{tipoDoctoOficialControlador.converterFinalidade}"
                                                title="Informe a Finalidade"
                                                var="f" id="finalidade"
                                                itemValue="#{f.id}"
                                                dropdown="true"
                                                itemLabel="#{f.descricao}"
                                                forceSelection="true"
                                                size="70">
                                </p:autoComplete>
                                <fc:novoParente destino="#{finalidadeControlador.caminhoDestinoNovoCadastro}"
                                                selecionado="#{tipoDoctoOficialControlador.selecionado}"
                                                origem="#{tipoDoctoOficialControlador.caminhoOrigem}"/>
                            </h:panelGrid>

                            <p:commandButton id="cbAdicionarFin"
                                             value="Adicionar"
                                             styleClass="operacao mbot05"
                                             title="Clique para Selecionar a Finalidade"
                                             actionListener="#{tipoDoctoOficialControlador.addFinalidade()}"
                                             update=":Formulario:tabView:panelFinalidades"
                                             icon="ui-icon-circle-plus"/>

                            <p:dataTable id="finalidadesTipos" style="text-align: center;"
                                         emptyMessage="Nenhum registro encontrado"
                                         value="#{tipoDoctoOficialControlador.selecionado.tipoDoctoFinalidades}"
                                         var="fin">
                                <f:facet name="header">
                                    <h:outputText value="Finalidades Selecionadas"/>
                                </f:facet>
                                <p:column headerText="Código">
                                    <h:outputText value="#{fin.finalidade.codigo}"/>
                                </p:column>
                                <p:column headerText="Descrição">
                                    <h:outputText value="#{fin.finalidade.descricao}"/>
                                </p:column>
                                <p:column headerText="Operação">
                                    <p:commandButton id="cmbFinalidadeExcluir"
                                                     icon="ui-icon-trash"
                                                     title="Clique para Excluir"
                                                     update=":Formulario:tabView:finalidadesTipos"
                                                     actionListener="#{tipoDoctoOficialControlador.removeFinalidade(fin)}">
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Atributos" id="tabAtributos">
                        <p:panel header="Atributos" id="panelAtributos">
                            <h:panelGrid columns="3">
                                <h:outputText value="Campo: "/>
                                <p:inputText value="#{tipoDoctoOficialControlador.atributoDoctoOficial.campo}"
                                             id="campoAtributo" maxlength="60" size="60"/>
                                <h:selectOneMenu value="#{tipoDoctoOficialControlador.atributoDoctoOficial.obrigatorio}"
                                                 id="obrigatorio">
                                    <f:selectItem itemLabel="Não obrigatório" itemValue="#{false}"/>
                                    <f:selectItem itemLabel="Obrigatório" itemValue="#{true}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>
                            <p:commandButton value="Adicionar"
                                             id="cbAtributoAdicionar"
                                             styleClass="operacao mbot05"
                                             title="Clique para Adicionar o Atributo"
                                             actionListener="#{tipoDoctoOficialControlador.addAtributo()}"
                                             onstart="dialogAdicionarAtributo.show();"
                                             onsuccess="dialogAdicionarAtributo.hide();"
                                             update=":Formulario:tabView:panelAtributos :Formulario:tabView:tabelaTags"
                                             icon="ui-icon-circle-plus"/>

                            <p:dataTable id="tabelaAtributos" style="text-align: center;"
                                         emptyMessage="Nenhum registro encontrado"
                                         value="#{tipoDoctoOficialControlador.selecionado.listaAtributosDoctoOficial}"
                                         var="objeto">
                                <f:facet name="header">
                                    <h:outputText value="Atributos Adicionados"/>
                                </f:facet>
                                <p:column headerText="Campo">
                                    <h:outputText value="#{objeto.campo}"/>
                                </p:column>
                                <p:column headerText="Obrigatório">
                                    <h:outputText value="#{objeto.obrigatorio ? 'Sim' : 'Não'}"/>
                                </p:column>
                                <p:column headerText="Ativo">
                                    <p:selectBooleanCheckbox value="#{objeto.ativo}">
                                        <p:ajax event="change" update=":Formulario:tabView:tabelaTags"
                                                listener="#{tipoDoctoOficialControlador.atualizaListaTags(objeto)}"/>
                                    </p:selectBooleanCheckbox>
                                </p:column>
                                <p:column headerText="Operação">
                                    <p:commandButton rendered="#{!tipoDoctoOficialControlador.renderizaExcluir(objeto)}"
                                                     id="cbOperacaoExcluir"
                                                     icon="ui-icon-trash"
                                                     title="Clique para Excluir"
                                                     update=":Formulario:tabView:panelAtributos :Formulario:tabView:tabelaTags"
                                                     actionListener="#{tipoDoctoOficialControlador.removeAtributo(objeto)}"
                                                     onstart="dialogExcluirAtributo.show();"
                                                     onsuccess="dialogExcluirAtributo.hide();"/>
                                    <p:commandButton rendered="#{tipoDoctoOficialControlador.renderizaExcluir(objeto)}"
                                                     icon="ui-icon-check"
                                                     styleClass="icone_verde"
                                                     update=":Formulario:tabView:panelAtributos :Formulario:tabView:tabelaTags"
                                                     disabled="true"
                                                     title="Este atributo está sendo utilizado em uma solicitação."/>
                                </p:column>
                            </p:dataTable>

                        </p:panel>
                    </p:tab>

                    <p:tab title="Usuários Autorizados" id="tabUsuarios">
                        <p:panel header="Usuários Autorizados" id="panelUsuarios">
                            <h:panelGrid columns="2" id="gridUsuarios">
                                <h:outputText value="Usuário do Sistema: "/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{tipoDoctoOficialControlador.usuarioTipoDocto.usuarioSistema}"
                                                completeMethod="#{tipoDoctoOficialControlador.completaUsuarioSistema}"
                                                converter="#{tipoDoctoOficialControlador.converterUsuarioSistema}"
                                                title="Informe o Usuário"
                                                var="u" id="usuario"
                                                itemValue="#{u.id}"
                                                itemLabel="#{u.login}"
                                                forceSelection="true"
                                                size="70"
                                                dropdown="true">
                                </p:autoComplete>
                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             id="cbUsuarioSelecionar"
                                             title="Clique para Adicionar"
                                             actionListener="#{tipoDoctoOficialControlador.addUsuarioSistema}"
                                             update=":Formulario:tabView:panelUsuarios"
                                             styleClass="operacao mbot05"
                                             icon="ui-icon-circle-plus"/>

                            <p:dataTable id="usuariosTipos" style="text-align: center;"
                                         emptyMessage="Nenhum registro encontrado"
                                         value="#{tipoDoctoOficialControlador.selecionado.listaUsuarioTipoDocto}"
                                         paginator="true"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         var="usu">
                                <f:facet name="header">
                                    <h:outputText value="Usuários Autorizados Selecionados"/>
                                </f:facet>
                                <p:column headerText="Usuário" style="text-align: left">
                                    <h:outputText value="#{usu.usuarioSistema}"/>
                                </p:column>
                                <p:column headerText="Operação">
                                    <p:commandButton id="operacaoUsuariosTiposExcluir"
                                                     icon="ui-icon-trash"
                                                     title="Clique para Excluir"
                                                     update=":Formulario:tabView:usuariosTipos"
                                                     actionListener="#{tipoDoctoOficialControlador.removeUsuarioSistema(usu)}">
                                    </p:commandButton>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Layout do Tipo de Documento Oficial"
                           id="tabLayout">
                        <p:panel header="Layout do Tipo de Documento Oficial">

                            <h:panelGrid id="pgTipodDocOficial" columns="2" style="width: 100%">
                                <div>
                                    <h:inputHidden id="inputEscondido"
                                                   value="#{tipoDoctoOficialControlador.modeloDoctoOficial.conteudo}"/>

                                    <textarea id="mytextarea"
                                              name="modelo"
                                              style="width: 100%; height: 600px; position: top; padding: 0px">
                                        #{tipoDoctoOficialControlador.modeloDoctoOficial.conteudo}
                                    </textarea>
                                </div>
                                <p:panel header="Tags"
                                         style="position: top; width:100%;height:600px;top:0px"
                                         id="tags">
                                    <table id="tableTags"
                                           style="border: 1px solid #aaaaaa; width: 100%">
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center;" class="negrito">
                                                Pré Definido
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagCabecalho" value="CABEÇALHO"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaCabecalho()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o cabeçalho no documento"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbtagDatHoje" value="Data Hoje Ano"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeAno()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o ano da data de hoje"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagDataMes" value="Data Hoje Mês"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeMes()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o mês da data de hoje"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagDataHojeDiaExtenso"
                                                               value="Data Hoje Dia Extenso"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeDiaExtenso()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o mês da data de hoje por extenso"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagDataHojeMesExtenso" value="Data Hoje Mês Extenso"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeMesExtenso()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o mês da data de hoje por extenso"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagDataHojeAnoExtenso" value="Data Hoje Ano Extenso"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeAnoExtenso()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o mês da data de hoje por extenso"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagDataHojeDia" value="Data Hoje Dia"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaDtaHojeDia()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o dia da data de hoje"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagTexoFixo" value="Texto(s) Fixo(s)"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.recuperaTextoFixosDoTipoDeCadastro()}"
                                                               title="Clique para visualizar os textos Fixos"
                                                               oncomplete="textoFixoDialog.show()"
                                                               update=":textoFixoForm"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagQuebraPagina" value="Quebrar Página"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaQuebraPagina()}"
                                                               immediate="true"
                                                               title="Clique para adicionar uma quebra de página"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagIPMaquina" value="IP Máquina"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaIP()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o IP da máquina"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagUsuario" value="Usuário"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaUsuario()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o usuário"/>
                                            </td>
                                        </tr>
                                        <tr style="background: url('webpublico/css/images/ui-bg_glass_75_ebebeb_1x400.png') repeat-x scroll 50% 50% #EBEBEB;">
                                            <td style="text-align: center">
                                                <p:commandLink id="cbTagRodape" value="Rodapé"
                                                               style="text-decoration: none !important"
                                                               actionListener="#{tipoDoctoOficialControlador.adicionaRodape()}"
                                                               immediate="true"
                                                               title="Clique para adicionar o rodapé no documento"/>
                                            </td>
                                        </tr>
                                    </table>
                                    <br/>
                                    <p:dataTable
                                        var="tag"
                                        value="#{tipoDoctoOficialControlador.listaTags}"
                                        rows="12"
                                        emptyMessage="Nenhuma tag!"
                                        paginator="true"
                                        widgetVar="tabela"
                                        selectionMode="single"
                                        rowKey="#{tag.label}"
                                        paginatorTemplate="{PreviousPageLink} {NextPageLink}"
                                        id="tabelaTags">
                                        <p:column headerText="Tag"
                                                  sortBy="#{tag.label}"
                                                  filterBy="#{tag.label}"
                                                  filterMatchMode="contains"
                                                  style="padding: 0px!important; text-decoration: none!important">
                                            <p:commandLink id="clTagListas"
                                                           immediate="true"
                                                           value="#{tag.label}"
                                                           onclick="insertAtCursor('$' + '#{tag.value}' + ' ')"
                                                           style="text-decoration: none!important">

                                            </p:commandLink>
                                        </p:column>
                                    </p:dataTable>
                                </p:panel>
                            </h:panelGrid>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Assinaturas" id="tabAssinatura">
                        <p:panel header="Assinaturas" id="assinaturasUsuario">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="Usuário do Sistema: "/>
                                <p:autoComplete queryDelay="1000"
                                                value="#{tipoDoctoOficialControlador.assinatura.usuarioSistema}"
                                                completeMethod="#{tipoDoctoOficialControlador.completaUsuarioSistema}"
                                                converter="#{tipoDoctoOficialControlador.converterUsuarioSistema}"
                                                title="Informe o Usuário" var="usuario" id="usuarioAssinatura"
                                                itemValue="#{usuario.id}" itemLabel="#{usuario}"
                                                forceSelection="true" size="70" dropdown="true">
                                </p:autoComplete>
                                <p:separator style="margin-top: 0; margin-bottom: 7px"/>
                                <p:separator style="margin-top: 0; margin-bottom: 7px"/>
                                <h:outputText value="Vigência"/>
                                <h:panelGrid columns="4" cellpadding="0" cellspacing="0">
                                    <fc:outputLabelObrigatorio value="Inicial: "/>
                                    <p:calendar id="assinInicio" pattern="dd/MM/yyyy"
                                                onkeypress="mascara(this,mdata)" styleClass="mlef02"
                                                navigator="true" title="Informe a data inicial."
                                                size="10" maxlength="10" showOn="button"
                                                value="#{tipoDoctoOficialControlador.assinatura.inicioVigencia}"/>
                                    <h:outputText value="Final: " styleClass="mlef03"/>
                                    <p:calendar id="assinFim" pattern="dd/MM/yyyy"
                                                onkeypress="mascara(this,mdata)" styleClass="mlef02"
                                                navigator="true" title="Informe a data inicial."
                                                size="10" maxlength="10" showOn="button"
                                                value="#{tipoDoctoOficialControlador.assinatura.finalVigencia}"/>
                                </h:panelGrid>
                            </h:panelGrid>

                            <p:commandButton value="Adicionar"
                                             id="btnAddAssinatura"
                                             title="Clique para Adicionar"
                                             actionListener="#{tipoDoctoOficialControlador.adicionarAssinatura}"
                                             update=":Formulario:tabView:assinaturasUsuario"
                                             styleClass="operacao mbot05"
                                             icon="ui-icon-circle-plus"/>

                            <p:dataTable id="tabelaAssinaturas" style="text-align: center;"
                                         value="#{tipoDoctoOficialControlador.selecionado.assinaturas}"
                                         var="assinatura" styleClass="mtop05" paginator="true"
                                         rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         rows="10" rowIndexVar="rowlx"
                                         paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>ASSINATURAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                         emptyMessage="Não foram localizados registros para serem apresentados.">
                                <p:column headerText="Ações">
                                    <p:commandButton id="btnExcluirAssinatura"
                                                     icon="ui-icon-trash"
                                                     title="Clique para Excluir"
                                                     update=":Formulario:tabView:tabelaAssinaturas"
                                                     actionListener="#{tipoDoctoOficialControlador.removerAssinatura(assinatura)}">
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Usuário" style="text-align: left">
                                    <h:outputText value="#{assinatura.usuarioSistema.login}"/>
                                </p:column>
                                <p:column headerText="Início de Vigência">
                                    <h:outputText value="#{assinatura.inicioVigencia}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Final de Vigência">
                                    <h:outputText value="#{assinatura.finalVigencia}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>

                        </p:panel>
                    </p:tab>
                </p:tabView>
            </p:panel>
            <br/>

            <div align="left">
                <p:remoteCommand name="remoteComand" update=":Formulario:tabView:inputEscondido"
                                 process=":Formulario:tabView:inputEscondido"/>
                <p:commandButton ajax="false"
                                 id="salvar"
                                 value="Salvar"
                                 styleClass="operacao prioritario"
                                 style="height: 30px;"
                                 icon="ui-icon-disk"
                                 onclick="transferirConteudo();

                    remoteComand();"
                                 action="#{tipoDoctoOficialControlador.salvar}"/>
                <p:commandButton ajax="false"
                                 id="cancelar"
                                 value="Cancelar"
                                 styleClass="operacao"
                                 icon="ui-icon-cancel"
                                 action="#{tipoDoctoOficialControlador.cancelar}"/>
            </div>

        </h:form>
        <p:dialog widgetVar="textoFixoDialog" header="Texto(s) Fixo(s)" width="1000">
            <h:form id="textoFixoForm">
                <h:panelGrid columns="2">
                    <div class="ui-messages-info-icon"/>
                    <h:outputText value="Selecione um Texto Fixo para adicionar no documento." style="font-size: 10px;"
                                  styleClass="azulnegrito"/>
                </h:panelGrid>
                <br/>
                <br/>
                <br/>
                <p:dataTable value="#{tipoDoctoOficialControlador.textoFixos}" var="textoFixo"
                             emptyMessage="Nenhum texto fixo encontrado!" style="text-align: center">
                    <p:column headerText="Operação">
                        <p:commandLink value="Selecionar" onclick="insertAtCursor('#{textoFixo.tag}');"/>
                    </p:column>
                    <p:column headerText="Código" style="width: 10%" sortBy="#{textoFixo.codigo}"
                              filterBy="#{textoFixo.codigo}" filterStyleClass="largura-campo-filtro-numerico"
                              filterMatchMode="contains">
                        <h:outputText value="#{textoFixo.codigo}"/>
                    </p:column>
                    <p:column headerText="Descrição" sortBy="#{textoFixo.descricao}" filterBy="#{textoFixo.descricao}"
                              filterMatchMode="contains">
                        <h:outputText value="#{textoFixo.descricao}"/>
                    </p:column>
                    <p:column headerText="Tag" sortBy="#{textoFixo.tag}" filterBy="#{textoFixo.tag}"
                              filterMatchMode="contains">
                        <h:outputText value="#{textoFixo.tag}"/>
                    </p:column>
                    <p:column headerText="Tipo de Cadastro" sortBy="#{textoFixo.tipoCadastroTributario.descricao}"
                              filterBy="#{textoFixo.tipoCadastroTributario.descricao}" filterMatchMode="contains">
                        <h:outputText value="#{textoFixo.tipoCadastroTributario.descricao}"/>
                    </p:column>
                    <p:column headerText="Texto Fixo">
                        <p:commandButton value="Vizualizar"
                                         styleClass="icone_branco botao_azul"
                                         icon="ui-icon-document"
                                         oncomplete="textoDialog.show()"
                                         update=":textoForm"
                                         actionListener="#{tipoDoctoOficialControlador.selecionouTextoFixo(textoFixo)}"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="textoDialog"
                  header="Detalhes de #{tipoDoctoOficialControlador.textoFixoSelecionado.descricao}" width="1000">
            <h:form id="textoForm">
                <h:panelGrid columns="2">
                    <h:outputText value="Código:" styleClass="azulnegrito"/>
                    <h:outputText value="#{tipoDoctoOficialControlador.textoFixoSelecionado.codigo}"/>

                    <h:outputText value="Descrição:" styleClass="azulnegrito"/>
                    <h:outputText value="#{tipoDoctoOficialControlador.textoFixoSelecionado.descricao}"/>

                    <h:outputText value="Tag:" styleClass="azulnegrito"/>
                    <h:outputText value="#{tipoDoctoOficialControlador.textoFixoSelecionado.tag}"/>

                    <h:outputText value="Tipo de Cadastro:" styleClass="azulnegrito"/>
                    <h:outputText
                        value="#{tipoDoctoOficialControlador.textoFixoSelecionado.tipoCadastroTributario.descricao}"/>

                    <h:outputText value="Texto:" styleClass="azulnegrito"/>
                    <h:outputText value="#{tipoDoctoOficialControlador.textoFixoSelecionado.textoFixo}" escape="false"/>
                </h:panelGrid>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
