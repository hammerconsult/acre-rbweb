<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">

        <script type="application/javascript">
            function openDialog(id) {
                $(id).modal({backdrop: 'static', keyboard: false});
                $(id).modal('show');
            }

            function closeDialog(id) {
                $(id).modal('hide');
            }
        </script>

        <h:form id="Formulario">
            <p:poll interval="1"
                    widgetVar="pollEfetivar"
                    update=":formEfetivar"
                    listener="#{processoParcelamentoControlador.acompanharProcesso()}"
                    autoStart="false"/>
            <p:remoteCommand name="rcFinalizarEfetivacao"
                             onstart="aguarde.show()" onsuccess="aguarde.hide()"
                             actionListener="#{processoParcelamentoControlador.finalizarProcesso()}"
                             oncomplete="aguarde.hide()"/>

            <fc:cabecalhoPretty controlador="#{processoParcelamentoControlador}"
                                origem="#{processoParcelamentoControlador.caminhoPadrao}listar/"/>
            <p:panel header="Processo de Parcelamento de Débitos">
                <p:outputPanel id="dadosParcelamento">
                    <h:panelGrid id="gridDadosParcelamento" columns="2" styleClass="verticalAlignTop">
                        <h:outputText value="Situação:"/>
                        <h:outputText
                            value="#{processoParcelamentoControlador.selecionado.situacaoParcelamento.descricao}"
                            styleClass="negrito"/>

                        <h:outputText value="Número:"/>
                        <h:outputText value="#{processoParcelamentoControlador.selecionado.numero}"
                                      styleClass="negrito"/>

                        <h:outputText value="Data:"/>
                        <h:outputText value="#{processoParcelamentoControlador.selecionado.dataProcessoParcelamento}"
                                      styleClass="negrito">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <fc:outputLabelObrigatorio value="Tipo de Cadastro:"/>
                        <h:selectOneMenu title="Selecione o tipo de cadastro."
                                         value="#{processoParcelamentoControlador.tipoCadastro}"
                                         disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                         id="tipocadastro">
                            <f:selectItems value="#{processoParcelamentoControlador.buscarTiposCadastro()}"/>
                            <p:ajax event="change" update="dadosParcelamento visualizar_debitos"
                                    process="dadosParcelamento"
                                    listener="#{processoParcelamentoControlador.limparCadastroPessoaSituacao()}"/>
                        </h:selectOneMenu>
                        <h:panelGrid columns="1" style="height: 30px; vertical-align: middle !important;"
                                     cellpadding="0" cellspacing="0">
                            <fc:outputLabelObrigatorio value="Cadastro:"/>
                        </h:panelGrid>
                        <h:panelGrid columns="2" cellpadding="0" cellspacing="0"
                                     style="height: 30px; vertical-align: middle !important;">
                            <p:inputText value="Selecione um Tipo de Cadastro" size="50" disabled="true"
                                         rendered="#{processoParcelamentoControlador.tipoCadastro eq null}"/>

                            <h:panelGroup rendered="#{processoParcelamentoControlador.tipoCadastro eq 'IMOBILIARIO'}">
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0"
                                             style="height: 30px; vertical-align: middle !important;">
                                    <h:selectOneMenu title="Selecione a Situação do Cadastro Imobiliário."
                                                     styleClass="mrig03 mtop03"
                                                     value="#{processoParcelamentoControlador.situacaoCadastroImobiliario}"
                                                     disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                     id="situacaocadastroimobiliario">
                                        <f:selectItems value="#{processoParcelamentoControlador.buscarSituacoes()}"/>
                                        <p:ajax event="change" update="dadosParcelamento" process="dadosParcelamento"
                                                listener="#{processoParcelamentoControlador.limparCadastroPessoa()}"/>
                                    </h:selectOneMenu>

                                    <p:autoComplete queryDelay="1000"
                                                    value="#{processoParcelamentoControlador.selecionado.cadastro}"
                                                    converter="#{componentePesquisaCadastroImobiliarioControlador.converterCadastroImobiliario}"
                                                    completeMethod="#{processoParcelamentoControlador.buscarCadastrosImobiliarios}"
                                                    var="ci"
                                                    size="70"
                                                    dropdown="true"
                                                    id="cadastroImobiliario"
                                                    itemLabel="#{ci}"
                                                    itemValue="#{ci.id}"
                                                    disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                    maxResults="10">
                                        <p:ajax event="itemSelect"
                                                process="dadosParcelamento"
                                                update="dadosParcelamento"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"
                                                listener="#{processoParcelamentoControlador.carregarCadastro()}"/>
                                    </p:autoComplete>
                                </h:panelGrid>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{processoParcelamentoControlador.tipoCadastro eq 'ECONOMICO'}">
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0"
                                             style="height: 30px; vertical-align: middle !important;">
                                    <h:selectOneMenu title="Selecione a Situação do Cadastro Econômico."
                                                     styleClass="mrig03 mtop03"
                                                     value="#{processoParcelamentoControlador.situacaoCadastroEconomico}"
                                                     disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                     id="situacaocadastroeconomico">
                                        <f:selectItems
                                            value="#{processoParcelamentoControlador.buscarSituacoesCadastroEconomico()}"/>
                                        <p:ajax event="change" update="dadosParcelamento" process="dadosParcelamento"
                                                listener="#{processoParcelamentoControlador.limparCadastroPessoa()}"/>
                                    </h:selectOneMenu>

                                    <fc:novoAutocompleteCadastroEconomico
                                        caminhoAtual="#{processoParcelamentoControlador.urlAtual}"
                                        mostraBotaoNovo="false"
                                        mostraBotaoEdita="false"
                                        value="#{processoParcelamentoControlador.selecionado.cadastro}" id="cad"
                                        situacoesPossiveis="#{processoParcelamentoControlador.buscarSituacoesDisponiveis()}"
                                        mostraSituacoes="false"
                                        size="70"
                                        disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                        listenerItemSelect="#{processoParcelamentoControlador.carregarCadastro()}"
                                        permiteAlterarSituacoes="false"
                                    />
                                </h:panelGrid>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{processoParcelamentoControlador.tipoCadastro eq 'RURAL'}">
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0"
                                             style="height: 30px; vertical-align: middle !important;">
                                    <h:selectOneMenu title="Selecione a Situação do Cadastro Rural."
                                                     styleClass="mrig03 mtop03"
                                                     value="#{processoParcelamentoControlador.situacaoCadastroRural}"
                                                     disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                     id="situacaocadastrorural">
                                        <f:selectItems value="#{processoParcelamentoControlador.buscarSituacoes()}"/>
                                        <p:ajax event="change" update="dadosParcelamento" process="dadosParcelamento"
                                                listener="#{processoParcelamentoControlador.limparCadastroPessoa()}"/>
                                    </h:selectOneMenu>

                                    <p:autoComplete queryDelay="1000"
                                                    value="#{processoParcelamentoControlador.selecionado.cadastro}"
                                                    converter="#{componentePesquisaCadastroRuralControlador.converterCadastroRural}"
                                                    completeMethod="#{processoParcelamentoControlador.buscarCadastroRurais}"
                                                    var="cadastroRural"
                                                    size="70"
                                                    dropdown="true"
                                                    disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                    id="cadastroRural"
                                                    itemLabel="#{cadastroRural}"
                                                    itemValue="#{cadastroRural.id}"
                                                    listener="#{processoFiscalizacaoControlador.carregaExisteReincidencia()}"
                                                    maxResults="10">
                                        <p:ajax event="itemSelect"
                                                process="dadosParcelamento"
                                                update="dadosParcelamento"
                                                onstart="aguarde.show()"
                                                listener="#{processoParcelamentoControlador.carregarCadastro()}"
                                                oncomplete="aguarde.hide()"/>
                                    </p:autoComplete>
                                </h:panelGrid>
                            </h:panelGroup>

                            <h:panelGroup rendered="#{processoParcelamentoControlador.tipoCadastro eq 'PESSOA'}">
                                <h:panelGrid columns="2" cellpadding="0" cellspacing="0"
                                             style="height: 30px; vertical-align: middle !important;">
                                    <h:selectOneMenu title="Selecione a Situação do Cadastro da Pessoa."
                                                     styleClass="mrig03 mtop03 width100"
                                                     value="#{processoParcelamentoControlador.situacaoCadastroPessoa}"
                                                     disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                     id="situacaocadastropessoa">
                                        <f:selectItems
                                            value="#{processoParcelamentoControlador.buscarSituacoesPessoa()}"/>
                                        <p:ajax event="change" update="dadosParcelamento" process="dadosParcelamento"
                                                listener="#{processoParcelamentoControlador.limparCadastroPessoa()}"/>
                                    </h:selectOneMenu>

                                    <fc:novoAutocompletePessoa
                                        value="#{processoParcelamentoControlador.selecionado.pessoa}"
                                        id="pessoa" mostraBotaoEdita="false"
                                        mostraBotaoNovo="false"
                                        situacoesPossiveis="#{processoParcelamentoControlador.buscarSituacoesDisponiveisPessoa()}"
                                        mostraSituacoes="false"
                                        disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                        mostraBotaoInfo="false"
                                        update=":Formulario:visualizar_debitos"
                                        listenerNavegacao="#{processoParcelamentoControlador.poeNaSessao()}"
                                        listenerItemSelect="#{processoParcelamentoControlador.carregarCadastro()}"
                                        caminhoAtual="#{processoParcelamentoControlador.urlAtual}"/>
                                </h:panelGrid>
                            </h:panelGroup>

                            <p:commandButton icon="ui-icon-search" oncomplete="consultaGenerica.show()"
                                             disabled="#{processoParcelamentoControlador.tipoCadastro == null or
                                                            (processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and
                                                            !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty())}"
                                             update=":dlgConsultaGenerica"/>
                        </h:panelGrid>

                        <h:outputLabel value="Contato: "/>
                        <p:inputText id="contato"
                                     title="Informe o número do telefone de contato do solicitante."
                                     onkeydown="mascara(this, mtel)"
                                     maxlength="15"
                                     onblur="validarTelefone(this)"
                                     value="#{processoParcelamentoControlador.selecionado.contato}"/>

                        <fc:outputLabelObrigatorio value="Parâmetro (Lei): " for="paramentroParcelamento"/>
                        <h:panelGrid columns="2" id="paramentroParcelamento" cellpadding="0" cellspacing="0">
                            <h:selectOneMenu
                                value="#{processoParcelamentoControlador.selecionado.paramParcelamento}"
                                disabled="#{processoParcelamentoControlador.tipoCadastro == null or
                (processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty())}"
                                converter="#{parametroParcelamentoControlador.converterGenerico}"
                                style="height: 20px">
                                <f:selectItems value="#{processoParcelamentoControlador.buscarParametros()}"/>
                                <p:ajax update="@form" event="change" process="@form" onstart="aguarde.show()"
                                        oncomplete="aguarde.hide()"
                                        listener="#{processoParcelamentoControlador.selecionarParametro()}"/>
                            </h:selectOneMenu>
                            <p:commandButton icon="ui-icon-info" styleClass="vinteLarguraVinteAltura mlef03"
                                             id="botaoParametro"
                                             disabled="#{processoParcelamentoControlador.selecionado.paramParcelamento == null}"
                                             title="Visualizar dados do parâmetro do parcelamento"
                                             onclick="verParametroParcelamento.show()"/>
                        </h:panelGrid>
                    </h:panelGrid>
                    <p:outputPanel rendered="#{processoParcelamentoControlador.selecionado.cadastro ne null}">
                        <h:panelGrid
                            columns="2"
                            rendered="#{processoParcelamentoControlador.tipoCadastro eq 'IMOBILIARIO'}">
                            <h:outputText value="Distrito: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.setor.distrito}"/>
                            <h:outputText value="Setor: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.setor.codigo}"/>
                            <h:outputText value="Quadra: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.quadra.codigo}"/>
                            <h:outputText value="Lote: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.codigoLote}"/>
                            <h:outputText value="Loteamento: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.quadra.loteamento.nome}"/>
                            <h:outputText value="Complemento do Lote: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.complemento}"/>
                            <h:outputText value="Lote do Loteamento: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.descricaoLoteamento}"/>
                            <h:outputText value="Endereço: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.endereco}"/>
                            <h:outputText value="Área do Terreno: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.lote.areaLote}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <h:outputText value="Área Total Construída: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.areaTotalConstruida}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <h:outputText value="Situação: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.ativo ? 'Ativo' : 'Inativo'}"/>
                            <h:outputText value="Propritários: "/>
                            <h:panelGroup>
                                <ui:repeat value="#{processoParcelamentoControlador.propriedadesBCI}"
                                           var="propriedade">
                                    <h:outputText styleClass="negrito"
                                                  value="#{propriedade.pessoa.nomeAutoComplete} - #{propriedade.proporcao}%"/><br/>
                                </ui:repeat>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid
                            columns="2"
                            rendered="#{processoParcelamentoControlador.tipoCadastro eq 'ECONOMICO'}">
                            <h:outputText value="Endereço de Localização: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.localizacao}"/>
                            <h:outputText value="Sócios: "/>
                            <h:panelGroup>
                                <ui:repeat
                                    value="#{processoParcelamentoControlador.socios}"
                                    var="socio">
                                    <h:outputText styleClass="negrito"
                                                  value="#{socio.socio.nomeAutoComplete} - #{socio.proporcao}%"/><br/>
                                </ui:repeat>
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid
                            columns="2"
                            rendered="#{processoParcelamentoControlador.tipoCadastro eq 'RURAL'}">
                            <h:outputText value="Endereço Fiscal: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.enderecoFiscal}"/>
                            <h:outputText value="Via de Acesso: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.viaAcesso}"/>
                            <h:outputText value="Distância da Sede (Km): "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.distanciaSede}"/>
                            <h:outputText value="Área: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.areaLote}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <h:outputText value="Tipo de Área: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.tipoAreaRural.descricao}"/>
                            <h:outputText value="Incra: "/>
                            <h:outputText styleClass="negrito"
                                          value="#{processoParcelamentoControlador.selecionado.cadastro.numeroIncra}"/>

                            <h:outputText value="Proprietários: "/>
                            <h:panelGroup>
                                <ui:repeat
                                    value="#{processoParcelamentoControlador.propriedadesBCR}"
                                    var="propriedade">
                                    <h:outputText styleClass="negrito"
                                                  value="#{propriedade.pessoa.nomeAutoComplete} - #{propriedade.proporcao}%"/><br/>
                                </ui:repeat>
                            </h:panelGroup>
                        </h:panelGrid>
                    </p:outputPanel>
                    <p:outputPanel rendered="#{processoParcelamentoControlador.selecionado.pessoa ne null}">
                        <p:dataTable value="#{processoParcelamentoControlador.enderecos}"
                                     emptyMessage="Nenhum endereço encontrado"
                                     var="endereco">
                            <f:facet name="header">
                                Endereço(s) do Contribuinte
                            </f:facet>
                            <p:column headerText="Tipo" styleClass="negrito">
                                #{endereco.tipoEndereco.descricao}
                            </p:column>
                            <p:column headerText="Logradouro">
                                #{endereco.logradouro}
                            </p:column>
                            <p:column headerText="Número">
                                #{endereco.numero}
                            </p:column>
                            <p:column headerText="Complemento">
                                #{endereco.complemento}
                            </p:column>
                            <p:column headerText="Bairro">
                                #{endereco.bairro}
                            </p:column>
                            <p:column headerText="Cidade">
                                #{endereco.localidade}
                            </p:column>
                            <p:column headerText="UF">
                                #{endereco.uf}
                            </p:column>
                            <p:column headerText="CEP">
                                #{endereco.cep}
                            </p:column>
                            <p:column headerText="Principal">
                                #{endereco.principal? 'Sim' : 'Não'}
                            </p:column>
                        </p:dataTable>
                        <br/>
                        <p:dataTable value="#{processoParcelamentoControlador.telefones}"
                                     emptyMessage="Nenhum telefone encontrado"
                                     var="telefone">
                            <f:facet name="header">
                                Telefone(s) do Contribuinte
                            </f:facet>
                            <p:column headerText="Tipo" styleClass="negrito">
                                #{telefone.tipoFone.tipoFone}
                            </p:column>
                            <p:column headerText="Número">
                                #{telefone.telefone}
                            </p:column>
                            <p:column headerText="Principal">
                                #{telefone.principal? 'Sim' : 'Não'}
                            </p:column>
                        </p:dataTable>
                        <br/>
                    </p:outputPanel>

                </p:outputPanel>

                <div class="centralizado mbot10">
                    <p:commandButton styleClass="operacao prioritario"
                                     icon="ui-icon-search"
                                     value="Buscar Débitos"
                                     update="@form"
                                     id="visualizar_debitos"
                                     title="Clique ou pressione F2, para visualizar os débitos do cadastro selecionado"
                                     onstart="statusDialog.show()"
                                     onsuccess="statusDialog.hide()"
                                     disabled="#{!processoParcelamentoControlador.isParcelamentoValido() or processoParcelamentoControlador.selecionado.paramParcelamento == null}"
                                     actionListener="#{processoParcelamentoControlador.recuperarParcelasValorDividas()}"/>
                </div>
                <p:dataTable id="tabelaDeParcelas"
                             style="font-size: 8pt !important"
                             emptyMessage="Pressione o botão 'Buscar Débitos' para carregar a lista."
                             value="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas}"
                             var="parcela"
                             rowKey="#{parcela.idParcela}"
                             selection="#{processoParcelamentoControlador.selecionadas}"
                             sortBy="#{parcela.cadastro}"
                             rowIndexVar="linha"
                             rowStyleClass="#{linha%2==0?'linha-selecionada': null}">
                    <f:facet name="header">
                        <h:outputText value="Débitos para Parcelamento"/>
                    </f:facet>
                    <p:column headerText="Cadastro" style="width: 8%;">
                        <h:outputText value="#{parcela.cadastro}"/>
                    </p:column>
                    <p:column headerText="Dívida" style="width: 12%;">
                        <h:outputText value="#{parcela.divida}"/>
                    </p:column>
                    <p:column headerText="Referência" style="width: 12%;">
                        <h:outputText value="#{parcela.referencia}"/>
                    </p:column>
                    <p:column headerText="Tipo de Débito" style="width: 5%;">
                        <h:outputText value="#{parcela.tipoDeDebito}"/>
                    </p:column>
                    <p:column headerText="Processo Ajuizamento"
                              rendered="#{processoParcelamentoControlador.selecionado.paramParcelamento.situacaoDebito eq 'AJUIZADA'}">
                        <h:outputText value="#{parcela.numeroProcessoAjuizamento}"/>
                    </p:column>
                    <p:column headerText="Parcela" style="width: 2%; text-align: center;"
                              sortBy="#{parcela.parcela}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.parcela}"/>
                    </p:column>
                    <p:column headerText="SD" style="width: 2%; text-align: center;">
                        <h:outputText value="#{parcela.sd}"/>
                    </p:column>
                    <p:column headerText="Vencimento" style="width: 5%; text-align: center;"
                              sortBy="#{parcela.vencimentoToString}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.vencimentoToString}"/>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="Total: " styleClass="negrito"/>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Imposto" style="text-align: right">
                        <h:outputText value="#{parcela.valorImposto}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.imposto}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Taxa / M.P.¹" style="text-align: right">
                        <h:outputText value="#{parcela.valorTaxa}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.taxa}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Juros" style="text-align: right">
                        <h:outputText value="#{parcela.valorJuros}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.juros}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Multa²" style="text-align: right">
                        <h:outputText value="#{parcela.valorMulta}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.multa}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Correção" style="text-align: right">
                        <h:outputText value="#{parcela.valorCorrecao}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.correcao}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Honorários²" style="text-align: right">
                        <h:outputText value="#{parcela.valorHonorarios}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.honorarios}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Total" style="text-align: right">
                        <h:outputText value="#{parcela.valorTotal}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.total}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                    <p:column selectionMode="multiple" style="text-align: center">
                        <f:facet name="footer">
                            <h:panelGrid columns="1" columnClasses="alinhamentoDireita, alinhamentoDireita">
                                <p:commandButton icon="ui-icon-trash"
                                                 actionListener="#{processoParcelamentoControlador.removerParcelas()}"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 process="@form"
                                                 update="@form"/>
                            </h:panelGrid>
                        </f:facet>
                    </p:column>
                </p:dataTable>

                <div style="width: 100%">
                    <table
                        style="border: 1px solid; border-color: #92b8d3; font-size: 11px; color: #000000; width: 100%; background-color: #f6fbfe">
                        <tr>
                            <td style="text-align: left">
                                <h:panelGrid columns="2">
                                    <h:outputText value="¹" styleClass="negrito"/>
                                    <h:outputText
                                        value=" Taxa: Referente à(s) taxa(s) dos tributos de IPTU, ISSQN, ITBI, Nota Fiscal Avulsa, Alvará, Documentos Oficiais, Taxas Diversas, Dívidas Diversas, Rendas Patrimoniais, CEASA, NFS-e, RBTrans;"/>

                                    <h:outputText value="¹" styleClass="negrito"/>
                                    <h:outputText
                                        value=" M.P.: Referente à Multa Punitiva do tributo de Fiscalização de ISSQN;"/>

                                    <h:outputText value="²" styleClass="negrito"/>
                                    <h:outputText
                                        value=" Valores calculados com base na data deste parcelamento."/>
                                </h:panelGrid>
                            </td>
                        </tr>
                    </table>
                </div>
                <br/>
                <h:panelGrid columns="2" id="finalizacaoParcelamento">
                    <h:outputText value="Valor Devido:"/>
                    <p:inputText readonly="true" size="12" value="#{processoParcelamentoControlador.total}"
                                 styleClass="opaco">
                        <f:convertNumber pattern="#,##0.00"/>
                    </p:inputText>

                    <h:outputText value="Valor dos Descontos:"/>
                    <p:inputText readonly="true" size="12"
                                 value="#{processoParcelamentoControlador.selecionado.valorDesconto}"
                                 styleClass="opaco">
                        <f:convertNumber pattern="#,##0.00"/>
                    </p:inputText>

                    <h:outputText value="Valor do Parcelamento:"/>
                    <p:inputText readonly="true" size="12"
                                 value="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.valorTotalOriginada}"
                                 styleClass="opaco">
                        <f:convertNumber pattern="#,##0.00"/>
                    </p:inputText>

                    <fc:outputLabelObrigatorio value="Primeiro Vencimento: "/>
                    <p:calendar pattern="dd/MM/yyyy" size="12"
                                onkeypress="mascara(this, mdata)"
                                value="#{processoParcelamentoControlador.selecionado.vencimentoPrimeiraParcela}"
                                disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or
                                processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty() or
                                !processoParcelamentoControlador.assistenteSimulacaoParcelamento.permissaoMudarDataVencimentoPrimeiraParcela}">
                        <p:ajax event="dateSelect" update="panelValoresFinais" process="@this"
                                listener="#{processoParcelamentoControlador.validarPrimeiroVencimento()}"/>
                        <p:ajax event="change" update="panelValoresFinais" process="@this"
                                listener="#{processoParcelamentoControlador.validarPrimeiroVencimento()}"/>
                    </p:calendar>

                    <h:outputText value="Valor da Entrada (R$):"
                                  rendered="#{processoParcelamentoControlador.selecionado.paramParcelamento.exigePercentualEntrada}"/>
                    <h:panelGroup
                        rendered="#{processoParcelamentoControlador.selecionado.paramParcelamento.exigePercentualEntrada}">

                        <table cellspacing="0" cellpadding="0">
                            <tr>
                                <td>
                                    <p:inputText value="#{processoParcelamentoControlador.selecionado.valorEntrada}"
                                                 size="15" maxlength="10"
                                                 disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null
                          or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                                 rendered="#{processoParcelamentoControlador.selecionado.paramParcelamento.exigePercentualEntrada}"
                                                 converter="converterBigDecimal2Casas">
                                        <p:ajax event="blur" update=":Formulario"
                                                process="@this"
                                                onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()"
                                                listener="#{processoParcelamentoControlador.validarValorDeEntrada()}"/>
                                    </p:inputText>
                                </td>
                                <td valign="middle">
                                    <div class="mlef05 amarelonegrito"
                                         style="display: #{processoParcelamentoControlador.selecionado.valorEntrada eq processoParcelamentoControlador.assistenteSimulacaoParcelamento.valorMinimoParcela ? 'block' : 'none'}">
                                        * Valor referente à #{processoParcelamentoControlador.montarDescricaoValorParametroEntrada()} UFM
                                    </div>
                                    &nbsp;
                                    <h:outputText
                                        rendered="#{processoParcelamentoControlador.valorMenorQueEntrada}"
                                        value="* Usuário com permissão para lançar entrada menor que o percentual configurado"
                                        styleClass="amarelonegrito"/>
                                </td>
                            </tr>
                        </table>

                    </h:panelGroup>

                    <fc:outputLabelObrigatorio value="Qtde de Parcelas: "/>
                    <h:panelGroup>
                        <p:spinner id="valorParcela"
                                   value="#{processoParcelamentoControlador.selecionado.numeroParcelas}"
                                   size="12"
                                   min="1"

                                   disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}">

                            <p:ajax process="finalizacaoParcelamento"
                                    update=":Formulario"
                                    onstart="aguarde.show()"
                                    oncomplete="aguarde.hide()"
                                    listener="#{processoParcelamentoControlador.calcularValoresAposAlteracaoQuantidadeParcelas()}"/>
                        </p:spinner>
                        &nbsp;
                        <h:outputText value="Qtde Máxima Permitida: "/>
                        &nbsp;
                        <h:outputText value="#{processoParcelamentoControlador.selecionado.quantidadeMaximaParcelas}"
                                      styleClass="vermelhonegrito"/>

                    </h:panelGroup>

                    <h:outputText value="Garantidor:"/>
                    <fc:novoAutocompletePessoa value="#{processoParcelamentoControlador.selecionado.fiador}"
                                               id="fiador"
                                               disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                               situacoesPossiveis="#{novoComponentePesquisaPessoaControlador.situacaoPorDescricao('ATIVO')}"
                                               mostraSituacoes="false"
                                               mostraBotaoInfo="false"
                                               listenerNavegacao="#{processoParcelamentoControlador.poeNaSessao()}"
                                               caminhoAtual="#{processoParcelamentoControlador.urlAtual}"/>
                    <h:outputText value="Procurador:"/>
                    <fc:novoAutocompletePessoa value="#{processoParcelamentoControlador.selecionado.procurador}"
                                               id="procurador"
                                               disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                               situacoesPossiveis="#{novoComponentePesquisaPessoaControlador.situacaoPorDescricao('ATIVO')}"
                                               mostraSituacoes="false"
                                               mostraBotaoInfo="false"
                                               listenerNavegacao="#{processoParcelamentoControlador.poeNaSessao()}"
                                               caminhoAtual="#{processoParcelamentoControlador.urlAtual}"/>

                </h:panelGrid>
                <p:panel header="Valores Finais" id="panelValoresFinais"
                         visible="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas ne null and !processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}">
                    <table class="table">
                        <tr>
                            <th class="alinhamentoDireita" style="width: 20%">#</th>
                            <th class="alinhamentoDireita" style="width: 10%">Imposto</th>
                            <th class="alinhamentoDireita" style="width: 10%">Taxa/M.P.¹</th>
                            <th class="alinhamentoDireita" style="width: 10%">Juros</th>
                            <th class="alinhamentoDireita" style="width: 10%">Multa</th>
                            <th class="alinhamentoDireita" style="width: 10%">Correção</th>
                            <th class="alinhamentoDireita" style="width: 10%">Honorários</th>
                            <th class="alinhamentoDireita" style="width: 10%">Total</th>
                            <th class="alinhamentoDireita" style="width: 10%">&nbsp;</th>
                        </tr>
                        <tr style="color: tomato">
                            <td class="alinhamentoDireita">(+) Total:</td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.imposto}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.taxa}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.juros}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.multa}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.correcao}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.honorarios}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.total}" styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td style="width: 10%">&nbsp;</td>
                        </tr>
                        <tr style="color: royalblue">
                            <td class="alinhamentoDireita">(-) Desconto:</td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.selecionado.valorDescontoImposto}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.selecionado.valorDescontoTaxa}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.selecionado.valorDescontoJuros}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.selecionado.valorDescontoMulta}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.selecionado.valorDescontoCorrecao}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.selecionado.valorDescontoHonorarios}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText value="#{processoParcelamentoControlador.selecionado.valorTotalDesconto}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td style="width: 10%">&nbsp;</td>
                        </tr>
                        <tr>
                            <td class="alinhamentoDireita">(=) Final:</td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.imposto - processoParcelamentoControlador.selecionado.valorDescontoImposto}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.taxa - processoParcelamentoControlador.selecionado.valorDescontoTaxa}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.juros - processoParcelamentoControlador.selecionado.valorDescontoJuros}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.multa - processoParcelamentoControlador.selecionado.valorDescontoMulta}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.correcao - processoParcelamentoControlador.selecionado.valorDescontoCorrecao}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.valorTotalHonorariosOriginada}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td class="alinhamentoDireita">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.valorTotalOriginada}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </td>
                            <td style="width: 10%">&nbsp;</td>
                        </tr>
                    </table>
                    <br/>
                    <p:dataTable
                        value="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelasGeradas}"
                        var="originada">
                        <f:facet name="header">Parcelas Originadas</f:facet>
                        <p:column headerText="Parcela" style="text-align: center; width: 10%">
                            <h:outputText value="#{originada.parcela}"/>
                        </p:column>
                        <p:column headerText="Vencimento" style="text-align: center; width: 10%">
                            <h:outputText value="#{originada.vencimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText styleClass="negrito" value="Total"/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Imposto" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorImposto}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalImpostoOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Taxa / M.P.¹" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorTaxa}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalTaxaOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Juros" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorJuros}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalJurosOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Multa" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorMulta}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalMultaOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Correção" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorCorrecao}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalCorrecaoOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Honorários" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorHonorarios}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.valorTotalHonorariosOriginada}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>

                        <p:column headerText="Total" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorTotalSemDesconto}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{processoParcelamentoControlador.valorTotalSemDescontoOriginada}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Desconto" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorDesconto}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.valorTotalDescontoOriginada}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Total com Desconto" style="text-align: right; width: 10%">
                            <h:outputText value="#{originada.valorTotal}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.valorTotalOriginada}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                    </p:dataTable>
                </p:panel>
            </p:panel>

            <p:panel styleClass="mtop05">
                <p:commandButton icon="ui-icon-check"
                                 styleClass="operacao prioritario"
                                 value="Finalizar"
                                 title="Clique aqui para finalizar o Processo de Parcelamento. É necessário que o Processo de Parcelamento esteja salvo."
                                 process="@form"
                                 disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                 update=":Formulario :formDialogoReparcelamento"
                                 onclick="dialogoConfirmaParcelamento.show()"/>

                <fc:botaoTargetBlank actionListener="#{processoParcelamentoControlador.emitirDemonstrativo()}"
                                     imprimeNoDialog="true" styleClass="mlef05"
                                     disabled="#{processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas eq null or processoParcelamentoControlador.assistenteSimulacaoParcelamento.parcelas.isEmpty()}"
                                     label="Demonstrativo"/>

                <p:commandButton icon="ui-icon-cancel"
                                 styleClass="operacao mlef05"
                                 value="Voltar"
                                 title="Clique aqui para voltar à página anterior."
                                 action="#{processoParcelamentoControlador.voltar()}"
                                 ajax="false"/>

            </p:panel>
        </h:form>
        <p:dialog widgetVar="gerarNovoTermo" id="dialogGerarNovoTermo"
                  modal="true" resizable="false" dynamic="true" position="center" style="position: fixed !important">
            <div class="alert">
                <strong>
                    Atenção!
                </strong>
                Já existe um Termo de Confissão de Dívida gerado e emitido para esse parcelamento!
            </div>
        </p:dialog>
        <p:dialog widgetVar="verParametroParcelamento" id="dialogVerParametroParcelamento"
                  modal="true" resizable="false" dynamic="true" position="center" showHeader="false"
                  style="position: fixed !important">
            <p:panel header="Parâmetro do Parcelamento" styleClass="mbot05">
                <h:panelGrid columns="2">
                    <h:outputText value="Código:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.codigo}"/>

                    <h:outputText value="Descrição:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.descricao}"/>

                    <h:outputText value="Ato Legal:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.atoLegal}"/>

                    <h:outputText value="Situação dos Débitos:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.situacaoDebito.descricao}"/>

                    <h:outputText value="Início da Vigência:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.vigenciaInicio}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Final da Vigência:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.vigenciaFim}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Dívida de Destino:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.dividaParcelamento}"/>

                    <h:outputText value="Tipo de Parcelamento:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.tipoParcelamento}"/>

                    <h:outputText value="Exige Entrada:"/>
                    <h:outputText styleClass="negrito"
                                  value="#{processoParcelamentoControlador.selecionado.paramParcelamento.exigePercentualEntrada? 'Sim':'Não'}"/>

                    <h:outputText value="Percentual de Entrada:"/>
                    <h:panelGrid columns="2" cellspacing="0" cellpadding="0">
                        <h:outputText styleClass="negrito"
                                      value="#{processoParcelamentoControlador.selecionado.paramParcelamento.valorPercentualEntrada}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText styleClass="negrito mlef03" value="%"/>
                    </h:panelGrid>

                    <h:outputText value="Valor Mínimo da Parcela:"/>
                    <h:panelGrid columns="2" cellspacing="0" cellpadding="0">
                        <h:outputText styleClass="negrito"
                                      value="#{processoParcelamentoControlador.selecionado.paramParcelamento.valorMinimoParcelaUfm}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText styleClass="negrito mlef03" value="UFM"/>
                    </h:panelGrid>
                </h:panelGrid>
            </p:panel>
            <div style="width: 100%; text-align: center">
                <p:commandButton styleClass="operacao" value="Fechar"
                                 icon="ui-icon-close" onclick="verParametroParcelamento.hide()"/>
            </div>
        </p:dialog>

        <p:dialog widgetVar="dialogoReparcelamento" id="dialogoReparcelamentoDlg" width="1000" modal="true">
            <h:form id="formDialogoReparcelamento">
                <div style="text-align: center;">
                    <div class="alert centralizado">
                        <strong>
                            Atenção!
                        </strong>
                        Esse processo de reparcelamento atingiu o limite máximo de reparcelamentos permitidos, será gerado em apenas uma parcela, tem certeza que deseja continuar?
                    </div>
                    <p:commandButton icon="ui-icon-check"
                                     styleClass="operacao prioritario"
                                     value="Continuar"
                                     title="Clique aqui para finalizar o Processo de Parcelamento."
                                     actionListener="#{processoParcelamentoControlador.efetivarProcessoParcelamento()}"
                                     process="@form"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"/>

                    <p:commandButton icon="ui-icon-close"
                                     styleClass="operacao"
                                     value="Cancelar"
                                     title="Clique aqui para cancelar o Processo de Parcelamento."
                                     update=":Formulario"
                                     oncomplete="dialogoReparcelamento.hide()"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog header="Consulta do Cadastro" modal="true" widgetVar="consultaGenerica" width="900" height="500"
                  id="dlgConsultaGenerica">
            <h:form id="formularioConsultaDebito">
                <fc:pesquisaGenerico id="lista"
                                     caminhoAtual="edita"
                                     nomeDaClasse="#{processoParcelamentoControlador.nomeClasse}"
                                     dialog="true"
                                     pretty="true"
                                     iconmSelecionar="check-icon.png"
                                     novo="#{processoParcelamentoControlador.novo()}"
                                     selecionar="#{processoParcelamentoControlador.selecionarObjetoPesquisaGenerico}"
                                     mostrarHistorico="false"
                                     mostrarBotaoNovo="false"
                                     meuControlador="#{processoParcelamentoControlador.componentePesquisa}"
                                     guardarNaSessao="false"
                                     pesquisaNoEnter="false"
                                     utilizarTabelaPessoa="#{processoParcelamentoControlador.tipoCadastro eq 'PESSOA' ? 'true': 'false'}"
                                     updateSelecionarTabela=":Formulario"/>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dialogoConfirmaParcelamento" id="dlgConfirmaParcelamento" width="1000" modal="true">
            <h:form id="formDialogoConfirmacao">
                <div style="text-align: center;">
                    <div class="alert alert-info centralizado">
                        <strong>
                            Atenção!
                        </strong>
                        Você tem certeza que deseja efetivar esse processo de parcelamento? Ao efetivar as parcelas assumirão as quantidades e valores exibidos no demonstrativo.
                    </div>
                    <br/>
                    <p:commandButton icon="ui-icon-check"
                                     styleClass="operacao prioritario"
                                     value="Sim, quero continuar"
                                     title="Clique aqui para finalizar o Processo de Parcelamento."
                                     actionListener="#{processoParcelamentoControlador.avaliarProcessoParcelamento()}"
                                     process="@form"
                                     onclick="aguarde.show()"/>

                    <p:commandButton icon="ui-icon-close"
                                     styleClass="operacao"
                                     value="Não, quero cancelar"
                                     title="Clique aqui para cancelar o Processo de Parcelamento."
                                     update=":Formulario"
                                     onclick="dialogoConfirmaParcelamento.hide()"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dialogoProprietariosCI" id="dlgProprietariosCI" width="1000" modal="true" closable="false">
            <h:form id="formDialogoAtualizacaoPFCadastro">
                <div style="text-align: center;">
                    <div class="alert centralizado">
                        Selecione o requerente do parcelamento.
                    </div>
                    <br/>

                    <p:dataTable value="#{processoParcelamentoControlador.proprietariosPessoaFisica()}"
                                 emptyMessage="Nenhum proprietário encontrado"
                                 var="prop">
                        <p:column headerText="Proprietário">
                            #{prop.pessoa}
                        </p:column>
                        <p:column headerText="Selecionar">
                            <p:commandButton icon="ui-icon-check"
                                             styleClass="prioritario"
                                             title="Clique aqui para selecionar o cadastro."
                                             actionListener="#{processoParcelamentoControlador.selecionouProprietario(prop)}"
                                             process="@form"/>
                        </p:column>
                    </p:dataTable>

                    <br/>

                    <p:commandButton icon="ui-icon-close"
                                     styleClass="operacao"
                                     value="Fechar"
                                     title="Clique aqui fechar."
                                     actionListener="#{processoParcelamentoControlador.fecharDialogSelecaoProprietarioCI()}"/>
                </div>
            </h:form>
        </p:dialog>

        <fc:dialog-atualizacao-cadastral-pessoa-fisica id="#{processoParcelamentoControlador.idDialogAtualizacaoCadastralPF()}" controlador="#{processoParcelamentoControlador}"/>

        <div id="dlgEfetivar" class="modal hide fade">
            <h:form id="formEfetivar">
                <div class="modal-body mtop20">
                    <fc:acompanhamentoBarraProgresso
                        assistenteBarraProgresso="#{processoParcelamentoControlador.assistente}"/>
                </div>
            </h:form>
        </div>

    </ui:define>
</ui:composition>
</html>
