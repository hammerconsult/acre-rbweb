<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
      >
    <ui:composition template="/corpo.xhtml">
        <ui:define name="body">
            <h:form>
                <fc:cabecalhoPretty auditavel="true" controlador="#{processoDebitoControlador}" origem="#{processoDebitoControlador.caminhoPadrao}/listar/"/>
                <p:panel header="Detalhes do Processo de Débito">
                    <table cellpadding="0" cellspacing="0" style="width: 100%">

                        <tbody>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Exercício: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.exercicio.ano}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Número: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.codigo}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Protocolo: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.numeroProtocolo}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Data: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.lancamento}" escape="false">
                                        <f:convertDateTime pattern="dd/MM/yyyy hh:MM:ss"/>
                                    </h:outputText>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Usuário: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.usuarioIncluiu.nome}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Situação: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.situacao.descricao}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Ato Legal: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.atoLegal}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Motivo: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <h:outputText value="#{processoDebitoControlador.selecionado.motivo}" escape="false"/>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Cadastro: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{processoDebitoControlador.buscarInscricaoDoCadastro(item.parcela)}" escape="false"/>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Dívida: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{item.parcela.valorDivida.divida.descricao}"/>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Exercício: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{item.parcela.valorDivida.exercicio.ano}"/>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Parcela: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{item.parcela.sequenciaParcela}"/>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Vencimento: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{item.parcela.vencimento}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Tipo de Dívida: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{processoDebitoControlador.retornarSituacaoDaDivida(item.parcela)}"/>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Situação: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                        <h:outputText value="#{processoDebitoControlador.recuperarUltimaSituacao(item.parcela)}" />
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: white">
                                <td align="right" height="18">
                                    <h:outputText value="Valor (R$): " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                       <h:outputText value="#{processoDebitoControlador.recuperarSaldoUltimaSituacao(item.parcela)}">
                                            <f:convertNumber pattern="###,##0.0000" />
                                        </h:outputText>
                                    </ui:repeat>
                                </td>
                            </tr>
                            <tr style="background-color: #d7e3e9">
                                <td align="right" height="18">
                                    <h:outputText value="Valor (UFM: " style="font-weight: bold"/>
                                </td>
                                <td align="left">
                                    <p:spacer width="5"/>
                                    <ui:repeat value="#{processoDebitoControlador.selecionado.itens}" var="item" >
                                         <h:outputText value="#{converterRealUfm.converterToUFMVigente(processoDebitoControlador.recuperarSaldoUltimaSituacao(item.parcela))}" />

                                    </ui:repeat>
                                </td>
                            </tr>





                        </tbody>
                    </table>
                </p:panel>
                <br/>
                <p:commandButton ajax="false" id="botaoEditar" value="Editar" action="edita" disabled="#{!autorizacao.isPodeEditar(request)}">
                    <f:setPropertyActionListener target="#{processoDebitoControlador.caminho}" value="visualizar" />
                </p:commandButton>
                <p:commandButton  ajax="false" id="botaoExcluir" value="Excluir" action="lista" disabled="#{!autorizacao.isPodeExcluir(request)}" actionListener="#{processoDebitoControlador.excluirSelecionado()}" onclick="if(!confirm('Deseja excluir este registro?')) return false;"/>
                <p:commandButton ajax="false" value="Voltar" action="#{processoDebitoControlador.caminho}"/>
            </h:form>
        </ui:define>
    </ui:composition>
</html>
