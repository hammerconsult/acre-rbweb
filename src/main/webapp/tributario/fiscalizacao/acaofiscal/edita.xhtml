<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<ui:composition template="/corpo.xhtml">

    <ui:define name="body">

        <script type="application/javascript">
            $(document).ready(function () {
                $('.valor').blur(function () {
                    if (!$(this).val()) {
                        $(this).val('0,00');
                    }
                });
            });

            function salvarAcaoFiscal() {
                salvarAcao();
            }

            function salvarAcaoFiscalToda() {
                salvarAcaoToda();
            }

            function ajustaModalNotasFiscaisEletronicas() {
                var wTotal = window.innerWidth;
                var hTotal = window.innerHeight;
                var diferencaW = wTotal * 0.05;
                var diferencaH = hTotal * 0.1;
                var aplicarW = ((diferencaW / 2) * 100) / wTotal;
                var aplicarH = ((diferencaH / 2) * 100) / wTotal;
                $("#modalNotasFiscaisEletronicas").css("width", (wTotal - diferencaW) + "px");
                $("#modalNotasFiscaisEletronicas").css("right", aplicarW + "%");
                $("#modalNotasFiscaisEletronicas").css("left", "inherit");
                $("#modalNotasFiscaisEletronicas").css("bottom", aplicarH + "%");
                $("#modalNotasFiscaisEletronicas > .modal-content > .modal-body").css("height", ((hTotal - diferencaH) - 100) + "px");
            }
        </script>
        <style type="text/css">
            .gridNota > tbody > tr > td {
                padding-right: 10px;
            }

            .lancamentoContabeis td div.ui-dt-c {
                padding: 2px 6px !important;
            }
        </style>

        <fc:aguarde widgetVar="statusDialog"/>

        <h:form id="Formulario">
            <p:remoteCommand name="salvarAcao" id="rcSalvarAcaoFiscal"
                             onstart="aguarde.show();" oncomplete="aguarde.hide();"
                             update=":Formulario" actionListener="#{acaoFiscalControlador.salvar()}"/>

            <p:remoteCommand name="salvarAcaoToda" id="rcSalvarAcaoFiscalToda"
                             onstart="aguarde.show();" oncomplete="aguarde.hide();"
                             update=":Formulario" actionListener="#{acaoFiscalControlador.salvarAcaoToda()}"/>

            <p:panel header="Ação Fiscal">

                <p:poll interval="1"
                        widgetVar="pollSalvar"
                        listener="#{acaoFiscalControlador.finalizarBarraProgressao()}"
                        update=":formDialogProgresSalvar:panelBarraSalvar"
                        stop="#{!acaoFiscalControlador.assistente.executando}"
                        autoStart="false"/>

                <table style="width: 100%">
                    <tr>
                        <td><h:panelGrid columns="2">
                            <h:outputText value="Período: "/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.dataLevantamentoInicial}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <h:outputText value=" até: "/>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.dataLevantamentoFinal}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                            </h:panelGroup>

                            <h:outputText value="Situação: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal.descricao}"/>
                            <h:outputText value="Cadastro Econômico: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.inscricaoCadastral}"
                                         styleClass="negrito"/>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.pessoa.nome}"
                                         styleClass="negrito"
                                         size="50"/>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.pessoa.cpf_Cnpj}"
                                         styleClass="negrito"/>

                            <h:outputText value="Contador: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.enquadramentoFiscal.escritorioContabil} #{acaoFiscalControlador.enquadramentoFiscal.escritorioContabil.crc}"
                                         styleClass="negrito"
                                         size="50"/>

                            <h:outputText value="Programação: "/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.numero}"
                                             styleClass="negrito"/>
                                <fc:novoParente selecionado="#{acaoFiscalControlador.selecionado}"
                                                icon="ui-icon-search"
                                                title="Visualizar programação"
                                                destino="/tributario/fiscalizacao/programacao/ver/#{acaoFiscalControlador.selecionado.programacaoFiscal.id}/"
                                                origem="#{acaoFiscalControlador.caminhoOrigem}"/>
                            </h:panelGroup>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.programacaoFiscal.descricao}"
                                         styleClass="negrito"
                                         size="50"/>
                            <p:spacer/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.dataInicio}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <h:outputText value=" até: "/>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.dataFinal}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                            </h:panelGroup>

                            <h:outputText value="Ordem de Serviço: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.formataNumeroOrdemServico}"
                                         styleClass="negrito"/>
                        </h:panelGrid></td>
                        <td style="text-align: right;" valign="top">
                            <h:panelGrid columns="1">
                                <p:commandButton value="1 - Início de Fiscalização" update=":formImprimirDocto @form"
                                                 onstart="statusDialog.show()"
                                                 icon="ui-icon-copy"
                                                 styleClass="#{(acaoFiscalControlador.selecionado.ordemServico eq null
                                               or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                               or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO') eq true ? '': 'prioritario'}"
                                                 style="height: 30px"
                                                 oncomplete="statusDialog.hide();"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoTermoFiscalizacao}"
                                                 disabled="#{acaoFiscalControlador.selecionado.ordemServico eq null
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>

                                <p:commandButton value="6 - Finalização da Fiscalização"
                                                 update=":formImprimirDocto @form"
                                                 onstart="statusDialog.show()"
                                                 icon="ui-icon-copy"
                                                 styleClass="icone_azul"
                                                 style="height: 30px"
                                                 oncomplete="statusDialog.hide(); dialogImprimirDocto.show()"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoTermoFinalizacaoFiscalizacao()}"
                                                 disabled="#{!acaoFiscalControlador.canEmitirTermoFinalizacaoFiscalizacao()}"/>

                                <p:commandButton value="Homologação" update=":formImprimirDocto :Formulario"
                                                 onstart="statusDialog.show()" oncomplete="statusDialog.hide();"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoHomologacao()}"
                                                 rendered="#{!acaoFiscalControlador.existeMulta}"
                                                 style="height: 30px"
                                                 onclick="if(!confirm('Deseja homologar essa fiscalização?')) return false;"
                                                 disabled="#{!acaoFiscalControlador.existeTermoFiscalizacaoGerado()
                                                          or (acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO')}"/>

                                <p:commandButton id="relatoriofiscal" value="Relatório Fiscal"
                                                 styleClass="icone_azul" icon="ui-icon-document"
                                                 update=":formImprimirDocto @form"
                                                 actionListener="#{acaoFiscalControlador.gerarRelatorioFiscal}"
                                                 rendered="#{acaoFiscalControlador.existeMulta}"
                                                 style="height: 30px"
                                                 onstart="statusDialog.show()"
                                                 oncomplete="statusDialog.hide(); dialogImprimirDocto.show()"/>
                            </h:panelGrid>
                        </td>
                    </tr>
                </table>
                <br/>

                <p:tabView id="tabView">
                    <p:ajax event="tabChange"
                            onstart="aguarde.show()"
                            oncomplete="aguarde.hide()"
                            listener="#{acaoFiscalControlador.onTabChange}"/>
                    <p:tab id="fiscaisDesignados" title="Fiscais Designados">

                        <p:dataTable value="#{acaoFiscalControlador.selecionado.fiscalDesignados}" var="fiscal"
                                     emptyMessage="Nenhum registro encontrado" id="tFiscais">
                            <f:facet name="header">
                                <h:outputText value="Fiscais Designados"/>
                            </f:facet>
                            <p:column headerText="Nome do Fiscal">
                                <h:outputText value="#{fiscal.usuarioSistema.pessoaFisica.nome}"/>
                            </p:column>
                            <p:column headerText="Login do Fiscal">
                                <h:outputText value="#{fiscal.usuarioSistema.login}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Histórico de Situações">
                        <p:dataTable value="#{acaoFiscalControlador.selecionado.situacoesAcaoFiscal}" var="situacao"
                                     emptyMessage="Nenhum registro encontrado" id="tSituacoes"
                                     sortBy="#{situacao.data}">
                            <f:facet name="header">
                                <h:outputText value="Histórico de Situações"/>
                            </f:facet>
                            <p:column headerText="Situação">
                                <h:outputText value="#{situacao.situacaoAcaoFiscal.descricao}"/>
                            </p:column>
                            <p:column headerText="Data">
                                <h:outputText value="#{situacao.data}">
                                    <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="2 - Levantamento Contábil">
                        <p:panel header="Arbitramento" id="arbitramento">
                            <h:panelGrid columns="3">
                                <h:outputText value="Data do Arbitramento:"/>
                                <p:inputText value="#{acaoFiscalControlador.selecionado.dataArbitramento}"
                                             readonly="true" styleClass="negrito"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <p:spacer rendered="#{!acaoFiscalControlador.fiscalTributarioSupervisor}"/>
                                <p:commandButton oncomplete="alteraArbitramento.show()"
                                                 title="Clique aqui para alterar a data de arbitramento da ação fiscal."
                                                 actionListener="#{acaoFiscalControlador.iniciarAlteracaoDataArbitramento()}"
                                                 rendered="#{acaoFiscalControlador.fiscalTributarioSupervisor}"
                                                 icon="ui-icon-pencil"
                                                 update=":Formulario_alteraArbitramento"
                                                 process="@this"/>

                                <h:outputText value="UFM do Arbitramento:"/>
                                <p:inputText value="#{acaoFiscalControlador.selecionado.ufmArbitramento}"
                                             readonly="true" styleClass="negrito"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </p:inputText>
                                <p:spacer/>
                            </h:panelGrid>

                            <p:dataTable id="tableAlteracoesDataArbitramento"
                                         var="alteracao"
                                         value="#{acaoFiscalControlador.selecionado.alteracoesDataArbitramento}"
                                         emptyMessage="Nenhuma alteração registrada."
                                         style="font-size: smaller"
                                         styleClass="mtop05">
                                <p:column headerText="Usuário">
                                    <h:outputText value="#{alteracao.usuarioSistema}"/>
                                </p:column>
                                <p:column headerText="Data de Alteração" styleClass="centralizado">
                                    <h:outputText value="#{alteracao.dataAlteracao}">
                                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Data de Arbitramento Anterior" styleClass="centralizado">
                                    <h:outputText value="#{alteracao.dataArbitramentoAnterior}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Nova Data de Arbitramento" styleClass="centralizado">
                                    <h:outputText value="#{alteracao.dataArbitramento}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>
                        </p:panel>

                        <p:panel id="panelLC" style="text-align: center; border: 0;" rendered="false">
                            <p:commandButton value="Carregar Meses" icon="ui-icon-refresh" title="Carregar Meses"
                                             style="height: 30px"
                                             rendered="#{acaoFiscalControlador.selecionado.levantamentosContabeis.size() eq 0}"
                                             styleClass="icone_verde"
                                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                   or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                             actionListener="#{acaoFiscalControlador.carregarMesesPorPeriodo()}"
                                             update=":Formulario:tabView:tableLevantamentoContabil :Formulario:tabView:panelLC"/>
                            <p:commandButton value="Carregar Meses" icon="ui-icon-refresh" title="Carregar Meses"
                                             style="height: 30px"
                                             rendered="#{acaoFiscalControlador.selecionado.levantamentosContabeis.size() ne 0}"
                                             styleClass="icone_verde"
                                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                   or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                             actionListener="#{acaoFiscalControlador.carregarMesesPorPeriodo()}"
                                             update=":Formulario:tabView:tableLevantamentoContabil :Formulario:tabView:panelLC"
                                             onclick="if(!confirm('Deseja recarregar os meses? Os valores atuais serão perdidos.')) return false;"/>

                        </p:panel>
                        <p:dataTable id="tableLevantamentoContabil"
                                     styleClass="mtop05"
                                     value="#{acaoFiscalControlador.selecionado.levantamentosContabeis}"
                                     var="levantamentoContabil"
                                     rowKey="#{levantamentoContabil}"
                                     widgetVar="tabelaLevan"
                                     selection="#{acaoFiscalControlador.levantamentosContabeisSelecionados}"
                                     emptyMessage="Nenhum registro encontrado.">
                            <f:facet name="header">
                                <h:outputText value="Levantamento"/>
                            </f:facet>
                            <p:column selectionMode="multiple" style="width:30px"
                                      rendered="#{!acaoFiscalControlador.existeAutoInfracaoValido()}"
                                      disabledSelection="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                     or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                            <p:column headerText="Mês">
                                <h:outputText value="#{levantamentoContabil.mes.descricao}"/>
                            </p:column>
                            <p:column headerText="Ano">
                                <h:outputText value="#{levantamentoContabil.ano}"/>
                            </p:column>
                            <p:column headerText="Valor da UFM (R$)" style="text-align: right">
                                <h:outputText value="#{levantamentoContabil.valorIndice}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                        <br/>
                        <p:panel style="text-align: center; border: 0;" rendered="false">
                            <p:commandButton id="botaoAlterar"
                                             value="Alterar Selecionados"
                                             style="height: 30px;"
                                             rendered="#{!acaoFiscalControlador.existeAutoInfracaoValido()}"
                                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                   or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                             actionListener="#{acaoFiscalControlador.alterarLevantamento}"
                                             update="@form"/>
                        </p:panel>
                    </p:tab>
                    <p:tab id="tabNotasFiscais"
                           title="3 - Notas Fiscais">
                        <p:panel id="panel-notas">
                            <table class="mtop10">
                                <tr>
                                    <td>
                                        <h:outputText value="Pesquisar por"
                                                      styleClass="azulnegrito"/>
                                    </td>
                                </tr>
                            </table>
                            <table class="mtop10">
                                <c:forEach items="#{acaoFiscalControlador.filtrosConsultaNsfe}" var="filtro"
                                           varStatus="index">

                                    <tr>
                                        <td>
                                            <h:selectOneMenu value="#{filtro.field}"
                                                             converter="#{acaoFiscalControlador.converterFieldConsulta}">
                                                <f:selectItems value="#{acaoFiscalControlador.pesquisaveisNotaFiscal}"/>
                                                <p:ajax process="@this" event="change" update="panel-notas"/>
                                            </h:selectOneMenu>
                                        </td>
                                        <td>
                                            <h:selectOneMenu value="#{filtro.operacao}">
                                                <f:selectItems value="#{filtro.field.tipo.selectItens}"/>
                                                <p:ajax process="@this" event="change" update="panel-notas"/>
                                            </h:selectOneMenu>
                                        </td>
                                        <td>
                                            <fc:inputConsultaEntidade tipoEnum="#{filtro.field.tipoEnum}"
                                                                      valor="#{filtro.valor}"
                                                                      operacao="#{filtro.operacao.name()}"
                                                                      select="#{filtro.field.select}"
                                                                      tipo="#{filtro.field.tipo}"/>
                                        </td>
                                        <td>
                                            <p:commandButton icon="ui-icon-plus"
                                                             rendered="#{index.index +1 == acaoFiscalControlador.filtrosConsultaNsfe.size()}"
                                                             onclick="aguarde.show()"
                                                             oncomplete="aguarde.hide()"
                                                             process="panel-notas"
                                                             update="panel-notas"
                                                             actionListener="#{acaoFiscalControlador.addFiltroNotaFiscal()}"/>
                                        </td>
                                        <td>
                                            <p:commandButton icon="ui-icon-close"
                                                             onclick="aguarde.show()"
                                                             oncomplete="aguarde.hide()"
                                                             process="panel-notas"
                                                             update="panel-notas"
                                                             actionListener="#{acaoFiscalControlador.removeFiltroNotaFiscal(index.index)}"/>
                                        </td>
                                    </tr>
                                </c:forEach>
                            </table>

                            <p:commandButton value="Pesquisar"
                                             id="pesquisar"
                                             icon="ui-icon-search"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             title="Clique para pesquisar"
                                             style="width: 180px; height: 30px"
                                             accesskey="P"
                                             process="panel-notas"
                                             update="panel-notas"
                                             styleClass="prioritario mrig05 pesquisar mtop10"
                                             actionListener="#{acaoFiscalControlador.consultarNotasFiscais()}"/>

                            <p:dataTable paginator="true"
                                         id="tabela-itens-qtde"
                                         lazy="true"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                         style="overflow: scroll; width: auto; max-height: 500px"
                                         paginatorPosition="top"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         rowKey="#{nota.id}"
                                         value="#{acaoFiscalControlador.notasFiscaisModel}"
                                         rows="10"
                                         styleClass="mtop10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>Notas Fiscais&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,50,100"
                                         var="nota">
                                <p:column headerText="Visualizar" styleClass="alinhamentoCentralizado">
                                    <p:button href="/nfse/nfse/ver/${nota.id}/"
                                              icon="ui-icon-search"/>
                                </p:column>
                                <p:column headerText="Número" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.numero}"/>
                                </p:column>
                                <p:column headerText="Emissão" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.emissao}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Código Emissão" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.codigoVerificacao}"/>
                                </p:column>
                                <p:column headerText="Tomador" styleClass="alinhamentoEsquerda">
                                    <h:outputText
                                        value="#{nota.declaracaoPrestacaoServico.dadosPessoaisTomador.nomeRazaoSocial}"/>
                                </p:column>
                                <p:column headerText="Descriminação do Serviço" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.descriminacaoServico}"/>
                                </p:column>
                                <p:column headerText="Total dos Serviços" styleClass="alinhamentoDireita">
                                    <h:outputText value="#{nota.declaracaoPrestacaoServico.totalServicos}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Situação" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.declaracaoPrestacaoServico.situacao.descricao}"/>
                                </p:column>
                            </p:dataTable>

                            <div style="display: flex; justify-content: right;">
                                <table>
                                    <tr>
                                        <td>Qtde Docs:</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.quantidadeNotas}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Serviços (R$):</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.totalServicos}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0.00"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Descontos (R$):</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.totalDescontos}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0.00"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Deduções (R$):</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.totalDeducoes}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0.00"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Base de Cálculo (R$):</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.totalBaseCalculo}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0.00"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>ISS (R$):</td>
                                        <td>
                                            <h:outputText value="#{acaoFiscalControlador.totalizadorNotasFiscais.totalIssCalculado}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="###,###,##0.00"/>
                                            </h:outputText>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </p:panel>
                    </p:tab>
                    <p:tab title="4 - Lançamento Contábil" id="tabLancamentoContabil">
                        <h:panelGroup id="painelLancamentoContabil">
                            <div style="width: 100%; text-align: center">
                                <p:panel visible="#{acaoFiscalControlador.temNotaExtraviadaSemMultaLancada()}"
                                         style="border: 0"
                                         id="tabLancamentosContabeis">
                                    <div class="ui-messages-error ui-corner-all">
                                        <div class="ui-messages-warn-icon"/>
                                        &nbsp;
                                        <b>Existem notas fiscais extraviadas passíveis de multa.</b>
                                    </div>
                                </p:panel>
                                <p:commandButton value="Novo Registro"
                                                 icon="ui-icon-circle-plus"
                                                 title="Carregar Meses"
                                                 id="botaoNovoMeses"
                                                 style="height: 30px;"
                                                 update=":formLancamentoContabil"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 actionListener="#{acaoFiscalControlador.novoRegistro()}"
                                                 disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                            </div>
                            <br/>
                            <c:forEach items="#{acaoFiscalControlador.selecionado.lancamentosContabeis}" var="registro"
                                       varStatus="var">
                                <p:panel header="Registro #{registro.numeroRegistro}/#{registro.ano}"
                                         id="painelRegistro#{registro.numeroRegistro}#{registro.ano}">

                                    <table style="width: 100%">
                                        <tr>
                                            <td>
                                                <h:panelGrid columns="2">
                                                    <h:outputText value="Processo Adm: "/>
                                                    <h:outputText value="#{registro.numeroProcessoAdministrativo}"
                                                                  styleClass="azulnegrito"/>
                                                    <h:outputText value="Situação: "/>
                                                    <h:outputText value="#{registro.situacao.descricao}"
                                                                  styleClass="azulnegrito"/>
                                                    <h:outputText value="Autos: "/>
                                                    <h:panelGrid columns="1"
                                                                 style="margin: 0 !important; padding: 0 !important">
                                                        <c:forEach items="#{registro.autosInfracao}" var="auto">
                                                            <h:panelGroup>
                                                                <h:outputText
                                                                    value="&lt;span class='negrito'&gt;#{auto.numero}/#{auto.ano}&lt;/span&gt; - &lt;span class='azulnegrito'&gt;#{auto.situacaoAutoInfracao}&lt;/span&gt;"
                                                                    escape="false"/>

                                                                <p:commandButton
                                                                    icon="ui-icon-print"
                                                                    title="Imprimir Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                    styleClass="botao-transparente"
                                                                    update=":formAutoInfracao"
                                                                    actionListener="#{acaoFiscalControlador.preparaImpressaoAuto(registro)}"
                                                                    rendered="#{auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO'}}"/>

                                                                <p:commandButton icon="ui-icon-cancel"
                                                                                 title="Estornar Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                                 styleClass="botao-transparente"
                                                                                 disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                                                                         or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                                                 rendered="#{auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO'}"
                                                                                 actionListener="#{acaoFiscalControlador.novoEstornoAutoInfracao(auto)}"
                                                                                 onstart="dialogEstornoAutoInfracao.show()"/>

                                                                <p:commandButton icon="ui-icon-pencil"
                                                                                 title="Retificar Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                                 styleClass="botao-transparente"
                                                                                 disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal ne 'REABERTO'}"
                                                                                 rendered="#{registro.situacao eq 'AUTO_INFRACAO' and (auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO')}"
                                                                                 actionListener="#{acaoFiscalControlador.novaRetificacaoAutoInfracao(auto)}"
                                                                                 onstart="dialogRetificacaoAutoInfracao.show()"/>

                                                                <p:commandButton ajax="false" icon="ui-icon-search"
                                                                                 styleClass="botao-transparente"
                                                                                 title="Ir para o Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                                 actionListener="#{acaoFiscalControlador.verAutoInfracao(auto)}">
                                                                </p:commandButton>
                                                            </h:panelGroup>
                                                        </c:forEach>
                                                    </h:panelGrid>
                                                </h:panelGrid>
                                            </td>
                                            <td style="text-align: right">
                                                <h:panelGrid columns="6" style="width: 100%; text-align: right">
                                                    <p:commandButton value="Lançar Multa"
                                                                     icon="ui-icon-newwin"
                                                                     styleClass="botaoCinza"
                                                                     update=":formLancamentoMulta"
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"
                                                                     actionListener="#{acaoFiscalControlador.defineRegistroDaMulta(registro)}"
                                                                     style="height: 30px; color: black"
                                                                     disabled="#{registro.situacao ne 'AGUARDANDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                                                    <p:commandButton value="Cancelar Lançamento"
                                                                     icon="ui-icon-cancel"
                                                                     styleClass="botaoCinza"
                                                                     actionListener="#{acaoFiscalControlador.cancelarLancamentoContabilFiscal(registro)}"
                                                                     update="@form"
                                                                     style="height: 30px; color: black"
                                                                     onclick="if(!confirm('Você está cancelando o Levantamento Contábil. Ao confirmar, essa operação não poderá ser revertida. Deseja continuar?')) return false;"
                                                                     disabled="#{registro.situacao ne 'AGUARDANDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                                                    <p:commandButton value="Remover Lançamento"
                                                                     icon="ui-icon-trash"
                                                                     styleClass="botaoCinza"
                                                                     actionListener="#{acaoFiscalControlador.removeRegistro(registro)}"
                                                                     update="@form"
                                                                     disabled="#{registro.situacao ne 'AGUARDANDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                                     style="height: 30px;color: black"
                                                                     onclick="if(!confirm('Você está removendo um registro e seus lançamentos contábeis. Ao confirmar, essa operação não poderá ser revertida. Deseja continuar?')) return false;"
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"/>
                                                    <p:commandButton id="autoinfracao${var.index}"
                                                                     value="Auto de Infração"
                                                                     style="height: 30px;color: black"
                                                                     disabled="#{!acaoFiscalControlador.podeGerarAuto(registro)
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                                     icon="ui-icon-copy"
                                                                     styleClass="botaoCinza" ajax="true"/>
                                                    <p:overlayPanel id="overAuto${var.index}"
                                                                    for="autoinfracao${var.index}"
                                                                    showEffect="blind"
                                                                    hideEffect="blind"
                                                                    style="width: 185px!important">
                                                        <p:commandButton
                                                            icon="ui-icon-print"
                                                            title="Imprimir Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                            style="height: 30px;color: black "
                                                            value="#{registro.autoInfracaoValido == null?'Gerar Novo Auto':'Imprimir Auto de Infração'}"
                                                            update=":formAutoInfracao"
                                                            actionListener="#{acaoFiscalControlador.preparaImpressaoAuto(registro)}"/>

                                                        <p:commandButton id="estornarAutoInfracao${var.index}"
                                                                         value="Estornar Auto de Infração"
                                                                         icon="ui-icon-cancel"
                                                                         styleClass="botaoCinza"
                                                                         disabled="#{registro.autoInfracaoValido == null}"
                                                                         actionListener="#{acaoFiscalControlador.novoEstornoAutoInfracao(registro.autoInfracaoValido)}"
                                                                         style="height: 30px;color: black "
                                                                         oncomplete="dialogEstornoAutoInfracao.show()"/>

                                                        <p:commandButton id="retificarAutoInfracao${var.index}"
                                                                         value="Retificar Auto de Infração"
                                                                         icon="ui-icon-pencil"
                                                                         styleClass="botaoCinza"
                                                                         disabled="#{registro.autoInfracaoValido == null or registro.situacao ne 'AUTO_INFRACAO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal ne 'REABERTO'}"
                                                                         actionListener="#{acaoFiscalControlador.novaRetificacaoAutoInfracao(registro.autoInfracaoValido)}"
                                                                         style="height: 30px;color: black "
                                                                         oncomplete="dialogRetificacaoAutoInfracao.show()"/>
                                                        <p:remoteCommand name="imprimeAuto" update="@form"/>
                                                    </p:overlayPanel>

                                                    <fc:botaoTargetBlank
                                                        actionListener="#{acaoFiscalControlador.imprimeDemonstrativo(registro)}"
                                                        label="Imprimir Demonstrativo"
                                                        rendered="#{registro.situacao ne 'ESTORNADO'}"
                                                        style="height: 30px" imprimeNoDialog="true"/>
                                                </h:panelGrid>
                                            </td>
                                        </tr>
                                    </table>

                                    <p:outputPanel id="panelLancementoPorAno${registro.id}"
                                                   rendered="#{registro.anoSelecionado ne null}">
                                        <ul class="nav nav-tabs">
                                            <c:forEach items="#{registro.lancamentosPorAno.keySet()}" var="lancamento"
                                                       varStatus="varTiriri">
                                                <li class="azulnegrito #{registro.anoSelecionado eq lancamento ? 'active' : ''}">
                                                    <p:commandLink value="#{lancamento}"
                                                                   style="text-decoration: none !important; font-weight: bold !important; color: #497692 !important;"
                                                                   actionListener="#{registro.selecionarLancamento(lancamento)}"
                                                                   update="panelLancementoPorAno${registro.id}"/>
                                                </li>
                                            </c:forEach>
                                        </ul>

                                        <p:outputPanel
                                            rendered="#{!acaoFiscalControlador.habilitarEdicaoIssLancado(registro.anoSelecionado, 1)}">
                                            <div class="alert mbot05">
                                                <b>No exercício de #{registro.anoSelecionado}</b>, o campo de ISS Lançado estará aberto para edição, para que seja discriminado o
                                                <b>ISSQN próprio</b>.
                                            </div>
                                        </p:outputPanel>
                                        <p:scrollPanel mode="native">
                                            <p:dataTable
                                                id="tableLancamentoContabil${registro.numeroRegistro}"
                                                style="font-size: 10px !important;"
                                                rowIndexVar="linhaRegistro"
                                                styleClass="lancamentoContabeis"
                                                value="#{registro.lancamentoSelecionado}"
                                                var="lancamentoContabil"
                                                emptyMessage="Nenhum registro encontrado.">
                                                <f:facet name="header">
                                                    <h:outputText
                                                        value="Lançamentos contábeis do exercício de ${registro.anoSelecionado}"/>
                                                </f:facet>
                                                <f:facet name="footer">
                                                    <h:outputText
                                                        value="Lançamentos contábeis do exercício de ${registro.anoSelecionado}"/>
                                                </f:facet>
                                                <p:column headerText="" style="text-align: center; width: 40px"
                                                          id="colunaBotoes">
                                                    <f:facet name="header">
                                                        <p:commandButton icon="ui-icon-check"
                                                                         styleClass="vinteLarguraVinteAltura"
                                                                         rendered="#{acaoFiscalControlador.containsTodosLancamentoParaMulta(registro, registro.anoSelecionado)}"
                                                                         actionListener="#{acaoFiscalControlador.removerTodosLancamentoParaMulta(registro, registro.anoSelecionado)}"
                                                                         update="tableLancamentoContabil${registro.numeroRegistro}"
                                                                         onstart="aguarde.show()"
                                                                         oncomplete="aguarde.hide()"/>
                                                        <p:commandButton value=" "
                                                                         styleClass="vinteLarguraVinteAltura"
                                                                         rendered="#{!acaoFiscalControlador.containsTodosLancamentoParaMulta(registro, registro.anoSelecionado)}"
                                                                         actionListener="#{acaoFiscalControlador.adicionarTodosLancamentoParaMulta(registro,registro.anoSelecionado)}"
                                                                         update="tableLancamentoContabil${registro.numeroRegistro}"
                                                                         onstart="aguarde.show()"
                                                                         oncomplete="aguarde.hide()"/>
                                                    </f:facet>
                                                    <p:commandButton icon="ui-icon-check"
                                                                     styleClass="vinteLarguraVinteAltura"
                                                                     rendered="#{acaoFiscalControlador.containsLancamentoParaMulta(lancamentoContabil)}"
                                                                     actionListener="#{acaoFiscalControlador.removerLancamentoParaMulta(lancamentoContabil)}"
                                                                     update="tableLancamentoContabil${registro.numeroRegistro}"
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"/>
                                                    <p:commandButton value=" "
                                                                     styleClass="vinteLarguraVinteAltura"
                                                                     rendered="#{!acaoFiscalControlador.containsLancamentoParaMulta(lancamentoContabil)}"
                                                                     actionListener="#{acaoFiscalControlador.adicionarLancamentoParaMulta(lancamentoContabil)}"
                                                                     update="tableLancamentoContabil${registro.numeroRegistro}"
                                                                     onstart="aguarde.show()"
                                                                     oncomplete="aguarde.hide()"/>
                                                </p:column>
                                                <p:column headerText="Seq." style="width: 30px">
                                                    <h:outputText value="#{lancamentoContabil.sequencia}"/>
                                                </p:column>
                                                <p:column headerText="Mês" style="width: 50px">
                                                    <h:outputText value="#{lancamentoContabil.mes.descricao}"/>
                                                </p:column>
                                                <p:column headerText="Ano" style="width: 35px">
                                                    <h:outputText value="#{lancamentoContabil.ano}"/>
                                                    <f:facet name="footer">
                                                        <h:outputText value="TOTAL:" styleClass="negrito"/>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Vlr Declarado" style="text-align: right">
                                                    <p:inputText value="#{lancamentoContabil.valorDeclarado}"
                                                                 styleClass="valor"
                                                                 onkeydown="mascaraPonto(this)"
                                                                 size="9" id="colValorDeclarado"
                                                                 label="Valor Declarado"
                                                                 style="border: 2px solid #6E95A6 !important;"
                                                                 disabled="#{registro.situacao ne 'AGUARDANDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'
                                           or !lancamentoContabil.tributado}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                        <p:ajax event="blur"
                                                                process="@this"
                                                                listener="#{acaoFiscalControlador.atualizarValoresTabelaLancamentoContabilComUpdate(lancamentoContabil, registro.numeroRegistro)}"
                                                                update="colIssPago colIssPagoOutPut colIssApurado colIssDevido colBaseCalculo juros multa correcao corrigido total"/>
                                                    </p:inputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Vlr Declarado"/><br/>
                                                        <h:outputText id="valorTatolDeclarado"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalDeclaradoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Vlr Apurado" style="text-align: right">
                                                    <p:inputText value="#{lancamentoContabil.valorApurado}"
                                                                 style="border: 2px solid #6E95A6 !important"
                                                                 size="9" id="colValorApurado"
                                                                 label="Valor Apurado"
                                                                 styleClass="valor"
                                                                 onkeydown="mascaraPonto(this)"
                                                                 disabled="#{registro.situacao ne 'AGUARDANDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'
                                           or !lancamentoContabil.tributado}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                        <p:ajax event="blur"
                                                                listener="#{acaoFiscalControlador.atualizarValoresTabelaLancamentoContabilComUpdate(lancamentoContabil, registro.numeroRegistro)}"
                                                                update="colIssPago colIssPagoOutPut colIssApurado colIssDevido colBaseCalculo juros multa correcao corrigido total"/>
                                                    </p:inputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Vlr Apurado"/><br/>
                                                        <h:outputText id="valorTotalApurado"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalApuradoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Base Cálculo" style="text-align: right">
                                                    <h:outputText value="#{lancamentoContabil.baseCalculo}"
                                                                  id="colBaseCalculo">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Base Cálculo"/><br/>
                                                        <h:outputText id="valorTotalBase"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalBaseCalculoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="% ISS" style="text-align: right">
                                                    <p:inputText value="#{lancamentoContabil.aliquotaISS}"
                                                                 size="4" id="colAliquotaISS" label="% ISS"
                                                                 style="border: 2px solid #6E95A6 !important"
                                                                 styleClass="valor"
                                                                 onkeydown="mascaraPonto(this)"
                                                                 disabled="#{registro.situacao ne 'AGUARDANDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                           or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'
                                           or !lancamentoContabil.tributado}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                        <p:ajax event="blur"
                                                                listener="#{acaoFiscalControlador.atualizarValoresTabelaLancamentoContabilComUpdate(lancamentoContabil, registro.numeroRegistro)}"
                                                                update="colIssPago colIssPagoOutPut colIssApurado colIssDevido colBaseCalculo juros multa correcao corrigido total"/>
                                                    </p:inputText>
                                                </p:column>
                                                <p:column headerText="ISS Lançado" style="text-align: right">
                                                    <h:outputText value="#{lancamentoContabil.issPago}"
                                                                  id="colIssPagoOutPut"
                                                                  rendered="#{acaoFiscalControlador.habilitarEdicaoIssLancado(lancamentoContabil.ano, lancamentoContabil.mes.numeroMes)}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <p:inputText value="#{lancamentoContabil.issPago}"
                                                                 size="8"
                                                                 id="colIssPago"
                                                                 label="ISS Lançado"
                                                                 style="border: 2px solid #6E95A6 !important"
                                                                 styleClass="valor"
                                                                 onkeydown="mascaraPonto(this)"
                                                                 rendered="#{!acaoFiscalControlador.habilitarEdicaoIssLancado(lancamentoContabil.ano, lancamentoContabil.mes.numeroMes)}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                        <p:ajax event="blur"
                                                                listener="#{acaoFiscalControlador.atualizarValoresTabelaLancamentoContabilComUpdate(lancamentoContabil, registro.numeroRegistro)}"
                                                                update="colIssPago colIssPagoOutPut colIssApurado colIssDevido colBaseCalculo juros multa correcao corrigido total"/>
                                                    </p:inputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="ISS Lançado"/><br/>
                                                        <h:outputText id="valorTotalIssPago"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalIssPagoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="ISS Apurado" style="text-align: right">
                                                    <h:outputText value="#{lancamentoContabil.issApurado}"
                                                                  id="colIssApurado">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="ISS Apurado"/><br/>
                                                        <h:outputText id="valorTotalIssApurado"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalIssApuradoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Saldo do ISS" style="text-align: right">
                                                    <h:outputText value="#{lancamentoContabil.issDevido}"
                                                                  id="colIssDevido">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Saldo ISS"/><br/>
                                                        <h:outputText id="valorTotalSaldo"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalIssDevidoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Correção Mon." style="text-align: right">
                                                    <h:outputText
                                                        value="#{lancamentoContabil.correcao}"
                                                        id="correcao">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Correção Mon."/><br/>
                                                        <h:outputText id="valorTotalCorrecao"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalCorrecaoMonetariaLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Valor Corrigido"
                                                          style="text-align: right">
                                                    <h:outputText value="#{lancamentoContabil.valorCorrigido}"
                                                                  id="corrigido">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Valor Corrigido"/><br/>
                                                        <h:outputText id="valorTotalCorrigido"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalCorrigidoLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Juros Mora" style="text-align: right">
                                                    <h:outputText
                                                        value="#{lancamentoContabil.juros}"
                                                        id="juros">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Juros Mora"/><br/>
                                                        <h:outputText id="valorTotalJuros"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalJurosMoraLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Multa Mora" style="text-align: right">
                                                    <h:outputText
                                                        value="#{lancamentoContabil.multa}"
                                                        id="multa">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Multa Mora"/><br/>
                                                        <h:outputText id="valorTotalMulta"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalMultaMoraLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>
                                                <p:column headerText="Valor Total" style="text-align: right">
                                                    <h:outputText
                                                        value="#{acaoFiscalControlador.calculaTotalLancamento(lancamentoContabil)}"
                                                        id="total">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputText>
                                                    <f:facet name="footer">
                                                        <h:outputText value="Valor Total"/><br/>
                                                        <h:outputText id="valorTotal"
                                                                      value="#{acaoFiscalControlador.retornarValorTotalTotalLancamento(registro.anoSelecionado, registro)}"
                                                                      styleClass="negrito">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </f:facet>
                                                </p:column>

                                                <p:column headerText="Operações"
                                                          style="width: 85px; text-align: center">
                                                    <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                                                        <p:commandButton icon="ui-icon-note"
                                                                         title="Notas Fiscais"
                                                                         styleClass="botao-transparente icone_vermelho"
                                                                         actionListener="#{acaoFiscalControlador.verNotasFiscaisDoLancamento(lancamentoContabil)}"
                                                                         update=":formNotasFiscaisDoLancamento"
                                                                         onclick="aguarde.show()"
                                                                         oncomplete="aguarde.hide(); notasFiscaisDoLancamento.show()"
                                                                         disabled="#{registro.situacao ne 'AGUARDANDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                                                        <p:commandButton icon="ui-icon-arrowthickstop-1-s"
                                                                         title="Duplicar lançamento"
                                                                         onclick="if(!confirm('Deseja duplicar este lançamento?')) return false;"
                                                                         styleClass="botao-transparente icone_azul"
                                                                         actionListener="#{acaoFiscalControlador.duplicarLancamentoContabil(lancamentoContabil, registro)}"
                                                                         disabled="#{registro.situacao ne 'AGUARDANDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                                         update="tableLancamentoContabil${registro.numeroRegistro}"/>
                                                        <p:commandButton icon="ui-icon-trash"
                                                                         title="Remover lançamento"
                                                                         onclick="if(!confirm('Deseja remover este lançamento?')) return false;"
                                                                         styleClass="botao-transparente icone_vermelho"
                                                                         actionListener="#{acaoFiscalControlador.excluirLancamentoContabil(lancamentoContabil, registro)}"
                                                                         update="tableLancamentoContabil${registro.numeroRegistro}"
                                                                         disabled="#{registro.situacao ne 'AGUARDANDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>
                                                    </h:panelGrid>
                                                </p:column>
                                            </p:dataTable>
                                        </p:scrollPanel>

                                        <p:commandButton value="Salvar Exercício #{registro.anoSelecionado}"
                                                         onstart="salvarAcaoFiscal();"
                                                         icon="ui-icon-check"
                                                         styleClass="operacao mtop05"
                                                         disabled="#{registro.situacao ne 'AGUARDANDO'}"
                                                         actionListener="#{acaoFiscalControlador.atribuirExercicioSalvar(registro.numeroRegistro, registro.anoSelecionado)}"
                                                         title="Clique para salvar o exercício de #{registro.anoSelecionado}"/>

                                        <p:commandButton
                                            value="Excluir Lançamentos Selecionados #{registro.anoSelecionado}"
                                            onclick="if(!confirm('Tem certeza que deseja excluir os lançamentos selecionados?')) {return true} else {aguarde.show();}"
                                            oncomplete="aguarde.hide()"
                                            icon="ui-icon-trash"
                                            styleClass="operacao mtop05"
                                            disabled="#{registro.situacao ne 'AGUARDANDO'}"
                                            process="panelLancementoPorAno${registro.id}"
                                            update="panelLancementoPorAno${registro.id}"
                                            actionListener="#{acaoFiscalControlador.excluirLancamentosContabil(registro)}"
                                            title="Clique para remover os lançamentos selecionados do exercício de #{registro.anoSelecionado}"/>
                                    </p:outputPanel>
                                </p:panel>
                                <br/>
                            </c:forEach>
                        </h:panelGroup>
                    </p:tab>
                    <p:tab title="5 - Multas" id="tabMultas">
                        <p:outputPanel id="painelMultas">
                            <c:forEach items="#{acaoFiscalControlador.selecionado.lancamentosContabeis}" var="registro"
                                       varStatus="var">
                                <p:panel header="Registro #{registro.numeroRegistro}/#{registro.ano}"
                                         rendered="#{registro.multas.size() >0}">
                                    <h:panelGrid columns="2">
                                        <h:outputText value="Processo Adm: "/>
                                        <h:outputText value="#{registro.numeroProcessoAdministrativo}"
                                                      styleClass="azulnegrito"/>
                                        <h:outputText value="Situação: "/>
                                        <h:outputText value="#{registro.situacao.descricao}" styleClass="azulnegrito"/>
                                    </h:panelGrid>
                                    <p:dataTable id="tableMultas${var.index}"
                                                 value="#{registro.multas}" var="multas"
                                                 widgetVar="tabelaMulta"
                                                 emptyMessage="Nenhum registro encontrado.">
                                        <f:facet name="header">
                                            <h:outputText
                                                value="Multas do Registro #{registro.numeroRegistro}/#{registro.ano}"/>
                                        </f:facet>
                                        <f:facet name="footer">
                                            <h:outputText
                                                value="Multas do Registro #{registro.numeroRegistro}/#{registro.ano}"/>
                                        </f:facet>
                                        <p:column headerText="" style="text-align: center; width: 40px"
                                                  id="colunaBotoesMulta">
                                            <f:facet name="header">
                                                <p:commandButton icon="ui-icon-check"
                                                                 styleClass="vinteLarguraVinteAltura"
                                                                 rendered="#{acaoFiscalControlador.todasMultasSelecionadas(registro)}"
                                                                 actionListener="#{acaoFiscalControlador.naoSelecionarTodasMultas(registro)}"
                                                                 update="tableMultas${var.index}"
                                                                 onstart="aguarde.show()"
                                                                 oncomplete="aguarde.hide()"/>
                                                <p:commandButton value=" "
                                                                 styleClass="vinteLarguraVinteAltura"
                                                                 rendered="#{!acaoFiscalControlador.todasMultasSelecionadas(registro)}"
                                                                 actionListener="#{acaoFiscalControlador.selecionarTodasMultas(registro)}"
                                                                 update="tableMultas${var.index}"
                                                                 onstart="aguarde.show()"
                                                                 oncomplete="aguarde.hide()"/>
                                            </f:facet>
                                            <p:commandButton icon="ui-icon-check"
                                                             styleClass="vinteLarguraVinteAltura"
                                                             rendered="#{acaoFiscalControlador.multaSelecionada(multas)}"
                                                             actionListener="#{acaoFiscalControlador.naoSelecionarMulta(multas)}"
                                                             update="tableMultas${var.index}"
                                                             onstart="aguarde.show()"
                                                             oncomplete="aguarde.hide()"/>
                                            <p:commandButton value=" "
                                                             styleClass="vinteLarguraVinteAltura"
                                                             rendered="#{!acaoFiscalControlador.multaSelecionada(multas)}"
                                                             actionListener="#{acaoFiscalControlador.selecionarMulta(multas)}"
                                                             update="tableMultas${var.index}"
                                                             onstart="aguarde.show()"
                                                             oncomplete="aguarde.hide()"/>
                                        </p:column>
                                        <p:column headerText="Registro">
                                            <h:outputText value="#{multas.registroLancamentoContabil}"/>
                                        </p:column>
                                        <p:column headerText="Referência" style="text-align: left">
                                            <h:outputText
                                                value="#{acaoFiscalControlador.montarReferenciaMulta(multas)}"/>
                                        </p:column>
                                        <p:column headerText="Multa" style="text-align: left">
                                            <h:outputText value="#{multas.multaFiscalizacao.artigo}"/>
                                            <f:facet name="footer">
                                                <h:outputText value="Total: " styleClass="negrito"/>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Valor (R$)" style="text-align: right">
                                            <h:outputText value="#{multas.valorMulta}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="#{acaoFiscalControlador.retornarValorTotalMulta()}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Valor (UFM)" style="text-align: right">
                                            <h:outputText value="#{multas.valorMultaIndice}">
                                                <f:convertNumber pattern="#,##0.0000"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText
                                                    value="#{acaoFiscalControlador.retornarValorTotalMultaIndice()}"
                                                    styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.0000"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Alíquota (%)" style="text-align: right">
                                            <h:outputText value="#{multas.aliquota}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Base de Cálculo" style="text-align: right">
                                            <h:outputText value="#{multas.baseCalculo}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Operações" style="text-align: center">
                                            <p:commandButton icon="ui-icon-trash" title="Remover multa"
                                                             styleClass="icone_vermelho botao-transparente"
                                                             actionListener="#{acaoFiscalControlador.excluirMultaLancada(multas, registro)}"
                                                             disabled="#{registro.situacao ne 'AGUARDANDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO' or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                             update="@form"/>
                                            <p:commandButton icon="ui-icon-info"
                                                             styleClass="icone_azul botao-transparente"
                                                             title="Ver informações da multa"
                                                             actionListener="#{acaoFiscalControlador.recuperaMulta(multas)}"
                                                             onclick="dialogInfoMulta.show()" update=":formInfoMulta"/>
                                        </p:column>
                                    </p:dataTable>

                                    <p:commandButton
                                        value="Excluir Multas Selecionadas #{registro.anoSelecionado}"
                                        onclick="if(!confirm('Tem certeza que deseja excluir as multas selecionadas?')) {return true} else {aguarde.show();}"
                                        oncomplete="aguarde.hide()"
                                        icon="ui-icon-trash"
                                        styleClass="operacao mtop05"
                                        disabled="#{registro.situacao ne 'AGUARDANDO'}"
                                        process="painelMultas"
                                        update="painelMultas"
                                        actionListener="#{acaoFiscalControlador.excluirMultas(registro)}"
                                        title="Clique para excluir as multas selecionadas do exercício de #{registro.anoSelecionado}"/>
                                </p:panel>
                                <br/>
                            </c:forEach>
                        </p:outputPanel>
                    </p:tab>
                    <p:tab title="Anexos">
                        <p:tabView>
                            <p:tab title="Anexos Ação Fiscal">
                                <p:outputPanel style="border: 0" id="panelAnexos">
                                    <p:fileUpload
                                        multiple="true"
                                        cancelLabel="Cancelar"
                                        sizeLimit="10485760"
                                        invalidSizeMessage="Arquivo maior que 10 MB"
                                        label="Selecione..."
                                        mode="advanced"
                                        uploadLabel="Upload Arquivo"
                                        fileUploadListener="#{acaoFiscalControlador.uploadArquivo}"
                                        update="panelAnexos"
                                        auto="false"/>
                                    <br/>
                                    <p:dataTable value="#{acaoFiscalControlador.selecionado.arquivos}"
                                                 emptyMessage="Nenhum Arquivo foi anexado"
                                                 id="tabelaAnexos"
                                                 paginator="true"
                                                 editable="true"
                                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                                 rowIndexVar="rowIx"
                                                 styleClass="mtop05"
                                                 rows="10"
                                                 paginatorTemplate="{CurrentPageReport}  &lt;spanclass='titulo-tabela mrig10'>ANEXOS AÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                 currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                 rowsPerPageTemplate="10,25,50,100"
                                                 var="arquivo">

                                        <p:column headerText="Ações"
                                                  style="text-align: center; width: 5%; ">
                                            <h:panelGrid columns="2" cellspacing="0">
                                                <p:commandButton rendered="#{arquivo.arquivo.id eq null}"
                                                                 id="downloadLink" ajax="false"
                                                                 icon="ui-icon-arrowthickstop-1-s"
                                                                 title="Download do Arquivo"
                                                                 process="@form" update="@this"
                                                                 styleClass="mrig05"
                                                                 onstart="aguarde.show()"
                                                                 oncomplete="aguarde.hide()">
                                                    <p:fileDownload value="#{acaoFiscalControlador.download(arquivo)}"/>
                                                </p:commandButton>
                                                <p:outputPanel rendered="#{arquivo.arquivo.id ne null}">
                                                    <a href='${facesContext.externalContext.requestContextPath}/arquivos/#{arquivo.arquivo.nome}?id=#{arquivo.arquivo.id}'>
                                                        <p:button icon="ui-icon-arrowthickstop-1-s"
                                                                  styleClass="mrig05"
                                                                  title="Download do Arquivo"/>
                                                    </a>
                                                </p:outputPanel>
                                                <p:commandButton icon="ui-icon-trash"
                                                                 update="tabelaAnexos"
                                                                 process="@this"
                                                                 styleClass="mrig05"
                                                                 actionListener="#{acaoFiscalControlador.removeAnexo(arquivo)}"
                                                                 onclick="if(!confirm('Tem certeza que deseja remover este registro?')) {return true} else {statusDialog.show();}"
                                                                 oncomplete="statusDialog.hide();"/>
                                            </h:panelGrid>
                                        </p:column>
                                        <p:column headerText="Tamanho">
                                            <h:outputText value="#{arquivo.arquivo.tamanho}"/>
                                        </p:column>
                                        <p:column headerText="Nome">
                                            <h:outputText value="#{arquivo.arquivo.nome}"/>
                                        </p:column>
                                        <p:column headerText="Descrição">
                                            <p:inputText value="#{arquivo.arquivo.descricao}" style="width: 95%"
                                                         rendered="#{arquivo.arquivo.descricao eq null}"
                                                         maxlength="255"/>
                                            <h:outputText value="#{arquivo.arquivo.descricao}" style="width: 95%"
                                                          rendered="#{arquivo.arquivo.descricao ne null}"
                                                          maxlength="255"/>
                                        </p:column>
                                        <p:column headerText="Tipo Documento Anexo"
                                                  style="text-align:center; width: 5%;">
                                            <h:selectOneMenu rendered="#{arquivo.tipoDocumentoAnexo eq null}"
                                                             value="#{arquivo.tipoDocumentoAnexo}">
                                                <f:selectItems value="#{acaoFiscalControlador.tiposDocumentosAnexos}"/>
                                            </h:selectOneMenu>
                                            <h:outputText value="#{arquivo.tipoDocumentoAnexo.descricao}"
                                                          rendered="#{arquivo.tipoDocumentoAnexo ne null}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                            </p:tab>
                            <p:tab title="Anexos Programação Fiscal">
                                <p:dataTable paginator="true"
                                             id="tabela-arquivos"
                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             rowIndexVar="rowIx"
                                             styleClass="mtop05"
                                             emptyMessage="Não foram localizados registros para serem apresentados"
                                             value="#{acaoFiscalControlador.programacaoRecuperada.detentorArquivoComposicao.arquivosComposicao}"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport}  &lt;spanclass='titulo-tabela mrig10'>ANEXOS PROGRAMAÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                             rowsPerPageTemplate="10,25,50,100"
                                             var="arquivoComposicao">
                                    <p:column headerText="Ações"
                                              style="text-align: center; width: 5%; ">
                                        <h:panelGrid columns="2">
                                            <p:outputPanel rendered="#{arquivoComposicao.arquivo.id ne null}">
                                                <a href='${facesContext.externalContext.requestContextPath}/arquivos/#{arquivoComposicao.arquivo.nome}?id=#{arquivoComposicao.arquivo.id}'>
                                                    <p:button icon="ui-icon-arrowthickstop-1-s"
                                                              styleClass="mrig05"
                                                              title="Download do Arquivo"/>
                                                </a>
                                            </p:outputPanel>
                                        </h:panelGrid>
                                    </p:column>
                                    <p:column headerText="Descrição" style="width: 100%;">
                                        <h:outputText value="#{arquivoComposicao.arquivo.descricao}" size="100"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                        <br/>
                    </p:tab>
                    <p:tab title="E-mail">
                        <p:outputPanel id="panelEmail">
                            <table style="width: 100%">
                                <tr>
                                    <td style="width: 85%" valign="top">
                                        <table style="width: 90%">
                                            <tr>
                                                <td>
                                                    <table style="width: 90%">
                                                        <tr>
                                                            <td style="width:10%;">
                                                            </td>
                                                            <td style="width:90%;">
                                                                <div class="alert warn"
                                                                     style="width:90%; text-align: center">
                                                                    Por favor digite os e-mails de envio separados por (",")
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width:10%;">
                                                                <fc:outputLabelObrigatorio value="E-mail(s): "
                                                                                           for="emails"/>
                                                            </td>
                                                            <td style="width:90%;">
                                                                <p:inputTextarea
                                                                    id="emails"
                                                                    style="width: 100% !important;"
                                                                    value="#{acaoFiscalControlador.emails}"
                                                                    rows="1" cols="70" maxlength="255"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width:10%;">
                                                                <fc:outputLabelObrigatorio value="Mensagem:"
                                                                                           for="mensagem"/>
                                                            </td>
                                                            <td style="width:90%;">
                                                                <p:inputTextarea
                                                                    title="Informe a mensagem do e-mail."
                                                                    value="#{acaoFiscalControlador.mensagemEmail}"
                                                                    maxlength="255"
                                                                    cols="70"
                                                                    rows="4"
                                                                    id="mensagem"
                                                                    counter="counterMensagem"
                                                                    counterTemplate="{0} Caracteres restantes."
                                                                    style="width: 100% !important;"
                                                                    autoResize="true"/>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td style="width:10%;"/>
                                                            <td style="width:90%;">
                                                                <table style="width: 100%">
                                                                    <tr>
                                                                        <td>
                                                                            <p:commandButton value="Enviar e-mail"
                                                                                             icon="ui-icon-arrowreturnthick-1-n"
                                                                                             onclick="aguarde.show()"
                                                                                             oncomplete="aguarde.hide()"
                                                                                             update="panelEmail"
                                                                                             styleClass="operacao "
                                                                                             actionListener="#{acaoFiscalControlador.enviarEmailAcaoFiscal()}"/>
                                                                        </td>
                                                                        <td style="text-align: right">
                                                                            <h:outputText id="counterMensagem"/>

                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td style="width: 15%" valign="top">
                                        <p:panel header="Anexos do E-mail" id="emailAnexo">
                                            <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
                                                <h:outputText value="Tipo Documento:"/>
                                                <p:selectOneRadio value="#{acaoFiscalControlador.emailAnexo}">
                                                    <f:selectItem itemLabel="Anexos Ação Fiscal" itemValue="true"/>
                                                    <f:selectItem itemLabel="Documentos Oficiais" itemValue="false"/>
                                                    <p:ajax event="change"
                                                            update="emailAnexo tabelaAnexosEmail tabelaDocEmail"
                                                            onstart="aguarde.show()"
                                                            oncomplete="aguarde.hide()"
                                                            listener="#{acaoFiscalControlador.limparSelecionados()}"/>
                                                </p:selectOneRadio>
                                            </h:panelGrid>
                                            <p:dataTable id="tabelaAnexosEmail"
                                                         value="#{acaoFiscalControlador.arquivosAnexosFiscais}"
                                                         var="anexo"
                                                         rendered="#{acaoFiscalControlador.emailAnexo}"
                                                         paginator="true"
                                                         rows="5"
                                                         paginatorPosition="top"
                                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ANEXOS AÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                         rowsPerPageTemplate="25,50,100"
                                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                                         rowIndexVar="index">
                                                <p:column headerText="Selecionar" style="width: 5%; text-align: center">
                                                    <p:commandButton
                                                        actionListener="#{acaoFiscalControlador.removerAnexoSelecionado(anexo)}"
                                                        icon="ui-icon-check"
                                                        id="btnDesmarcarAnexo"
                                                        onclick="aguarde.show()"
                                                        oncomplete="aguarde.hide()"
                                                        title="Clique para desmarcar este anexo."
                                                        rendered="#{anexo.selecionado}"
                                                        process="@this"
                                                        update="tabelaAnexosEmail"
                                                        styleClass="vinteLarguraVinteAltura botao_verde icone_branco">
                                                    </p:commandButton>

                                                    <p:commandButton
                                                        actionListener="#{acaoFiscalControlador.selecionarAnexo(anexo)}"
                                                        icon="ui-icon-none"
                                                        id="btnSelecionarAnexo"
                                                        disabled="#{acaoFiscalControlador.anexoSelecionado ne null}"
                                                        onclick="aguarde.show();"
                                                        rendered="#{!anexo.selecionado}"
                                                        oncomplete="aguarde.hide()"
                                                        title="Clique para marcar este anexo."
                                                        process="@this"
                                                        update="tabelaAnexosEmail"
                                                        styleClass="vinteLarguraVinteAltura botao_vermelho icone_branco">
                                                    </p:commandButton>
                                                </p:column>
                                                <p:column headerText="Documento" style="width: 95%">
                                                    <h:outputText value="#{anexo.arquivo.descricao}"
                                                                  rendered="#{anexo.arquivo.descricao ne null}"/>
                                                    <h:outputText value="#{anexo.arquivo.nome}"
                                                                  rendered="#{anexo.arquivo.descricao eq null}"/>
                                                </p:column>
                                            </p:dataTable>

                                            <p:dataTable id="tabelaDocEmail"
                                                         value="#{acaoFiscalControlador.documentosAcaoFiscal}"
                                                         var="doc"
                                                         rendered="#{!acaoFiscalControlador.emailAnexo}"
                                                         paginator="true"
                                                         rows="5"
                                                         paginatorPosition="top"
                                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>DOCUMENTOS AÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                         rowsPerPageTemplate="25,50,100"
                                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                                         rowIndexVar="index">
                                                <p:column headerText="Selecionar" style="width: 5%; text-align: center">
                                                    <p:commandButton
                                                        actionListener="#{acaoFiscalControlador.removerDocumentoSelecionado()}"
                                                        icon="ui-icon-check"
                                                        id="btnDesmacarDoc"
                                                        onclick="aguarde.show()"
                                                        oncomplete="aguarde.hide()"
                                                        title="Clique para desmarcar este documento."
                                                        rendered="#{doc.documento eq acaoFiscalControlador.documentoSelecionado}"
                                                        process="@this"
                                                        update="tabelaDocEmail"
                                                        styleClass="vinteLarguraVinteAltura botao_verde icone_branco">
                                                    </p:commandButton>

                                                    <p:commandButton
                                                        actionListener="#{acaoFiscalControlador.selecionarDocumento(doc.documento)}"
                                                        icon="ui-icon-none"
                                                        id="btnSelecionarDoc"
                                                        disabled="#{acaoFiscalControlador.documentoSelecionado ne null}"
                                                        onclick="aguarde.show();"
                                                        rendered="#{doc.documento ne acaoFiscalControlador.documentoSelecionado}"
                                                        oncomplete="aguarde.hide()"
                                                        title="Clique para marcar este documento."
                                                        process="@this"
                                                        update="tabelaDocEmail"
                                                        styleClass="vinteLarguraVinteAltura botao_vermelho icone_branco">
                                                    </p:commandButton>
                                                </p:column>
                                                <p:column headerText="Documento" style="width: 95%">
                                                    <h:outputText value="#{doc.identificacao} - #{doc.nome}"/>
                                                </p:column>
                                            </p:dataTable>
                                        </p:panel>
                                    </td>
                                </tr>
                            </table>
                            <p:dataTable id="tabela-emails-enviados"
                                         value="#{acaoFiscalControlador.comunicacoesAcaoFiscal}"
                                         var="comunicacao"
                                         paginator="true"
                                         rows="5"
                                         style="margin-top: 15px"
                                         paginatorPosition="top"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>COMUNICAÇÕES ENVIADAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="5,10,25,50,100"
                                         emptyMessage="Não foram localizados registros para serem apresentados."
                                         rowIndexVar="index">
                                <p:column headerText="Usuário">
                                    <h:outputText value="#{comunicacao.usuario.login}"/>
                                </p:column>
                                <p:column headerText="Arquivo">
                                    <h:outputText value="#{comunicacao.nomeArquivo}"/>
                                </p:column>
                                <p:column headerText="E-mail(s)">
                                    <h:outputText value="#{comunicacao.emailsEnvio}"/>
                                </p:column>
                                <p:column headerText="Mensagem">
                                    <h:outputText value="#{comunicacao.textoEmail}"/>
                                </p:column>
                                <p:column headerText="Data Envio" style="text-align: center">
                                    <h:outputText value="#{comunicacao.dataEnvioEmail}">
                                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                                    </h:outputText>
                                </p:column>

                            </p:dataTable>
                        </p:outputPanel>
                    </p:tab>
                </p:tabView>
                <br/>
                <table border="0" style="width: 100%">
                    <tr>
                        <td>
                            <h:outputText value="Conclusão: "/>
                        </td>
                        <td style="width: 95%">
                            <p:inputTextarea value="#{acaoFiscalControlador.selecionado.conclusao}"
                                             rows="3"
                                             style="width: 99%"/>
                        </td>
                    </tr>
                </table>


            </p:panel>
            <br/>
            <p:panel visible="#{!acaoFiscalControlador.podeEditar}">
                <div class="ui-messages-warn ui-corner-all">
                    <div class="ui-messages-warn-icon"/>
                    &nbsp;
                    Para salvar a ação fiscal é necessário estar entre os fiscais designados.
                </div>
            </p:panel>

            <p:commandButton title="Clique para salvar o registro."
                             icon="ui-icon-disk" update=":Formulario"
                             value="Salvar"
                             process="@this" onstart="salvarAcaoFiscalToda()"
                             disabled="#{!acaoFiscalControlador.podeEditar}"
                             styleClass="operacao prioritario mrig05 mtop10"/>

            <fc:rodapePretty controlador="#{acaoFiscalControlador}" nomeBotaoCancelar="Fechar"
                             ocultarSalvar="true"/>
        </h:form>
        <p:dialog id="dialogImprimirDoctoDlg" width="1000" height="500" modal="true" widgetVar="dialogImprimirDocto"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Impressão de Documentos" resizable="false">
            <h:form id="formImprimirDocto">
                <h:panelGrid style="text-align: center; width: 100%; font-weight: bold;"
                             rendered="#{acaoFiscalControlador.desabilitaEditorDocumento()}">
                    <div class="ui-messages-info ui-corner-all">
                        <div class="ui-messages-info-icon"/>
                        &nbsp;
                        Impossível fazer alteração! Não é permitido fazer qualquer alteração no documento, pois o tipo de documento #{acaoFiscalControlador.documentoOficial.modeloDoctoOficial.tipoDoctoOficial.descricao} não permite.
                    </div>
                </h:panelGrid>
                <p:panel rendered="#{acaoFiscalControlador.documentoOficial == null}">
                    <div class="ui-messages-info ui-corner-all">
                        <div class="ui-messages-info-icon"/>
                        &nbsp;
                        Este Documento não pode ser Impresso, verifique o log de mensagens para obter as informações necessárias de impressão desse documento.
                    </div>
                </p:panel>
                <p:panel style="overflow-y: auto;
                         overflow-x: hidden;
                         max-height: 500px !important;"
                         rendered="#{acaoFiscalControlador.documentoOficial != null}">
                    <p:editor value="#{acaoFiscalControlador.documentoOficial.conteudo}"
                              id="modelo" width="940"
                              disabled="#{acaoFiscalControlador.desabilitaEditorDocumento()}"
                              height="430" widgetVar="conteudos">
                    </p:editor>
                </p:panel>
                <br/>

                <div style="width: 100%; text-align: center">
                    <fc:botaoTargetBlank actionListener="#{acaoFiscalControlador.imprimirDocumento()}" label="Imprimir"
                                         styleClass="operacao prioritario" imprimeNoDialog="true"/>

                    <p:commandButton value="Fechar" icon="ui-icon-close"
                                     onclick="dialogImprimirDocto.hide()"
                                     styleClass="operacao"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog id="dialogLevantamentoContabilDlg" width="700" modal="true" widgetVar="dialogLevantamentoContabil"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Levantamento Contábil" resizable="false">
            <h:form id="formLevantamentoContabil">
                <p:panel>
                    <h:panelGrid columns="3">
                        <h:outputText value="Data: "/>
                        <p:calendar value="#{acaoFiscalControlador.dataParaValorIndice}" id="dataParaIndice"
                                    pattern="dd/MM/yyyy">
                        </p:calendar>
                        <p:commandButton value="Pesquisar Índice"
                                         actionListener="#{acaoFiscalControlador.getValorIndicePorData}"
                                         update=":formLevantamentoContabil"/>

                        <h:outputText value="Valor: "/>
                        <p:inputText id="valorIndiceEncontrado" value="#{acaoFiscalControlador.valorIndiceEncontrado}">
                            <f:convertNumber pattern="###,###,##0.00"/>
                        </p:inputText>
                        <p:spacer/>
                    </h:panelGrid>
                    <p:commandButton value="Confirmar" styleClass="botao_azul icone_branco" icon="ui-icon-check"
                                     update=":formLevantamentoContabil :Formulario"
                                     actionListener="#{acaoFiscalControlador.confirmarAlteracaoLevantamento()}"
                                     oncomplete="dialogLevantamentoContabil.hide()"/>
                    <p:commandButton value="Fechar" icon="ui-icon-close" onclick="dialogLevantamentoContabil.hide()"
                                     styleClass="botao_azul icone_branco"/>
                </p:panel>
            </h:form>
        </p:dialog>
        <p:dialog id="dialogEstornoAutoInfracaoDlg" width="700"
                  modal="true" widgetVar="dialogEstornoAutoInfracao"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Estorno do Auto de Infração"
                  resizable="false" closable="false">
            <h:form id="formEstornoAutoInfracao">
                <p:panel>
                    <h:panelGrid columns="2">
                        <h:outputText value="Data: "/>
                        <h:outputText value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.dataEstorno}"
                                      styleClass="negrito">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <fc:outputLabelObrigatorio value="Motivo: "/>
                        <p:inputTextarea id="motivoEstorno"
                                         value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.motivoEstorno}"
                                         cols="80" maxlength="500"
                                         counter="counterEstorno"
                                         counterTemplate="{0} Caracteres Restantes."
                                         rows="5" autoResize="false">
                        </p:inputTextarea>

                        <p:spacer/>
                        <h:panelGroup>
                            <div style="width: 100%; text-align: right">
                                <h:outputText id="counterEstorno" styleClass="azulnegrito"/>
                            </div>
                        </h:panelGroup>
                    </h:panelGrid>
                </p:panel>
                <br/>

                <div style="width: 100%; text-align: center">
                    <p:commandButton value="Confirmar" styleClass="operacao prioritario" icon="ui-icon-check"
                                     update=":formEstornoAutoInfracao :Formulario"
                                     actionListener="#{acaoFiscalControlador.estornarAutoInfracao()}"
                                     onclick="aguarde.show()"
                                     onsuccess="aguarde.hide()"
                                     oncomplete="dialogEstornoAutoInfracao.hide()"/>
                    <p:commandButton value="Fechar" icon="ui-icon-close" oncomplete="dialogEstornoAutoInfracao.hide()"
                                     styleClass="operacao"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogRetificacaoAutoInfracaoDlg" width="700"
                  modal="true" widgetVar="dialogRetificacaoAutoInfracao"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Retificação do Auto de Infração"
                  resizable="false" closable="false">
            <h:form id="formRetificacaoAutoInfracao">
                <p:panel>
                    <h:panelGrid columns="2">
                        <h:outputText value="Data: "/>
                        <h:outputText value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.dataEstorno}"
                                      styleClass="negrito">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <fc:outputLabelObrigatorio value="Motivo: "/>
                        <p:inputTextarea id="motivoRetificacao"
                                         value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.motivoEstorno}"
                                         cols="80" maxlength="500"
                                         counter="counterRetificacao"
                                         counterTemplate="{0} Caracteres Restantes."
                                         rows="5" autoResize="false">
                        </p:inputTextarea>

                        <p:spacer/>
                        <h:panelGroup>
                            <div style="width: 100%; text-align: right">
                                <h:outputText id="counterRetificacao" styleClass="azulnegrito"/>
                            </div>
                        </h:panelGroup>
                    </h:panelGrid>
                </p:panel>
                <br/>
                <p:commandButton value="Confirmar" styleClass="operacao prioritario" icon="ui-icon-check"
                                 update=":formRetificacaoAutoInfracao :Formulario"
                                 actionListener="#{acaoFiscalControlador.retificarAutoInfracao()}"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide(); dialogRetificacaoAutoInfracao.hide()"/>
                <p:commandButton value="Fechar" icon="ui-icon-close" oncomplete="dialogRetificacaoAutoInfracao.hide()"
                                 styleClass="operacao"/>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogInfoMultaDlg" width="700" modal="true" widgetVar="dialogInfoMulta"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Multa"
                  resizable="false">
            <h:form id="formInfoMulta">
                <center>
                    <h:outputText styleClass="azulnegrito " value="Detalhes da Multa"/>
                    <br/>
                    <h:panelGrid columns="2" styleClass="margem-superior-dez-pixels">
                        <h:outputText value="Descrição:"/>
                        <h:outputText value="#{acaoFiscalControlador.lancamentoMultaFiscalRecuperada.descricao}"
                                      styleClass="negrito"/>
                        <h:outputText value="Observação:"/>
                        <h:outputText value="#{acaoFiscalControlador.lancamentoMultaFiscalRecuperada.observacao}"
                                      styleClass="negrito"/>
                    </h:panelGrid>
                    <br/>
                    <p:commandButton value="Sair" icon="ui-icon-cancel" onclick="dialogInfoMulta.hide()"/>
                </center>
            </h:form>
        </p:dialog>
        <p:dialog id="lancamentoContabilDlg" width="700" modal="true" widgetVar="lancamentoContabil"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  showHeader="false"
                  resizable="false">
            <h:form id="formLancamentoContabil">
                <p:panel>
                    <div style="text-align: center" class="alert">
                        <h:outputText
                            value="Ao confirmar, essa operação não pode ser revertida, será criado um novo registro de lançamentos contábeis para esta ação fiscal."/>
                        <br/>
                        <br/>
                        <h:outputText
                            value="Deseja continuar?" styleClass="negrito"/>
                    </div>
                    <h:panelGrid columns="1" styleClass="centralizado" style="width: 100%">
                        <h:outputText value="Número do Registro" styleClass="azulnegrito"/>
                        <p:inputText readonly="true" styleClass="campo-bloqueado" style="text-align: center"
                                     value="#{acaoFiscalControlador.registro.numeroRegistro}/#{acaoFiscalControlador.registro.ano}"/>
                        <h:outputText value="Informe o Processo Administrativo" styleClass="azulnegrito"/>
                        <p:inputText size="30" value="#{acaoFiscalControlador.registro.numeroProcessoAdministrativo}"
                                     maxlength="15"/>
                    </h:panelGrid>
                    <br/>
                    <center>
                        <p:commandButton value="Continuar" icon="ui-icon-triangle-1-e"
                                         title="Carregar lançamentos contábeis"
                                         id="botaoCarregarMeses"
                                         actionListener="#{acaoFiscalControlador.carregarMesesLancamentoContabil()}"
                                         onstart="aguarde.show()"
                                         styleClass="operacao prioritario"
                                         oncomplete="lancamentoContabil.hide();aguarde.hide();"
                                         update=":Formulario"/>
                        <p:commandButton value="Cancelar" icon="ui-icon-cancel" title="cancelar e fechar"
                                         onclick="lancamentoContabil.hide()" styleClass="operacao"/>
                    </center>
                </p:panel>
            </h:form>
        </p:dialog>
        <p:dialog id="lancamentoMultaDlg" closable="false" width="850" modal="true" widgetVar="lancamentoMulta"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Lançamento de Multas"
                  resizable="false">
            <h:form id="formLancamentoMulta">
                <p:panel id="panelMultas" style="max-height: 300px; overflow: auto">
                    <center>
                        <h:panelGrid columns="2">
                            <h:outputText value="Registro: "/>
                            <h:outputText styleClass="azulnegrito"
                                          value="#{acaoFiscalControlador.lancamentoMultaFiscal.registroLancamentoContabil.numeroAno}"/>

                            <h:outputText value="Multa: "/>
                            <h:panelGroup>
                                <p:autoComplete queryDelay="1000" id="multaAutoComp"
                                                value="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao}"
                                                completeMethod="#{acaoFiscalControlador.completarMulta}"
                                                converter="#{multaFiscalizacaoControlador.converterGenerico}"
                                                var="multa" dropdown="true"
                                                itemLabel="#{multa.codigo}  #{multa.descricao}"
                                                itemValue="#{multa.id}"
                                                forceSelection="true"
                                                scrollHeight="150"
                                                title="Selecione a Multa." size="70">
                                    <p:ajax event="itemSelect"
                                            update=":formLancamentoMulta:panelMultas"
                                            listener="#{acaoFiscalControlador.pegaDescricaoDaMulta}"/>
                                </p:autoComplete>
                                <p:spacer width="5"/>
                                <p:commandButton styleClass="botao_azul icone_branco"
                                                 update=":Formulario_dialog_pesquisa_multa"
                                                 onclick="aguarde.show()"
                                                 oncomplete="dialogPesquisaMultas.show(); "
                                                 icon="ui-icon-search"/>
                            </h:panelGroup>

                            <h:outputText value="Descrição: "/>
                            <p:inputTextarea id="descricaoMulta"
                                             value="#{acaoFiscalControlador.lancamentoMultaFiscal.descricao}" cols="70"
                                             rows="3"
                                             autoResize="false"/>

                            <h:outputText value="Observação: "/>
                            <p:inputTextarea id="observacaoMulta"
                                             value="#{acaoFiscalControlador.lancamentoMultaFiscal.observacao}" cols="70"
                                             rows="3" autoResize="false"/>

                            <p:spacer/>
                            <h:panelGrid columns="5">
                                <h:outputText value="Ano: "/>
                                <p:inputMask value="#{acaoFiscalControlador.lancamentoMultaFiscal.ano}" mask="9999"
                                             size="15"
                                             disabled="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoCalculoMultaFiscalizacao eq 'MENSAL'}"/>

                                <h:outputText value="Quantidade: "/>
                                <p:inputText value="#{acaoFiscalControlador.lancamentoMultaFiscal.quantidade}"
                                             size="15" maxlength="6"
                                             disabled="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.formaCalculoMultaFiscalizacao ne 'QUANTIDADE'}"/>

                                <p:commandButton value="Calcular" icon="ui-icon-calculator" styleClass="padrao"
                                                 actionListener="#{acaoFiscalControlador.calcularMulta()}"
                                                 update="@form"/>
                            </h:panelGrid>
                        </h:panelGrid>

                        <p:dataTable value="#{acaoFiscalControlador.multasALancar}" var="m"
                                     emptyMessage="Multas a serem lançadas." style="text-align: center">
                            <p:column headerText="Mês" style="text-align: left"
                                      rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoCalculoMultaFiscalizacao eq 'MENSAL'}">
                                <h:outputText value="#{m.mes.descricao}"/>
                            </p:column>
                            <p:column headerText="Ano" style="text-align: center">
                                <h:outputText value="#{m.ano}"/>
                            </p:column>
                            <p:column headerText="Valor da Multa (R$)" style="text-align: right">
                                <h:outputText value="#{m.valorMulta}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor da Multa (UFM)" style="text-align: right">
                                <h:outputText value="#{m.valorMultaIndice}">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Alíquota da Multa (%)" style="text-align: right"
                                      rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}">
                                <h:outputText value="#{m.aliquota}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Base de Cálculo Corrigido" style="text-align: right">
                                <h:outputText value="#{m.baseCalculo}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>

                        <h:panelGrid columns="8" styleClass="mtop05">
                            <h:outputText value="Valor da Multa (R$): "/>
                            <h:outputText styleClass="azulnegrito" value="#{acaoFiscalControlador.valorMulta}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <p:spacer width="10px"/>
                            <h:outputText value="Valor da Multa (UFM): "/>
                            <h:outputText value="#{acaoFiscalControlador.valorMultaUFM}" styleClass="azulnegrito">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <p:spacer width="10px"/>
                            <h:outputText value="Alíquota da Multa (%): "
                                          rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}"/>
                            <h:outputText value="#{acaoFiscalControlador.valorAliquota}" styleClass="azulnegrito"
                                          rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </h:panelGrid>
                    </center>
                </p:panel>

                <div style="width: 100%; text-align: center" class="mtop05">
                    <p:commandButton id="adicionarMulta"
                                     value="Lançar"
                                     onstart="aguarde.show();"
                                     oncomplete="aguarde.hide();"
                                     icon="ui-icon-circle-plus"
                                     styleClass="prioritario"
                                     style="height: 30px"
                                     actionListener="#{acaoFiscalControlador.podeLancarMulta}"/>
                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-cancel"
                                     update=":Formulario"
                                     onstart="aguarde.show();"
                                     oncomplete="aguarde.hide(); lancamentoMulta.hide();"
                                     style="height: 30px"
                                     actionListener="#{acaoFiscalControlador.limparCamposMulta()}"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog width="400" modal="true" widgetVar="confirmaMulta"
                  dynamic="true"
                  showHeader="false"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false">
            <div class="alert alert-info" style="text-align: center">
                <h:outputText
                    value="Você pode lançar a multa e voltar para a ação fiscal ou continuar lançando multas para este registro."/>
                <br/>
                <h:form>
                    <div class="margem-superior-dez-pixels">
                        <h:panelGrid columns="2">
                            <p:commandButton value="Lançar e Continuar"
                                             icon="ui-icon-circle-plus"
                                             styleClass="icone_verde"
                                             update=":formLancamentoMulta"
                                             oncomplete="confirmaMulta.hide()"
                                             style="height: 30px"
                                             actionListener="#{acaoFiscalControlador.adicionarMulta()}"/>
                            <p:commandButton value="Lançar e Sair"
                                             icon="ui-icon-arrowreturnthick-1-e"
                                             styleClass="icone_azul"
                                             update=":Formulario"
                                             oncomplete="confirmaMulta.hide(); lancamentoMulta.hide()"
                                             style="height: 30px"
                                             actionListener="#{acaoFiscalControlador.adicionarMulta()}"/>
                        </h:panelGrid>
                    </div>

                </h:form>
            </div>
        </p:dialog>
        <p:dialog modal="true" widgetVar="imprimeAutoInfracao" width="600" closable="false"
                  resizable="false"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Gerar Auto de Infração">
            <h:form id="formAutoInfracao">
                <h:panelGrid columns="1">
                    <h:outputText value="Fundamentação Legal"/>
                    <p:inputTextarea cols="90" rows="5" style="width: 100%"
                                     maxlength="1000"
                                     value="#{acaoFiscalControlador.fundamentacaoAutoInfracao}"/>

                    <h:outputText value="Histórico Fiscal"/>
                    <p:inputTextarea cols="90" rows="5" style="width: 100%"
                                     maxlength="1000"
                                     value="#{acaoFiscalControlador.historicoAutoInfracao}"/>
                </h:panelGrid>
                <p:separator style="width: 100%; margin-bottom: 10px; margin-top: 10px"/>

                <div style="text-align: center; width: 100%">
                    <fc:botaoTargetBlank actionListener="#{acaoFiscalControlador.gerarAutoInfracao()}"
                                         icon="ui-icon-print"
                                         label="Imprimir"
                                         styleClass="operacao prioritario"
                                         imprimeNoDialog="true"/>
                    <p:commandButton value="Cancelar"
                                     styleClass="operacao"
                                     onclick="imprimeAutoInfracao.hide()"
                                     icon="ui-icon-cancel"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dialogPesquisaMultas" modal="true" width="1000" height="400"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  onShow="aguarde.hide();"
                  resizable="false">
            <h:form id="Formulario_dialog_pesquisa_multa">
                <fc:pesquisaGenerico id="lista"
                                     caminhoAtual="edita"
                                     caminhoControlador="#{acaoFiscalControlador.caminho}"
                                     actionSelecionar="#{acaoFiscalControlador.actionSelecionar()}"
                                     nomeDaClasse="MultaFiscalizacao"
                                     guardarNaSessao="false"
                                     pesquisaNoEnter="false"
                                     iconmSelecionar="check-icon.png"
                                     mostrarBotaoConsultasPersonalizadas="false"
                                     mostrarBotaoEditarConfiguracaoRelatorio="false"
                                     mostrarBotaoImprimirRelatorioTabela="false"
                                     mostrarBotaoImprimirRelatorioUnicoRegistro="false"
                                     novo="#{acaoFiscalControlador.novo()}"
                                     selecionar="#{acaoFiscalControlador.selecionarMulta}"
                                     meuControlador="#{pesquisaMultaFiscalizacao}"
                                     mostrarHistorico="false"
                                     mostrarBotaoNovo="false"
                                     dialog="true"/>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="alteraArbitramento" modal="true" width="400" resizable="false"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Alteração do Arbitramento">
            <h:form id="Formulario_alteraArbitramento">
                <p:panel>
                    <h:panelGrid>
                        <fc:outputLabelObrigatorio value="Data do Arbitramento"/>
                        <p:calendar value="#{acaoFiscalControlador.alteracaoDataArbitramento.dataArbitramento}"
                                    pattern="dd/MM/yyyy"
                                    onkeyup="mascara(this, Data)" maxlength="10" showOn="button"/>
                    </h:panelGrid>
                </p:panel>
                <p:commandButton value="Confirmar" actionListener="#{acaoFiscalControlador.alterarDataArbitramento()}"
                                 update=":Formulario"
                                 oncomplete="alteraArbitramento.hide(); aguarde.hide()"
                                 onclick="aguarde.show()" styleClass="padrao prioritario mtop05" icon="ui-icon-check"/>
                <p:commandButton value="Cancelar" onclick="alteraArbitramento.hide()" styleClass="padrao mtop05"
                                 icon="ui-icon-cancel"/>
            </h:form>
        </p:dialog>
        <p:dialog id="lancamentoMultaNotasDlg" closable="false" width="850" modal="true"
                  widgetVar="lancamentoMultaNotas"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Lançamento de Multas para Notas Fiscais"
                  resizable="false">
            <h:form id="formLancamentoMultaNotas">
                <p:panel id="panelMultasNotas" style="max-height: 300px; overflow: auto">
                    <center>
                        <h:panelGrid columns="2">
                            <h:outputText value="Multa: "/>
                            <h:panelGroup>
                                <p:autoComplete queryDelay="1000" id="multaNotasAutoComp"
                                                value="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao}"
                                                completeMethod="#{acaoFiscalControlador.completarMultaMensal}"
                                                converter="#{multaFiscalizacaoControlador.converterGenerico}"
                                                var="multa"
                                                itemLabel="#{multa.codigo}  #{multa.descricao}"
                                                itemValue="#{multa.id}"
                                                forceSelection="true"
                                                scrollHeight="150"
                                                title="Selecione a Multa." size="70">
                                    <p:ajax event="itemSelect"
                                            update=":formLancamentoMultaNotas:panelMultasNotas"
                                            listener="#{acaoFiscalControlador.pegarDescricaoDaMultaNotas}"/>
                                </p:autoComplete>
                                <p:spacer width="5"/>
                                <p:commandButton styleClass="botao_azul icone_branco"
                                                 update=":Formulario_dialog_pesquisa_multa"
                                                 onclick="aguarde.show()"
                                                 oncomplete="dialogPesquisaMultas.show(); "
                                                 icon="ui-icon-search"/>
                            </h:panelGroup>

                            <h:outputText value="Descrição: "/>
                            <p:inputTextarea id="descricaoMultaNotas"
                                             value="#{acaoFiscalControlador.lancamentoMultaFiscal.descricao}" cols="70"
                                             rows="3"
                                             autoResize="false"/>

                            <h:outputText value="Observação: "/>
                            <p:inputTextarea id="observacaoMultaNotas"
                                             value="#{acaoFiscalControlador.lancamentoMultaFiscal.observacao}" cols="70"
                                             rows="3" autoResize="false"/>

                            <h:outputText value="Quantidade: "/>
                            <h:panelGroup>
                                <p:inputText value="#{acaoFiscalControlador.lancamentoMultaFiscal.quantidade}"
                                             size="15" maxlength="6"
                                             disabled="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.formaCalculoMultaFiscalizacao ne 'QUANTIDADE'}"/>
                                <p:spacer width="5"/>
                                <p:commandButton value="Calcular" icon="ui-icon-calculator" styleClass="padrao"
                                                 actionListener="#{acaoFiscalControlador.calcularMultaNotas()}"
                                                 update="@form"/>
                            </h:panelGroup>
                        </h:panelGrid>

                        <p:dataTable value="#{acaoFiscalControlador.multasALancar}" var="m"
                                     emptyMessage="Multas a serem lançadas." style="text-align: center">
                            <p:column headerText="AIDF" style="text-align: center">
                                <h:outputText
                                    value="#{m.lancamentoDoctoFiscal.aidf.numeroAidf}"/>
                            </p:column>
                            <p:column headerText="Nº da NF" style="text-align: center">
                                <h:outputText
                                    value="#{m.lancamentoDoctoFiscal.numeroNotaFiscal}"/>
                            </p:column>
                            <p:column headerText="Série" style="text-align: center">
                                <h:outputText
                                    value="#{m.lancamentoDoctoFiscal.serie.serie}"/>
                            </p:column>
                            <p:column headerText="Valor da Multa (R$)" style="text-align: right">
                                <h:outputText value="#{m.valorMulta}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor da Multa (UFM)" style="text-align: right">
                                <h:outputText value="#{m.valorMultaIndice}">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Alíquota da Multa (%)" style="text-align: right"
                                      rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}">
                                <h:outputText value="#{m.aliquota}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor Corrigido" style="text-align: right">
                                <h:outputText value="#{m.lancamentoDoctoFiscal.valorCorrigido}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>

                        <h:panelGrid columns="8" styleClass="mtop05">
                            <h:outputText value="Valor da Multa (R$): "/>
                            <h:outputText styleClass="azulnegrito" value="#{acaoFiscalControlador.valorMulta}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <p:spacer width="10px"/>
                            <h:outputText value="Valor da Multa (UFM): "/>
                            <h:outputText value="#{acaoFiscalControlador.valorMultaUFM}" styleClass="azulnegrito">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <p:spacer width="10px"/>
                            <h:outputText value="Alíquota da Multa (%): "
                                          rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}"/>
                            <h:outputText value="#{acaoFiscalControlador.valorAliquota}" styleClass="azulnegrito"
                                          rendered="#{acaoFiscalControlador.lancamentoMultaFiscal.multaFiscalizacao.tipoMultaFiscalizacao ne 'FIXO'}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </h:panelGrid>
                    </center>
                </p:panel>

                <div style="width: 100%; text-align: center" class="mtop05">
                    <p:commandButton id="adicionarMultaNotas"
                                     value="Lançar"
                                     icon="ui-icon-circle-plus"
                                     styleClass="prioritario"
                                     update=":Formulario"
                                     style="height: 30px"
                                     actionListener="#{acaoFiscalControlador.podeLancarMultaNotas}"/>
                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-cancel"
                                     update=":Formulario"
                                     oncomplete="lancamentoMultaNotas.hide()"
                                     style="height: 30px"
                                     actionListener="#{acaoFiscalControlador.limparCamposMulta()}"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog id="notasFiscaisDoLancamentoDlg" closable="false" modal="true"
                  widgetVar="notasFiscaisDoLancamento"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  header="Notas Fiscais do Lançamento">
            <h:form id="formNotasFiscaisDoLancamento">
                <p:dataTable id="tableDoctoFiscalDoLancamento" widgetVar="tabelaNF" style="font-size: x-small"
                             value="#{acaoFiscalControlador.notasFiscaisDoLancamento}" var="doctofiscal"
                             styleClass="lancamentoContabeis mbot05 mtop05"
                             paginator="true" rows="10"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                             rowsPerPageTemplate="10,25,50,100,500"
                             rowStyleClass="#{doctofiscal.notaExtraviada or doctofiscal.notaCancelada or doctofiscal.naoTributada ? 'vermelho' : ''}"
                             emptyMessage="Nenhuma nota fiscal encontrada.">
                    <p:column headerText="" style="text-align: center; width: 40px" id="colunaBotoesNotas">
                        <f:facet name="header">
                            <p:commandButton icon="ui-icon-check"
                                             styleClass="vinteLarguraVinteAltura"
                                             rendered="#{acaoFiscalControlador.containsTodasNotasParaMulta()}"
                                             actionListener="#{acaoFiscalControlador.removerTodasNotasParaMulta()}"
                                             update="tableDoctoFiscalDoLancamento"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"/>
                            <p:commandButton value=" "
                                             styleClass="vinteLarguraVinteAltura"
                                             rendered="#{!acaoFiscalControlador.containsTodasNotasParaMulta()}"
                                             actionListener="#{acaoFiscalControlador.adicionarTodasNotasParaMulta()}"
                                             update="tableDoctoFiscalDoLancamento"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"/>
                        </f:facet>
                        <p:commandButton icon="ui-icon-check"
                                         styleClass="vinteLarguraVinteAltura"
                                         rendered="#{acaoFiscalControlador.containsNotasParaMulta(doctofiscal)}"
                                         actionListener="#{acaoFiscalControlador.removerNotasParaMulta(doctofiscal)}"
                                         update="tableDoctoFiscalDoLancamento"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide()"/>
                        <p:commandButton value=" "
                                         styleClass="vinteLarguraVinteAltura"
                                         rendered="#{!acaoFiscalControlador.containsNotasParaMulta(doctofiscal)}"
                                         actionListener="#{acaoFiscalControlador.adicionarNotasParaMulta(doctofiscal)}"
                                         update="tableDoctoFiscalDoLancamento"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide()"/>
                    </p:column>
                    <p:column headerText="AIDF" style="width: 25px; text-align: center">
                        <h:outputText value="#{doctofiscal.aidf.numeroAidf}"/>
                    </p:column>
                    <p:column headerText="N° da NF" style="width: 25px; text-align: center">
                        <h:outputText value="#{doctofiscal.numeroNotaFiscal}"/>
                    </p:column>
                    <p:column headerText="Série" style="width: 30px; text-align: center">
                        <h:outputText value="#{doctofiscal.serie.serie}"/>
                    </p:column>
                    <p:column headerText="Data Emissão" style="width: 35px; text-align: center">
                        <h:outputText value="#{doctofiscal.dataEmissao}">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Valor da NF" style="text-align: right">
                        <h:outputText value="#{doctofiscal.valorNotaFiscal}" style="text-align: right">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Base de Cálculo" style="text-align: right">
                        <h:outputText value="#{doctofiscal.baseCalculoISS}" style="text-align: right">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="% ISS" style="text-align: right; width: 2%">
                        <h:outputText value="#{doctofiscal.porcentagemISS}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Valor ISS (R$)" style="text-align: right">
                        <h:outputText value="#{doctofiscal.valorISS}" style="text-align: right">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Valor ISS (UFM)" style="text-align: right">
                        <h:outputText value="#{doctofiscal.valorIndice}" style="text-align: right">
                            <f:convertNumber pattern="#,##0.0000"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Valor Corrigido (R$)" style="text-align: right">
                        <h:outputText
                            value="#{doctofiscal.valorCorrigido}"
                            style="text-align: right">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Valor Apurado (R$)" style="text-align: right">
                        <h:outputText value="#{doctofiscal.valorApurado}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                    </p:column>
                    <p:column headerText="Cancelada" style="width: 20px; text-align: center">
                        <h:outputText value="#{doctofiscal.notaCancelada ? 'Sim' : 'Não'}"/>
                    </p:column>
                    <p:column headerText="Extraviada" style="width: 20px; text-align: center">
                        <h:outputText value="#{doctofiscal.notaExtraviada ? 'Sim' : 'Não'}"/>
                    </p:column>
                    <p:column headerText="Tributada" style="text-align: center">
                        <h:outputText value="#{doctofiscal.naoTributada ? 'Não' : 'Sim'}"/>
                        <p:outputPanel rendered="#{doctofiscal.naoTributada}">
                            <br/>
                            <h:outputText value="#{doctofiscal.tipoNaoTributacao.descricao}"/>
                        </p:outputPanel>
                    </p:column>
                    <p:column headerText="Observação">
                        <h:outputText value="#{doctofiscal.observacao}"/>
                    </p:column>
                    <p:column headerText="Tomador">
                        <h:outputText value="#{doctofiscal.nomeCpfCnpjTomador}"/>
                    </p:column>
                </p:dataTable>
                <p:separator style="width: 100%"/>

                <div style="width: 100%; text-align: center">
                    <p:commandButton
                        actionListener="#{acaoFiscalControlador.abrirDialogDeLancamentoDeMultasDasNotasFiscais()}"
                        value="Lançar Multa" icon="ui-icon-newwin"
                        update=":formLancamentoMultaNotas"
                        rendered="#{acaoFiscalControlador.selecionado.lancamentoDoctoFiscal.size() gt 0 and !acaoFiscalControlador.existeAutoInfracaoValido()}"
                        styleClass="operacao"/>

                    <p:commandButton value="Fechar" icon="ui-icon-close" styleClass="operacao"
                                     actionListener="#{acaoFiscalControlador.removerTodasNotasParaMulta()}"
                                     update=":Formulario"
                                     oncomplete="notasFiscaisDoLancamento.hide()"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dialogProgresSalvar"
                  width="800"
                  closable="false"
                  showHeader="false"
                  modal="true"
                  hideEffect="clip"
                  resizable="false"
                  position="center"
                  dynamic="true">
            <h:form id="formDialogProgresSalvar">
                <div class="alert alert-success centralizado mtop05">
                    <strong>Aguarde, </strong> Salvando Ação Fiscal...
                </div>

                <p:panel style="text-align: center; width: 100%; border: 0px;"
                         visible="#{acaoFiscalControlador.assistente.executando}"
                         id="panelBarraSalvar">
                    <div class="modal-body" style="text-align: center">
                        <div>
                            <h:graphicImage
                                value="#{facesContext.externalContext.requestContextPath}/img/ajaxloading.gif"
                                styleClass="mtop05"/> <br/>
                        </div>
                    </div>
                    <br/>
                    <h:outputText
                        value="Tempo Decorrido: #{acaoFiscalControlador.assistente.tempoDecorrido}"
                        styleClass="negrito"/>
                    <br/>
                </p:panel>
            </h:form>
        </p:dialog>

        <div id="modalNotasFiscaisEletronicas"
             style="padding-top: 10px!important;padding-bottom: 10px!important;width: 90%"
             class="modal hide fade"
             tabindex="-1" role="dialog"
             aria-labelledby="modalIdleMonitor"
             aria-hidden="true">
            <div class="modal-content">
                <div class="modal-header alert alert-info " style="text-align: center">
                    Notas fiscais
                </div>
                <h:form id="FormularioConsultaEntidade">
                    <p:remoteCommand name="addfiltros" id="rcAddFiltros"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide();rcPesquisar();"
                                     update=":nfseAcaoFiscal:FormularioPesquisa:filtros"
                                     actionListener="#{acaoFiscalControlador.addFiltrosPadraoConsultaNotas(consultaEntidadeController.consulta)}"/>
                </h:form>
                <div class="modal-body" style="text-align: justify; overflow-y: auto; height: 300px;padding: 0">
                    <fc:consultaEntidade id="nfseAcaoFiscal" chave="NOTA_FISCAL_VIEW"/>
                </div>
                <div class="modal-footer">
                    <p:commandButton value="Fechar"
                                     icon="ui-icon-circle-check"
                                     styleClass="mlef05"
                                     title="Clique para fechar"
                                     onclick="$('#modalNotasFiscaisEletronicas').modal('hide')"/>
                </div>
            </div>
        </div>
    </ui:define>
</ui:composition>
</html>
