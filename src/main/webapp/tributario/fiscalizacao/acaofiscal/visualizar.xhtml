<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <p:dialog modal="true" position="350,200" widgetVar="statusDialog" header="Carregando ...."
                  draggable="false" closable="false" resizable="false">
            <center>
                Por Favor, aguarde um instante.
                <br/>
                <p:graphicImage value="/img/ajaxloadingbar.gif"/>
            </center>
        </p:dialog>
        <h:form id="Formulario">

            <p:panel header="Detalhes da Ação Fiscal">
                <table style="width: 100%">
                    <tr>
                        <td><h:panelGrid columns="2">
                            <h:outputText value="Período: "/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.dataLevantamentoInicial}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <h:outputText value=" até: "/>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.dataLevantamentoFinal}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                            </h:panelGroup>

                            <h:outputText value="Situação: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal.descricao}"/>
                            <h:outputText value="Cadastro Econômico: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.inscricaoCadastral}"
                                         styleClass="negrito"/>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.pessoa.nome}"
                                         styleClass="negrito"
                                         size="50"/>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.pessoa.cpf_Cnpj}"
                                         styleClass="negrito"/>

                            <h:outputText value="Contador: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.cadastroEconomico.escritorioContabil} #{acaoFiscalControlador.selecionado.cadastroEconomico.escritorioContabil.crc}"
                                         styleClass="negrito"
                                         size="50"/>

                            <h:outputText value="Programação: "/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.numero}"
                                             styleClass="negrito"/>
                                <fc:novoParente selecionado="#{acaoFiscalControlador.selecionado}"
                                                icon="ui-icon-search"
                                                title="Visualizar programação"
                                                destino="/tributario/fiscalizacao/programacao/ver/#{acaoFiscalControlador.selecionado.programacaoFiscal.id}/"
                                                origem="#{acaoFiscalControlador.caminhoOrigem}"/>
                            </h:panelGroup>
                            <p:spacer/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.selecionado.programacaoFiscal.descricao}"
                                         styleClass="negrito"
                                         size="50"/>
                            <p:spacer/>
                            <h:panelGroup>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.dataInicio}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <h:outputText value=" até: "/>
                                <p:inputText readonly="true"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                             value="#{acaoFiscalControlador.selecionado.programacaoFiscal.dataFinal}"
                                             styleClass="negrito">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                            </h:panelGroup>

                            <h:outputText value="Ordem de Serviço: "/>
                            <p:inputText readonly="true"
                                         style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important"
                                         value="#{acaoFiscalControlador.formataNumeroOrdemServico}"
                                         styleClass="negrito"/>
                        </h:panelGrid></td>
                        <td style="text-align: right;" valign="top">
                            <h:panelGrid columns="1">
                                <p:commandButton value="1 - Início de Fiscalização" update=":formImprimirDocto @form"
                                                 onstart="statusDialog.show()"
                                                 icon="ui-icon-copy"
                                                 styleClass="#{(acaoFiscalControlador.selecionado.ordemServico eq null
                                               or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                               or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO') eq true ? '': 'prioritario'}"
                                                 style=" height: 30px"
                                                 oncomplete="statusDialog.hide();"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoTermoFiscalizacao}"
                                                 disabled="#{acaoFiscalControlador.selecionado.ordemServico eq null
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"/>

                                <p:commandButton value="6 - Finalização da Fiscalização"
                                                 update=":formImprimirDocto @form"
                                                 onstart="statusDialog.show()"
                                                 icon="ui-icon-copy"
                                                 styleClass="icone_azul"
                                                 style="height: 30px"
                                                 oncomplete="statusDialog.hide(); dialogImprimirDocto.show()"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoTermoFinalizacaoFiscalizacao()}"
                                                 disabled="#{!acaoFiscalControlador.canEmitirTermoFinalizacaoFiscalizacao()}"/>

                                <p:commandButton value="Homologação" update=":formImprimirDocto :Formulario"
                                                 onstart="statusDialog.show()" oncomplete="statusDialog.hide();"
                                                 actionListener="#{acaoFiscalControlador.gerarDocumentoHomologacao()}"
                                                 rendered="#{!acaoFiscalControlador.existeMulta}"
                                                 style="height: 30px"
                                                 onclick="if(!confirm('Deseja homologar essa fiscalização?')) return false;"
                                                 disabled="#{!acaoFiscalControlador.existeTermoFiscalizacaoGerado()
                                             or (acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                             or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO')}"
                                                 id="homologar"
                                                 icon="ui-icon-copy"
                                                 styleClass="icone_azul"/>

                                <p:commandButton id="relatoriofiscal" value="Relatório Fiscal"
                                                 styleClass="icone_azul" icon="ui-icon-document"
                                                 update=":formImprimirDocto @form"
                                                 actionListener="#{acaoFiscalControlador.gerarRelatorioFiscal}"
                                                 rendered="#{acaoFiscalControlador.existeMulta}"
                                                 style="height: 30px"
                                                 onstart="statusDialog.show()"
                                                 oncomplete="statusDialog.hide(); dialogImprimirDocto.show()"/>
                            </h:panelGrid>
                        </td>
                    </tr>
                </table>

                <br/>
                <p:tabView id="tabView">
                    <p:ajax event="tabChange"
                            onstart="aguarde.show()"
                            oncomplete="aguarde.hide()"
                            listener="#{acaoFiscalControlador.onTabChange}"/>
                    <p:tab title="Fiscais Designados">
                        <p:panel header="Fiscais Designados" id="pFiscais">
                            <p:dataTable value="#{acaoFiscalControlador.selecionado.fiscalDesignados}" var="fiscal"
                                         emptyMessage="Nenhum registro encontrado" id="tFiscais">
                                <p:column headerText="Nome do Fiscal">
                                    <h:outputText value="#{fiscal.usuarioSistema.pessoaFisica.nome}"/>
                                </p:column>
                                <p:column headerText="Login do Fiscal">
                                    <h:outputText value="#{fiscal.usuarioSistema.login}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="Histórico de Situações">
                        <p:panel header="Histórico de Situações" id="pSituacoes">
                            <p:dataTable value="#{acaoFiscalControlador.selecionado.situacoesAcaoFiscal}" var="situacao"
                                         emptyMessage="Nenhum registro encontrado" id="tSituacoes">
                                <p:column headerText="Situação">
                                    <h:outputText value="#{situacao.situacaoAcaoFiscal.descricao}"/>
                                </p:column>
                                <p:column headerText="Data">
                                    <h:outputText value="#{situacao.data}">
                                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="2 - Levantamento Contábil">
                        <p:panel header="Arbitramento">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="Data do Arbitramento:"/>
                                <p:inputText value="#{acaoFiscalControlador.selecionado.dataArbitramento}"
                                             readonly="true" styleClass="negrito"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>

                                <fc:outputLabelObrigatorio value="UFM do Arbitramento:"/>
                                <p:inputText value="#{acaoFiscalControlador.selecionado.ufmArbitramento}"
                                             readonly="true" styleClass="negrito"
                                             style="border: slategray 2px solid !important; color: slategray !important; font-weight: bold !important">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </p:inputText>
                            </h:panelGrid>
                        </p:panel>
                        <p:dataTable id="tableLevantamentoContabil" style="font-size: x-small"
                                     styleClass="mtop05"
                                     value="#{acaoFiscalControlador.selecionado.levantamentosContabeis}"
                                     var="levantamentoContabil"
                                     widgetVar="tabela"
                                     selection="#{acaoFiscalControlador.levantamentosContabeisSelecionados}"
                                     emptyMessage="Nenhum registro encontrado.">
                            <f:facet name="header">
                                <h:outputText value="Levantamento"/>
                            </f:facet>
                            <p:column headerText="Mês">
                                <h:outputText value="#{levantamentoContabil.mes.descricao}"/>
                            </p:column>
                            <p:column headerText="Ano">
                                <h:outputText value="#{levantamentoContabil.ano}"/>
                            </p:column>
                            <p:column headerText="Valor da UFM (R$)" style="text-align: right">
                                <h:outputText value="#{levantamentoContabil.valorIndice}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="3 - Notas Fiscais" id="tabNotas">
                        <p:panel id="panel-notas">
                            <table class="mtop10">
                                <tr>
                                    <td>
                                        <h:outputText value="Pesquisar por"
                                                      styleClass="azulnegrito"/>
                                    </td>
                                </tr>
                            </table>
                            <table class="mtop10">
                                <c:forEach items="#{acaoFiscalControlador.filtrosConsultaNsfe}" var="filtro"
                                           varStatus="index">

                                    <tr>
                                        <td>
                                            <h:selectOneMenu value="#{filtro.field}"
                                                             converter="#{acaoFiscalControlador.converterFieldConsulta}">
                                                <f:selectItems value="#{acaoFiscalControlador.pesquisaveisNotaFiscal}"/>
                                                <p:ajax process="@this" event="change" update="panel-notas"/>
                                            </h:selectOneMenu>
                                        </td>
                                        <td>
                                            <h:selectOneMenu value="#{filtro.operacao}">
                                                <f:selectItems value="#{filtro.field.tipo.selectItens}"/>
                                                <p:ajax process="@this" event="change" update="panel-notas"/>
                                            </h:selectOneMenu>
                                        </td>
                                        <td>
                                            <fc:inputConsultaEntidade tipoEnum="#{filtro.field.tipoEnum}"
                                                                      valor="#{filtro.valor}"
                                                                      operacao="#{filtro.operacao.name()}"
                                                                      select="#{filtro.field.select}"
                                                                      tipo="#{filtro.field.tipo}"/>
                                        </td>
                                        <td>
                                            <p:commandButton icon="ui-icon-plus"
                                                             rendered="#{index.index +1 == acaoFiscalControlador.filtrosConsultaNsfe.size()}"
                                                             onclick="aguarde.show()"
                                                             oncomplete="aguarde.hide()"
                                                             process="panel-notas"
                                                             update="panel-notas"
                                                             actionListener="#{acaoFiscalControlador.addFiltroNotaFiscal()}"/>
                                        </td>
                                        <td>
                                            <p:commandButton icon="ui-icon-close"
                                                             onclick="aguarde.show()"
                                                             oncomplete="aguarde.hide()"
                                                             process="panel-notas"
                                                             update="panel-notas"
                                                             actionListener="#{acaoFiscalControlador.removeFiltroNotaFiscal(index.index)}"/>
                                        </td>
                                    </tr>
                                </c:forEach>
                            </table>

                            <p:commandButton value="Pesquisar"
                                             id="pesquisar"
                                             icon="ui-icon-search"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             title="Clique para pesquisar"
                                             style="width: 180px; height: 30px"
                                             accesskey="P"
                                             process="panel-notas"
                                             update="panel-notas"
                                             styleClass="prioritario mrig05 pesquisar mtop10"
                                             actionListener="#{acaoFiscalControlador.consultarNotasFiscais()}"/>

                            <p:dataTable paginator="true"
                                         id="tabela-itens-qtde"
                                         lazy="true"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                         style="overflow: scroll; width: auto; max-height: 500px"
                                         paginatorPosition="top"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         rowKey="#{nota.id}"
                                         value="#{acaoFiscalControlador.notasFiscaisModel}"
                                         rows="10"
                                         styleClass="mtop10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='negrito titulo-tabela mrig10'>Notas Fiscais&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,50,100"
                                         var="nota">
                                <p:column headerText="Visualizar" styleClass="alinhamentoCentralizado">
                                    <p:button href="/nfse/nfse/ver/${nota.id}/"
                                              icon="ui-icon-search"/>
                                </p:column>
                                <p:column headerText="Número" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.numero}"/>
                                </p:column>
                                <p:column headerText="Emissão" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.emissao}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Código Emissão" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.codigoVerificacao}"/>
                                </p:column>
                                <p:column headerText="Tomador" styleClass="alinhamentoEsquerda">
                                    <h:outputText
                                        value="#{nota.declaracaoPrestacaoServico.dadosPessoaisTomador.nomeRazaoSocial}"/>
                                </p:column>
                                <p:column headerText="Descriminação do Serviço" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.descriminacaoServico}"/>
                                </p:column>
                                <p:column headerText="Total dos Serviços" styleClass="alinhamentoDireita">
                                    <h:outputText value="#{nota.declaracaoPrestacaoServico.totalServicos}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Situação" styleClass="alinhamentoEsquerda">
                                    <h:outputText value="#{nota.declaracaoPrestacaoServico.situacao.descricao}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="4 - Lançamento Contábil">
                        <c:forEach items="#{acaoFiscalControlador.selecionado.lancamentosContabeis}" var="registro"
                                   varStatus="var">
                            <p:panel header="Registro #{registro.numeroRegistro}/#{registro.ano}">
                                <table style="width: 100%">
                                    <tr>
                                        <td>
                                            <h:panelGrid columns="2">
                                                <h:outputText value="Processo Adm: "/>
                                                <h:outputText value="#{registro.numeroProcessoAdministrativo}"
                                                              styleClass="azulnegrito"/>
                                                <h:outputText value="Situação: "/>
                                                <h:outputText value="#{registro.situacao.descricao}"
                                                              styleClass="azulnegrito"/>
                                                <h:outputText value="Autos: "/>
                                                <h:panelGrid columns="1"
                                                             style="margin: 0 !important; padding: 0 !important">
                                                    <c:forEach items="#{registro.autosInfracao}" var="auto">
                                                        <h:panelGroup>
                                                            <h:outputText
                                                                value="&lt;span class='negrito'&gt;#{auto.numero}/#{auto.ano}&lt;/span&gt; - &lt;span class='azulnegrito'&gt;#{auto.situacaoAutoInfracao}&lt;/span&gt;"
                                                                escape="false"/>

                                                            <p:commandButton
                                                                icon="ui-icon-print"
                                                                title="Imprimir Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                styleClass="botao-transparente"
                                                                update=":formAutoInfracao"
                                                                actionListener="#{acaoFiscalControlador.preparaImpressaoAuto(registro)}"
                                                                rendered="#{auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO'}}"/>

                                                            <p:commandButton icon="ui-icon-cancel"
                                                                             title="Estornar Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                             styleClass="botao-transparente"
                                                                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'
                                                                                         or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CANCELADO'}"
                                                                             rendered="#{auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO'}"
                                                                             actionListener="#{acaoFiscalControlador.novoEstornoAutoInfracao(auto)}"
                                                                             onstart="dialogEstornoAutoInfracao.show()"/>

                                                            <p:commandButton icon="ui-icon-pencil"
                                                                             title="Retificar Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                             styleClass="botao-transparente"
                                                                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal ne 'REABERTO'}"
                                                                             rendered="#{registro.situacao eq 'AUTO_INFRACAO' and (auto.situacaoAutoInfracao ne 'CANCELADO' and auto.situacaoAutoInfracao ne 'ESTORNADO' and auto.situacaoAutoInfracao ne 'RETIFICADO')}"
                                                                             actionListener="#{acaoFiscalControlador.novaRetificacaoAutoInfracao(auto)}"
                                                                             onstart="dialogRetificacaoAutoInfracao.show()"/>

                                                            <p:commandButton ajax="false" icon="ui-icon-search"
                                                                             styleClass="botao-transparente"
                                                                             title="Ir para o Auto de Infração nº. #{auto.numero}/#{auto.ano}"
                                                                             actionListener="#{acaoFiscalControlador.verAutoInfracao(auto)}"/>

                                                        </h:panelGroup>
                                                    </c:forEach>
                                                </h:panelGrid>
                                            </h:panelGrid>
                                        </td>
                                        <td style="text-align: right">
                                            <fc:botaoTargetBlank
                                                actionListener="#{acaoFiscalControlador.imprimeDemonstrativo(registro)}"
                                                label="Imprimir Demonstrativo"
                                                rendered="#{registro.situacao ne 'ESTORNADO'}"
                                                style="height: 30px" imprimeNoDialog="true"/>
                                        </td>
                                    </tr>
                                </table>
                                <br/>
                                <c:forEach items="#{registro.lancamentosPorAno.keySet()}" var="lancamento"
                                           varStatus="var2">

                                    <p:dataTable style="font-size: x-small !important;"
                                                 value="#{registro.lancamentosPorAno.get(lancamento)}"
                                                 var="lancamentoContabil"
                                                 widgetVar="tabela"
                                                 emptyMessage="Nenhum registro encontrado.">
                                        <f:facet name="header">
                                            <h:outputText value="Lançamentos contábeis do exercício de ${lancamento}"/>
                                        </f:facet>
                                        <f:facet name="footer">
                                            <h:outputText value="Lançamentos contábeis do exercício de ${lancamento}"/>
                                        </f:facet>
                                        <p:column headerText="Seq." style="width: 30px">
                                            <h:outputText value="#{lancamentoContabil.sequencia}"/>
                                        </p:column>
                                        <p:column headerText="Mês" style="width: 50px">
                                            <h:outputText value="#{lancamentoContabil.mes.descricao}"/>
                                        </p:column>
                                        <p:column headerText="Ano" style="width: 40px">
                                            <h:outputText value="#{lancamentoContabil.ano}"/>
                                            <f:facet name="footer">
                                                <h:outputText value="TOTAL:" styleClass="negrito"/>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Vlr Declarado" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.valorDeclarado}" size="9"
                                                          id="colValorDeclarado"
                                                          label="Valor Declarado"
                                                          disabled="#{registro.situacao eq 'CANCELADO'}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Vlr Declarado"/><br/>
                                                <h:outputText id="valorTatolDeclarado"
                                                              value="#{acaoFiscalControlador.retornarValorTotalDeclaradoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Vlr Apurado" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.valorApurado}" size="9"
                                                          id="colValorApurado" label="Valor Apurado"
                                                          disabled="#{registro.situacao eq 'CANCELADO'}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Vlr Apurado"/><br/>
                                                <h:outputText id="valorTotalApurado"
                                                              value="#{acaoFiscalControlador.retornarValorTotalApuradoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Base Cálculo" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.baseCalculo}" id="colBaseCalculo">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Base Cálculo"/><br/>
                                                <h:outputText id="valorTotalBase"
                                                              value="#{acaoFiscalControlador.retornarValorTotalBaseCalculoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="% ISS" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.aliquotaISS}" size="9"
                                                          id="colAliquotaISS" label="% ISS">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="ISS Lançado" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.issPago}" id="colIssPago">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="ISS Lançado"/><br/>
                                                <h:outputText id="valorTotalIssPago"
                                                              value="#{acaoFiscalControlador.retornarValorTotalIssPagoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="ISS Apurado" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.issApurado}" id="colIssApurado">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="ISS Apurado"/><br/>
                                                <h:outputText id="valorTotalIssApurado"
                                                              value="#{acaoFiscalControlador.retornarValorTotalIssApuradoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Saldo do ISS" style="text-align: right">
                                            <h:outputText value="#{lancamentoContabil.issDevido}" id="colIssDevido">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Saldo ISS"/><br/>
                                                <h:outputText id="valorTotalSaldo"
                                                              value="#{acaoFiscalControlador.retornarValorTotalIssDevidoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Correção Mon." style="text-align: right">
                                            <h:outputText
                                                value="#{lancamentoContabil.correcao}"
                                                id="correcao">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Correção Mon."/><br/>
                                                <h:outputText id="valorTotalCorrecao"
                                                              value="#{acaoFiscalControlador.retornarValorTotalCorrecaoMonetariaLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Valor Corrigido" style="text-align: right">
                                            <h:outputText
                                                value="#{acaoFiscalControlador.calculaValorCorrigido(lancamentoContabil)}"
                                                id="corrigido">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Valor Corrigido"/><br/>
                                                <h:outputText id="valorTotalCorrigido"
                                                              value="#{acaoFiscalControlador.retornarValorTotalCorrigidoLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Juros Mora" style="text-align: right">
                                            <h:outputText
                                                value="#{lancamentoContabil.juros}"
                                                id="juros">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Juros Mora"/><br/>
                                                <h:outputText id="valorTotalJuros"
                                                              value="#{acaoFiscalControlador.retornarValorTotalJurosMoraLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Multa Mora" style="text-align: right">
                                            <h:outputText
                                                value="#{lancamentoContabil.multa}"
                                                id="multa">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Multa Mora"/><br/>
                                                <h:outputText id="valorTotalMulta"
                                                              value="#{acaoFiscalControlador.retornarValorTotalMultaMoraLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                        <p:column headerText="Valor Total" style="text-align: right">
                                            <h:outputText
                                                value="#{acaoFiscalControlador.calculaTotalLancamento(lancamentoContabil)}"
                                                id="total">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                            <f:facet name="footer">
                                                <h:outputText value="Valor Total"/><br/>
                                                <h:outputText id="valorTotal"
                                                              value="#{acaoFiscalControlador.retornarValorTotalTotalLancamento(lancamento, registro)}"
                                                              styleClass="negrito">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </f:facet>
                                        </p:column>
                                    </p:dataTable>
                                    <br/>
                                </c:forEach>
                            </p:panel>
                            <br/>
                        </c:forEach>
                    </p:tab>
                    <p:tab title="5 - Multas">
                        <c:forEach items="#{acaoFiscalControlador.selecionado.lancamentosContabeis}" var="registro"
                                   varStatus="var">
                            <p:panel header="Registro #{registro.numeroRegistro}/#{registro.ano}"
                                     rendered="#{registro.multas.size() >0}">
                                <h:panelGrid columns="2">
                                    <h:outputText value="Processo Adm: "/>
                                    <h:outputText value="#{registro.numeroProcessoAdministrativo}"
                                                  styleClass="azulnegrito"/>
                                    <h:outputText value="Situação: "/>
                                    <h:outputText value="#{registro.situacao.descricao}" styleClass="azulnegrito"/>
                                </h:panelGrid>
                                <p:dataTable id="tableMultas${var.index}"
                                             value="#{registro.multas}" var="multas"
                                             widgetVar="tabelaMulta"
                                             emptyMessage="Nenhum registro encontrado.">
                                    <f:facet name="header">
                                        <h:outputText
                                            value="Multas do Registro #{registro.numeroRegistro}/#{registro.ano}"/>
                                    </f:facet>
                                    <f:facet name="footer">
                                        <h:outputText
                                            value="Multas do Registro #{registro.numeroRegistro}/#{registro.ano}"/>
                                    </f:facet>
                                    <p:column headerText="Registro">
                                        <h:outputText value="#{multas.registroLancamentoContabil}"/>
                                    </p:column>
                                    <p:column headerText="Referência" style="text-align: left">
                                        <h:outputText
                                            value="#{acaoFiscalControlador.montarReferenciaMulta(multas)}"/>
                                    </p:column>
                                    <p:column headerText="Multa" style="text-align: left">
                                        <h:outputText value="#{multas.multaFiscalizacao.artigo}"/>
                                        <f:facet name="footer">
                                            <h:outputText value="Total: " styleClass="negrito"/>
                                        </f:facet>
                                    </p:column>
                                    <p:column headerText="Valor (R$)" style="text-align: right">
                                        <h:outputText value="#{multas.valorMulta}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                        <f:facet name="footer">
                                            <h:outputText value="#{acaoFiscalControlador.retornarValorTotalMulta()}"
                                                          styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </f:facet>
                                    </p:column>
                                    <p:column headerText="Valor (UFM)" style="text-align: right">
                                        <h:outputText value="#{multas.valorMultaIndice}">
                                            <f:convertNumber pattern="#,##0.0000"/>
                                        </h:outputText>
                                        <f:facet name="footer">
                                            <h:outputText
                                                value="#{acaoFiscalControlador.retornarValorTotalMultaIndice()}"
                                                styleClass="negrito">
                                                <f:convertNumber pattern="#,##0.0000"/>
                                            </h:outputText>
                                        </f:facet>
                                    </p:column>
                                    <p:column headerText="Alíquota (%)" style="text-align: right">
                                        <h:outputText value="#{multas.aliquota}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Base de Cálculo" style="text-align: right">
                                        <h:outputText value="#{multas.baseCalculo}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </p:column>
                                </p:dataTable>
                            </p:panel>
                        </c:forEach>
                    </p:tab>
                    <p:tab title="Anexos">
                        <p:tabView>
                            <p:tab title="Anexos Ação Fiscal">
                                <p:outputPanel style="border: 0" id="panelAnexos">
                                    <p:dataTable value="#{acaoFiscalControlador.selecionado.arquivos}"
                                                 emptyMessage="Nenhum Arquivo foi anexado"
                                                 id="tabelaAnexos"
                                                 paginator="true"
                                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                                 rowIndexVar="rowIx"
                                                 styleClass="mtop05"
                                                 rows="10"
                                                 paginatorTemplate="{CurrentPageReport}  &lt;spanclass='titulo-tabela mrig10'>ANEXOS AÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                 currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                                 rowsPerPageTemplate="10,25,50,100"
                                                 var="arquivo">

                                        <p:column headerText="Ações"
                                                  style="text-align: center; width: 5%; ">
                                            <h:panelGrid columns="2">
                                                <p:commandButton rendered="#{arquivo.arquivo.id eq null}"
                                                                 id="downloadLink" ajax="false"
                                                                 icon="ui-icon-arrowthickstop-1-s"
                                                                 title="Download do Arquivo"
                                                                 process="@form" update="@this"
                                                                 styleClass="mrig05"
                                                                 onstart="aguarde.show()"
                                                                 oncomplete="aguarde.hide()">
                                                    <p:fileDownload value="#{acaoFiscalControlador.download(arquivo)}"/>
                                                </p:commandButton>
                                                <p:outputPanel rendered="#{arquivo.arquivo.id ne null}">
                                                    <a href='${facesContext.externalContext.requestContextPath}/arquivos/#{arquivo.arquivo.nome}?id=#{arquivo.arquivo.id}'>
                                                        <p:button icon="ui-icon-arrowthickstop-1-s"
                                                                  styleClass="mrig05"
                                                                  title="Download do Arquivo"/>
                                                    </a>
                                                </p:outputPanel>
                                            </h:panelGrid>
                                        </p:column>
                                        <p:column headerText="Tamanho">
                                            <h:outputText value="#{arquivo.arquivo.tamanho}"/>
                                        </p:column>
                                        <p:column headerText="Nome">
                                            <h:outputText value="#{arquivo.arquivo.nome}"/>
                                        </p:column>
                                        <p:column headerText="Descrição">
                                            <h:outputText value="#{arquivo.arquivo.descricao}"/>
                                        </p:column>
                                        <p:column headerText="Tipo Documento Anexo" style="width: 5%;">
                                            <h:outputText value="#{arquivo.tipoDocumentoAnexo.descricao}" size="100"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:outputPanel>
                            </p:tab>
                            <p:tab title="Anexos Programação Fiscal">
                                <p:dataTable paginator="true"
                                             id="tabela-arquivos"
                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                             rowIndexVar="rowIx"
                                             styleClass="mtop05"
                                             emptyMessage="Não foram localizados registros para serem apresentados"
                                             value="#{acaoFiscalControlador.programacaoRecuperada.detentorArquivoComposicao.arquivosComposicao}"
                                             rows="10"
                                             paginatorTemplate="{CurrentPageReport}  &lt;spanclass='titulo-tabela mrig10'>ANEXOS PROGRAMAÇÃO FISCAL&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                             rowsPerPageTemplate="10,25,50,100"
                                             var="arquivoComposicao">
                                    <p:column headerText="Ações"
                                              style="text-align: center; width: 5%; ">
                                        <h:panelGrid columns="2">
                                            <p:outputPanel rendered="#{arquivoComposicao.arquivo.id ne null}">
                                                <a href='${facesContext.externalContext.requestContextPath}/arquivos/#{arquivoComposicao.arquivo.nome}?id=#{arquivoComposicao.arquivo.id}'>
                                                    <p:button icon="ui-icon-arrowthickstop-1-s"
                                                              styleClass="mrig05"
                                                              title="Download do Arquivo"/>
                                                </a>
                                            </p:outputPanel>
                                        </h:panelGrid>
                                    </p:column>
                                    <p:column headerText="Descrição" style="width: 95%;">
                                        <h:outputText value="#{arquivoComposicao.arquivo.descricao}" size="100"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                        <br/>
                    </p:tab>
                </p:tabView>

                <h:panelGrid columns="2" rendered="#{acaoFiscalControlador.mostraConclusao()}">
                    <h:outputText value="Conclusão: "/>
                    <h:outputText value="#{acaoFiscalControlador.selecionado.conclusao}"/>
                </h:panelGrid>
            </p:panel>
            <br/>
            <p:button value="Editar"
                      icon="ui-icon-pencil"
                      title="Clique para editar o registro"
                      styleClass="operacao prioritario"
                      href="../../editar/#{acaoFiscalControlador.urlKeyValue}"
                      disabled="#{acaoFiscalControlador.selecionado.ordemServico eq null or !acaoFiscalControlador.podeEditar or acaoFiscalControlador.selecionado.situacaoAcaoFiscal eq 'CONCLUIDO'}"/>
            <p:commandButton id="btnReabrir" value="Reabrir"
                             styleClass="operacao"
                             icon="ui-icon-unlocked"
                             onclick="aguarde.show()"
                             oncomplete="aguarde.hide()"
                             rendered="#{acaoFiscalControlador.reabrir}"
                             disabled="#{acaoFiscalControlador.selecionado.situacaoAcaoFiscal ne 'CONCLUIDO' or !acaoFiscalControlador.ehSupervisor}"
                             actionListener="#{acaoFiscalControlador.reabrirAcaoFiscal()}" update="@form"/>
            <p:commandButton ajax="false" value="Voltar" styleClass="operacao"
                             icon="ui-icon-cancel"
                             actionListener="#{acaoFiscalControlador.cancelar()}"/>
            <br/><br/>
            <p:panel visible="#{acaoFiscalControlador.selecionado.ordemServico eq null}">
                <div class="ui-messages-warn ui-corner-all">
                    <div class="ui-messages-warn-icon"/>
                    &nbsp;
                    Para editar a ação fiscal é necessário ter gerado a ordem de serviço na programação fiscal.
                </div>
            </p:panel>
            <p:panel visible="#{!acaoFiscalControlador.podeEditar}">
                <div class="ui-messages-warn ui-corner-all">
                    <div class="ui-messages-warn-icon"/>
                    &nbsp;
                    Para editar a ação fiscal é necessário estar entre os fiscais designados.
                </div>
            </p:panel>
            <p:panel visible="#{acaoFiscalControlador.podeEditar and acaoFiscalControlador.todosAutoInfracaoValidos()}">
                <div class="ui-messages-warn ui-corner-all">
                    <div class="ui-messages-warn-icon"/>
                    &nbsp;
                    Essa ação fiscal não pode ser alterada, pois possui autos de infração lançados.
                </div>
            </p:panel>
        </h:form>


        <p:dialog modal="true" widgetVar="imprimeAutoInfracao" width="700" closable="false"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Gerar Auto de Infração">
            <h:form id="formAutoInfracao">
                <center>
                    <h:outputText value="Fundamentação Legal:"/>
                    <br/>
                    <p:inputTextarea style="margin-top: 5px" cols="80" rows="10" disabled="true"
                                     value="#{acaoFiscalControlador.fundamentacaoAutoInfracao}"/>
                    <br/>
                    <br/>

                    <fc:botaoTargetBlank actionListener="#{acaoFiscalControlador.gerarAutoInfracao()}"
                                         icon="ui-icon-print"
                                         label="Imprimir"
                                         styleClass="operacao prioritario"
                                         imprimeNoDialog="true"/>
                    <p:commandButton value="Cancelar"
                                     styleClass="operacao"
                                     onclick="imprimeAutoInfracao.hide()"
                                     icon="ui-icon-cancel"/>
                </center>
            </h:form>
        </p:dialog>

        <p:dialog modal="true" widgetVar="statusDialog" header="Carregando ...."
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="false" closable="false" resizable="false">
            <center>
                Por favor, aguarde um instante.
                <br/>
                <p:graphicImage value="/img/ajaxloadingbar.gif"/>
            </center>
        </p:dialog>

        <p:dialog id="dialogEstornoAutoInfracaoDlg" width="700" modal="true" widgetVar="dialogEstornoAutoInfracao"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Estorno do Auto de Infração"
                  resizable="false" closable="false">
            <h:form id="formEstornoAutoInfracao">
                <p:panel>
                    <h:panelGrid columns="2">
                        <h:outputText value="Data: "/>
                        <h:outputText value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.dataEstorno}"
                                      styleClass="negrito">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <fc:outputLabelObrigatorio value="Motivo: "/>
                        <p:inputTextarea id="motivoEstorno"
                                         value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.motivoEstorno}"
                                         cols="80" maxlength="500"
                                         counter="counterEstorno"
                                         counterTemplate="{0} Caracteres Restantes."
                                         rows="5" autoResize="false">
                        </p:inputTextarea>

                        <p:spacer/>
                        <h:panelGroup>
                            <div style="width: 100%; text-align: right">
                                <h:outputText id="counterEstorno" styleClass="azulnegrito"/>
                            </div>
                        </h:panelGroup>
                    </h:panelGrid>
                </p:panel>
                <br/>
                <p:commandButton value="Confirmar" styleClass="operacao prioritario" icon="ui-icon-check"
                                 update=":formEstornoAutoInfracao :Formulario"
                                 actionListener="#{acaoFiscalControlador.estornarAutoInfracao()}"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide(); dialogEstornoAutoInfracao.hide()"/>
                <p:commandButton value="Fechar" icon="ui-icon-close" oncomplete="dialogEstornoAutoInfracao.hide()"
                                 styleClass="operacao"/>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogRetificacaoAutoInfracaoDlg" width="700" modal="true" widgetVar="dialogRetificacaoAutoInfracao"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Retificação do Auto de Infração"
                  resizable="false" closable="false">
            <h:form id="formRetificacaoAutoInfracao">
                <p:panel>
                    <h:panelGrid columns="2">
                        <h:outputText value="Data: "/>
                        <h:outputText value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.dataEstorno}"
                                      styleClass="negrito">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:outputText>

                        <fc:outputLabelObrigatorio value="Motivo: "/>
                        <p:inputTextarea id="motivoRetificacao"
                                         value="#{acaoFiscalControlador.autoInfracaoFiscalSelecionado.motivoEstorno}"
                                         cols="80" maxlength="500"
                                         counter="counterRetificacao"
                                         counterTemplate="{0} Caracteres Restantes."
                                         rows="5" autoResize="false">
                        </p:inputTextarea>

                        <p:spacer/>
                        <h:panelGroup>
                            <div style="width: 100%; text-align: right">
                                <h:outputText id="counterRetificacao" styleClass="azulnegrito"/>
                            </div>
                        </h:panelGroup>
                    </h:panelGrid>
                </p:panel>
                <br/>
                <p:commandButton value="Confirmar" styleClass="operacao prioritario" icon="ui-icon-check"
                                 update=":formRetificacaoAutoInfracao :Formulario"
                                 actionListener="#{acaoFiscalControlador.retificarAutoInfracao()}"
                                 onclick="aguarde.show()"
                                 oncomplete="aguarde.hide(); dialogRetificacaoAutoInfracao.hide()"/>
                <p:commandButton value="Fechar" icon="ui-icon-close" oncomplete="dialogRetificacaoAutoInfracao.hide()"
                                 styleClass="operacao"/>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogImprimirDoctoDlg" width="1000" height="500" modal="true" widgetVar="dialogImprimirDocto"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  header="Impressão de Documentos" resizable="false">
            <h:form id="formImprimirDocto">
                <h:panelGrid style="text-align: center; width: 100%; font-weight: bold;"
                             rendered="#{acaoFiscalControlador.desabilitaEditorDocumento()}">
                    <div class="ui-messages-info ui-corner-all">
                        <div class="ui-messages-info-icon"/>
                        &nbsp;
                        Impossível fazer alteração! Não é permitido fazer qualquer alteração no documento, pois o tipo de documento #{acaoFiscalControlador.documentoOficial.modeloDoctoOficial.tipoDoctoOficial.descricao} não permite.
                    </div>
                </h:panelGrid>
                <p:panel rendered="#{acaoFiscalControlador.documentoOficial == null}">
                    <div class="ui-messages-info ui-corner-all">
                        <div class="ui-messages-info-icon"/>
                        &nbsp;
                        Este Documento não pode ser Impresso, verifique o log de mensagens para obter as informações necessárias de impressão desse documento.
                    </div>
                </p:panel>
                <p:panel style="overflow-y: auto;
                         overflow-x: hidden;
                         max-height: 500px !important;"
                         rendered="#{acaoFiscalControlador.documentoOficial != null}">
                    <p:editor value="#{acaoFiscalControlador.documentoOficial.conteudo}"
                              id="modelo" width="940"
                              disabled="false"
                              height="430" widgetVar="conteudos">
                    </p:editor>
                </p:panel>
                <br/>

                <div style="width: 100%; text-align: center">
                    <fc:botaoTargetBlank actionListener="#{acaoFiscalControlador.imprimirDocumento()}" label="Imprimir"
                                         styleClass="operacao prioritario" imprimeNoDialog="true"/>

                    <p:commandButton value="Fechar" icon="ui-icon-close"
                                     onclick="dialogImprimirDocto.hide()"
                                     styleClass="operacao"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
