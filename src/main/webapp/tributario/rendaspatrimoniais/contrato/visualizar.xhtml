<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <fc:cabecalhoPretty origem="#{contratoRendasPatrimoniaisControlador.caminhoPadrao}listar/"
                                mostrarBotaoNovo="${false}"
                                auditavel="${true}"
                                controlador="#{contratoRendasPatrimoniaisControlador}"/>
            <p:outputPanel
                rendered="#{contratoRendasPatrimoniaisControlador.selecionado.temContratoOriginal()}">
                <div class="ui-messages-warn ui-corner-all textomedio">
                    <div class="ui-messages-warn-icon margem-direita-cinco-pixels"/>
                    <h:outputText value="Atenção! "
                                  styleClass="ui-messages-warn-summary"/>
                    <h:outputText
                        value="Este contrato é uma #{contratoRendasPatrimoniaisControlador.getSituacaoDoContratoOrinario(contratoRendasPatrimoniaisControlador.selecionado.originario)
             eq 'RENOVADO' ? 'RENOVAÇÃO.' : 'ALTERAÇÃO.'} Para ver o contrato anterior clique na lupa ao lado."
                        styleClass="ui-messages-warn-detail"/>
                    <h:commandLink
                        actionListener="#{contratoRendasPatrimoniaisControlador.navegarParaProximoContrato()}"
                        onclick="aguarde.show()">
                        <h:graphicImage id="visualizar"
                                        alt="visualizar"
                                        url="/img/pesquisa.png"
                                        width="15">
                        </h:graphicImage>
                    </h:commandLink>
                    <br/>
                </div>
            </p:outputPanel>
            <p:panel id="panelContrato" header="Detalhes do Contrato">
                <h:panelGrid id="panelGridContrato" columns="2">
                    <h:outputText value="Número do Contrato: "/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.numeroContrato}"
                                  styleClass="negrito"/>

                    <h:outputText value="Situação do Contrato: "/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato}"
                                  styleClass="negrito"/>

                    <h:outputText
                        value="Usuário da Operação (#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato}): "
                        rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"/>
                    <h:outputText
                        value="${contratoRendasPatrimoniaisControlador.selecionado.usuarioOperacao.pessoaFisica.nome}"
                        rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"
                        styleClass="negrito"/>

                    <h:outputText
                        value="Data da Operação (#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato}): "
                        rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.dataOperacao}"
                                  rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy 'às' HH:mm"/>
                    </h:outputText>

                    <h:outputText
                        value="Motivo da Operação (#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato}): "
                        rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.motivoOperacao}"
                                  rendered="#{contratoRendasPatrimoniaisControlador.selecionado.situacaoContrato ne 'ATIVO'}"
                                  styleClass="negrito"/>

                    <h:outputText value="Lotação: "/>
                    <h:outputText
                        value="${contratoRendasPatrimoniaisControlador.selecionado.lotacaoVistoriadora.descricao}"
                        styleClass="negrito"/>

                    <h:outputText value="Índice Econômico: "/>
                    <h:outputText
                        value="#{contratoRendasPatrimoniaisControlador.selecionado.indiceEconomico} - #{contratoRendasPatrimoniaisControlador.selecionado.valorUfmDoContrato}"
                        styleClass="negrito"/>

                    <h:outputText value="Vigência: "/>
                    <h:outputText
                        value="${contratoRendasPatrimoniaisControlador.selecionado.periodoVigencia} ${contratoRendasPatrimoniaisControlador.selecionado.periodoVigencia ne null ? ' Meses': ''}"
                        styleClass="negrito"/>

                    <h:outputText value="Dia do Vencimento: "/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.parametroRendas.diaVencimentoParcelas}"
                                  styleClass="negrito"/>

                    <h:outputText value="Data de Início do Contrato: "/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.dataInicio}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Data de Término do Contrato: "/>
                    <h:outputText value="${contratoRendasPatrimoniaisControlador.selecionado.dataFim}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Localização: "/>
                    <h:outputText
                        value="#{contratoRendasPatrimoniaisControlador.localizacao.descricao}"
                        styleClass="negrito"/>

                    <h:outputText value="Atividade do Ponto Comercial: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.atividadePonto.descricao}"
                                  styleClass="negrito"/>

                    <h:outputText value="Locatário: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.locatario}"
                                  styleClass="negrito"/>

                    <h:outputText rendered="#{contratoRendasPatrimoniaisControlador.selecionado.temContratoOriginal()}"
                                  value="Valor do contrato na #{contratoRendasPatrimoniaisControlador.getSituacaoDoContratoOrinario(contratoRendasPatrimoniaisControlador.selecionado.originario)
             eq 'RENOVADO' ? 'Renovação' : 'Alteração'}:"/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorDoCalculoDoContrato}"
                                  rendered="#{contratoRendasPatrimoniaisControlador.selecionado.temContratoOriginal()}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>
                </h:panelGrid>
                <br/>
                <p:dataTable id="tabelaEnderecos"
                             value="#{contratoRendasPatrimoniaisControlador.enderecos}"
                             var="ender">
                    <f:facet name="header">
                        <h:outputText value="Endereço(s) do Locatário"/>
                    </f:facet>
                    <p:column headerText="Tipo">
                        <h:outputText value="#{ender.tipoEndereco.descricao}"/>
                    </p:column>
                    <p:column headerText="Logradouro">
                        <h:outputText value="#{ender.logradouro}"/>
                    </p:column>
                    <p:column headerText="Número" style="text-align: center">
                        <h:outputText value="#{ender.numero}"/>
                    </p:column>
                    <p:column headerText="Complemento">
                        <h:outputText value="#{ender.complemento}"/>
                    </p:column>
                    <p:column headerText="Bairro">
                        <h:outputText value="#{ender.bairro}"/>
                    </p:column>
                    <p:column headerText="Cidade">
                        <h:outputText value="#{ender.localidade}"/>
                    </p:column>
                    <p:column headerText="UF" style="text-align: center">
                        <h:outputText value="#{ender.uf}"/>
                    </p:column>
                    <p:column headerText="CEP" style="text-align: center">
                        <h:outputText value="#{ender.cep}"/>
                    </p:column>
                    <p:column headerText="Principal" style="text-align: center">
                        <h:outputText value="#{ender.principal ? 'Sim' : 'Não'}"/>
                    </p:column>
                </p:dataTable>
                <br/>
                <p:dataTable id="tabelaTelefones"
                             value="#{contratoRendasPatrimoniaisControlador.telefones}"
                             var="telefone"
                             emptyMessage="Telefone(s) não encontrado(s).">
                    <f:facet name="header">
                        <h:outputText value="Telefone(s) do Locatário"/>
                    </f:facet>
                    <p:column headerText="Tipo">
                        <h:outputText value="#{telefone.tipoFone.tipoFone}"/>
                    </p:column>
                    <p:column headerText="Telefone">
                        <h:outputText value="#{telefone.telefone}"/>
                    </p:column>
                    <p:column headerText="Principal" style="text-align: center">
                        <h:outputText value="#{telefone.principal ? 'Sim' : 'Não'}"/>
                    </p:column>
                </p:dataTable>
                <br/>
                <p:dataTable emptyMessage="Nenhum registro encontrado"
                             id="cnaeTabelaVigente"
                             value="#{contratoRendasPatrimoniaisControlador.selecionado.contratoRendaCNAEs}"
                             var="c">
                    <f:facet name="header">
                        <h:outputText value="CNAE's Desempenhados pelo Locatário"/>
                    </f:facet>
                    <p:column headerText="CNAE">
                        <h:outputText value="#{c.cnae.codigoCnae} "/>
                    </p:column>
                    <p:column headerText="Descrição Detalhada">
                        <h:outputText value="#{c.cnae.descricaoDetalhada} "/>
                    </p:column>
                </p:dataTable>
                <br/>
                <p:dataTable id="tabelaPontosComerciais"
                             value="#{contratoRendasPatrimoniaisControlador.selecionado.pontoComercialContratoRendasPatrimoniais}"
                             var="item"
                             emptyMessage="Nenhum Ponto Comercial encontrado.">
                    <f:facet name="header">
                        <h:outputText value="Pontos Comerciais Objetos do Contrato"/>
                    </f:facet>
                    <p:column headerText="Ponto Comercial (Box)">
                        <h:outputText value="#{item.pontoComercial}"/>
                        <f:facet name="footer">
                            <h:outputText value="Total" styleClass="negrito"/>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Área (M²)" style="text-align: right">
                        <h:outputText value="#{item.area}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.somaTotalArea}"
                                          styleClass="negrito">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Valor do M² (UFM)" style="text-align: right">
                        <h:outputText value="#{item.valorMetroQuadrado}">
                            <f:convertNumber pattern="#,##0.0000"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.selecionado.somaValorMetroQuadrado}"
                                styleClass="negrito">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Valor por Mês (UFM)" style="text-align: right">
                        <h:outputText value="#{item.valorCalculadoMes}">
                            <f:convertNumber pattern="#,##0.0000"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.selecionado.somaDoValorCalculadoMes}"
                                styleClass="negrito">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Valor por Mês (R$)" style="text-align: right">
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.getMultiplicaPeloUFMDoContrato(item.valorCalculadoMes)}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.somaDoValorCalculadoMesMultiplicado}"
                                styleClass="negrito">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Valor Total (UFM)" style="text-align: right">
                        <h:outputText value="#{item.valorTotalContrato}">
                            <f:convertNumber pattern="#,##0.0000"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.selecionado.somaDoValorTotalContrato}"
                                styleClass="negrito">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                    <p:column headerText="Valor Total (R$)" style="text-align: right">
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.getMultiplicaPeloUFMDoContrato(item.valorTotalContrato)}">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <f:facet name="footer">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.somaDoValorTotalContratoMultiplicado}"
                                styleClass="negrito">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </f:facet>
                    </p:column>
                </p:dataTable>

                <br/>

                <div style="background: wheat; width: 100%;">
                    <p:dataTable id="tabelaparcelas"
                                 var="parcela"
                                 rowStyleClass="#{parcela.situacaoDescricaoEnum eq 'Em Aberto'? parcela.vencimento lt programacaoCobrancaControlador.dataOperacao? 'vermelho': 'verde': ''}"
                                 emptyMessage="Nenhuma parcela encontrada"
                                 value="#{contratoRendasPatrimoniaisControlador.parcelas}">
                        <f:facet name="header">
                            <p:outputPanel>
                                <h:outputText value="Parcelas do Contrato"/>
                            </p:outputPanel>
                        </f:facet>
                        <p:column styleClass="centralizado" style="width: 5%">

                            <f:facet name="header">

                                <p:commandButton icon="ui-icon-check"
                                                 styleClass="vinteLarguraVinteAltura"
                                                 update="tabelaparcelas"
                                                 process="@this"
                                                 onstart="aguarde.show();"
                                                 oncomplete="aguarde.hide();"
                                                 title="Desmarcar Todos"
                                                 rendered="#{contratoRendasPatrimoniaisControlador.todosItensMarcados}"
                                                 actionListener="#{contratoRendasPatrimoniaisControlador.setTodosItensMarcados(false)}"/>

                                <p:commandButton styleClass="vinteLarguraVinteAltura ui-icon-none"
                                                 value=""
                                                 process="@this"
                                                 onstart="aguarde.show();"
                                                 oncomplete="aguarde.hide();"
                                                 update="tabelaparcelas"
                                                 title="Marcar Todos"
                                                 rendered="#{!contratoRendasPatrimoniaisControlador.todosItensMarcados}"
                                                 actionListener="#{contratoRendasPatrimoniaisControlador.setTodosItensMarcados(true)}"/>
                            </f:facet>

                            <p:commandButton icon="ui-icon-check"
                                             styleClass="vinteLarguraVinteAltura"
                                             update="tabelaparcelas"
                                             process="@this"
                                             onstart="aguarde.show();"
                                             oncomplete="aguarde.hide();"
                                             disabled="#{!parcela.emAberto}"
                                             rendered="#{contratoRendasPatrimoniaisControlador.parcelaMarcada(parcela)}"
                                             actionListener="#{contratoRendasPatrimoniaisControlador.desmarcarParcela(parcela)}"/>

                            <p:commandButton styleClass="vinteLarguraVinteAltura botao-select-desmarcado"
                                             update="tabelaparcelas"
                                             process="@this"
                                             value=""
                                             onstart="aguarde.show();"
                                             oncomplete="aguarde.hide();"
                                             disabled="#{!parcela.emAberto}"
                                             rendered="#{!contratoRendasPatrimoniaisControlador.parcelaMarcada(parcela)}"
                                             actionListener="#{contratoRendasPatrimoniaisControlador.marcarParcela(parcela)}"/>
                        </p:column>
                        <p:column headerText="DAM" style="width: 8%;">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.recuperaDAM(parcela.idParcela).numeroDAM}"/>
                        </p:column>
                        <p:column headerText="Cadastro" style="width: 8%;">
                            <h:outputText value="#{parcela.cadastro}"/>
                        </p:column>
                        <p:column headerText="Dívida" style="width: 12%;">
                            <h:outputText value="#{parcela.divida}"/>
                        </p:column>
                        <p:column headerText="Exercício" style="width: 5%; text-align: center;">
                            <h:outputText value="#{parcela.exercicio}"/>
                        </p:column>
                        <p:column headerText="Tipo de Débito" style="width: 5%;">
                            <h:outputText value="#{parcela.tipoDeDebito}"/>
                        </p:column>
                        <p:column headerText="Parcela" style="width: 2%; text-align: center;">
                            <h:outputText value="#{parcela.parcela}"/>
                        </p:column>
                        <p:column headerText="SD" style="width: 2%; text-align: center;">
                            <h:outputText value="#{parcela.sd}"/>
                        </p:column>
                        <p:column headerText="Vencimento" style="width: 5%; text-align: center;">
                            <h:outputText value="#{parcela.vencimentoToString}"/>
                        </p:column>
                        <p:column headerText="Imposto" style="text-align: right">
                            <h:outputText value="#{parcela.valorImposto}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Taxa" style="text-align: right">
                            <h:outputText value="#{parcela.valorTaxa}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Desconto" style="text-align: right">
                            <h:outputText value="#{parcela.valorDesconto}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Juros" style="text-align: right">
                            <h:outputText value="#{parcela.valorJuros}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Multa" style="text-align: right">
                            <h:outputText value="#{parcela.valorMulta}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Correcao" style="text-align: right">
                            <h:outputText value="#{parcela.valorCorrecao}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Honorários" style="text-align: right">
                            <h:outputText value="#{parcela.valorHonorarios}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Total" style="text-align: right">
                            <h:outputText value="#{parcela.valorTotal}">
                                <f:convertNumber pattern="###,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Situação">
                            <h:outputText value="#{parcela.situacaoDescricaoEnum}" title="cod. ${parcela.idParcela}"/>
                        </p:column>
                    </p:dataTable>
                </div>
            </p:panel>
            <h:panelGrid columns="8">

                <p:commandButton value="Renovar" id="botaoRenovar" icon="ui-icon-script"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 rendered="#{contratoRendasPatrimoniaisControlador.podeGerenciarContrato()}"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.chamaDialogRenovacaoContrato}"/>

                <p:commandButton value="Rescindir " icon="ui-icon-closethick"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 rendered="#{contratoRendasPatrimoniaisControlador.podeGerenciarContrato()}"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.rescindirContrato()}"
                                 onclick="if (!confirm('Deseja RESCINDIR este contrato?'))
                                         return false;"
                />

                <p:commandButton value="Encerrar Contrato " icon="ui-icon-closethick"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 rendered="#{contratoRendasPatrimoniaisControlador.podeGerenciarContrato()}"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.encerrarContrato()}"
                                 onclick="if (!confirm('Deseja ENCERRAR este contrato?'))
                                         return false;"
                />

                <p:commandButton value="Alteração de Contrato" icon="ui-icon-pencil"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 rendered="#{contratoRendasPatrimoniaisControlador.podeGerenciarContrato()}"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.chamaDialogAlteracaoContrato()}"
                                 onclick="if (!confirm('Deseja Alterar este contrato?'))
                                         return false;"
                />

                <fc:botaoTargetBlank actionListener="#{contratoRendasPatrimoniaisControlador.imprimeContrato()}"
                                     disabled="#{!contratoRendasPatrimoniaisControlador.efetivouContrato}"
                                     icon="ui-icon-print" styleClass="operacao" label="Imprimir Contrato"
                                     imprimeNoDialog="true"/>

                <p:commandButton actionListener="#{contratoRendasPatrimoniaisControlador.verificarImpressaoDam()}"
                                 icon="ui-icon-print"
                                 disabled="#{!contratoRendasPatrimoniaisControlador.podeImprimirDAM()}"
                                 value="Imprimir DAM"/>

                <p:commandButton styleClass="operacao" value="Voltar" icon="ui-icon-cancel"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.cancelar()}"/>
            </h:panelGrid>
        </h:form>

        <p:dialog id="dialogEfetivacao" width="1000" height="500"
                  modal="true" widgetVar="widgetDialogEfetivacao"
                  header="Efetivação de Contrato" resizable="false" closable="false">
            <h:form id="formEfetivacao">
                <p:panel>
                    <h:panelGrid id="panelDialog" columns="2">
                        <h:outputText value="Índice Econômico: "/>
                        <h:outputText id="indiceEconomicoParam"
                                      value="#{contratoRendasPatrimoniaisControlador.selecionado.indiceEconomico} - #{contratoRendasPatrimoniaisControlador.selecionado.valorUfmDoContrato}"
                                      styleClass="negrito"/>

                        <h:outputText value="Vigência: "/>
                        <h:outputText id="vigenciaDialog"
                                      value="#{contratoRendasPatrimoniaisControlador.parametroRendas.quantidadeMesesVigencia} #{contratoRendasPatrimoniaisControlador.parametroRendas.quantidadeMesesVigencia ne null ? ' Meses': ''}"
                                      styleClass="negrito"/>

                        <h:outputText value="Dia do Vencimento: "/>
                        <h:outputText id="diaVencimentoParam"
                                      value="#{contratoRendasPatrimoniaisControlador.parametroRendas.diaVencimentoParcelas}"
                                      styleClass="negrito"/>

                        <h:outputText value="Valor Total do Contrato (R$):"/>
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.somaDoValorTotalContratoMultiplicado}"
                            styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Quantidade Máxima de Parcelas: "/>
                        <h:outputText id="parcelasDialog"
                                      value="#{contratoRendasPatrimoniaisControlador.selecionado.periodoVigencia}"
                                      styleClass="negrito"/>


                    </h:panelGrid>
                    <br/>
                    <br/>
                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio for="quantidadeParcelas" value="Quantidade de Parcelas: "/>
                        <p:inputText id="quantidadeParcelas"
                                     value="${contratoRendasPatrimoniaisControlador.selecionado.quantidadeParcelas}"
                                     title="Informe a quantidade de Parcelas">
                            <p:ajax event="blur" process="@this" update="formEfetivacao"/>
                        </p:inputText>
                    </h:panelGrid>
                    <br/>
                    <p:dataTable id="tableParcelas"
                                 emptyMessage="A quantidade de parcelas deve ser igual ou menor do que o período de vigência"
                                 value="#{contratoRendasPatrimoniaisControlador.simulacaoParcelas}"
                                 var="p">
                        <f:facet name="header">
                            <h:outputText value="Demonstrativo de Parcelas"/>
                        </f:facet>
                        <p:column headerText="Parcela">
                            <h:outputText value="#{p.parcela}"/>
                        </p:column>
                        <p:column headerText="Valor (R$)">
                            <h:outputText value="#{p.valor}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Vencimento">
                            <h:outputText value="#{p.vencimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>

                    <p:commandButton value="Efetivar Contrato"
                                     styleClass="operacao prioritario"
                                     icon="ui-icon-check"
                                     disabled="#{!contratoRendasPatrimoniaisControlador.validarQuantidadeParcela(contratoRendasPatrimoniaisControlador.selecionado)}"
                                     ajax="true"
                                     onclick="if (!confirm('Tem certeza que deseja efetivar este contrato?'))
                                             return false;"
                                     actionListener="#{contratoRendasPatrimoniaisControlador.efetivaContrato}"/>

                    <p:commandButton value="Cancelar" styleClass="operacao" icon="ui-icon-close"
                                     onclick="widgetDialogEfetivacao.hide()"/>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogRenovacao" width="1000"
                  widgetVar="widgetDialogRenovacao"
                  header="Renovação de Contrato" resizable="false" closable="false"
                  height="530">
            <h:form id="formRenovacao">
                <p:panel styleClass="mbot10">
                    <h:panelGrid id="panelDialog" columns="2">
                        <h:outputText value="Vigência: "/>
                        <h:outputText id="vigenciaDialog"
                                      value="#{contratoRendasPatrimoniaisControlador.contratoRenovado.periodoVigencia} #{contratoRendasPatrimoniaisControlador.parametroRendas.quantidadeMesesVigencia ne null ? ' Meses': ''}"
                                      styleClass="negrito"/>

                        <h:outputText value="Área (M²): "/>
                        <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.somaTotalArea}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>

                        <h:outputText value="Valor por Mês (UFM): "/>
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.contratoRenovado.valorPorMesUFM}"
                            styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>

                        <h:outputText value="Valor por Mês (R$): "/>
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.contratoRenovado.valorPorMesRS}"
                            styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>

                        <h:outputText value="Valor Total (UFM): "/>
                        <h:outputText
                            value="#{contratoRendasPatrimoniaisControlador.contratoRenovado.valorTotalUFM}"
                            styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>

                        <h:outputText value="Quantidade Máxima de Parcelas: "/>
                        <h:outputText id="parcelasDialog"
                                      value="#{contratoRendasPatrimoniaisControlador.contratoRenovado.periodoVigencia}"
                                      styleClass="negrito"/>

                        <h:outputText value="Valor Total do Contrato: "/>
                        <h:outputText id="valorTotalContratoDialog"
                                      value="#{contratoRendasPatrimoniaisControlador.somaDoValorTotalContratoMultiplicadoRenovado}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="R$ #,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Usuário Operação: "/>
                        <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.usuarioOperacao.nome}"
                                      styleClass="negrito"/>
                        <fc:outputLabelObrigatorio value="Motivo da Operação: "/>
                        <p:inputTextarea value="#{contratoRendasPatrimoniaisControlador.selecionado.motivoOperacao}"
                                         maxlength="2000" counter="conta" counterTemplate="{0} caracteres restantes"
                                         styleClass="negrito" rows="3" cols="50">
                            <p:ajax process="@this" event="blur"/>
                        </p:inputTextarea>
                        <p:spacer/>
                        <h:outputText id="conta" styleClass="azulnegrito"/>

                        <fc:outputLabelObrigatorio for="quantidadeParcelas" value="Quantidade de Parcelas: "/>
                        <p:inputText id="quantidadeParcelas"
                                     value="${contratoRendasPatrimoniaisControlador.contratoRenovado.quantidadeParcelas}"
                                     title="Informe a quantidade desejada de Parcelas" size="6"
                                     maxlength="2">
                            <p:ajax event="blur" process="@this" update="@form"
                                    listener="#{contratoRendasPatrimoniaisControlador.calculaParcelas()}"/>
                        </p:inputText>
                    </h:panelGrid>
                    <p:dataTable id="tableParcelas" styleClass="mtop10"
                                 value="#{contratoRendasPatrimoniaisControlador.simulacaoParcelasRenovacao}"
                                 var="p"
                                 emptyMessage="Informe a quantidade de Parcelas igual ou inferior à quantide máxima!">
                        <f:facet name="header">
                            <h:outputText value="Simulação de Parcelas"/>
                        </f:facet>
                        <p:column headerText="Parcela" style="text-align: center; width: 34%">
                            <h:outputText
                                value="#{p.parcela}/#{contratoRendasPatrimoniaisControlador.contratoRenovado.quantidadeParcelas}"/>
                        </p:column>
                        <p:column headerText="Valor" style="text-align: right; width: 33%">
                            <h:outputText value="#{p.valor}">
                                <f:convertNumber pattern="R$ #,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Vencimento" style="text-align: center; width: 33%">
                            <h:outputText value="#{p.vencimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:panel>
                <p:commandButton value="Renovar Contrato"
                                 styleClass="operacao prioritario mbot10"
                                 icon="ui-icon-check"
                                 ajax="true"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 onclick="if (!confirm('Tem certeza que deseja RENOVAR este contrato?'))
                                             return false;"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.renovarContrato}"
                                 disabled="#{contratoRendasPatrimoniaisControlador.desabilitaRenovarContrato}"/>

                <p:commandButton value="Cancelar" styleClass="operacao mbot10" icon="ui-icon-close"
                                 onclick="widgetDialogRenovacao.hide()"/>
            </h:form>
        </p:dialog>
        <p:dialog id="rescisao" modal="true" closable="false" header="Rescisão de contrato."
                  widgetVar="dialogRescindirParcela"
                  resizable="false">
            <h:form>
                <h:outputLabel
                    value="ATENÇÃO: Este contrato possui parcelas vencidas. Tem certeza que deseja rescindi-lo mesmo assim?"
                    styleClass="negrito"/>
                <br/>

                <div align="center">
                    <p:commandButton value="Sim" styleClass="mtop10 mrig05 prioritario"
                                     style="height: 30px;" icon="ui-icon-check"
                                     actionListener="#{contratoRendasPatrimoniaisControlador.chamaDialogRescisao()}"/>
                    <p:commandButton value="Não" onclick="dialogRescindirParcela.hide()"
                                     styleClass="mtop10 mrig05 prioritario"
                                     style="height: 30px;" icon="ui-icon-close"/>
                </div>
            </h:form>

        </p:dialog>
        <p:dialog id="confirmacaoRescisao" modal="true" closable="false" header="Confirmação de Rescisão de Contrato."
                  widgetVar="dialogConfirmacaoRescisao" resizable="false">
            <h:form>
                <h:panelGrid columns="2">
                    <h:outputText value="Data/Hora da Operação"/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação:"/>
                    <p:inputTextarea value="#{contratoRendasPatrimoniaisControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" rows="5" counter="caracteresRescisao" cols="50"
                                     counterTemplate="{0} Caracteres Restantes"/>
                    <p:spacer/>
                    <h:outputText id="caracteresRescisao" styleClass="azulnegrito"/>
                </h:panelGrid>
                <p:commandButton value="Confirmar"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.confirmarRescisaoDoContrato()}"
                                 styleClass="mtop10 mrig05 prioritario" icon="ui-icon-check"/>
                <p:commandButton value="Cancelar"
                                 styleClass="mtop10 mrig05" icon="ui-icon-close"
                                 onclick="dialogConfirmacaoRescisao.hide()"
                />
            </h:form>
        </p:dialog>
        <p:dialog id="encerramento" modal="true" closable="false" header="Encerramento de contrato."
                  widgetVar="dialogEncerramentoParcela"
                  resizable="false">
            <h:form>
                <h:outputLabel
                    value="ATENÇÃO: Este contrato possui parcelas vencidas. Tem certeza que deseja encerrá-lo mesmo assim?"
                    styleClass="negrito"/>
                <br/>
                <p:commandButton value="Sim" styleClass="mtop10 mrig05 prioritario"
                                 style="height: 30px;" icon="ui-icon-check"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.chamaDialogEncerramento()}"/>
                <p:commandButton value="Não" onclick="dialogEncerramentoParcela.hide()"
                                 styleClass="mtop10 mrig05 prioritario"
                                 style="height: 30px;" icon="ui-icon-close"/>

            </h:form>
        </p:dialog>

        <p:dialog id="confirmacaoEncerramento" modal="true" closable="false"
                  header="Confirmação de Encerramento de Contrato."
                  widgetVar="dialogConfirmacaoEncerramento" resizable="false">
            <h:form>
                <h:panelGrid columns="2">
                    <h:outputText value="Data/Hora da Operação"/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação:"/>
                    <p:inputTextarea value="#{contratoRendasPatrimoniaisControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" rows="5" counter="caracteresEncerramento" cols="50"
                                     counterTemplate="{0} Caracteres Restantes"/>
                    <h:outputText id="caracteresEncerramento"/>
                </h:panelGrid>
                <p:commandButton value="Confirmar"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.confirmarEncerramentoDoContrato()}"
                                 styleClass="mtop10 mrig05 prioritario" icon="ui-icon-check"/>
                <p:commandButton value="Cancelar"
                                 styleClass="mtop10 mrig05" icon="ui-icon-close"
                                 onclick="dialogConfirmacaoEncerramento.hide()"
                />
            </h:form>
        </p:dialog>

        <p:dialog header="Alteração de Contrato" id="idAlteracaoContrato" widgetVar="alteracaoContrato"
                  modal="true" dynamic="true" position="center" resizable="false" height="550" width="1100"
        >
            <h:form id="formularioAlteracaoContrato">
                <h:panelGrid columns="2" styleClass="verticalAlignTop">
                    <h:outputText value="Usuário da Operação : "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.usuarioOperacao.nome}"
                                  styleClass="negrito"/>
                    <h:outputText value="Data e Hora da Operação: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação : "/>
                    <p:inputTextarea value="#{contratoRendasPatrimoniaisControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" cols="50"
                                     disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}">
                        <p:ajax process="@this" event="blur"/>
                    </p:inputTextarea>
                    <fc:outputLabelObrigatorio value="Locatário: "/>
                    <fc:novoAutocompletePessoa id="locatario"
                                               disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}"
                                               value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.locatario}"
                                               waterMark="Nenhum locatário selecionado"
                                               caminhoAtual="#{contratoRendasPatrimoniaisControlador.urlAtual}"
                                               size="70"
                                               permiteAlterarSituacoes="false"
                                               mostraSituacoes="false"
                                               mostraBotaoEdita="false"
                                               mostraBotaoInfo="false"
                                               mostraBotaoNovo="false"
                                               situacoesPossiveis="#{novoComponentePesquisaPessoaControlador.situacaoPorDescricao('ATIVO')}"
                                               listenerItemSelect="#{contratoRendasPatrimoniaisControlador.atualizaCamposPessoaContratoAlterado()}"
                                               listenerNavegacao="#{contratoRendasPatrimoniaisControlador.poeNaSessao()}"/>

                    <h:outputText value="Valor Total Pago no contrato: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorTotalPagoNoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Pago do contrato: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorPagoDoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Original vencido no contrato: "/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorOriginalVencidoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>
                </h:panelGrid>
                <p:panel id="panelPontosComerciais" header="Pontos Comerciais Objetos do Contrato" styleClass="mtop10">
                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio value="Localização: "/>
                        <p:autoComplete queryDelay="1000" id="autoCompleteLocalizacao"
                                        value="#{contratoRendasPatrimoniaisControlador.localizacao}"
                                        completeMethod="#{contratoRendasPatrimoniaisControlador.completaLocalizacao}"
                                        converter="#{contratoRendasPatrimoniaisControlador.converterLocalizacao}"
                                        var="localizacao"
                                        dropdown="true"
                                        itemLabel="#{localizacao.toStringAutoComplete}"
                                        itemValue="#{localizacao.id}"
                                        forceSelection="true"
                                        size="70"
                                        scrollHeight="200"
                                        disabled="#{!contratoRendasPatrimoniaisControlador.contratoAlterado.pontoComercialContratoRendasPatrimoniais.isEmpty()}">
                            <p:ajax event="itemSelect" process="@this"/>
                        </p:autoComplete>
                        <fc:outputLabelObrigatorio value="Atividade do Ponto Comercial: "/>
                        <h:selectOneMenu id="ponto" title="Informe a Atividade do Ponto"
                                         value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.atividadePonto}"
                                         converter="#{contratoRendasPatrimoniaisControlador.converterAtividadePonto}"
                                         disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}">
                            <f:selectItems value="#{contratoRendasPatrimoniaisControlador.atividadePontos}"/>
                            <p:ajax process="@this" event="change"/>
                        </h:selectOneMenu>
                        <fc:outputLabelObrigatorio value="Ponto Comercial (Box): "/>
                        <p:autoComplete queryDelay="1000"
                                        value="#{contratoRendasPatrimoniaisControlador.pontoComercialContratoRendasPatrimoniais.pontoComercial}"
                                        completeMethod="#{contratoRendasPatrimoniaisControlador.completaPontosQueNaoEstaoEmContrato}"
                                        converter="#{contratoRendasPatrimoniaisControlador.converterPonto}"
                                        var="ponto"
                                        dropdown="true"
                                        disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}"
                                        itemLabel="#{ponto.descricaoCompleta}"
                                        itemValue="#{ponto.id}"
                                        forceSelection="true"
                                        scrollHeight="200"
                                        size="70"
                                        id="pontoComercial">
                            <p:ajax event="itemSelect" process="@this"/>
                        </p:autoComplete>
                    </h:panelGrid>
                    <p:commandButton id="adicionarPontoComercial" value="Adicionar" icon="ui-icon-circle-arrow-s"
                                     disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}"
                                     process="@this" onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                     actionListener="#{contratoRendasPatrimoniaisControlador.adicionaPontoComercialContratoAlterado()}"
                                     title="Adicionar ponto comercial ao contrato"
                                     update="tabelaPontosComerciaisAlteracao pontoComercial :formularioAlteracaoContrato"/>
                    <p:panel style="border: 0" id="panelMensagem"
                             rendered="#{!contratoRendasPatrimoniaisControlador.contratoAlterado.pontoComercialContratoRendasPatrimoniais.isEmpty()}">
                        <div class="alert alert-alert" align="center">
                            <strong>Atenção! </strong> Para alterar a Localização é necessário remover todos os pontos comerciais adicionados.
                        </div>
                    </p:panel>
                    <p:dataTable id="tabelaPontosComerciaisAlteracao"
                                 value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.pontoComercialContratoRendasPatrimoniais}"
                                 var="item" emptyMessage="Nenhum Ponto Comercial Adicionado!">
                        <p:column headerText="Ponto Comercial (Box)" style="text-align: left">
                            <h:outputText value="#{item.pontoComercial}"/>
                            <f:facet name="footer">
                                <h:outputText value="Total" styleClass="negrito"/><br/>
                                <h:outputText value="Valor Pago" styleClass="negrito"/><br/>
                                <h:outputText value="Valor Vencido" styleClass="negrito"/><br/>
                                <h:outputText value="Saldo" styleClass="negrito"/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Área (M²)" style="text-align: right">
                            <h:outputText value="#{item.area}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.somaTotalArea}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                                <br/><br/><br/><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor do M² (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorMetroQuadrado}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.somaValorMetroQuadrado}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                                <br/><br/><br/><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor por Mês(UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorCalculadoMes}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.somaDoValorCalculadoMes}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                                <br/><br/><br/><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor por Mês (R$)" style="text-align: right">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.getMultiplicaPeloUFMAtual(item.valorCalculadoMes)}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.somaDoValorCalculadoMesMultiplicadoContratoAlterado}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                                <br/><br/><br/><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorTotalContrato}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.contratoAlterado.somaDoValorTotalContrato}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                                <br/><br/><br/><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (R$)" style="text-align: right">
                            <h:outputText
                                value="#{contratoRendasPatrimoniaisControlador.getMultiplicaPeloUFMAtual(item.valorTotalContrato)}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.somaDoValorTotalContratoMultiplicadoAlterado}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText><br/>
                                <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorPagoDoContrato}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText><br/>
                                <h:outputText
                                    value="#{contratoRendasPatrimoniaisControlador.valorOriginalVencidoContrato}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText><br/>
                                <h:outputText value="#{contratoRendasPatrimoniaisControlador.saldoDoContrato}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Remover" style="text-align: center">
                            <p:commandButton
                                disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}"
                                actionListener="#{contratoRendasPatrimoniaisControlador.removePontoComercialContratoAlterado}"
                                update="tabelaPontosComerciaisAlteracao :formularioAlteracaoContrato:autoCompleteLocalizacao :formularioAlteracaoContrato"
                                icon="ui-icon-trash"
                                styleClass="wp-botao-tabela"
                                process="@this"
                                onclick="if(!confirm('Tem certeza que deseja excluir este Ponto Comercial?'))
                                         return false;">
                                <f:attribute value="#{item}" name="objeto"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:panel>

                <br/>
                <p:commandButton value="Confirmar" icon="ui-icon-check" process="@this"
                                 styleClass="operacao prioritario"
                                 title="Confirmar Alteração do Contrato"
                                 onclick="aguarde.show()" id="confirmarAlteracaoParcial"
                                 oncomplete="aguarde.hide()"
                                 disabled="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.confirmarAlteracaoDeContrato()}"
                                 update="formularioAlteracaoContrato"/>

                <p:commandButton value="Cancelar Operação" icon="ui-icon-close" process="@this"
                                 styleClass="operacao"
                                 actionListener="#{contratoRendasPatrimoniaisControlador.cancelarAlteracaoDeContrato()}"
                                 title="Cancelar alteração do contrato."
                                 onclick="alteracaoContrato.hide()"
                                 update="formularioAlteracaoContrato"/>
                <br/>
                <br/>
                <p:outputPanel id="parcelasAlteracao"
                               rendered="#{contratoRendasPatrimoniaisControlador.mostraDemonstrativoDeParcelas}">
                    <p:panel header="Parcelas" rendered="#{contratoRendasPatrimoniaisControlador.soAlterouPessoa()}">
                        <h:outputText
                            value="Foi alterado somente o locatario nessa alteração, sendo assim, caso haja parcelas com a situação de em aberto, as parcelas serão passadas para o nome do novo locatario."/>
                    </p:panel>
                    <p:panel header="Parcelas" rendered="#{!contratoRendasPatrimoniaisControlador.soAlterouPessoa()}">
                        <fc:outputLabelObrigatorio value="Quantidade de Parcelas:"/>
                        <p:inputText id="quantidadeParcelasAlteracao"
                                     value="${contratoRendasPatrimoniaisControlador.contratoAlterado.quantidadeParcelas}"
                                     title="Informe a quantidade de Parcelas">
                            <p:ajax event="blur" process="@this" update="parcelasAlteracao"
                                    listener="#{contratoRendasPatrimoniaisControlador.calcularSimulacaoParcelasAlteracaoContrato()}"/>
                        </p:inputText>
                        <p:dataTable id="tableParcelasAlteracao"
                                     value="#{contratoRendasPatrimoniaisControlador.parcelasAlteracaoContrato}"
                                     var="p" styleClass="mtop05"
                                     emptyMessage="Nenhuma parcela será gerada de acordo com a quantidade de parcelas e o valor do contrato!">
                            <f:facet name="header">
                                <h:outputText value="Demonstrativo de Parcelas"/>
                            </f:facet>
                            <p:column headerText="Parcela" style="text-align: center">
                                <h:outputText value="#{p.parcela}"/>
                            </p:column>
                            <p:column headerText="Valor (R$)" style="text-align: right">
                                <h:outputText value="#{p.valor}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Vencimento" style="text-align: center">
                                <h:outputText value="#{p.vencimento}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                    <p:commandButton value="Alterar o Contrato" id="confirmarAlteracaoContrato"
                                     styleClass="operacao prioritario mtop05 mbot05"
                                     disabled="#{!contratoRendasPatrimoniaisControlador.podeEfetivarAlteracaoContrato()}"
                                     actionListener="#{contratoRendasPatrimoniaisControlador.salvarAlteracaoContrato()}"
                                     onclick="aguarde.show()" oncomplete="aguarde.hide()" icon="ui-icon-disk"/>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog header="Confirmação de Lançamento do DAM"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  widgetVar="confirmaDam">
            <h:form id="formConfirmaDam">
                <div class="centralizado">
                    <h:outputText value="Você selecionou mais de uma parcela. O que deseja fazer? "
                                  rendered="#{contratoRendasPatrimoniaisControlador.maisDeUmaParcelaSelecionada()}"
                                  styleClass="negrito"/>
                </div>
                <h:panelGrid columns="2">
                    <h:outputText value="Valor: R$"/>
                    <h:outputText value="#{contratoRendasPatrimoniaisControlador.valorDam()}" styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>
                </h:panelGrid>

                <div class="alert alert-info">
                    <strong>Atenção! </strong> Para parcelas vencidas ou DAMs agrupados será gerado um DAM com vencimento para o último dia útil do mês.
                    (<h:outputText value="#{contratoRendasPatrimoniaisControlador.calcularVencimentoDam()}"
                                   styleClass="negrito">
                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                </h:outputText>)
                </div>
                <p:separator/>
                <h:panelGrid columns="2" style="width: 100%" styleClass="centralizado">
                    <p:commandButton
                        value="#{contratoRendasPatrimoniaisControlador.maisDeUmaParcelaSelecionada() ? 'DAM Individual' : 'Imprimir DAM'}"
                        icon="ui-icon-print"
                        onclick="aguarde.show()"
                        oncomplete="aguarde.hide();confirmaDam.hide()"
                        actionListener="#{contratoRendasPatrimoniaisControlador.imprimeDam(false)}"
                        styleClass="operacao"/>

                    <p:commandButton value="DAM Agrupado"
                                     rendered="#{contratoRendasPatrimoniaisControlador.maisDeUmaParcelaSelecionada()}"
                                     icon="ui-icon-print"
                                     onclick="aguarde.show()"
                                     oncomplete="aguarde.hide();confirmaDam.hide()"
                                     styleClass="operacao"
                                     actionListener="#{contratoRendasPatrimoniaisControlador.imprimeDam(true)}"/>
                </h:panelGrid>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
</html>
