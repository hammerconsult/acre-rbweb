<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
    >
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <fc:cabecalhoPretty origem="#{contratoCEASAControlador.caminhoPadrao}listar/"
                                mostrarBotaoNovo="${false}"
                                auditavel="${true}"
                                controlador="#{contratoCEASAControlador}"/>
            <p:outputPanel
                rendered="#{contratoCEASAControlador.selecionado.temContratoOriginal()}">
                <div class="ui-messages-warn ui-corner-all textomedio">
                    <div class="ui-messages-warn-icon margem-direita-cinco-pixels"/>
                    <h:outputText value="Atenção! "
                                  styleClass="ui-messages-warn-summary"/>
                    <h:outputText
                        value="Este contrato é uma #{contratoCEASAControlador.getSituacaoDoContratoOrinario(contratoCEASAControlador.selecionado.originario)
             eq 'RENOVADO' ? 'RENOVAÇÃO.' : 'ALTERAÇÃO.'} Para ver o contrato anterior clique na lupa ao lado."
                        styleClass="ui-messages-warn-detail"/>
                    <h:commandLink
                        actionListener="#{contratoCEASAControlador.navegarParaProximoContrato()}"
                        onclick="aguarde.show()">
                        <h:graphicImage id="visualizar"
                                        alt="visualizar"
                                        url="/img/pesquisa.png"
                                        width="15">
                        </h:graphicImage>
                    </h:commandLink>
                    <br/>
                </div>
            </p:outputPanel>
            <p:panel id="panelContrato" header="Detalhes do Contrato">
                <h:panelGrid id="panelGridContrato" columns="2">
                    <h:outputText value="Número do Contrato: "/>
                    <h:outputText value="${contratoCEASAControlador.selecionado.numeroContrato}" styleClass="negrito"/>

                    <h:outputText value="Situação do Contrato: "/>
                    <h:outputText value="${contratoCEASAControlador.selecionado.situacaoContrato}"
                                  styleClass="negrito"/>

                    <h:outputText value="Índice Econômico: "/>
                    <h:outputText
                        value="#{contratoCEASAControlador.selecionado.indiceEconomico.descricao} - #{contratoCEASAControlador.selecionado.valorUFMAtual}"
                        styleClass="negrito"/>

                    <h:outputText value="Vigência: "/>
                    <h:outputText
                        value="${contratoCEASAControlador.selecionado.periodoVigencia} ${contratoCEASAControlador.selecionado.periodoVigencia ne null ? ' Meses': ''}"
                        styleClass="negrito"/>

                    <h:outputText value="Dia do Vencimento: "/>
                    <h:outputText value="${contratoCEASAControlador.selecionado.diaVencimento}" styleClass="negrito"/>

                    <h:outputText value="Data de Início do Contrato: "/>
                    <h:outputText value="${contratoCEASAControlador.selecionado.dataInicio}"
                        styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Data de Fim do Contrato: "/>
                    <h:outputText value="${contratoCEASAControlador.selecionado.dataFim}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>

                    <h:outputText value="Localização: "/>
                    <h:outputText value="#{contratoCEASAControlador.localizacao.descricao}"
                                  styleClass="negrito"/>

                    <h:outputText value="Atividade do Ponto Comercial: "/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.atividadePonto.descricao}"
                                  styleClass="negrito"/>

                    <h:outputText value="Valor da Licitação: "/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.valorLicitacao}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText rendered="#{contratoCEASAControlador.selecionado.temContratoOriginal()}"
                                  value="Valor do contrato na #{contratoCEASAControlador.getSituacaoDoContratoOrinario(contratoCEASAControlador.selecionado.originario)
             eq 'RENOVADO' ? 'Renovação' : 'Alteração'}:"/>
                    <h:outputText value="#{contratoCEASAControlador.valorDoCalculoDoContrato}"
                                  rendered="#{contratoCEASAControlador.selecionado.temContratoOriginal()}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText rendered="#{contratoCEASAControlador.selecionado.temContratoOriginal()}"
                                  value="Valor do rateio na #{contratoCEASAControlador.getSituacaoDoContratoOrinario(contratoCEASAControlador.selecionado.originario)
             eq 'RENOVADO' ? 'Renovação' : 'Alteração'}:"/>
                    <h:outputText value="#{contratoCEASAControlador.valorDoCalculoDoRateio}"
                                  rendered="#{contratoCEASAControlador.selecionado.temContratoOriginal()}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>
                </h:panelGrid>
                <br/>
                <p:panel header="Dados do Locatário">
                    <h:panelGrid columns="2">
                        <h:outputText value="Cadastro Econômico: "/>
                        <h:outputText
                            value="${contratoCEASAControlador.locatario.inscricaoCadastral} - ${contratoCEASAControlador.locatario.pessoa.nome} - ${contratoCEASAControlador.locatario.pessoa.cpf_Cnpj}"
                            styleClass="negrito"/>
                    </h:panelGrid>
                    <br/>
                    <p:dataTable id="tabelaEnderecos" emptyMessage="Nenhum registro encontrado."
                                 value="#{contratoCEASAControlador.enderecos}"
                                 var="ender">
                        <f:facet name="header">
                            <h:outputText value="Endereço(s) do Locatário"/>
                        </f:facet>
                        <p:column headerText="Tipo">
                            <h:outputText value="#{ender.tipoEndereco.descricao}"/>
                        </p:column>
                        <p:column headerText="Logradouro">
                            <h:outputText value="#{ender.logradouro}"/>
                        </p:column>
                        <p:column headerText="Número" style="text-align: center">
                            <h:outputText value="#{ender.numero}"/>
                        </p:column>
                        <p:column headerText="Complemento">
                            <h:outputText value="#{ender.complemento}"/>
                        </p:column>
                        <p:column headerText="Bairro">
                            <h:outputText value="#{ender.bairro}"/>
                        </p:column>
                        <p:column headerText="Cidade">
                            <h:outputText value="#{ender.localidade}"/>
                        </p:column>
                        <p:column headerText="UF" style="text-align: center">
                            <h:outputText value="#{ender.uf}"/>
                        </p:column>
                        <p:column headerText="CEP" style="text-align: center">
                            <h:outputText value="#{ender.cep}"/>
                        </p:column>
                        <p:column headerText="Principal" style="text-align: center">
                            <h:outputText value="#{ender.principal ? 'Sim' : 'Não'}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <p:dataTable id="tabelaTelefones" emptyMessage="Nenhum registro encontrado."
                                 value="#{contratoCEASAControlador.telefones}"
                                 var="telefone">
                        <f:facet name="header">
                            <h:outputText value="Telefone(s) do Locatário"/>
                        </f:facet>
                        <p:column headerText="Tipo">
                            <h:outputText value="#{telefone.tipoFone.tipoFone}"/>
                        </p:column>
                        <p:column headerText="Telefone">
                            <h:outputText value="#{telefone.telefone}"/>
                        </p:column>
                        <p:column headerText="Principal" style="text-align: center">
                            <h:outputText value="#{telefone.principal ? 'Sim' : 'Não'}"/>
                        </p:column>
                    </p:dataTable>
                </p:panel>
                <br/>
                <p:panel id="panelPontosComerciais" header="Pontos Comerciais Objetos do Contrato">
                    <p:dataTable id="tabelaPontosComerciais"
                                 value="#{contratoCEASAControlador.selecionado.pontoComercialContratoCEASAs}"
                                 var="item"
                                 emptyMessage="Nenhum ponto comercial adicionado">
                        <p:column headerText="Ponto Comercial (Box)" id="cpontcom">
                            <h:outputText value="#{item.pontoComercial}"/>
                            <f:facet name="footer">
                                <h:outputText value="Total" styleClass="negrito"/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Área (M²)" style="text-align: right">
                            <h:outputText value="#{item.area}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.selecionado.somaTotalArea}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor do M² (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorMetroQuadrado}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor por Mês (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorCalculadoMes}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.selecionado.somaDoValorCalculadoMes}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor por Mês (R$)" style="text-align: right">
                            <h:outputText
                                value="#{contratoCEASAControlador.getCalcularUFMDoContratoEmReais(item.valorCalculadoMes)}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.getCalcularValorTotalMensal()}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorTotalContrato}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.selecionado.somaDoValorTotalContrato}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (R$)" style="text-align: right">
                            <h:outputText
                                value="#{contratoCEASAControlador.getCalcularUFMDoContratoEmReais(item.valorTotalContrato)}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoCEASAControlador.getCalcularDoValorTotalContratoMultiplicado()}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>

                    </p:dataTable>
                </p:panel>
                <br/>
                <p:panel header="RDC - Rateio das Despesas Comuns" id="rateio">
                    <h:panelGrid columns="2">
                        <h:outputText value="Área Total para Rateio (m²)"/>
                        <h:outputText value="#{contratoCEASAControlador.selecionado.areaTotalRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Total dos Serviços para Rateio (R$)"/>
                        <h:outputText value="#{contratoCEASAControlador.selecionado.valorServicosRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor do Rateio por Mês (R$)"/>
                        <h:outputText value="#{contratoCEASAControlador.selecionado.valorMensalRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Total do Rateio (R$)"/>
                        <h:outputText value="#{contratoCEASAControlador.selecionado.valorTotalRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>
                    </h:panelGrid>
                </p:panel>
                <br/>
                <p:dataTable id="tabelaConsultas"
                             style="width: 100% !important"
                             var="parcela"
                             rowStyleClass="#{parcela.situacaoDescricaoEnum eq 'Em Aberto'? parcela.vencimento lt programacaoCobrancaControlador.dataOperacao? 'vermelho': 'verde': ''}"
                             emptyMessage="Nenhuma parcela encontrada."
                             value="#{contratoCEASAControlador.parcelas}">
                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="Parcelas do Contrato"/>
                        </p:outputPanel>
                    </f:facet>
                    <p:column headerText="Cadastro" style="width: 8%;">
                        <h:outputText value="#{parcela.cadastro}"/>
                    </p:column>
                    <p:column headerText="Dívida" style="width: 12%;">
                        <h:outputText value="#{parcela.divida}"/>
                    </p:column>
                    <p:column headerText="Exercício" style="width: 5%; text-align: center;"
                              sortBy="#{parcela.exercicio}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.exercicio}"/>
                    </p:column>
                    <p:column headerText="Tipo de Débito" style="width: 5%;">
                        <h:outputText value="#{parcela.tipoDeDebito}"/>
                    </p:column>
                    <p:column headerText="Parcela" style="width: 2%; text-align: center;"
                              sortBy="#{parcela.parcela}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.parcela}"/>
                    </p:column>
                    <p:column headerText="SD" style="width: 2%; text-align: center;">
                        <h:outputText value="#{parcela.sd}"/>
                    </p:column>
                    <p:column headerText="Vencimento" style="width: 5%; text-align: center;"
                              sortBy="#{parcela.vencimentoToString}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.vencimentoToString}"/>
                    </p:column>
                    <p:column headerText="Imposto" style="text-align: right">
                        <h:outputText value="#{parcela.valorImposto}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Taxa" style="text-align: right">
                        <h:outputText value="#{parcela.valorTaxa}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Desconto" style="text-align: right">
                        <h:outputText value="#{parcela.valorDesconto}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Juros" style="text-align: right">
                        <h:outputText value="#{parcela.valorJuros}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Multa" style="text-align: right">
                        <h:outputText value="#{parcela.valorMulta}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Honorários" style="text-align: right">
                        <h:outputText value="#{parcela.valorHonorarios}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Total" style="text-align: right">
                        <h:outputText value="#{parcela.valorTotal}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Situação">
                        <h:outputText value="#{parcela.situacaoDescricaoEnum}" title="cod. ${parcela.idParcela}"/>
                    </p:column>
                </p:dataTable>
                <br/>
                <br/>
                <p:dataTable id="tabelaConsultasLicitacao"
                             style="width: 100% !important"
                             var="parcela"
                             rowStyleClass="#{parcela.situacaoDescricaoEnum eq 'Em Aberto'? parcela.vencimento lt programacaoCobrancaControlador.dataOperacao? 'vermelho': 'verde': ''}"
                             emptyMessage="Não existe licitação para esse contrato."
                             value="#{contratoCEASAControlador.parcelasLicitacao}">
                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="Parcelas da Licitação"/>
                        </p:outputPanel>
                    </f:facet>
                    <p:column headerText="Cadastro" style="width: 8%;">
                        <h:outputText value="#{parcela.cadastro}"/>
                    </p:column>
                    <p:column headerText="Dívida" style="width: 12%;">
                        <h:outputText value="#{parcela.divida}"/>
                    </p:column>
                    <p:column headerText="Exercício" style="width: 5%; text-align: center;"
                              sortBy="#{parcela.exercicio}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.exercicio}"/>
                    </p:column>
                    <p:column headerText="Tipo de Débito" style="width: 5%;">
                        <h:outputText value="#{parcela.tipoDeDebito}"/>
                    </p:column>
                    <p:column headerText="Parcela" style="width: 2%; text-align: center;"
                              sortBy="#{parcela.parcela}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.parcela}"/>
                    </p:column>
                    <p:column headerText="SD" style="width: 2%; text-align: center;">
                        <h:outputText value="#{parcela.sd}"/>
                    </p:column>
                    <p:column headerText="Vencimento" style="width: 5%; text-align: center;"
                              sortBy="#{parcela.vencimentoToString}" filterMatchMode="contains">
                        <h:outputText value="#{parcela.vencimentoToString}"/>
                    </p:column>
                    <p:column headerText="Imposto" style="text-align: right">
                        <h:outputText value="#{parcela.valorImposto}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Taxa" style="text-align: right">
                        <h:outputText value="#{parcela.valorTaxa}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Desconto" style="text-align: right">
                        <h:outputText value="#{parcela.valorDesconto}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Juros" style="text-align: right">
                        <h:outputText value="#{parcela.valorJuros}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Multa" style="text-align: right">
                        <h:outputText value="#{parcela.valorMulta}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Honorários" style="text-align: right">
                        <h:outputText value="#{parcela.valorHonorarios}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Total" style="text-align: right">
                        <h:outputText value="#{parcela.valorTotal}">
                            <f:convertNumber pattern="###,##0.00"/>
                        </h:outputText>

                    </p:column>
                    <p:column headerText="Situação">
                        <h:outputText value="#{parcela.situacaoDescricaoEnum}" title="cod. ${parcela.idParcela}"/>
                    </p:column>
                </p:dataTable>
            </p:panel>
            <br/>
            <h:panelGrid columns="9">

                <p:commandButton value="Renovar" id="botaoRenovar" icon="ui-icon-script"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 actionListener="#{contratoCEASAControlador.chamaDialogRenovacaoContrato}"/>

                <p:commandButton value="Rescindir " icon="ui-icon-closethick"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 actionListener="#{contratoCEASAControlador.rescindirContrato()}"
                                 onclick="if (!confirm('Deseja RESCINDIR este contrato?')) return false;"/>

                <p:commandButton value="Encerrar Contrato " icon="ui-icon-closethick"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 actionListener="#{contratoCEASAControlador.encerrarContrato()}"
                                 onclick="if (!confirm('Deseja ENCERRAR este contrato?')) return false;"/>

                <p:commandButton value="Alteração de Contrato" icon="ui-icon-pencil"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 styleClass="operacao"
                                 actionListener="#{contratoCEASAControlador.chamaDialogAlteracaoContrato()}"
                                 onclick="if (!confirm('Deseja Alterar este contrato?')) return false;"/>

                <p:commandButton rendered="#{contratoCEASAControlador.podeImprimirContrato}"
                                 icon="ui-icon-print"
                                 actionListener="#{contratoCEASAControlador.verificaSeTemDocumentoOficialGerado()}"
                                 value="Imprimir Contrato"
                                 styleClass="operacao"/>

                <p:commandButton rendered="#{!contratoCEASAControlador.podeImprimirContrato}"
                                 icon="ui-icon-print"
                                 value="Imprimir Contrato"
                                 styleClass="operacao"
                                 oncomplete="widgetDialogNaoImprimeContrato.show()" ajax="true"/>

                <fc:botaoTargetBlank actionListener="#{contratoCEASAControlador.imprimeDAM()}"
                                     disabled="#{!contratoCEASAControlador.contratoEfetivado}"
                                     label="Imprimir DAM do Contrato"/>

                <fc:botaoTargetBlank actionListener="#{contratoCEASAControlador.imprimeDamLicitacao()}"
                                     disabled="#{!contratoCEASAControlador.imprimeDAMLicitacaoHabilitado}"
                                     label="Imprimir DAM da Licitação"/>

                <p:commandButton ajax="false" value="Voltar" actionListener="#{contratoCEASAControlador.cancelar()}"
                                 styleClass="operacao" icon="ui-icon-cancel"/>

                <p:commandButton value="Gerar Debito" actionListener="#{contratoCEASAControlador.gerarDebitoQuandoNaoGerado()}"
                                 onclick="aguarde.show()"
                                 rendered="#{sistemaControlador.usuarioCorrente.hasRole('ROLE_ADMIN')}"
                                 oncomplete="aguarde.hide()"
                                 update="@form"
                                 styleClass="operacao"/>
            </h:panelGrid>
        </h:form>


        <p:confirmDialog id="confirmaSemValorLicitacao"
                         message="Tem certeza que deseja efetivar este contrato sem licitação ?"
                         header="Confirmação" severity="alert" widgetVar="widgetConfirmaSemValorLicitacao">
            <h:form id="formConfirmaSemValorLicitacao">
                <h:panelGrid columns="2">
                    <p:commandButton id="btnConfirma" value="Sim" title="Sim"
                                     oncomplete="widgetConfirmaSemValorLicitacao.hide()"
                                     actionListener="#{contratoCEASAControlador.chamaDialogEfetivacao}"
                                     ajax="true"/>

                    <p:commandButton id="btnCancelar" value="Não" title="Não"
                                     onclick="widgetConfirmaSemValorLicitacao.hide()"
                                     ajax="true"/>
                </h:panelGrid>
            </h:form>
        </p:confirmDialog>
        <p:confirmDialog id="idDialogDocumentoOficial"
                         message="ATENÇÃO: Já existe um documento de contrato gerado. O que deseja fazer?"
                         modal="true" header="Confirmação" severity="alert" widgetVar="dialogDocumentoOficial">
            <h:form id="formDialogDoc">
                <h:outputText value=""/>
                <Br/>
                <h:panelGrid columns="2">
                    <fc:botaoTargetBlank actionListener="#{contratoCEASAControlador.imprimeContratoExistente()}"
                                         imprimeNoDialog="true" label="Imprimir contrato existente"
                                         title="Imprime contrato já gerado anteriormente"/>

                    <fc:botaoTargetBlank actionListener="#{contratoCEASAControlador.imprimeNovoContrato()}"
                                         imprimeNoDialog="true" label="Atualizar contrato e imprimir"
                                         title="Imprime novo contrato com os dados atualizados"/>

                </h:panelGrid>
            </h:form>
        </p:confirmDialog>

        <p:confirmDialog id="confirmaComValorLicitacao" message="Tem certeza que deseja efetivar este contrato ?"
                         modal="true" header="Confirmação" severity="alert" widgetVar="widgetConfirmaComValorLicitacao">
            <h:form id="formConfirmaComValorLicitacao">
                <h:panelGrid columns="2">
                    <p:commandButton id="btnConfirma2" value="Sim" title="Sim"
                                     oncomplete="widgetConfirmaComValorLicitacao.hide()"
                                     action="#{contratoCEASAControlador.chamaDialogEfetivacao}"
                                     ajax="true"/>

                    <p:commandButton id="btnCancelar2" value="Não" title="Não"
                                     onclick="widgetConfirmaComValorLicitacao.hide()"
                                     ajax="true"/>
                </h:panelGrid>
            </h:form>
        </p:confirmDialog>

        <p:confirmDialog id="dialogNaoImprimeContrato"
                         message="Não Foi Possível Continuar! O DAM da Licitação ainda não foi pago."
                         modal="true" header="Aviso" severity="alert" widgetVar="widgetDialogNaoImprimeContrato">
            <h:form id="formDialogNaoImprimeContrato">
                <h:panelGrid columns="2">
                    <p:commandButton id="btnOK" value="OK" title="OK"
                                     onclick="widgetDialogNaoImprimeContrato.hide()"/>
                </h:panelGrid>
            </h:form>
        </p:confirmDialog>


        <p:dialog id="dialogEfetivacao" width="1000" height="500"
                  modal="true" widgetVar="widgetDialogEfetivacao"
                  header="Efetivação de Contrato" resizable="false" closable="false">
            <h:form id="formEfetivacao">
                <p:panel>
                    <h:panelGrid id="panelDialog" columns="2">
                        <h:outputText value="Índice Econômico: "/>
                        <h:outputText id="indiceEconomicoParam"
                                      value="#{contratoCEASAControlador.selecionado.indiceEconomico} - #{contratoCEASAControlador.selecionado.valorUFMAtual}"/>

                        <h:outputText value="Vigência: "/>
                        <h:outputText id="vigenciaDialog"
                                      value="#{contratoCEASAControlador.parametroRendas.quantidadeMesesVigencia} #{contratoCEASAControlador.parametroRendas.quantidadeMesesVigencia ne null ? ' Meses': ''}"
                                      styleClass="negrito"/>

                        <h:outputText value="Dia do Vencimento: "/>
                        <h:outputText id="diaVencimentoParam"
                                      value="#{contratoCEASAControlador.parametroRendas.diaVencimentoParcelas}"
                                      styleClass="negrito"/>

                        <h:outputText value="Valor Total do Contrato: "/>
                        <h:outputText value="#{contratoCEASAControlador.somaDoValorTotalContratoMultiplicado}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>

                        <h:outputText value="Quantidade de Parcelas: "/>
                        <h:outputText id="parcelasDialog" value="#{contratoCEASAControlador.quantidadeParcelas}"
                                      styleClass="negrito"/>
                    </h:panelGrid>
                    <br/>
                    <br/>
                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio for="quantidadeParcelas" value="Quantidade de Parcelas: "/>
                        <p:inputText id="quantidadeParcelas"
                                     value="${contratoCEASAControlador.selecionado.quantidadeParcelas}"
                                     title="Informe a quantidade de Parcelas">
                            <p:ajax event="blur" process="@this" update="tableParcelas"/>
                        </p:inputText>
                    </h:panelGrid>
                    <br/>

                    <p:dataTable id="tableParcelas"
                                 value="#{contratoCEASAControlador.simulacaoParcelas}"
                                 emptyMessage="A quantidade de parcelas informada deve ser menor que a quantidade máxima permitida."
                                 var="p">
                        <f:facet name="header">
                            <h:outputText value="Demonstrativo de Parcelas"/>
                        </f:facet>
                        <p:column headerText="Parcela">
                            <h:outputText value="#{p.parcela}"/>
                        </p:column>
                        <p:column headerText="Valor do Contrato (R$)">
                            <h:outputText value="#{p.valor}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor do Rateio (R$)">
                            <h:outputText value="#{p.valorRateio}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor da Parcela (R$)">
                            <h:outputText value="#{p.valorTotal}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Vencimento">
                            <h:outputText value="#{p.vencimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <p:commandButton value="Efetivar Contrato"
                                     styleClass="operacao prioritario"
                                     icon="ui-icon-check"
                                     ajax="true"
                                     update="@form"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     onclick="if (!confirm('Tem certeza que deseja efetivar este contrato?'))
                                                     return false;"
                                     action="#{contratoCEASAControlador.efetivaContrato}"/>

                    <p:commandButton value="Cancelar" styleClass="operacao" icon="ui-icon-close"
                                     onclick="widgetDialogEfetivacao.hide()"/>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog id="rescisao" modal="true" closable="false" header="Rescisão de contrato."
                  widgetVar="dialogRescindirParcela"
                  resizable="false">
            <h:form>
                <h:outputLabel
                    value="ATENÇÃO: Este contrato possui parcelas vencidas. Tem certeza que deseja rescindi-lo mesmo assim?"
                    styleClass="negrito"/>
                <br/>

                <div align="center">
                    <p:commandButton value="Sim" styleClass="mtop10 mrig05 prioritario"
                                     style="height: 30px;" icon="ui-icon-check"
                                     actionListener="#{contratoCEASAControlador.chamaDialogRescisao()}"/>
                    <p:commandButton value="Não" onclick="dialogRescindirParcela.hide()"
                                     styleClass="mtop10 mrig05 prioritario"
                                     style="height: 30px;" icon="ui-icon-close"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog id="confirmacaoRescisao" modal="true" closable="false" header="Confirmação de Rescisão de Contrato."
                  widgetVar="dialogConfirmacaoRescisao" resizable="false">
            <h:form>
                <h:panelGrid columns="2">
                    <h:outputText value="Data/Hora da Operação"/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação:"/>
                    <p:inputTextarea value="#{contratoCEASAControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" rows="5" counter="caracteresRescisao" cols="50"
                                     counterTemplate="{0} Caracteres Restantes"/>
                    <h:outputText id="caracteresRescisao"/>
                </h:panelGrid>
                <p:commandButton value="Confirmar"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 actionListener="#{contratoCEASAControlador.confirmarRescisaoDoContrato()}"
                                 update=":Formulario:tabelaConsultas"
                                 styleClass="mtop10 mrig05 prioritario" icon="ui-icon-check"/>
                <p:commandButton value="Cancelar"
                                 styleClass="mtop10 mrig05" icon="ui-icon-close"
                                 onclick="dialogConfirmacaoRescisao.hide()"/>
            </h:form>
        </p:dialog>

        <p:dialog id="encerramento" modal="true" closable="false" header="Encerramento de contrato."
                  widgetVar="dialogEncerramentoParcela"
                  resizable="false">
            <h:form>
                <h:outputLabel
                    value="ATENÇÃO: Este contrato possui parcelas vencidas. Tem certeza que deseja encerrá-lo mesmo assim?"
                    styleClass="negrito"/>
                <br/>
                <p:commandButton value="Sim" styleClass="mtop10 mrig05 prioritario"
                                 style="height: 30px;" icon="ui-icon-check"
                                 actionListener="#{contratoCEASAControlador.chamaDialogEncerramento()}"/>
                <p:commandButton value="Não" onclick="dialogEncerramentoParcela.hide()"
                                 styleClass="mtop10 mrig05 prioritario"
                                 style="height: 30px;" icon="ui-icon-close"/>

            </h:form>
        </p:dialog>
        <p:dialog id="confirmacaoEncerramento" modal="true" closable="false"
                  header="Confirmação de Encerramento de Contrato."
                  widgetVar="dialogConfirmacaoEncerramento" resizable="false">
            <h:form>
                <h:panelGrid columns="2">
                    <h:outputText value="Data/Hora da Operação"/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação:"/>
                    <p:inputTextarea value="#{contratoCEASAControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" rows="5" counter="caracteresRescisao" cols="50"
                                     counterTemplate="{0} Caracteres Restantes"/>
                    <h:outputText id="caracteresRescisao"/>
                </h:panelGrid>
                <p:commandButton value="Confirmar"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 actionListener="#{contratoCEASAControlador.confirmarEncerramentoDoContrato()}"
                                 styleClass="mtop10 mrig05 prioritario" icon="ui-icon-check"/>
                <p:commandButton value="Cancelar"
                                 styleClass="mtop10 mrig05" icon="ui-icon-close"
                                 onclick="dialogConfirmacaoEncerramento.hide()"/>
            </h:form>
        </p:dialog>
        <p:dialog header="Alteração de Contrato" id="idAlteracaoContrato" widgetVar="alteracaoContrato"
                  modal="true" dynamic="true" position="center" resizable="false" height="550" width="1100"
                  closable="false">
            <h:form id="formularioAlteracaoContrato">
                <h:panelGrid columns="2" styleClass="verticalAlignTop">
                    <h:outputText value="Usuário da Operação: "/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.usuarioOperacao.nome}"
                                  styleClass="negrito"/>
                    <h:outputText value="Data e Hora da Operação: "/>
                    <h:outputText value="#{contratoCEASAControlador.selecionado.dataOperacao}"
                                  styleClass="negrito">
                        <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                    </h:outputText>
                    <fc:outputLabelObrigatorio value="Motivo da Operação : "/>
                    <p:inputTextarea value="#{contratoCEASAControlador.selecionado.motivoOperacao}"
                                     maxlength="2000" cols="50"
                                     disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}">
                        <p:ajax process="@this" event="blur"/>
                    </p:inputTextarea>
                    <fc:outputLabelObrigatorio value="Locatário: "/>
                    <fc:novoAutocompleteCadastroEconomico caminhoAtual="#{contratoCEASAControlador.urlAtual}"
                                                          mostraBotaoNovo="false"
                                                          mostraBotaoEdita="false"
                                                          value="#{contratoCEASAControlador.contratoAlterado.locatario}"
                                                          id="cad"
                                                          situacoesPossiveis="#{contratoCEASAControlador.situacoesDisponiveis}"
                                                          mostraSituacoes="false"
                                                          mostraBotaoInfo="false"
                                                          disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}"
                                                          permiteAlterarSituacoes="false"/>

                    <h:outputText value="Valor Total Pago no contrato: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorTotalPagoNoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Pago do Contrato: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorPagoDoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Pago do Rateio: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorPagoDoRateio}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Original vencido no contrato: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorOriginalVencidoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Vencido do Contrato: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorVencidoDoContrato}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>

                    <h:outputText value="Valor Vencido do Rateio: "/>
                    <h:outputText value="#{contratoCEASAControlador.valorVencidoDoRateio}"
                                  styleClass="negrito">
                        <f:convertNumber pattern="#,##0.00"/>
                    </h:outputText>
                </h:panelGrid>
                <p:panel id="panelPontosComerciaisAlteracao" header="Pontos Comerciais Objetos do Contrato" styleClass="mtop10 mbot05">
                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio value="Localização: "/>
                        <p:autoComplete queryDelay="1000" id="autoCompleteLocalizacao"
                                        value="#{contratoCEASAControlador.localizacao}"
                                        completeMethod="#{contratoCEASAControlador.completaLocalizacao}"
                                        converter="#{contratoCEASAControlador.converterLocalizacao}"
                                        var="localizacao"
                                        dropdown="true"
                                        itemLabel="#{localizacao.toStringAutoComplete}"
                                        itemValue="#{localizacao.id}"
                                        forceSelection="true"
                                        size="70"
                                        scrollHeight="200"
                                        disabled="#{!contratoCEASAControlador.contratoAlterado.pontoComercialContratoCEASAs.isEmpty()}">
                            <p:ajax event="itemSelect" process="@this"/>
                        </p:autoComplete>
                        <h:outputText value="Atividade do Ponto: "/>
                        <h:selectOneMenu id="atvdPonto" title="Informe a Atividade do Ponto"
                                         value="#{contratoCEASAControlador.contratoAlterado.atividadePonto}"
                                         converter="#{contratoCEASAControlador.converterAtividadePonto}"
                                         disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}">
                            <f:selectItems value="#{contratoCEASAControlador.atividadePontos}"/>
                            <p:ajax event="change" process="@this"/>
                        </h:selectOneMenu>
                        <fc:outputLabelObrigatorio value="Ponto Comercial (Box): "/>
                        <p:autoComplete queryDelay="1000"
                                        value="#{contratoCEASAControlador.pontoComercialContratoCEASA.pontoComercial}"
                                        completeMethod="#{contratoCEASAControlador.completaPontosQueNaoEstaoEmContrato}"
                                        converter="#{contratoCEASAControlador.converterPonto}"
                                        var="ponto"
                                        dropdown="true"
                                        itemLabel="#{ponto.descricaoCompleta}"
                                        itemValue="#{ponto.id}"
                                        forceSelection="true"
                                        size="70"
                                        id="pontoComercial"
                                        disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}"
                                        scrollHeight="200">
                            <p:ajax event="itemSelect" process="@this"/>
                        </p:autoComplete>
                    </h:panelGrid>
                    <p:commandButton id="adicionarPontoComercial" value="Adicionar" icon="ui-icon-circle-arrow-s"
                                     process="@this" onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                     actionListener="#{contratoCEASAControlador.adicionaPontoComercialContratoAlterado()}"
                                     title="Adicionar ponto comercial ao contrato"
                                     update="tabelaPontosComerciaisAlteracao pontoComercial :formularioAlteracaoContrato"/>
                    <p:panel style="border: 0" id="panelMensagem"
                             rendered="#{!contratoCEASAControlador.contratoAlterado.pontoComercialContratoCEASAs.isEmpty()}">
                        <div class="alert alert-alert" align="center">
                            <strong>Atenção! </strong> Para alterar a Localização é necessário remover todos os pontos comerciais adicionados.
                        </div>
                    </p:panel>
                    <p:dataTable id="tabelaPontosComerciaisAlteracao"
                                 value="#{contratoCEASAControlador.contratoAlterado.pontoComercialContratoCEASAs}"
                                 var="item"
                                 emptyMessage="Nenhum ponto comercial adicionado">
                        <p:column headerText="Ponto Comercial (Box)" id="cpontcom" style="text-align: left">
                            <h:outputText value="#{item.pontoComercial}"/>
                            <f:facet name="footer">
                                <h:outputText value="Total" styleClass="negrito"/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Área (M²)" style="text-align: right">
                            <h:outputText value="#{item.area}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.contratoAlterado.somaTotalArea}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor do M² (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorMetroQuadrado}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor por Mês (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorCalculadoMes}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoCEASAControlador.contratoAlterado.somaDoValorCalculadoMes}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor por Mês (R$)" style="text-align: right">
                            <h:outputText value="#{item.valorTotalMes}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.totalDoContratoAlteradoPorMes()}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (UFM)" style="text-align: right">
                            <h:outputText value="#{item.valorTotalContrato}">
                                <f:convertNumber pattern="#,##0.0000"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText
                                    value="#{contratoCEASAControlador.contratoAlterado.somaDoValorTotalContrato}"
                                    styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.0000"/>
                                </h:outputText>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Valor Total (R$)" style="text-align: right">
                            <h:outputText value="#{item.valorReal}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{contratoCEASAControlador.totalDoContratoAlterado()}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText><br/>
                            </f:facet>
                        </p:column>
                        <p:column headerText="Remover" style="text-align: center" >
                            <p:commandButton icon="ui-icon-trash"
                                             onclick="aguarde.show(); if(!confirm('Tem certeza que deseja excluir este Ponto Comercial?'))return false;"
                                             oncomplete="aguarde.hide()"
                                             disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}"
                                             actionListener="#{contratoCEASAControlador.removePontoComercialContratoAlterado}"
                                             update=":Formulario :Formulario:rateio tabelaPontosComerciaisAlteracao :formularioAlteracaoContrato:autoCompleteLocalizacao :formularioAlteracaoContrato">
                                <f:attribute value="#{item}" name="objeto"/>
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </p:panel>

                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr><td style="vertical-align: top">
                        <p:panel header="RDC - Rateio das Despesas Comuns" id="rateio" styleClass="mrig05">
                            <h:panelGrid columns="2">
                                <h:outputText value="Área Total para Rateio (m²)"/>
                                <h:outputText value="#{contratoCEASAControlador.selecionado.areaTotalRateio}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </h:outputText>
                                <h:outputText value="Valor Total dos Serviços para Rateio (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.selecionado.valorServicosRateio}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </h:outputText>
                                <h:outputText value="Valor do Rateio por Mês (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.selecionado.valorMensalRateio}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </h:outputText>
                                <h:outputText value="Valor Total do Rateio (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.selecionado.valorTotalRateio}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="###,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </p:panel>
                    </td><td style="vertical-align: top">
                        <p:panel header="Total do Contrato" id="totalContrato">
                            <h:panelGrid columns="2">
                                <h:outputText value="Saldo do Contrato (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.saldoDoContrato}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>

                                <h:outputText value="Saldo do Rateio (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.saldoDoRateio}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>

                                <h:outputText value="Total (R$)"/>
                                <h:outputText value="#{contratoCEASAControlador.saldoTotal}"
                                              styleClass="negrito">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </h:panelGrid>
                        </p:panel>
                    </td></tr>
                </table>
                <br/>
                <p:commandButton value="Confirmar" icon="ui-icon-check" process="@this"
                                 styleClass="operacao prioritario"
                                 title="Confirmar Alteração do Contrato"
                                 onclick="aguarde.show()" id="confirmarAlteracaoParcial"
                                 oncomplete="aguarde.hide()"
                                 disabled="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}"
                                 actionListener="#{contratoCEASAControlador.confirmarAlteracaoDeContrato()}"
                                 update="formularioAlteracaoContrato"/>

                <p:commandButton value="Cancelar Operação" icon="ui-icon-close" process="@this"
                                 styleClass="operacao"
                                 title="Cancelar alteração do contrato."
                                 onclick="alteracaoContrato.hide()"
                                 actionListener="#{contratoCEASAControlador.mostraDemonstrativoFalse()}"
                                 update="formularioAlteracaoContrato"/>
                <br/>
                <br/>
                <p:outputPanel id="parcelasAlteracao"
                               rendered="#{contratoCEASAControlador.mostraDemonstrativoDeParcelas}">
                    <p:panel header="Parcelas">
                        <fc:outputLabelObrigatorio value="Quantidade de Parcelas:"/>
                        <p:inputText id="quantidadeParcelasAlteraxao"
                                     value="${contratoCEASAControlador.contratoAlterado.quantidadeParcelas}"
                                     styleClass="negrito">
                            <p:ajax event="change" process="@this" update="parcelasAlteracao"
                                    listener="#{contratoCEASAControlador.calcularSimulacaoParcelasAlteracaoContrato()}"
                                    onstart="aguarde.show()" oncomplete="aguarde.hide()"/>
                        </p:inputText>
                        <p:dataTable id="tableParcelasAlteracao" styleClass="mtop05"
                                     value="#{contratoCEASAControlador.parcelasAlteracaoContrato}"
                                     emptyMessage="Nenhuma parcela será gerada de acordo com a quantidade de parcelas e o valor do contrato!"
                                     var="p">
                            <f:facet name="header">
                                <h:outputText value="Demonstrativo de Parcelas"/>
                            </f:facet>
                            <p:column headerText="Parcela" style="text-align: center">
                                <h:outputText value="#{p.parcela}"/>
                            </p:column>
                            <p:column headerText="Valor do Contrato (R$)" style="text-align: right">
                                <h:outputText value="#{p.valor}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor do Rateio (R$)" style="text-align: right">
                                <h:outputText value="#{p.valorRateio}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Valor da Parcela (R$)" style="text-align: right">
                                <h:outputText value="#{p.valorTotal}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Vencimento" style="text-align: center">
                                <h:outputText value="#{p.vencimento}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                    <p:commandButton value="Alterar o Contrato" id="confirmarAlteracaoContrato"
                                     styleClass="operacao prioritario mtop05 mbot05"
                                     disabled="#{contratoCEASAControlador.contratoAlterado.periodoVigencia lt contratoCEASAControlador.contratoAlterado.quantidadeParcelas}"
                                     actionListener="#{contratoCEASAControlador.salvarAlteracaoContrato()}"
                                     onclick="aguarde.show()" oncomplete="aguarde.hide()" icon="ui-icon-disk"/>
                </p:outputPanel>
            </h:form>
        </p:dialog>

        <p:dialog id="dialogRenovacao" width="1000"
                  widgetVar="widgetDialogRenovacao"
                  header="Renovação de Contrato" resizable="false" closable="false"
                  height="530">
            <h:form id="formRenovacao">
                <p:panel styleClass="mbot10">
                    <h:panelGrid id="panelDialog" columns="2">
                        <h:outputText value="Índice Econômico: "/>
                        <h:outputText id="indiceEconomicoParam"
                                      value="#{contratoCEASAControlador.contratoRenovado.indiceEconomico} - #{contratoCEASAControlador.contratoRenovado.valorUFMAtual}"
                                      styleClass="negrito">
                        </h:outputText>
                        <h:outputText value="Vigência: "/>
                        <h:outputText id="vigencia"
                                      value="#{contratoCEASAControlador.contratoRenovado.periodoVigencia} #{contratoCEASAControlador.parametroRendas.quantidadeMesesVigencia ne null ? ' Meses': ''}"
                                      styleClass="negrito"/>
                        <h:outputText value="Dia do Vencimento: "/>
                        <h:outputText id="diaVencimentoParam"
                                      value="#{contratoCEASAControlador.contratoRenovado.diaVencimento}"
                                      styleClass="negrito"/>
                        <h:outputText value="Valor Mensal do Contrato (R$): "/>
                        <h:outputText value="#{contratoCEASAControlador.totalDoContratoRenovadoPorMes()}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Total do Contrato (R$): "/>
                        <h:outputText value="#{contratoCEASAControlador.totalDoContratoRenovado()}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Mensal do Rateio (R$): "/>
                        <h:outputText value="#{contratoCEASAControlador.contratoRenovado.valorMensalRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Total do Rateio (R$): "/>
                        <h:outputText value="#{contratoCEASAControlador.contratoRenovado.valorTotalRateio}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Valor Total Geral (R$)': "/>
                        <h:outputText value="#{contratoCEASAControlador.totalGeralDoContratoRenovado()}"
                                      styleClass="negrito">
                            <f:convertNumber pattern="#,##0.00"/>
                        </h:outputText>
                        <h:outputText value="Quantidade de Parcelas"/>
                        <h:outputText
                            value="#{contratoCEASAControlador.contratoRenovado.quantidadeParcelas}"
                            styleClass="negrito"/>
                        <h:outputText value="Usuário Operação: "/>
                        <h:outputText value="#{contratoCEASAControlador.selecionado.usuarioOperacao.nome}"
                                      styleClass="negrito"/>
                        <fc:outputLabelObrigatorio value="Motivo da Operação: "/>
                        <p:inputTextarea value="#{contratoCEASAControlador.selecionado.motivoOperacao}"
                                         maxlength="2000" counter="conta" counterTemplate="{0} Caracteres Restantes"
                                         styleClass="negrito" rows="3" cols="50">
                            <p:ajax process="@this" event="blur"/>
                        </p:inputTextarea>
                        <p:spacer/>
                        <h:outputText id="conta" styleClass="azulnegrito"/>

                        <fc:outputLabelObrigatorio for="quantidadeParcelas" value="Quantidade de Parcelas: "/>
                        <p:inputText id="quantidadeParcelas" styleClass="negrito" size="5"
                                     value="${contratoCEASAControlador.contratoRenovado.quantidadeParcelas}">
                            <p:ajax event="change" process="@this" update="formRenovacao"/>
                        </p:inputText>
                    </h:panelGrid>
                    <br/>
                    <p:dataTable id="tableParcelasss"
                                 value="#{contratoCEASAControlador.simulacaoParcelasRenovacao}"
                                 emptyMessage="A quantidade de parcelas informada deve ser menor que a quantidade máxima permitida."
                                 var="p">
                        <f:facet name="header">
                            <h:outputText value="Demonstrativo de Parcelas"/>
                        </f:facet>
                        <p:column headerText="Parcela" style="text-align: center">
                            <h:outputText value="#{p.parcela}/#{contratoCEASAControlador.contratoRenovado.quantidadeParcelas}"/>
                        </p:column>
                        <p:column headerText="Valor do Contrato (R$)" style="text-align: right">
                            <h:outputText value="#{p.valor}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor do Rateio (R$)" style="text-align: right">
                            <h:outputText value="#{p.valorRateio}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Valor da Parcela (R$)" style="text-align: right">
                            <h:outputText value="#{p.valorTotal}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Vencimento" style="text-align: center">
                            <h:outputText value="#{p.vencimento}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:panel>
                <p:commandButton value="Renovar Contrato"
                                 styleClass="operacao prioritario mbot10"
                                 icon="ui-icon-check"
                                 disabled="#{contratoCEASAControlador.contratoRenovado.periodoVigencia lt contratoCEASAControlador.contratoRenovado.quantidadeParcelas}"
                                 ajax="true"
                                 onstart="aguarde.show()"
                                 oncomplete="aguarde.hide()"
                                 onclick="if (!confirm('Tem certeza que deseja RENOVAR este contrato?'))
                                             return false;"
                                 actionListener="#{contratoCEASAControlador.renovarContrato}"
                    />

                <p:commandButton value="Cancelar" styleClass="operacao mbot10" icon="ui-icon-close"
                                 onclick="widgetDialogRenovacao.hide()"/>
            </h:form>
        </p:dialog>

        <p:confirmDialog id="confirmaSemValorLicitacaoRenovacao"
                         message="Tem certeza que deseja efetivar este contrato sem licitação ?"
                         modal="true" header="Confirmação" severity="alert"
                         widgetVar="widgetConfirmaSemValorLicitacaoRenovacao">
            <h:form id="formConfirmaSemValorLicitacaoRenovacao">
                <h:panelGrid columns="2">
                    <p:commandButton id="btnConfirma" value="Sim" title="Sim"
                                     actionListener="#{contratoCEASAControlador.renovarContrato()}"
                                     update=":Formulario"
                                     process=":Formulario"
                                     ajax="false"/>

                    <p:commandButton id="btnCancelar" value="Não" title="Não"
                                     onclick="widgetConfirmaSemValorLicitacaoRenovacao.hide()"
                                     process=":Formulario"
                                     ajax="true"/>
                </h:panelGrid>
            </h:form>
        </p:confirmDialog>
    </ui:define>
</ui:composition>
</html>
