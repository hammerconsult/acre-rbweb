<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
>

<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <p:panel header="Cadastro de Pessoa Jurídica">
                <table style="width: 100%">
                    <tr>
                        <td>
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="Razão Social:" id="oRazaoSocial"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.razaoSocial}"
                                             id="iRazaoSocial" size="70" maxlength="150" styleClass="maiusculo"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <p:ajax event="change" update="iNomeReduzido"
                                            listener="#{pessoaTributarioControlador.preencheNomeReduzido}"/>
                                    <p:ajax event="blur" update="iNomeReduzido"
                                            listener="#{pessoaTributarioControlador.preencheNomeReduzido}"/>
                                </p:inputText>

                                <h:outputText value="Nome Reduzido:" id="oNomeReduzido"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.nomeReduzido}"
                                             id="iNomeReduzido" size="70" maxlength="70" styleClass="maiusculo"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <p:ajax event="change" update="iNomeReduzido"/>
                                </p:inputText>

                                <h:outputText value="Nome Fantasia:" id="oNomeFantasia"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.nomeFantasia}"
                                             id="iNomeFantasia" size="70" maxlength="70" styleClass="maiusculo"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText id="oTipoInscricao" value="Tipo de Inscrição"/>
                                <h:selectOneMenu value="#{pessoaTributarioControlador.selecionado.tipoInscricao}"
                                                 id="iTipoInscricao"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.tiposInscricao}"/>
                                    <p:ajax event="change" process="Formulario"
                                            update="Formulario"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="CNPJ:" id="oCNPJ"/>
                                <h:panelGroup>
                                    <p:inputMask mask="99.999.999/9999-99"
                                                 value="#{pessoaTributarioControlador.selecionado.cnpj}"
                                                 readonly="#{!pessoaTributarioControlador.isOperacaoNovo()}"
                                                 id="iCNPJ" size="20" maxlength="18"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                        <p:ajax event="blur" process="@this"
                                                listener="#{pessoaTributarioControlador.validarCnpj()}"/>
                                    </p:inputMask>
                                    <fc:buscarDadosPessoaReceita
                                        value="#{pessoaTributarioControlador.selecionado.cnpj}"
                                        id="buscar-receita"/>

                                    <p:commandButton icon="ui-icon-pencil"
                                                     process="@form"
                                                     value="Preencher com dados da Rede Sim"
                                                     title="Preencher os dados da pessoa com as informações da Rede Sim"
                                                     onclick="aguarde.show(); "
                                                     update="@form"
                                                     oncomplete="aguarde.hide();"
                                                     actionListener="#{pessoaTributarioControlador.buscarPessoaJuridicaNaRedeSim()}"/>
                                </h:panelGroup>

                                <h:outputText value="Natureza Jurídica:"/>
                                <h:selectOneMenu id="naturezaJuridica"
                                                 converter="#{pessoaTributarioControlador.converterNaturezaJuridica}"
                                                 value="#{pessoaTributarioControlador.selecionado.naturezaJuridica}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.naturezasJuridica}"/>
                                </h:selectOneMenu>

                                <h:outputText value="CEI:" id="oCEI"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.cei}"
                                             id="iCEI" size="20" maxlength="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Inscrição Estadual:" id="oInscricao"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.inscricaoEstadual}"
                                             id="iIncricao" size="20" maxlength="25"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Email:" id="oEmail"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.email}"
                                             id="iEmail" size="70" maxlength="70" style="text-transform: lowercase"
                                             onkeyup="minuscula(this)"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Home Page:" id="oHomePage"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.homePage}"
                                             id="iHomePage" size="70" maxlength="70" style="text-transform: lowercase"
                                             onkeyup="minuscula(this)"/>

                                <h:outputText value="Situação Cadastral:" id="oSituacaoCadastral"/>
                                <p:inputText title="Selecione uma situação cadastral"
                                             styleClass="campo-bloqueado"
                                             disabled="true"
                                             value="#{pessoaTributarioControlador.selecionado.situacaoCadastralPessoa.descricao}"
                                             id="iSituacaoCadastral"
                                             size="20"/>

                                <h:outputText value="Classe Pessoa:" id="oClassePessoa"/>
                                <h:selectOneMenu title="Selecione a Classe da Pessoa"
                                                 value="#{pessoaTributarioControlador.selecionado.classePessoa}"
                                                 id="iClassePessoa"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.classesPessoa()}"/>
                                </h:selectOneMenu>

                                <h:outputText id="oNire" value="Nire:"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.nire}"
                                             id="iNire" size="20" maxlength="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText id="oDescricaoObjeto" value="Descrição do Objeto:"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.descricaoObjeto}"
                                             id="iDescricaoObjeto" size="70" maxlength="70"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText id="oCapitalSocial" value="Capital Social:"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.capitalSocial}"
                                             id="iCapitalSocial" size="20" maxlength="16"
                                             onkeypress="mascara(this, monetario)"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:convertNumber pattern="###,###,##0.00"/>
                                </p:inputText>

                                <h:outputText id="oInicioAtividade" value="Início da Atividade:"/>
                                <p:calendar pattern="dd/MM/yyyy" id="iInicioAtividade"
                                            value="#{pessoaTributarioControlador.selecionado.inicioAtividade}"
                                            onkeyup="mascara(this, mdata)"
                                            navigator="true"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText id="oCapitalIntegralizado" value="Capital Integralizado:"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.capitalIntegralizado}"
                                             id="iCapitalIntegralizado" size="20" maxlength="16"
                                             onkeypress="mascara(this, monetario)"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:convertNumber pattern="###,###,##0.00"/>
                                </p:inputText>

                                <h:outputText id="oValorQuota" value="Valor Quota:"/>
                                <p:inputText value="#{pessoaTributarioControlador.selecionado.valorCota}"
                                             id="iValorQuota" size="20" maxlength="16"
                                             onkeypress="mascara(this, monetario)"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:convertNumber pattern="###,###,##0.00"/>
                                </p:inputText>

                                <h:outputText id="oTipoEmpresa" value="Porte:"/>
                                <h:selectOneMenu value="#{pessoaTributarioControlador.selecionado.porte}"
                                                 id="iTipoEmpresa"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{cadastroEconomicoControlador.tipoPorte}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>
                        </td>
                        <td>
                            <div style="text-align: center">
                                <h:panelGrid id="pFoto"
                                             style="float : right; text-align: center;"
                                             columns="1">
                                    <p:graphicImage value="/css/images/semfoto.jpg"
                                                    id="oSemFoto"
                                                    width="110"
                                                    rendered="#{pessoaTributarioControlador.mostraImagem()}"
                                                    height="150"
                                                    style="height: 150px; text-align: center; border : solid #666 1px;"/>

                                    <p:graphicImage
                                        value="#{facesContext.externalContext.sessionMap.get('imagem-foto')}"
                                        id="oFotoUpload"
                                        rendered="#{!pessoaTributarioControlador.mostraImagem()}"
                                        width="110"
                                        height="150"
                                        style="height: 150px; text-align: center; border : solid #666 1px;"/>


                                    <p:fileUpload fileUploadListener="#{pessoaTributarioControlador.uploadArquivo}"
                                                  update=":Formulario:pFoto"
                                                  process=":Formulario:pFoto"
                                                  cancelLabel="Cancelar"
                                                  auto="true"
                                                  uploadLabel="Enviar"
                                                  label="Selecionar"
                                                  sizeLimit="15728640"
                                                  id="iBotaoUpload"
                                                  invalidFileMessage="O tipo de arquivo inválido"
                                                  disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    </p:fileUpload>
                                </h:panelGrid>

                            </div>
                        </td>
                    </tr>
                </table>
                <br/>
                <p:tabView id="tvComplementoCadPJTributario">
                    <p:tab title="Telefones" id="pTelefones">
                        <script type="text/javascript">
                            function validarTelefone(elem) {
                                if (elem.value.toString().length &lt; 14) {
                                    elem.value = '';
                                }
                            }
                        </script>
                        <h:panelGrid columns="2" id="gridTel">
                            <h:outputLabel value="Telefone:"/>
                            <p:inputText id="inputFone"
                                         maxlength="15"
                                         onkeydown="mascara(this, mtel)"
                                         onblur="validarTelefone(this)"
                                         title="Informe o número do telefone"
                                         value="#{pessoaTributarioControlador.telefone.telefone}"/>

                            <h:outputText value="Tipo:"/>
                            <h:selectOneMenu value="#{pessoaTributarioControlador.telefone.tipoFone}" id="tipoFone">
                                <f:selectItems value="#{pessoaTributarioControlador.tiposFone}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Principal: "/>
                            <p:selectBooleanCheckbox id="fonePrincipal"
                                                     value="#{pessoaTributarioControlador.telefone.principal}"
                                                     disabled="#{!pessoaTributarioControlador.habilitarTelefonePrincipal()}"/>
                        </h:panelGrid>
                        <br/>
                        <p:commandButton id="cbAdicionaTel" value="Adicionar" icon="ui-icon-circle-plus"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         styleClass="operacao"
                                         update="gridTel fones"
                                         actionListener="#{pessoaTributarioControlador.adicionarFone}"/>
                        <p:commandButton id="cbLimparCamposTel" value="Limpar Campos" icon="ui-icon-clear"
                                         styleClass="operacao"
                                         update="gridTel"
                                         actionListener="#{pessoaTributarioControlador.limparTelefone}"/>
                        <br/>
                        <p:dataTable id="fones"
                                     value="#{pessoaTributarioControlador.selecionado.telefones}"
                                     var="fone"
                                     editable="true"
                                     paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Telefones&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100">
                            <p:column headerText="Telefone" style="text-align: left;">
                                <h:outputText value="#{fone.telefone}"/>
                            </p:column>
                            <p:column headerText="Tipo" style="text-align: left;">
                                <h:outputText value="#{fone.tipoFone}"/>
                            </p:column>
                            <p:column headerText="Principal" style="text-align: left;">
                                <h:outputText value="#{fone.principal ? 'Principal' : ''}"/>
                            </p:column>
                            <p:column headerText="Remover" style="text-align: center; width: 25px">
                                <p:commandButton id="cbRomeveTel" title="Clique para remover." icon="ui-icon-trash"
                                                 styleClass="botao_vermelho icone_branco" update="fones" process="@this"
                                                 actionListener="#{pessoaTributarioControlador.removeFone}">
                                    <f:attribute name="vfone" id="vfone" value="#{fone}"/>
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <br/>
                    <p:tab title="Endereços" id="pEnderecos">
                        <h:outputText
                            value="* Ao informar os campos do endereço o sistema sujere os valores para CEP, Cidade, Bairro e Logradouro. Isso não obriga a seleciona-los."
                            styleClass="azulnegrito"/>
                        <h:panelGrid columns="2" id="gridEndereco2">
                            <h:outputText value="CEP: "/>
                            <h:panelGroup>
                                <p:autoComplete queryDelay="1000" value="#{pessoaTributarioControlador.endereco.cep}"
                                                completeMethod="#{pessoaTributarioControlador.completaCEP}"
                                                var="ce"
                                                id="cepNumero"
                                                itemLabel="#{ce}"
                                                itemValue="#{ce}"
                                                size="25"
                                                disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                </p:autoComplete>
                                &nbsp;
                                <p:commandButton title="clique para pesquisar" styleClass="botao_azul icone_branco"
                                                 icon="ui-icon-search"
                                                 actionListener="#{pessoaTributarioControlador.atualizaLogradouros}"
                                                 update="gridEndereco2"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </h:panelGroup>

                            <h:outputText id="oEstado" value="UF: "/>
                            <h:selectOneMenu value="#{pessoaTributarioControlador.endereco.uf}"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                <f:selectItems value="#{pessoaTributarioControlador.listaUF}"
                                               var="uf" itemLabel="#{uf.nome}" itemValue="#{uf.sigla}"/>
                                <p:ajax update="iCidade" event="change" process="@this"/>
                            </h:selectOneMenu>

                            <fc:outputLabelObrigatorio id="oCidade" value="Cidade: "/>
                            <p:autoComplete queryDelay="1000" value="#{pessoaTributarioControlador.endereco.localidade}"
                                            completeMethod="#{pessoaTributarioControlador.completaCidade}"
                                            var="loc"
                                            id="iCidade"
                                            itemLabel="#{loc}"
                                            itemValue="#{loc}"
                                            size="70"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                <p:ajax update="iLogradouro" event="blur" process="@this"/>
                            </p:autoComplete>

                            <fc:outputLabelObrigatorio id="oBairro" value="Bairro: "/>
                            <p:autoComplete queryDelay="1000" value="#{pessoaTributarioControlador.endereco.bairro}"
                                            completeMethod="#{pessoaTributarioControlador.completaBairro}"
                                            var="bairro"
                                            id="iBairro"
                                            size="50"
                                            itemLabel="#{bairro}"
                                            itemValue="#{bairro}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                            <fc:outputLabelObrigatorio id="oLogradouro" value="Logradouro: "/>
                            <p:autoComplete queryDelay="1000" value="#{pessoaTributarioControlador.endereco.logradouro}"
                                            completeMethod="#{pessoaTributarioControlador.completaLogradouro}"
                                            var="log"
                                            id="iLogradouro"
                                            itemLabel="#{log}"
                                            itemValue="#{log}"
                                            size="100"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                            <h:outputText value="Complemento: "/>
                            <p:inputText value="#{pessoaTributarioControlador.endereco.complemento}"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                            <h:outputText value="Número: "/>
                            <p:inputText value="#{pessoaTributarioControlador.endereco.numero}"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                            <h:outputText value="Tipo de Endereço: " id="oTipoEndereco"/>
                            <h:selectOneMenu id="iTipoEndereco"
                                             value="#{pessoaTributarioControlador.endereco.tipoEndereco}"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                <f:selectItems value="#{pessoaTributarioControlador.tiposEnderecos}"/>
                            </h:selectOneMenu>
                        </h:panelGrid>
                        <p:panel id="pEndPrin" style="border-color: white; padding: 0 !important; margin: 0 !important"
                                 visible="#{pessoaTributarioControlador.habilitarEnderecoPrincipal()}">
                            <h:panelGrid columns="2">
                                <h:outputText value="Endereço Principal: "/>
                                <p:selectBooleanCheckbox id="endPrincipal"
                                                         value="#{pessoaTributarioControlador.endereco.principal}"
                                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </h:panelGrid>
                        </p:panel>
                        <p:commandButton value="Adicionar" update="endersD pEndPrin gridEndereco2"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{pessoaTributarioControlador.adicionarEndereco}"
                                         styleClass="operacao"
                                         icon="ui-icon-circle-plus"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                        <p:commandButton value="Limpar Campos" update="endersD pEndPrin gridEndereco2"
                                         actionListener="#{pessoaTributarioControlador.limparEndereco}"
                                         styleClass="operacao" icon="ui-icon-clear"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                        <br/>
                        <p:dataTable id="endersD"
                                     value="#{pessoaTributarioControlador.selecionado.enderecos}"
                                     var="ender"
                                     editable="true"
                                     paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Endereços&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100">
                            <p:column headerText="Endereço" style="text-align: left">
                                <h:outputText value="#{ender.enderecoCompleto}"/>
                            </p:column>
                            <p:column style="text-align: center; width: 75px" headerText="Ações">
                                <p:commandButton icon="ui-icon-pencil" title="Clique para alterar esse endereco."
                                                 update="endersD :Formulario:tvComplementoCadPJTributario:pEnderecos"
                                                 process="@this"
                                                 actionListener="#{pessoaTributarioControlador.alterarEndereco(ender)}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                                <p:commandButton icon="ui-icon-trash" title="Clique para remover."
                                                 update="endersD" process="@this"
                                                 actionListener="#{pessoaTributarioControlador.removeEndereco}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:attribute name="vendereco" id="vendereco" value="#{ender}"/>
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>

                    </p:tab>

                    <p:tab title="Representante Legal" id="pRepresentante">
                        <p:outputPanel id="panelRepresentante">
                            <h:panelGrid columns="2" styleClass="verticalAlignTop">
                                <fc:outputLabelObrigatorio value="Representante: "/>
                                <p:autoComplete queryDelay="1000"
                                                id="autoCompleteRepresentante"
                                                style="margin: 0 !important"
                                                title="Selecione o registro desejado"
                                                value="#{pessoaTributarioControlador.representante.representante}"
                                                completeMethod="#{pessoaTributarioControlador.completaPessoa}"
                                                var="p" size="70"
                                                itemLabel="#{p}"
                                                itemValue="#{p.id}"
                                                converter="#{novoComponentePesquisaPessoaControlador.converterPessoa}"
                                                forceSelection="true"
                                                maxResults="10"
                                                disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <p:ajax event="itemSelect" onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()" process="@this"/>
                                </p:autoComplete>

                                <fc:outputLabelObrigatorio id="oTipoRepresentante" value="Tipo:"/>
                                <h:selectOneMenu
                                    value="#{pessoaTributarioControlador.representante.tipoRepresentanteLegal}"
                                    id="iTipoRepresentante"
                                    disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.tipoRepresentantes}"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Data Inicial: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="iniciorepresentante" navigator="true"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.representante.dataInicio}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Data Final: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="fimrepresentante" navigator="true"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.representante.dataFim}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </h:panelGrid>
                        </p:outputPanel>
                        <p:commandButton id="btNovoRepresentante"
                                         value="Adicionar" styleClass="operacao"
                                         icon="ui-icon-circle-arrow-s"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{pessoaTributarioControlador.adicionarRepresentanteLegal()}"
                                         update="panelRepresentante tableRepresentante"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                        <p:dataTable value="#{pessoaTributarioControlador.selecionado.representantesLegal}"
                                     var="rl" emptyMessage="Nenhum registro cadastrado."
                                     id="tableRepresentante" styleClass="mtop05">
                            <p:column headerText="Representante">
                                <h:outputText value="#{rl.representante}"/>
                            </p:column>
                            <p:column headerText="Tipo do Representante">
                                <h:outputText value="#{rl.tipoRepresentanteLegal.descricao}"/>
                            </p:column>
                            <p:column headerText="Início de Vigência">
                                <h:outputText value="#{rl.dataInicio}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Final de Vigência">
                                <h:outputText value="#{rl.dataFim}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Remover" style="text-align: center; width: 25px">
                                <p:commandButton icon="ui-icon-trash"
                                                 title="Pressione este botão para remover o registro"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 update="tableRepresentante"
                                                 actionListener="#{pessoaTributarioControlador.removerRepresentanteLegal(rl)}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab title="Junta Comercial" id="pJuntaComercial">
                        <p:outputPanel id="panelJuntaComercial">
                            <h:panelGrid columns="2" styleClass="verticalAlignTop">
                                <fc:outputLabelObrigatorio value="Número do Protocolo Junta:"/>
                                <p:inputText
                                    value="#{pessoaTributarioControlador.juntaComercial.numeroProtocoloJuntaComercial}"
                                    maxlength="20" size="18"
                                    disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Número do Protocolo Viabilidade:"/>
                                <p:inputText
                                    value="#{pessoaTributarioControlador.juntaComercial.numeroProtocoloViabilidade}"
                                    maxlength="20" size="18"
                                    disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Nire:"/>
                                <p:inputText value="#{pessoaTributarioControlador.juntaComercial.nire}"
                                             maxlength="20" size="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Data Nire:"/>
                                <p:calendar pattern="dd/MM/yyyy" id="dataNire" navigator="true" size="18"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.juntaComercial.dataNire}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Número do Processo:"/>
                                <p:inputText value="#{pessoaTributarioControlador.juntaComercial.numeroProcesso}"
                                             maxlength="20" size="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Requerente:"/>
                                <p:inputText value="#{pessoaTributarioControlador.juntaComercial.requerente}"
                                             maxlength="70" size="70"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Ato:"/>
                                <p:inputText value="#{pessoaTributarioControlador.juntaComercial.ato}"
                                             maxlength="70" size="70"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Natureza Jurídica:"/>
                                <h:selectOneMenu id="naturezaJuridicaJunta"
                                                 converter="#{pessoaTributarioControlador.converterNaturezaJuridica}"
                                                 value="#{pessoaTributarioControlador.juntaComercial.naturezaJuridica}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.naturezasJuridica}"/>
                                </h:selectOneMenu>

                                <h:outputText value="Assinado em:"/>
                                <p:calendar pattern="dd/MM/yyyy" id="assinadoEm" navigator="true" size="18"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.juntaComercial.assinadoEm}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </h:panelGrid>
                        </p:outputPanel>
                        <p:commandButton id="btNovaJuntaComercial"
                                         value="Adicionar" styleClass="operacao"
                                         icon="ui-icon-circle-arrow-s"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{pessoaTributarioControlador.adicionarJuntaComercial()}"
                                         update="panelJuntaComercial tableJuntaComercial"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                        <p:dataTable value="#{pessoaTributarioControlador.selecionado.juntaComercial}"
                                     var="junta" emptyMessage="Nenhum registro cadastrado."
                                     id="tableJuntaComercial" styleClass="mtop05">
                            <p:column headerText="Número do Protocolo Junta">
                                <h:outputText value="#{junta.numeroProtocoloJuntaComercial}"/>
                            </p:column>
                            <p:column headerText="Número do Protocolo Viabilidade">
                                <h:outputText value="#{junta.numeroProtocoloViabilidade}"/>
                            </p:column>
                            <p:column headerText="Nire">
                                <h:outputText value="#{junta.nire}"/>
                            </p:column>
                            <p:column headerText="Data da Nire">
                                <h:outputText value="#{junta.dataNire}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Número do Processo">
                                <h:outputText value="#{junta.numeroProcesso}"/>
                            </p:column>
                            <p:column headerText="Requerente">
                                <h:outputText value="#{junta.requerente}"/>
                            </p:column>
                            <p:column headerText="Ato">
                                <h:outputText value="#{junta.ato}"/>
                            </p:column>
                            <p:column headerText="Natureza Jurídica">
                                <h:outputText value="#{junta.naturezaJuridica}"/>
                            </p:column>
                            <p:column headerText="Assinado em">
                                <h:outputText value="#{junta.assinadoEm}"/>
                            </p:column>
                            <p:column headerText="Remover" style="text-align: center; width: 25px">
                                <p:commandButton icon="ui-icon-trash"
                                                 title="Pressione este botão para remover o registro"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 update="tableJuntaComercial"
                                                 actionListener="#{pessoaTributarioControlador.removerJuntaComercial(junta)}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab title="Filiais" id="pFiliais">
                        <p:outputPanel id="panelFilial">
                            <h:panelGrid columns="2" styleClass="verticalAlignTop">
                                <fc:outputLabelObrigatorio value="Filial: "/>
                                <p:autoComplete queryDelay="1000"
                                                id="autoCompleteFilial"
                                                style="margin: 0 !important"
                                                title="Selecione o registro desejado"
                                                value="#{pessoaTributarioControlador.filial.filial}"
                                                completeMethod="#{pessoaTributarioControlador.completarPessoaJuridica}"
                                                var="p" size="70"
                                                itemLabel="#{p}"
                                                itemValue="#{p.id}"
                                                converter="#{novoComponentePesquisaPessoaControlador.converterPessoa}"
                                                forceSelection="true"
                                                maxResults="10"
                                                disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <p:ajax event="itemSelect" onstart="aguarde.show()"
                                            oncomplete="aguarde.hide()" process="@this"/>
                                </p:autoComplete>
                            </h:panelGrid>
                        </p:outputPanel>

                        <p:commandButton id="btNovaFilial"
                                         value="Adicionar" styleClass="operacao"
                                         icon="ui-icon-circle-arrow-s"
                                         onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                         actionListener="#{pessoaTributarioControlador.adicionarFilial()}"
                                         update="panelFilial tableFilial"
                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                        <p:dataTable value="#{pessoaTributarioControlador.selecionado.filiais}"
                                     var="filial" emptyMessage="Nenhum registro cadastrado."
                                     id="tableFilial" styleClass="mtop05">
                            <p:column headerText="Filial">
                                <h:outputText value="#{filial.filial}"/>
                            </p:column>
                            <p:column headerText="Remover" style="text-align: center; width: 25px">
                                <p:commandButton icon="ui-icon-trash"
                                                 title="Pressione este botão para remover o registro"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 update="tableFilial"
                                                 actionListener="#{pessoaTributarioControlador.removerFilial(filial)}"
                                                 disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab title="CNAE" id="tabCANE">
                        <p:panel id="painelCnae">
                            <h:panelGrid columns="2">
                                <h:outputText value="CNAE: "/>
                                <p:autoComplete queryDelay="1000" id="CNAE" title="Digite o CNAE"
                                                value="#{pessoaTributarioControlador.cnae.cnae}"
                                                completeMethod="#{cadastroEconomicoControlador.completaCNAE}"
                                                var="cnae" size="70"
                                                itemLabel="#{cnae.codigoCnae} - #{cnae.descricaoReduzida} "
                                                itemValue="#{cnae.id}"
                                                forceSelection="true"
                                                disabled="#{pessoaTributarioControlador.alterandoCNAE
                                                    or !pessoaTributarioControlador.hasPermissaoEditar()}"
                                                converter="#{cadastroEconomicoControlador.converterCNAE}"
                                                maxResults="10"/>

                                <h:outputText value="Data Inicial: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="inicio"
                                            onkeyup="mascara(this, mdata)"
                                            disabled="#{pessoaTributarioControlador.alterandoCNAE
                                                or !pessoaTributarioControlador.hasPermissaoEditar()}"
                                            value="#{pessoaTributarioControlador.cnae.inicio}" navigator="true"/>

                                <h:outputText value="Data Final: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="fim"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.cnae.fim}" navigator="true"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Tipo: "/>
                                <h:selectOneMenu value="#{pessoaTributarioControlador.cnae.tipo}" id="tipo"
                                                 disabled="#{pessoaTributarioControlador.alterandoCNAE
                                                    or !pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:selectItems value="#{pessoaTributarioControlador.tipoCnae}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>
                            <br/>
                            <p:commandButton value="Adicionar" update="painelCnae cnaeTabelaVigente"
                                             icon="ui-icon-circle-arrow-s" id="btNovoCnae" styleClass="operacao"
                                             style="height: 30px; margin-top:8px"
                                             onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                             action="#{pessoaTributarioControlador.adicionarCNAE()}"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            <p:commandButton value="Cancelar" icon="ui-icon-circle-close" id="btCancelar"
                                             update="painelCnae cnaeTabelaVigente" styleClass="operacao"
                                             action="#{pessoaTributarioControlador.cancelarCnae()}"
                                             disabled="#{!pessoaTributarioControlador.alterandoCNAE
                                                or !pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            <br/>
                            <p:dataTable id="cnaeTabelaVigente"
                                         value="#{pessoaTributarioControlador.cnaesAtivos}"
                                         var="c"
                                         editable="true"
                                         paginator="true"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>CNAE's&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,25,50,100">
                                <p:column headerText="CNAE" style="text-align: left;">
                                    <h:outputText value="#{c.cnae.codigoCnae} "/>
                                </p:column>
                                <p:column headerText="Descrição Detalhada" style="text-align: left;">
                                    <h:outputText value="#{c.cnae.descricaoDetalhada} "/>
                                </p:column>
                                <p:column style="text-align: center" headerText="Data Inicial">
                                    <h:outputText value="#{c.inicio}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column style="text-align: center" headerText="Data Final">
                                    <h:outputText value="#{c.fim}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column style="text-align: center" headerText="Tipo">
                                    <h:outputText value="#{c.tipo.descricao}"/>
                                </p:column>
                                <p:column style="text-align: center" headerText="Grau de Risco">
                                    <h:outputText value="#{c.cnae.grauDeRisco.descricao}"/>
                                </p:column>
                                <p:column style="text-align: center" headerText="Situação">
                                    <h:outputText value="#{c.cnae.situacao.descricao}"/>
                                </p:column>
                                <p:column style="text-align: center" headerText="Sanitário">
                                    <h:outputText value="#{c.cnae.fiscalizacaoSanitaria ? 'Sim' : 'Não'}"/>
                                </p:column>
                                <p:column style="text-align: center" headerText="Exercida no Local">
                                    <h:outputText
                                        value="#{c.exercidaNoLocal eq null ? '' : c.exercidaNoLocal ? 'Sim' : 'Não'}"/>
                                </p:column>
                                <p:column style="text-align: center; width: 75px;" headerText="Operação">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="Pressione este botão para editar o registro"
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     update=":Formulario:tvComplementoCadPJTributario:painelCnae cnaeTabelaVigente"
                                                     actionListener="#{pessoaTributarioControlador.alterarCnae(c)}"
                                                     disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    </p:commandButton>
                                    <p:commandButton icon="ui-icon-trash"
                                                     title="Pressione este botão para remover o registro"
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     update="cnaeTabelaVigente"
                                                     actionListener="#{pessoaTributarioControlador.removerCnae(c)}"
                                                     disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <p:tab title="Horário de Funcionamento">
                        <p:commandButton
                            value="Novo Horário de Funcionamento"
                            icon="ui-icon-search"
                            styleClass="mlef05 operacao"
                            actionListener="#{pessoaTributarioControlador.abrirPesquisaHorarioFuncionamento()}"/>

                        <p:dataTable id="horarios"
                                     value="#{pessoaTributarioControlador.selecionado.horariosFuncionamentoAtivos}"
                                     var="horario"
                                     editable="true"
                                     paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Nenhum horário de funcionamento informado"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Horários de Funcionamento&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100">
                            <p:column style="width: 5px">
                                <p:rowToggler/>
                            </p:column>
                            <p:column headerText="Código">
                                <h:outputText value="#{horario.horarioFuncionamento.codigo}"/>
                            </p:column>
                            <p:column headerText="Descrição">
                                <h:outputText value="#{horario.horarioFuncionamento.descricao}"/>
                            </p:column>
                            <p:column style="text-align: center; width: 75px;" headerText="Operação">
                                <p:commandButton icon="ui-icon-trash"
                                                 title="Pressione este botão para remover o registro"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 update="horarios"
                                                 actionListener="#{pessoaTributarioControlador.removerHorarioFuncionamento(horario)}"/>
                            </p:column>
                            <p:rowExpansion>
                                <p:dataTable value="#{horario.horarioFuncionamento.itens}"
                                             var="item">
                                    <p:column headerText="Dia (Entrada)">
                                        <h:outputText value="#{item.diaEntrada.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Entrada">
                                        <h:outputText value="#{item.horarioEntrada}">
                                            <f:convertDateTime pattern="HH:mm"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Dia (Saída)">
                                        <h:outputText value="#{item.diaSaida.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Saída">
                                        <h:outputText value="#{item.horarioSaida}">
                                            <f:convertDateTime pattern="HH:mm"/>
                                        </h:outputText>
                                    </p:column>
                                </p:dataTable>
                            </p:rowExpansion>
                        </p:dataTable>
                    </p:tab>

                    <p:tab d="tabSocios" title="Sócios">
                        <p:outputPanel id="panelsocios">
                            <h:panelGrid columns="2" styleClass="verticalAlignTop">
                                <fc:outputLabelObrigatorio value="Sócio: "/>
                                <h:panelGrid columns="3" styleClass="verticalAlignTop" cellpadding="0" cellspacing="0">
                                    <p:autoComplete queryDelay="1000"
                                                    id="autoCompleteSocio"
                                                    style="margin: 0 !important"
                                                    title="Selecione o registro desejado"
                                                    value="#{pessoaTributarioControlador.socio.socio}"
                                                    completeMethod="#{pessoaTributarioControlador.completaPessoa}"
                                                    var="p" size="70"
                                                    itemLabel="#{p}"
                                                    itemValue="#{p.id}"
                                                    converter="#{novoComponentePesquisaPessoaControlador.converterPessoa}"
                                                    forceSelection="true"
                                                    maxResults="10"
                                                    disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                        <p:ajax event="itemSelect" onstart="aguarde.show()"
                                                oncomplete="aguarde.hide()" process="@this"/>
                                    </p:autoComplete>
                                </h:panelGrid>
                                <fc:outputLabelObrigatorio value="Proporção (%): "/>
                                <p:inputText id="proporcao" size="10"
                                             value="#{pessoaTributarioControlador.socio.proporcao}"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </p:inputText>

                                <fc:outputLabelObrigatorio value="Data Inicial: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="iniciosocio" navigator="true"
                                            onkeyup="mascara(this, mdata)"
                                            value="#{pessoaTributarioControlador.socio.dataInicio}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputLabel rendered="#{pessoaTributarioControlador.socio.id ne null}"
                                               for="fimsocio" value="Data Final: "/>
                                <p:calendar pattern="dd/MM/yyyy" id="fimsocio" navigator="true"
                                            onkeyup="mascara(this, mdata)"
                                            rendered="#{pessoaTributarioControlador.socio.id ne null}"
                                            value="#{pessoaTributarioControlador.socio.dataFim}"
                                            disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Nire:"/>
                                <p:inputText value="#{pessoaTributarioControlador.socio.nire}"
                                             id="iSocioNire" size="20" maxlength="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Condição:"/>
                                <p:inputText value="#{pessoaTributarioControlador.socio.condicao}"
                                             id="iSocioCondicao" size="20" maxlength="18"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Cargo:"/>
                                <p:inputText value="#{pessoaTributarioControlador.socio.cargo}"
                                             id="iSocioCargo" size="20" maxlength="40"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>

                                <h:outputText value="Administrador:"/>
                                <p:selectBooleanCheckbox value="#{pessoaTributarioControlador.socio.administrador}"
                                                         disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            </h:panelGrid>
                            <p:commandButton id="btNovoSocio"
                                             value="Adicionar" styleClass="operacao"
                                             style="height: 30px; margin-top:7px"
                                             onclick="aguarde.show()" oncomplete="aguarde.hide()"
                                             icon="ui-icon-circle-arrow-s"
                                             actionListener="#{pessoaTributarioControlador.adicionarSocio()}"
                                             process="panelsocios"
                                             update="panelsocios"
                                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                            <p:commandButton value="Cancelar" icon="ui-icon-circle-close" id="btCancelarSocio"
                                             update="panelsocios tabelasocios" styleClass="operacao"
                                             action="#{pessoaTributarioControlador.cancelarSocio()}"
                                             disabled="#{!pessoaTributarioControlador.alterandoSocio
                                                or !pessoaTributarioControlador.hasPermissaoEditar()}"/>

                            <p:dataTable var="socio" id="tabelasocios" emptyMessage="Nenhum registro encontrado"
                                         editable="true" styleClass="mtop05"
                                         value="#{pessoaTributarioControlador.sociedadePessoaJuridica}">
                                <p:column style="width: 5px">
                                    <p:rowToggler/>
                                </p:column>
                                <p:column headerText="Sócio" style="text-align: left;">
                                    <h:outputText value="#{socio.socio}"/>
                                </p:column>
                                <p:column headerText="Proporção (%)" style="text-align: center; width: 10%">
                                    <h:outputText value="#{socio.proporcao}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Data Inicial" style="text-align: center">
                                    <h:outputText value="#{socio.dataInicio}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Data Final" style="text-align: center">
                                    <h:outputText value="#{socio.dataFim}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column style="text-align: center; width: 75px;" headerText="Operação">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="Pressione este botão para editar o registro"
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     update=":Formulario:tvComplementoCadPJTributario:panelsocios tabelasocios"
                                                     actionListener="#{pessoaTributarioControlador.alterarSocio(socio)}"
                                                     disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                                    <p:commandButton icon="ui-icon-trash"
                                                     title="Pressione este botão para remover o registro"
                                                     actionListener="#{pessoaTributarioControlador.removerSocios(socio)}"
                                                     update="tabelasocios"
                                                     disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"/>
                                </p:column>
                                <p:rowExpansion>
                                    <p:panel header="Informações do Sócio">
                                        <h:panelGrid columns="2" style="width: 20%;">
                                            <h:outputText value="Nire:"/>
                                            <h:outputText value="#{socio.nire}" styleClass="negrito"/>

                                            <h:outputText value="Condição do Sócio:"/>
                                            <h:outputText value="#{socio.condicao}" styleClass="negrito"/>

                                            <h:outputText value="Cargo:"/>
                                            <h:outputText value="#{socio.cargo}" styleClass="negrito"/>

                                            <h:outputText value="Administrador:"/>
                                            <h:outputText value="#{socio.administrador ? 'Sim' : 'Não'}"
                                                          styleClass="negrito"/>
                                        </h:panelGrid>
                                    </p:panel>
                                </p:rowExpansion>
                                <f:facet id="rodaPeSocios" name="footer">
                                    <h:outputText value="Proporção Total:"/>
                                    <h:outputText value="#{pessoaTributarioControlador.totalSocios}"
                                                  id="totalSocios"
                                                  style="color:#{pessoaTributarioControlador.totalSocios eq 100 ? 'seagreen':'tomato'}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>%
                                </f:facet>
                            </p:dataTable>

                        </p:outputPanel>
                    </p:tab>


                    <p:tab title="Cadastro Econômico">
                        <p:dataTable id="panelcadastroeco"
                                     var="ce"
                                     value="#{pessoaTributarioControlador.cadastroEconomicos}"
                                     emptyMessage="Nenhum registro encontrado.">
                            <p:column headerText="Código">
                                <h:outputText value="#{ce.inscricaoCadastral}"/>
                            </p:column>
                            <p:column headerText="Data Cadastro" style="text-align: center">
                                <h:outputText value="#{ce.dataCadastro}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Situação">
                                <h:outputText
                                    value="#{ce.situacaoAtual.situacaoCadastral.descricao}"/>
                            </p:column>
                            <p:column headerText="Ação" styleClass="centralizado">
                                <p:commandButton value="" id="verCadastro"
                                                 actionListener="#{pessoaTributarioControlador.verCadastroEconomico(ce)}"
                                                 styleClass="mrig05 wp-botao-tabela"
                                                 title="Carrega a página de cadastro econômico"
                                                 icon="ui-icon-person"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>


                    <p:tab title="Histórico" id="pHistorico">
                        <p:dataTable value="#{pessoaTributarioControlador.selecionado.historicosIntegracaoRedeSim}"
                                     var="historico"
                                     emptyMessage="Nenhum registro cadastrado.">
                            <p:column headerText="Data da Alteração" styleClass="alinhamentoCentralizado"
                                      style="width: 12%">
                                <h:outputText value="#{historico.dataAlteracao}">
                                    <f:convertDateTime type="both"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{historico.descricao}"/>
                            </p:column>
                            <p:column headerText="Usuário" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{historico.usuarioSistema.login}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab title="Portal do Contribuinte">
                        <p:outputPanel id="portalEmail">
                            <h:panelGrid columns="2" id="gridPortal">
                                <h:outputLabel value="Email para Login:"
                                               rendered="#{pessoaTributarioControlador.desabilitarBotaoAdicionarEmail or pessoaTributarioControlador.desabilitarBotaoAlterarEmail}"/>
                                <p:inputText value="#{pessoaTributarioControlador.usuarioWeb.email}"
                                             rendered="#{pessoaTributarioControlador.desabilitarBotaoAdicionarEmail or pessoaTributarioControlador.desabilitarBotaoAlterarEmail}"
                                             maxlength="200" size="70"/>
                            </h:panelGrid>
                            <p:commandButton value="Criar Usuário Portal"
                                             update=":Formulario :Formulario:tvComplementoCadPJTributario:portalEmail"
                                             process=":Formulario :Formulario:tvComplementoCadPJTributario:portalEmail"
                                             styleClass="operacao"
                                             icon="ui-icon-plus"
                                             rendered="#{pessoaTributarioControlador.desabilitarBotaoAdicionarEmail}"
                                             disabled="#{!pessoaTributarioControlador.selecionado.isSituacaoCadastralAtivo()}"
                                             actionListener="#{pessoaTributarioControlador.criarUsuarioWeb()}"/>

                            <p:commandButton value="Alterar Usuário Portal"
                                             update=":Formulario :Formulario:tvComplementoCadPJTributario:portalEmail"
                                             process=":Formulario :Formulario:tvComplementoCadPJTributario:portalEmail"
                                             styleClass="operacao"
                                             icon="ui-icon-check"
                                             rendered="#{pessoaTributarioControlador.desabilitarBotaoAlterarEmail}"
                                             disabled="#{!pessoaTributarioControlador.selecionado.isSituacaoCadastralAtivo()}"
                                             actionListener="#{pessoaTributarioControlador.alterarUsuarioWeb()}"/>

                            <p:dataTable value="#{pessoaTributarioControlador.selecionado.usuariosWeb}"
                                         styleClass="mtop03" id="tablePortal"
                                         var="usuario" emptyMessage="Nenhum usuário cadastrado.">
                                <p:column headerText="Remover Usuário Portal" style="width: 8%; text-align: center"
                                          rendered="false">
                                    <p:commandButton icon="ui-icon-trash"
                                                     styleClass="botao_vermelho icone_branco"
                                                     process=":Formulario:tvComplementoCadPJTributario:portalEmail"
                                                     title="Clique para remover este registro."
                                                     onstart="aguarde.show()"
                                                     oncomplete="aguarde.hide()"
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     update=":Formulario:tvComplementoCadPJTributario:portalEmail"
                                                     actionListener="#{pessoaTributarioControlador.removerEmailPortal(usuario)}">
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Alterar Usuário Portal" style="width: 8%; text-align: center">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     styleClass="botao_vermelho icone_branco"
                                                     process=":Formulario:tvComplementoCadPJTributario:portalEmail"
                                                     title="Clique para alterar este registro."
                                                     update=":Formulario:tvComplementoCadPJTributario:portalEmail"
                                                     actionListener="#{pessoaTributarioControlador.alterarEmailUsuarioPortalWeb(usuario)}">
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Email" style="text-align: center">
                                    <h:outputText value="#{usuario.email}"/>
                                </p:column>
                                <p:column headerText="Último Acesso" style="text-align: center">
                                    <h:outputText value="#{usuario.ultimoAcesso}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Status" style="text-align: center">
                                    <h:outputText value="#{usuario.activated ? 'Ativo' : 'Inativo'}"/>
                                </p:column>
                            </p:dataTable>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Documentos Anexos" id="pDocumentosAnexos">
                        <p:tab title="Anexos">
                            <p:outputPanel id="panel-anexos">
                                <fc:filesUploadWP selecionado="#{pessoaTributarioControlador.selecionado}"/>
                            </p:outputPanel>
                        </p:tab>
                    </p:tab>
                </p:tabView>
            </p:panel>
            <br/>
            <p:commandButton value="Confirmar cadastro e ativar pessoa"
                             id="cbSalvar"
                             styleClass="mtop10 mrig05 prioritario"
                             style="height: 30px"
                             icon="ui-icon-disk"
                             title="Clique para confirmar o cadastro e ativar a pessoa."
                             actionListener="#{pessoaTributarioControlador.salvar()}"
                             rendered="#{pessoaTributarioControlador.selecionado.isSituacaoCadastralAguardandoConfirmacaoCadastro()}"
                             onclick="aguarde.show()"
                             oncomplete="aguarde.hide()"
                             disabled="#{!pessoaTributarioControlador.hasPermissaoEditar()}"
            />
            <fc:rodapePretty id="rpRodapePretty"
                             controlador="#{pessoaTributarioControlador}"
                             ocultarSalvar="#{pessoaTributarioControlador.selecionado.isSituacaoCadastralAguardandoConfirmacaoCadastro()}"
            />
        </h:form>
        <p:dialog widgetVar="dialogoHorarioFuncionamento"
                  header="Horários de Funcionamento"
                  modal="true"
                  id="dialogoHorarioFuncionamentoDlg"
                  width="1000"
                  height="600"
                  resizable="false">
            <h:form id="formHorarioFuncionamento">
                <p:outputPanel style="height: 300px;">
                    <p:panel id="pesquisaHorarios">
                        <h:panelGrid columns="5">
                            <h:outputText value="Código:" styleClass="mrig02"/>
                            <p:inputText value="#{pessoaTributarioControlador.codigoPesquisaHorario}" maxlength="10"
                                         size="10" styleClass="mrig05"/>

                            <h:outputText value="Descrição:" styleClass="mrig02"/>
                            <p:inputText value="#{pessoaTributarioControlador.descricaoPesquisaHorario}" maxlength="150"
                                         size="65"/>

                            <p:commandButton icon="ui-icon-search" value="Pesquisar" styleClass="operacao"
                                             actionListener="#{pessoaTributarioControlador.filtrarHorariosFuncionamento()}"
                                             update="tabela" onclick="aguarde.show()" oncomplete="aguarde.hide()"/>
                        </h:panelGrid>
                    </p:panel>

                    <p:dataTable id="tabela"
                                 value="#{pessoaTributarioControlador.horariosFuncionamentoFiltrado}"
                                 var="objeto"
                                 editable="true"
                                 paginator="true"
                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                 rowIndexVar="rowIx"
                                 styleClass="mtop05"
                                 emptyMessage="Nenhum horário de funcionamento informado"
                                 rows="10"
                                 paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Horários de Funcionamento&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                 rowsPerPageTemplate="10,25,50,100">
                        <p:column style="width: 5%">
                            <p:rowToggler/>
                        </p:column>
                        <p:column headerText="Adicionar" style="text-align: center;">
                            <p:commandButton icon="ui-icon-circle-plus"
                                             styleClass="botao-transparente"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()" update=":Formulario"
                                             actionListener="#{pessoaTributarioControlador.selecionarHorario(objeto)}"/>
                        </p:column>
                        <p:column headerText="Código"
                                  style="width: 5%">
                            <h:outputText value="#{objeto.codigo}"/>
                        </p:column>
                        <p:column headerText="Descrição">
                            <h:outputText value="#{objeto.descricao}"/>
                        </p:column>
                        <p:rowExpansion>
                            <p:dataTable id="tabelaexp"
                                         value="#{objeto.itens}"
                                         var="item"
                                         style="width: 100%"
                                         emptyMessage="Nenhum item adicionado">
                                <p:column headerText="Dia (Entrada)">
                                    <h:outputText value="#{item.diaEntrada.descricao}"/>
                                </p:column>
                                <p:column headerText="Entrada">
                                    <h:outputText value="#{item.horarioEntrada}">
                                        <f:convertDateTime pattern="HH:mm"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Dia (Saída)">
                                    <h:outputText value="#{item.diaSaida.descricao}"/>
                                </p:column>
                                <p:column headerText="Saída">
                                    <h:outputText value="#{item.horarioSaida}">
                                        <f:convertDateTime pattern="HH:mm"/>
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>
                        </p:rowExpansion>
                    </p:dataTable>
                </p:outputPanel>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
