<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <fc:cabecalhoPretty origem="#{atoLegalControlador.caminhoPadrao}listar/"
                                controlador="#{atoLegalControlador}"/>

            <p:panel header="Cadastro de Ato Legal">
                <h:panelGrid columns="2">

                    <fc:outputLabelObrigatorio value="Exercício: " styleAsterisco="margin-right: 120px"/>
                    <p:inputMask id="exercicio" value="#{atoLegalControlador.selecionado.exercicio}"
                                 converter="#{extratoControlador.converterExercicio}" mask="9999"/>

                    <fc:outputLabelObrigatorio value="Tipo de Ato Legal: " for="tipoAtoLegal"/>
                    <h:selectOneMenu title="Selecione um Tipo de Ato Legal."
                                     value="#{atoLegalControlador.selecionado.tipoAtoLegal}"
                                     id="tipoAtoLegal">
                        <f:selectItems value="#{atoLegalControlador.tipoAtoLegal}"/>
                        <p:ajax listener="#{atoLegalControlador.processarPropositoSelecionado}"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                process="@form"
                                update=":Formulario"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Propósito do Ato Legal :" for="propositoAtoLegal"/>
                    <h:selectOneMenu title="Selecione um propósito do Ato Legal."
                                     value="#{atoLegalControlador.selecionado.propositoAtoLegal}"
                                     id="propositoAtoLegal">
                        <f:selectItems value="#{atoLegalControlador.propositoAtoLegal}"/>
                        <p:ajax listener="#{atoLegalControlador.processarPropositoSelecionado}"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                process="@this"
                                update=":Formulario"/>
                    </h:selectOneMenu>

                    <h:outputLabel value="Situação: " rendered="#{!atoLegalControlador.isValidarSituacao()}"/>
                    <fc:outputLabelObrigatorio value="Situação: "
                                               rendered="#{atoLegalControlador.isValidarSituacao()}"/>
                    <h:selectOneMenu value="#{atoLegalControlador.selecionado.situacaoAtoLegal}">
                        <f:selectItems value="#{atoLegalControlador.situacoesAtoLegal}"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Número do Ato Legal: " for="numero"/>
                    <p:inputText title="Digite o número do Ato Legal"
                                 maxlength="20"
                                 style="text-transform: uppercase"
                                 value="#{atoLegalControlador.selecionado.numero}"
                                 id="numero" size="20"
                                 validator="#{atoLegalControlador.validaNumero}">
                        <f:convertNumber integerOnly="true"/>
                    </p:inputText>


                    <h:outputText value="Tipo de Unidade:" style="margin-right: 82px"
                                  rendered="#{atoLegalControlador.renderizaPainelUnidades()
                                  or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria()}"/>
                    <h:selectOneMenu title="Informe o tipo unidade para o ato legal."
                                     rendered="#{atoLegalControlador.renderizaPainelUnidades()
                                      or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria()}"
                                     value="#{atoLegalControlador.selecionado.tipoAtoLegalUnidade}"
                                     id="tipoAtoLegalUnidade">
                        <f:selectItems value="#{atoLegalControlador.tipoAtoLegalUnidade}"/>
                        <p:ajax onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                listener="#{atoLegalControlador.setaCamposAutoCompleteNull}"
                                process="@form"
                                update=":Formulario"/>
                    </h:selectOneMenu>

                    <fc:outputLabelObrigatorio value="Unidade Organizacional: "
                                               rendered="#{atoLegalControlador.selecionado.tipoAtoLegalUnidade eq 'INTERNA'
                                               and (atoLegalControlador.renderizaPainelUnidades()
                                               or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria())}"/>
                    <p:autoComplete queryDelay="1000" id="unidade"
                                    value="#{atoLegalControlador.hierarquiaOrganizacional}"
                                    completeMethod="#{atoLegalControlador.completaUnidadeOrganizacional}"
                                    converter="#{atoLegalControlador.converterUnidadeOrganizacional}"
                                    rendered="#{atoLegalControlador.selecionado.tipoAtoLegalUnidade eq 'INTERNA'
                                    and (atoLegalControlador.renderizaPainelUnidades()
                                    or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria())}"
                                    var="unid"
                                    forceSelection="true"
                                    size="70"
                                    maxResults="10"
                                    itemLabel="#{unid}"
                                    itemValue="#{unid.id}"
                                    title="Selecione uma unidade organizacional para o ato legal.">
                        <p:ajax event="itemSelect"
                                listener="#{atoLegalControlador.adicionaUnidadeHierarquiaSelecionada}"/>
                    </p:autoComplete>

                    <fc:outputLabelObrigatorio value="Unidade Externa: "
                                               rendered="#{atoLegalControlador.selecionado.tipoAtoLegalUnidade eq 'EXTERNA'
                                               and (atoLegalControlador.renderizaPainelUnidades()
                                               or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria())}"/>
                    <p:autoComplete queryDelay="1000" id="unidadeExterna"
                                    value="#{atoLegalControlador.selecionado.unidadeExterna}"
                                    completeMethod="#{atoLegalControlador.completaUnidadeExterna}"
                                    converter="#{atoLegalControlador.converterUnidadeExterna}"
                                    rendered="#{atoLegalControlador.selecionado.tipoAtoLegalUnidade eq 'EXTERNA'
                                    and (atoLegalControlador.renderizaPainelUnidades()
                                    or atoLegalControlador.isTipoAtoLegalLegislativoOuControleExternoOuPortaria())}"
                                    var="unidExt"
                                    forceSelection="true"
                                    size="70"
                                    maxResults="10"
                                    itemLabel="#{unidExt}"
                                    itemValue="#{unidExt.id}"
                                    title="Selecione uma unidade externa para o ato legal.">
                    </p:autoComplete>

                    <h:outputText id="atoU" value="Ato Legal da Lei: "
                                  rendered="#{atoLegalControlador.selecionado.tipoAtoLegal eq 'DECRETO'}"/>
                    <p:outputPanel id="selOneMenuAtoLegal"
                                   rendered="#{atoLegalControlador.selecionado.tipoAtoLegal eq 'DECRETO'}">
                        <h:selectOneMenu title="Ato Legal do decreto"
                                         value="#{atoLegalControlador.selecionado.superior}"
                                         converter="#{atoLegalControlador.converterAtoLegal}">
                            <f:selectItems value="#{atoLegalControlador.superiores}"/>
                            <p:ajax listener="#{atoLegalControlador.copiaValoreAtoPai}"
                                    onstart="aguarde.show()"
                                    oncomplete="aguarde.hide()"
                                    process="@this"
                                    update="validaVeiculoPublic painelAtoLegalOrc"/>
                        </h:selectOneMenu>
                    </p:outputPanel>

                    <fc:outputLabelObrigatorio value="Esfera de Governo: " for="esferaGoverno"/>
                    <h:panelGroup>
                        <h:selectOneMenu title="Selecione a Esfera de Governo"
                                         styleClass="mrig05"
                                         value="#{atoLegalControlador.selecionado.esferaGoverno}"
                                         id="esferaGoverno" converter="#{atoLegalControlador.converterEsferaGoverno}">
                            <f:selectItems value="#{atoLegalControlador.esferaGoverno}"/>
                        </h:selectOneMenu>

                        <p:commandButton process="@none"
                                         id="bt-nova-esfera-governo"
                                         icon="ui-icon-plus"
                                         styleClass="mrig10"
                                         update="@none"
                                         onclick="window.open('#{request.contextPath}/esfera-governo/novo/','_blank');"/>
                    </h:panelGroup>

                    <h:outputText value="Data de Emissão: "/>
                    <p:calendar title="Informe a data da Emissão do Ato Legal"
                                value="#{atoLegalControlador.selecionado.dataEmissao}"
                                id="dataEmissao" navigator="true"
                                pattern="dd/MM/yyyy" locale="pt_BR"
                                onkeyup="mascara(this, mdata)">
                        <p:ajax event="dateSelect" update="dataEmissao"/>
                        <p:ajax event="blur" update="dataEmissao"/>
                    </p:calendar>

                    <h:outputText value="Data de Sanção: " rendered="#{atoLegalControlador.renderizaPainelUnidades()}"/>
                    <fc:outputLabelObrigatorio value="Data de Sanção: " for="dataPromulgacao"
                                               rendered="#{!atoLegalControlador.renderizaPainelUnidades()}"/>
                    <p:calendar title="Informe a data de sanção do Ato Legal"
                                value="#{atoLegalControlador.selecionado.dataPromulgacao}"
                                id="dataPromulgacao" navigator="true"
                                pattern="dd/MM/yyyy" locale="pt_BR"
                                onkeyup="mascara(this, mdata)">
                    </p:calendar>

                    <fc:outputLabelObrigatorio value="Veículo de Publicação: "
                                               id="validaVeiculoPublic"
                                               for="veiculodepublicacao"
                                               rendered="#{!atoLegalControlador.selecionado.tipoAtoLegalOficio}"/>
                    <h:outputLabel value="Veículo de Publicação: "
                                   id="veiculoPublic"
                                   for="veiculodepublicacao"
                                   rendered="#{atoLegalControlador.selecionado.tipoAtoLegalOficio}"/>

                    <h:panelGrid columns="2">
                        <p:autoComplete queryDelay="1000" id="veiculodepublicacao"
                                        title="Digite o nome do Veículo de publicação"
                                        value="#{atoLegalControlador.selecionado.veiculoDePublicacao}"
                                        completeMethod="#{atoLegalControlador.completaVeiculoDePublicacao}"
                                        var="veiculoPublicacao"
                                        style="margin-left: -4px"
                                        itemLabel="#{veiculoPublicacao.nome}"
                                        itemValue="#{veiculoPublicacao.id}"
                                        forceSelection="true"
                                        size="70"
                                        converter="#{atoLegalControlador.converterVeiculoDePublicacao}">
                        </p:autoComplete>

                        <p:commandButton process="@none"
                                         id="bt-novo-veiculo-publicacao"
                                         icon="ui-icon-plus"
                                         styleClass="mrig10"
                                         update="@none"
                                         onclick="window.open('#{request.contextPath}/veiculo-publicacao/novo/','_blank');"/>

                    </h:panelGrid>

                    <fc:outputLabelObrigatorio value="Data de Publicação: " for="dataPublicacao"/>
                    <p:calendar title="Informe a data de Publicação do Ato Legal"
                                value="#{atoLegalControlador.selecionado.dataPublicacao}"
                                id="dataPublicacao" navigator="true"
                                validator="#{atoLegalControlador.validaDataDecreto}"
                                pattern="dd/MM/yyyy" locale="pt_BR"
                                onkeyup="mascara(this, mdata)">
                    </p:calendar>

                    <h:outputText value="Número da Publicação: "/>
                    <p:inputText title="Digite o numero da publicação do Ato Legal"
                                 value="#{atoLegalControlador.selecionado.numeroPublicacao}"
                                 id="numeroPublicacao"
                                 maxlength="10"/>

                    <fc:outputLabelObrigatorio value="Data de Envio: "
                                               rendered="#{atoLegalControlador.selecionado.tipoAtoLegal eq 'PROJETO_DE_LEI'}"/>
                    <h:outputText value="Data de Envio: "
                                  rendered="#{atoLegalControlador.selecionado.tipoAtoLegal ne 'PROJETO_DE_LEI'}"/>
                    <p:calendar title="Informe a data de a data de envio."
                                value="#{atoLegalControlador.selecionado.dataEnvio}"
                                id="dataEnvio" navigator="true"
                                pattern="dd/MM/yyyy" locale="pt_BR"
                                onkeyup="mascara(this, mdata)">
                    </p:calendar>

                    <fc:outputLabelObrigatorio value="Nome do Ato Legal: "/>
                    <p:inputText title="Digite a descrição para o Ato Legal"
                                 size="70"
                                 style="text-transform: uppercase"
                                 value="#{atoLegalControlador.selecionado.nome}"
                                 id="nomeAto"/>

                    <h:outputText value="Data de Validade: "/>
                    <p:calendar title="Informe a data de validade do ato legal."
                                value="#{atoLegalControlador.selecionado.dataValidade}"
                                id="dataValidade"
                                navigator="true"
                                validator="#{atoLegalControlador.validaDataDecreto}"
                                pattern="dd/MM/yyyy" locale="pt_BR"
                                onkeyup="mascara(this, mdata)">
                    </p:calendar>

                    <h:outputText value="Fundamentação Legal"/>
                    <h:panelGrid columns="2">
                        <p:inputTextarea title="Digite a fundamentação do Ato Legal"
                                         value="#{atoLegalControlador.selecionado.fundamentacaoLegal}"
                                         id="fundamentacaoLegal" cols="70" rows="5"
                                         style="margin-left: -4px; text-transform: uppercase"
                                         maxlength="3000"
                                         counterTemplate="{0} Caracteres Restantes." counter="counterFundamentacao"/>
                        <h:outputText id="counterFundamentacao"/>
                    </h:panelGrid>

                    <h:outputText value="Descrição Conforme Diário Oficial:"/>
                    <h:panelGrid columns="2">
                        <p:inputTextarea title="Digite o descrição conforme do diário oficial do Ato Legal"
                                         value="#{atoLegalControlador.selecionado.descricaoConformeDo}"
                                         id="descricaoConformeDo" cols="70" rows="5"
                                         style="margin-left: -4px; text-transform: uppercase"
                                         maxlength="3000"
                                         counterTemplate="{0} Caracteres Restantes." counter="counterDescricao"/>
                        <h:outputText id="counterDescricao"/>
                    </h:panelGrid>

                    <fc:outputLabelObrigatorio value="Anexar Arquivo:"/>
                    <h:panelGrid columns="3" id="panelArquivo">
                        <p:commandButton id="anexarArquivo"
                                         rendered="#{atoLegalControlador.selecionado.arquivo eq null}"
                                         title="Clique para anexar o arquivo ao ato legal."
                                         oncomplete="aguarde.hide()"
                                         icon="ui-icon-folder-open"
                                         value="Anexar"
                                         styleClass="padrao"
                                         onclick="aguarde.show();arq.show();"/>

                        <p:commandButton rendered="#{atoLegalControlador.selecionado.arquivo ne null}"
                                         value="Remover"
                                         styleClass="padrao"
                                         icon="ui-icon-trash"
                                         onstart="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                                         onclick="if (!confirm('Tem certeza que deseja remover este arquivo?')) {return false; } else {aguarde.show();}"
                                         update="panelArquivo"
                                         actionListener="#{atoLegalControlador.cancelarArquivo}"/>

                        <p:panel id="painel">
                            <h:outputText rendered="#{atoLegalControlador.selecionado.arquivo eq null}"
                                          value="Nenhum arquivo anexado."/>

                            <h:outputText rendered="#{atoLegalControlador.selecionado.arquivo ne null}"
                                          value="Arquivo adicionado: "/>

                            <h:outputText rendered="#{atoLegalControlador.selecionado.arquivo ne null}"
                                          value="#{atoLegalControlador.selecionado.arquivo.descricao}"
                                          styleClass="negrito"/>

                            <p:panel style="border: 0" rendered="#{atoLegalControlador.selecionado.arquivo ne null}">
                                <a title="#{atoLegalControlador.selecionado.arquivo.descricao}"
                                   href="${facesContext.externalContext.requestContextPath}/arquivos/#{atoLegalControlador.selecionado.arquivo.nome}?id=#{atoLegalControlador.selecionado.arquivo.id}">#{atoLegalControlador.selecionado.arquivo.nome}</a>
                            </p:panel>
                        </p:panel>
                        <h:inputHidden/>
                    </h:panelGrid>
                </h:panelGrid>

                <p:panel id="painelAtoLegalOrc"
                         header="Orçamento do Ato Legal"
                         styleClass="mtop05"
                         rendered="#{atoLegalControlador.selecionado.propositoAtoLegal eq 'ALTERACAO_ORCAMENTARIA'}">

                    <h:panelGrid columns="2">
                        <h:panelGrid columns="2">
                            <h:outputLabel value="Crédito Suplementar: "/>
                            <p:inputText id="creditoSuplementar"
                                         onkeydown="mascaraMonetaria(this);"
                                         styleClass="alinhamentoDireita"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         value="#{atoLegalControlador.atoLegalORC.creditoSuplementar}"
                                         title="Informe o Crédito Suplementar do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Crédito Especial: ">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </h:outputLabel>

                            <p:inputText id="creditoEspecial" value="#{atoLegalControlador.atoLegalORC.creditoEspecial}"
                                         onkeydown="mascaraMonetaria(this);"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         styleClass="alinhamentoDireita"
                                         title="Informe o Crédito Especial do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Crédito Extraordinário: "/>
                            <p:inputText id="creditoExtraordinario"
                                         value="#{atoLegalControlador.atoLegalORC.creditoExtraordinario}"
                                         onkeydown="mascaraMonetaria(this);"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         styleClass="alinhamentoDireita"
                                         title="Informe o Crédito Extraordinário do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Reserva de Contigência: "/>
                            <p:inputText id="reservaContigencia"
                                         value="#{atoLegalControlador.atoLegalORC.reservaDeContingencia}"
                                         onkeydown="mascaraMonetaria(this);"
                                         styleClass="alinhamentoDireita"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         title="Informe um valor para reserva de contingência.">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="mlef20">
                            <h:outputLabel value="Excesso de Arrecadação: "/>
                            <p:inputText id="excessoArecadacao"
                                         value="#{atoLegalControlador.atoLegalORC.excessoArecadacao}"
                                         onkeydown="mascaraMonetaria(this);"
                                         styleClass="alinhamentoDireita"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         title="Informe o Excesso de Arrecadação do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Superavit Financeiro: ">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </h:outputLabel>
                            <p:inputText id="superAvit" value="#{atoLegalControlador.atoLegalORC.superAvit}"
                                         onkeydown="mascaraMonetaria(this);"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         styleClass="alinhamentoDireita"
                                         title="Informe o Superavit Financeiro do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Anulação de Dotação: "/>
                            <p:inputText id="anulacao" value="#{atoLegalControlador.atoLegalORC.anulacao}"
                                         onkeydown="mascaraMonetaria(this);"
                                         converter="#{atoLegalControlador.moneyConverter}"
                                         styleClass="alinhamentoDireita"
                                         title="Informe a Anulação do Ato Legal">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>

                            <h:outputLabel value="Operação de Crédito: "/>
                            <p:inputText id="operacaoDeCredito"
                                         value="#{atoLegalControlador.atoLegalORC.operacaoDeCredito}"
                                         styleClass="alinhamentoDireita"
                                         onkeydown="mascaraMonetaria(this);"
                                         converter="#{atoLegalControlador.moneyConverter}">
                                <p:ajax event="blur" update=":Formulario:totaisAtoLegalOrc"
                                        listener="#{atoLegalControlador.calculaLancamento}"/>
                            </p:inputText>
                        </h:panelGrid>
                    </h:panelGrid>
                    <p:separator styleClass="mbot10"/>
                    <h:panelGrid columns="6" id="totaisAtoLegalOrc">
                        <h:outputText value="Total de Créditos: "/>
                        <h:outputText value="#{atoLegalControlador.totalCredito}"
                                      styleClass="negrito"
                                      converter="#{atoLegalControlador.moneyConverter}"/>
                        <h:outputText value="Total de Suplementações: " styleClass="mlef20"/>
                        <h:outputText value="#{atoLegalControlador.totalDeducao}"
                                      styleClass="negrito"
                                      converter="#{atoLegalControlador.moneyConverter}"/>
                        <h:outputText value="Diferença: " styleClass="mlef20"/>
                        <h:outputText value="#{atoLegalControlador.resto}"
                                      converter="#{atoLegalControlador.moneyConverter}"
                                      styleClass="#{atoLegalControlador.validaTotais ? 'verdenegrito' : 'vermelhonegrito'}"/>
                    </h:panelGrid>
                </p:panel>


                <p:panel id="painelComissoes" header="Comissões"
                         rendered="#{atoLegalControlador.selecionado.isPropositoAtoLegalComissao()}">

                    <p:commandButton id="bt-nova-comissao"
                                     icon="ui-icon-plus"
                                     title="Clique para adicionar nova comissão"
                                     value="Nova Comissão"
                                     actionListener="#{atoLegalControlador.novaComissao()}"
                                     disabled="#{atoLegalControlador.comissaoSelecionada ne null}"
                                     process="@this"
                                     update=":Formulario:painelComissoes"
                                     onclick="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     styleClass="padrao mtop05"
                    />

                    <p:panel id="panel-nova-comissao"
                             header="Nova/Editar Comissão"
                             rendered="#{atoLegalControlador.comissaoSelecionada ne null}"
                             styleClass="mtop05 mbot05">

                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Código:"/>
                            <p:inputText title="Digite o codigo da Comissão"
                                         value="#{atoLegalControlador.comissaoSelecionada.codigo}"
                                         id="codigo"
                                         size="10">
                                <f:convertNumber integerOnly="true"/>
                                <p:ajax event="blur" listener="#{atoLegalControlador.validarCodigoNegativo()}"
                                        process="@this" update="@this"/>
                            </p:inputText>

                            <fc:outputLabelObrigatorio for="inicioVigencia" value="Inicio de Vigência:"/>
                            <p:calendar title="Digite o inicio da vigência da Comissão"
                                        value="#{atoLegalControlador.comissaoSelecionada.inicioVigencia}"
                                        locale="pt_BR" navigator="true"
                                        onkeyup="mascara(this, mdata)"
                                        id="inicioVigencia" pattern="dd/MM/yyyy"
                                        size="10"/>

                            <h:outputText value="Fim de Vigência:"/>
                            <p:calendar title="Digite o final da vigência da Comissão"
                                        value="#{atoLegalControlador.comissaoSelecionada.finalVigencia}"
                                        locale="pt_BR" navigator="true"
                                        onkeyup="mascara(this, mdata)"
                                        id="finalVigencia" pattern="dd/MM/yyyy"
                                        size="10"/>

                            <fc:outputLabelObrigatorio value="Tipo de Comissão:"/>
                            <h:selectOneMenu title="Selecione um Tipo de Comissão"
                                             value="#{atoLegalControlador.comissaoSelecionada.tipoComissao}"
                                             style="min-width: 166px!important;"
                                             id="tipoComissao">
                                <f:selectItems value="#{atoLegalControlador.tipoDeComissao}"/>
                            </h:selectOneMenu>

                            <fc:outputLabelObrigatorio value="Título:"/>
                            <p:inputText title="Digite o titulo da Comissão"
                                         value="#{atoLegalControlador.comissaoSelecionada.titulo}"
                                         id="titulo" maxlength="70" size="70"/>
                        </h:panelGrid>

                        <div class="mtop05">
                            <p:commandButton icon="ui-icon-check"
                                             title="Clique para confirmar"
                                             value="Confirmar"
                                             actionListener="#{atoLegalControlador.confirmarComissao()}"
                                             styleClass="padrao mrig05"
                                             process="panel-nova-comissao"
                                             update=":Formulario:painelComissoes"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                            />
                            <p:commandButton icon="ui-icon-cancel"
                                             title="Clique para cancelar"
                                             value="Cancelar"
                                             actionListener="#{atoLegalControlador.cancelarComissaoSelecionada()}"
                                             styleClass="padrao mrig05"
                                             process="@this"
                                             update="painelComissoes"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                            />
                        </div>

                    </p:panel>

                    <p:dataTable id="tabelaComissoes"
                                 value="#{atoLegalControlador.selecionado.atoDeComissao.comissoes}"
                                 var="comissao"
                                 rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                 paginator="true"
                                 styleClass="mtop05"
                                 rows="10"
                                 paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>COMISSÕES&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                 emptyMessage="Não foram localizados registros para serem apresentados."
                                 rowIndexVar="rowlx">

                        <p:column headerText="Ação" styleClass="alinhamentoCentralizado" style="width: 90px;">
                            <p:commandButton actionListener="#{atoLegalControlador.selecionarComissao(comissao)}"
                                             icon="ui-icon-pencil"
                                             title="Clique para alterar"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             update=":Formulario:painelComissoes">
                            </p:commandButton>

                            <p:commandButton actionListener="#{atoLegalControlador.removerComissao(comissao)}"
                                             icon="ui-icon-trash"
                                             title="Clique para remover"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             onclick="if(!confirm('Tem certeza que deseja remover este registro?')) return false;"
                                             update="tabelaComissoes"
                                             styleClass="mlef05">
                            </p:commandButton>
                        </p:column>
                        <p:column headerText="Membro" styleClass="alinhamentoCentralizado" style="width: 90px;">
                            <p:commandButton icon="ui-icon-plus"
                                             title="Clique para adicionar membro"
                                             actionListener="#{atoLegalControlador.selecionarComissaoAndNovoMembro(comissao)}"
                                             oncomplete="dialogEditaMembro.show()"
                                             process="@this"
                                             update=":form-edita-membro"
                                             styleClass="mrig05"
                            />
                            <p:commandButton icon="ui-icon-lupa"
                                             title="Clique para visualizar membros"
                                             actionListener="#{atoLegalControlador.selecionarComissao(comissao)}"
                                             oncomplete="dialogVisualizaMembro.show()"
                                             process="@this"
                                             update=":form-visualiza-membro"
                                             styleClass="mrig05"
                            />
                        </p:column>
                        <p:column headerText="Código" styleClass="alinhamentoDireita">
                            <h:outputText value="#{comissao.codigo} "/>
                        </p:column>
                        <p:column headerText="Início de Vigência" styleClass="allinhamentoCentralizado">
                            <h:outputText value="#{comissao.inicioVigencia}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Final de Vigência" styleClass="allinhamentoCentralizado">
                            <h:outputText value="#{comissao.finalVigencia}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Tipo de Comissão" styleClass="allinhamentoEsquerda">
                            <h:outputText value="#{comissao.tipoComissao.descricao}"/>
                        </p:column>
                        <p:column headerText="Título" styleClass="allinhamentoEsquerda">
                            <h:outputText value="#{comissao.titulo}"/>
                        </p:column>
                    </p:dataTable>
                </p:panel>

                <p:panel id="painelRep"
                         styleClass="mtop10"
                         header="Republicação">
                    <p:commandButton value="Novo"
                                     icon="ui-icon-circle-plus"
                                     actionListener="#{atoLegalControlador.instanciarRepublicacao()}"
                                     rendered="#{atoLegalControlador.atoLegalRepublicacao eq null}"
                                     update="painelRep"
                                     process="@this"
                                     id="btnNovoRep"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     styleClass="padrao"
                                     title="Clique para adicionar uma novo republicação."/>

                    <h:panelGrid columns="2"
                                 rendered="#{atoLegalControlador.atoLegalRepublicacao ne null}">
                        <fc:outputLabelObrigatorio value="Número: "/>
                        <p:inputText value="#{atoLegalControlador.atoLegalRepublicacao.numeroRepublicacao}"
                                     maxlength="15"
                                     onkeyup="mascara(this, soNumeros)"/>

                        <fc:outputLabelObrigatorio value="Data: "/>
                        <fc:calendar value="#{atoLegalControlador.atoLegalRepublicacao.dataRepublicacao}"/>
                    </h:panelGrid>

                    <p:commandButton value="Adicionar"
                                     icon="ui-icon-circle-plus"
                                     actionListener="#{atoLegalControlador.adicionarRepublicacao()}"
                                     update="painelRep"
                                     process="@this painelRep"
                                     styleClass="padrao mtop10"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     rendered="#{atoLegalControlador.atoLegalRepublicacao ne null}"
                                     title="Clique para adicionar a Republicação"/>

                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-cancel"
                                     actionListener="#{atoLegalControlador.cancelarRepublicacao()}"
                                     update="painelRep"
                                     process="@this"
                                     styleClass="mlef05 mtop10 padrao"
                                     onstart="aguarde.show()"
                                     oncomplete="aguarde.hide()"
                                     rendered="#{atoLegalControlador.atoLegalRepublicacao ne null}"
                                     title="Clique para cancelar"/>

                    <p:dataTable id="tabelaRep"
                                 value="#{atoLegalControlador.selecionado.republicacoes}"
                                 var="re"
                                 styleClass="mtop02"
                                 rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                 paginator="true"
                                 rows="10"
                                 paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>Republicação&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                 emptyMessage="Não foram localizados registros para serem apresentados."
                                 rowIndexVar="rowlx">
                        <p:column headerText="Ações" style="text-align: center; width: 7%">
                            <p:commandButton icon="ui-icon-pencil"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="mrig05"
                                             actionListener="#{atoLegalControlador.editarRepublicacao(re)}"
                                             title="Clique para alterar este registro."
                                             id="btEditarRep"
                                             update=":Formulario:painelRep"/>

                            <p:commandButton icon="ui-icon-trash"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{atoLegalControlador.removerRepublicacao(re)}"
                                             title="Clique para remover este registro."
                                             onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                             id="btRemoveRep"
                                             process="@this"
                                             update="tabelaRep"/>
                        </p:column>
                        <p:column headerText="Número da Republicação" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{re.numeroRepublicacao}"/>
                        </p:column>
                        <p:column headerText="Data da Republicação" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{re.dataRepublicacao}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:panel>

            </p:panel>
            <fc:rodapePretty id="rpRodapePretty" controlador="#{atoLegalControlador}"/>

            <p:commandButton value="Importar Atos"
                             id="cbImportarAtos"
                             style="height: 30px;"
                             styleClass="mtop10 mlef05"
                             icon="ui-icon-folder-open"
                             onclick="aguarde.show()"
                             oncomplete="aguarde.hide()"
                             rendered="#{atoLegalControlador.operacaoNovo}"
                             title="Clique para ser redirecionado para a tela de importar atos legais."
                             actionListener="#{atoLegalControlador.redirecinarParaTelaImportacao()}"
                             immediate="true"/>
        </h:form>

        <p:dialog header="Novo/Editar Membro"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="true"
                  resizable="false"
                  widgetVar="dialogEditaMembro"
                  closable="true">
            <h:form id="form-edita-membro">
                <p:outputPanel id="panel-edita-membro">

                    <div class="mtop05 mbot05">
                        <h:outputText value="Comissão Selecionada: #{atoLegalControlador.comissaoSelecionada}"
                                      style="font-size: 14px"
                                      styleClass="negrito"
                        />
                    </div>

                    <h:panelGrid columns="2">
                        <fc:outputLabelObrigatorio value="Membro:"/>
                        <h:panelGroup>
                            <p:autoComplete queryDelay="1000" id="pessoa"
                                            title="Digite o nome do membro"
                                            value="#{atoLegalControlador.membroComissaoSelecionado.pessoaFisica}"
                                            completeMethod="#{atoLegalControlador.completaPessoaFisica}"
                                            converter="#{atoLegalControlador.converterPessoaFisica}"
                                            var="pessoaFisica"
                                            itemLabel="#{pessoaFisica.nome}"
                                            itemValue="#{pessoaFisica.id}"
                                            forceSelection="true"
                                            size="70"
                                            styleClass="mrig05"/>

                            <p:commandButton process="@none"
                                             id="bt-nova-pf"
                                             icon="ui-icon-plus"
                                             styleClass="mrig10"
                                             update="@none"
                                             onclick="window.open('#{request.contextPath}/pessoa-fisica/novo/','_blank');"/>
                        </h:panelGroup>

                        <h:outputLabel value="Natureza do Cargo:"/>
                        <h:selectOneMenu title="Selecione a natureza do Cargo"
                                         value="#{atoLegalControlador.membroComissaoSelecionado.naturezaDoCargo}"
                                         id="naturezaCargo">
                            <f:selectItems value="#{atoLegalControlador.naturezaDoCargo}"/>
                        </h:selectOneMenu>

                        <h:outputLabel value="Atribuicao da Comissao:"/>
                        <h:selectOneMenu title="Selecione a atribuição"
                                         style="min-width: 174px!important;"
                                         value="#{atoLegalControlador.membroComissaoSelecionado.atribuicaoComissao}"
                                         id="atribuicaoComissao">
                            <f:selectItems value="#{atoLegalControlador.atruibuicaoComissao}"/>
                        </h:selectOneMenu>
                    </h:panelGrid>

                    <div class="mtop05">
                        <p:commandButton icon="ui-icon-check"
                                         title="Clique para confirmar"
                                         value="Confirmar"
                                         actionListener="#{atoLegalControlador.confirmarMembro()}"
                                         styleClass="padrao mrig05"
                                         process="@form"
                                         update="@form"
                                         onclick="aguarde.show()"
                                         oncomplete="aguarde.hide()"
                        />
                    </div>

                    <p:dataTable id="tabela-membro"
                                 value="#{atoLegalControlador.comissaoSelecionada.membroComissao}"
                                 var="membro"
                                 rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                 paginator="true"
                                 styleClass="mtop05"
                                 rows="5"
                                 paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>MEMBROS DESTA COMISSÃO&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                                 emptyMessage="Não foram localizados registros para serem apresentados."
                                 rowIndexVar="rowlx">

                        <p:column headerText="Ações" styleClass="alinhamentoCentralizado" style="width: 120px;">
                            <p:commandButton title="Clique para exonerar este membro."
                                             icon="ui-icon-cancel"
                                             actionListener="#{atoLegalControlador.selecionarMembroExoneracao(membro)}"
                                             disabled="#{membro.id == null or membro.temExoneradoEm()}"
                                             process="@this"
                                             update=":formulario-exoneracao"
                                             onstart="aguarde.show()"
                                             oncomplete="dialogExoneracao.show(); aguarde.hide();"
                                             styleClass="mrig05"/>

                            <p:commandButton title="Clique para alterar este membro."
                                             icon="ui-icon-pencil"
                                             actionListener="#{atoLegalControlador.selecionarMembro(membro)}"
                                             disabled="#{atoLegalControlador.membroComissaoSelecionado ne null and membro.temExoneradoEm()}"
                                             process="@this"
                                             update="@form"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="mrig05"/>

                            <p:commandButton title="Clique para remover este membro."
                                             icon="ui-icon-trash"
                                             actionListener="#{atoLegalControlador.removerMembro(membro)}"
                                             disabled="#{membro.temExoneradoEm()}"
                                             onclick="if(!confirm('Tem certeza que deseja remover este registro?')) return false;"
                                             onstart="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             process="@this"
                                             update="tabela-membro"
                                             styleClass="mrig05"/>
                        </p:column>
                        <p:column headerText="Membro" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{membro.pessoaFisica}"/>
                        </p:column>
                        <p:column headerText="Natureza do Cargo" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{membro.naturezaDoCargo.descricao}"/>
                        </p:column>
                        <p:column headerText="Atribuição da Comissão" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{membro.atribuicaoComissao.descricao}"/>
                        </p:column>
                        <p:column headerText="Data de Exoneração" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{membro.exoneradoEm}">
                                <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>

                <div class="mtop05 alinhamentoCentralizado">
                    <p:commandButton icon="ui-icon-cancel"
                                     title="Clique para fechar"
                                     value="Fechar"
                                     actionListener="#{atoLegalControlador.cancelarMembroComissaoSelecionadoAndComissaoSelecionada()}"
                                     styleClass="padrao mrig05"
                                     process="@this"
                                     update="@this"
                                     onclick="aguarde.show()"
                                     oncomplete="dialogEditaMembro.hide(); aguarde.hide();"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  draggable="true"
                  resizable="false"
                  widgetVar="dialogVisualizaMembro"
                  closable="true">
            <h:form id="form-visualiza-membro">

                <div class="mtop05 mbot05">
                    <h:outputText value="Comissão Selecionada: #{atoLegalControlador.comissaoSelecionada}"
                                  style="font-size: 14px"
                                  styleClass="negrito"
                    />
                </div>

                <p:dataTable id="tabelaMembros"
                             value="#{atoLegalControlador.comissaoSelecionada.membroComissao}"
                             var="membro"
                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                             paginator="true"
                             styleClass="mtop05"
                             rows="5"
                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>MEMBROS DESTA COMISSÃO&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                             emptyMessage="Não foram localizados registros para serem apresentados."
                             rowIndexVar="rowlx">

                    <p:column headerText="Membro" styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{membro.pessoaFisica}"/>
                    </p:column>
                    <p:column headerText="Natureza do Cargo" styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{membro.naturezaDoCargo.descricao}"/>
                    </p:column>
                    <p:column headerText="Atribuição da Comissão" styleClass="alinhamentoEsquerda">
                        <h:outputText value="#{membro.atribuicaoComissao.descricao}"/>
                    </p:column>
                    <p:column headerText="Data de Exoneração" styleClass="alinhamentoCentralizado">
                        <h:outputText value="#{membro.exoneradoEm}">
                            <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
                        </h:outputText>
                    </p:column>
                </p:dataTable>

                <div class="mtop05 alinhamentoCentralizado">
                    <p:commandButton icon="ui-icon-cancel"
                                     value="Fechar"
                                     title="Clique para fechar"
                                     actionListener="#{atoLegalControlador.cancelarComissaoSelecionada()}"
                                     process="@this"
                                     update="@none"
                                     onclick="aguarde.show()"
                                     oncomplete="dialogVisualizaMembro.hide(); aguarde.hide();"
                                     styleClass="padrao"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog modal="true" id="dialogUpload"
                  header="Upload de Arquivos"
                  widgetVar="arq"
                  dynamic="true"
                  position="center"
                  style="position: fixed!important;"
                  closable="false"
                  resizable="false">
            <h:form id="formularioUpload">
                <h:panelGrid id="panelUpload">
                    <p:fileUpload fileUploadListener="#{atoLegalControlador.handleFileUpload}"
                                  mode="advanced"
                                  auto="true"
                                  update=":Formulario:panelArquivo formularioUpload"
                                  cancelLabel="Cancelar"
                                  uploadLabel="Enviar"
                                  label="Selecionar"
                                  sizeLimit="15728640"
                                  id="botaoSelecionar"
                    />
                    <br/>
                    <h:outputText value="Descrição"/>
                    <p:inputText id="descricaoAnexo" value="#{atoLegalControlador.selecionado.arquivo.descricao}"
                                 size="70"
                                 rendered="#{atoLegalControlador.selecionado.arquivo ne null}"
                                 title="Informe a Descrição do Arquivo do Ato Legal"/>

                    <p:commandButton id="fecharAnexo"
                                     value="Fechar"
                                     styleClass="padrao"
                                     update=":Formulario:painel"
                                     onclick="arq.hide();aguarde.show();"
                                     oncomplete="aguarde.hide()"
                                     title="Clique para Fechar a Janela"
                                     icon="ui-icon-close"/>
                </h:panelGrid>
            </h:form>
        </p:dialog>

        <p:dialog
            id="dialog-exoneracao"
            widgetVar="dialogExoneracao"
            modal="true"
            width="500"
            closable="false"
            header="Exoneração Membro Comissao"
            resizable="false">

            <h:form id="formulario-exoneracao">
                <h:panelGrid id="grid-exoneracao" columns="2">
                    <h:outputText value="Membro: "/>
                    <h:outputText value="#{atoLegalControlador.membroExoneracao.pessoaFisica}" styleClass="negrito"/>

                    <h:outputText value="Natureza do Cargo: "/>
                    <h:outputText value="#{atoLegalControlador.membroExoneracao.naturezaDoCargo.descricao}"
                                  styleClass="negrito"/>

                    <h:outputText value="Atribuição Comissão: "/>
                    <h:outputText value="#{atoLegalControlador.membroExoneracao.atribuicaoComissao.descricao}"
                                  styleClass="negrito"/>

                    <h:outputText value="Data Exoneração: "/>
                    <p:calendar
                        title="A data de inicialização do inventário é preenchida automáticamente pelo sistema quando o processo é iniciado."
                        value="#{atoLegalControlador.membroExoneracao.exoneradoEm}"
                        id="exoneradoEm" pattern="dd/MM/yyyy HH:mm:ss" navigator="true" locale="pt_BR"/>
                </h:panelGrid>

                <div align="center" class="margem-superior-dez-pixels">
                    <p:commandButton icon="ui-icon-check"
                                     id="bt-confirmar-exoneracao"
                                     styleClass="icone_verde margem-direita-cinco-pixels"
                                     update="@this"
                                     actionListener="#{atoLegalControlador.confirmarExoneracaoMembro()}"
                                     oncomplete="dialogExoneracao.hide();"
                                     value="Confirmar Exoneração"/>
                    <p:commandButton icon="ui-icon-closethick"
                                     styleClass="icone_vermelho"
                                     update="@this"
                                     actionListener="#{atoLegalControlador.cancelarExoneracao}"
                                     oncomplete="dialogExoneracao.hide()"
                                     value="Cancelar"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
