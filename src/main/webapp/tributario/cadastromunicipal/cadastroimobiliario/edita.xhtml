<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <style type="text/css">
            .ui-datatable table table * {
                border: none !important;
            }
        </style>
        <h:form id="formulario">
            <p:outputPanel rendered="#{cadastroImobiliarioControlador.imovelPenhorado}"
                           style="text-align: center !important">
                <div
                    class="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error':'ui-messages-warn'} ui-corner-all textomedio">
                    <div
                        class="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-icon':'ui-messages-warn-icon'} margem-direita-cinco-pixels"/>
                    <h:outputText value="Atenção! "
                                  styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-summary': 'ui-messages-warn-summary'}"/>
                    <h:outputText
                        value="Este imóvel encontra-se penhorado #{cadastroImobiliarioControlador.imovelBloqueado ? 'e bloqueado. Não é permitido realizar alteração ou exclusão.':''}"
                        styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/>
                    <br/><h:outputText
                    value="Processo nº #{cadastroImobiliarioControlador.ultimaPenhora.numeroProcesso}, na data de #{cadastroImobiliarioControlador.ultimaPenhora.dataPenhora}, pelo Autor #{cadastroImobiliarioControlador.ultimaPenhora.autor.nome}."
                    styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/><br/>
                    <h:outputText
                        value="#{cadastroImobiliarioControlador.ultimaPenhora.bloqueio? 'Com ':'Sem '}Bloqueio."
                        styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/>
                </div>
            </p:outputPanel>
            <br/>
            <p:panel header="Cadastro Imobiliário">
                <div class="row">
                    <div class="col-md-6">
                        <fc:atributosGenericos atributos="#{cadastroImobiliarioControlador.selecionado.atributos}"
                                               classe="${sistemaControlador.classeCadastroImobiliario}"/>
                    </div>
                    <div class="col-md-6">
                        <fc:eventoCalculadoBci cadastroImobiliario="#{cadastroImobiliarioControlador.selecionado}"/>
                    </div>
                </div>
                <p:tabView id="tabView">
                    <p:tab id="tabLote" title="Lote">
                        <p:outputPanel id="lotes">
                            <div class="row">
                                <div class="col-md-4">
                                    <h:panelGrid columns="2" id="panelGrid">
                                        <fc:outputLabelObrigatorio value="Setor: "/>
                                        <h:panelGroup id="groupSetor">
                                            <h:panelGrid id="gridSetor" columns="2">
                                                <h:selectOneMenu id="setor"
                                                                 value="#{cadastroImobiliarioControlador.setor}"
                                                                 disabled="#{!cadastroImobiliarioControlador.operacaoNovo}"
                                                                 converter="#{cadastroImobiliarioControlador.converterSetor}">
                                                    <f:selectItems value="#{cadastroImobiliarioControlador.setores}"/>
                                                    <p:ajax update="quadra groupNavegaSetor" event="change"
                                                            process="setor"/>
                                                </h:selectOneMenu>
                                                <h:panelGroup id="groupNavegaSetor">
                                                    <fc:navegaCadastros id="navegaSetor"
                                                                        objetoDoCadastro="#{cadastroImobiliarioControlador.setor}"
                                                                        rendered="#{cadastroImobiliarioControlador.operacaoNovo}"
                                                                        destinoNovo="/tributario/setor/novo/"
                                                                        destinoEditar="/tributario/setor/editar/#{cadastroImobiliarioControlador.setor.id}/"
                                                                        porNaSessao="#{cadastroImobiliarioControlador.selecionado}"
                                                                        origem="#{cadastroImobiliarioControlador.urlAtual}"/>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </h:panelGroup>
                                        <fc:outputLabelObrigatorio value="Quadra: "/>
                                        <h:panelGroup id="groupQuadra">
                                            <h:panelGrid id="gridQuadra" columns="2">
                                                <p:autoComplete queryDelay="1000" id="quadra"
                                                                value="#{cadastroImobiliarioControlador.quadra}"
                                                                converter="#{cadastroImobiliarioControlador.converterQuadra}"
                                                                disabled="#{!cadastroImobiliarioControlador.operacaoNovo}"
                                                                completeMethod="#{cadastroImobiliarioControlador.completaQuadra}"
                                                                var="quadra"
                                                                size="23" dropdown="true"
                                                                itemLabel="#{quadra.descricao}"
                                                                itemValue="#{quadra.id}">
                                                    <p:ajax update="lote groupNavegaQuadra" event="itemSelect"
                                                            process="quadra"/>
                                                    <p:ajax update="groupNavegaQuadra" event="blur" process="quadra"/>
                                                </p:autoComplete>
                                                <h:panelGroup id="groupNavegaQuadra">
                                                    <fc:navegaCadastros id="navegaQuadra"
                                                                        destinoNovo="/tributario/quadra/novo/"
                                                                        destinoEditar="/tributario/quadra/editar/#{cadastroImobiliarioControlador.selecionado.lote.quadra.id}/"
                                                                        objetoDoCadastro="#{cadastroImobiliarioControlador.selecionado.lote.quadra}"
                                                                        rendered="#{cadastroImobiliarioControlador.operacaoNovo}"
                                                                        porNaSessao="#{cadastroImobiliarioControlador.selecionado}"
                                                                        origem="#{cadastroImobiliarioControlador.urlAtual}"/>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </h:panelGroup>
                                        <fc:outputLabelObrigatorio value="Lote (Município): "/>
                                        <h:panelGroup id="groupLote">
                                            <h:panelGrid columns="2">
                                                <p:autoComplete queryDelay="1000" id="lote"
                                                                value="#{cadastroImobiliarioControlador.lote}"
                                                                converter="#{cadastroImobiliarioControlador.converterLote}"
                                                                completeMethod="#{cadastroImobiliarioControlador.completaLote}"
                                                                disabled="#{!cadastroImobiliarioControlador.operacaoNovo}"
                                                                var="lote"
                                                                size="23" dropdown="true"
                                                                maxResults="10"
                                                                itemLabel="#{lote.codigoLote}"
                                                                itemValue="#{lote.id}">
                                                    <p:ajax update="lotes groupNavegaLote"
                                                            event="itemSelect"
                                                            listener="#{cadastroImobiliarioControlador.selecionaLote}"
                                                            process="lote"/>
                                                    <p:ajax update="groupNavegaLote" event="blur" process="@this"/>
                                                </p:autoComplete>
                                                <h:panelGroup id="groupNavegaLote">
                                                    <fc:navegaCadastros id="navegaLote"
                                                                        destinoNovo="/tributario/lote/novo/"
                                                                        destinoEditar="/tributario/lote/editar/#{cadastroImobiliarioControlador.selecionado.lote.id}/"
                                                                        objetoDoCadastro="#{cadastroImobiliarioControlador.selecionado.lote}"
                                                                        porNaSessao="#{cadastroImobiliarioControlador.selecionado}"
                                                                        rendered="#{cadastroImobiliarioControlador.operacaoNovo}"
                                                                        origem="#{cadastroImobiliarioControlador.urlAtual}"/>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </h:panelGroup>

                                        <h:outputText value="Loteamento: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.quadra.loteamento.nome}"
                                            styleClass="azulnegrito"/>

                                        <h:outputText value="Lote (Loteamento): "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.descricaoLoteamento}"
                                            styleClass="azulnegrito"/>

                                        <h:outputLabel value="Zona: "/>
                                        <h:panelGroup id="groupZona">
                                            <h:panelGrid id="gridZona" columns="2">
                                                <p:autoComplete queryDelay="1000" id="zona"
                                                                value="#{cadastroImobiliarioControlador.zona}"
                                                                converter="#{zonaControlador.converterGenerico}"
                                                                completeMethod="#{zonaControlador.completarZonas}"
                                                                disabled="#{!cadastroImobiliarioControlador.operacaoNovo}"
                                                                var="zona"
                                                                size="23" dropdown="true"
                                                                itemLabel="#{zona}"
                                                                itemValue="#{zona.id}">
                                                    <p:ajax event="itemSelect" process="zona"/>
                                                    <p:ajax event="blur" process="zona"/>
                                                </p:autoComplete>
                                                <h:panelGroup id="groupNavegaZona">
                                                    <fc:navegaCadastros id="navegaZona"
                                                                        objetoDoCadastro="#{cadastroImobiliarioControlador.zona}"
                                                                        destinoNovo="/cadastro-imobiliario/alvara-imediato/zona/novo/"
                                                                        destinoEditar="/cadastro-imobiliario/alvara-imediato/zona/editar/#{cadastroImobiliarioControlador.zona.id}/"
                                                                        rendered="#{cadastroImobiliarioControlador.operacaoNovo}"
                                                                        porNaSessao="#{cadastroImobiliarioControlador.selecionado}"
                                                                        origem="#{cadastroImobiliarioControlador.urlAtual}"/>
                                                </h:panelGroup>
                                            </h:panelGrid>
                                        </h:panelGroup>

                                        <h:outputText value="Área do Terreno (m²): "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.areaLote}"
                                            styleClass="azulnegrito">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                        <h:outputText value="Código Anterior: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.codigoAnterior}"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="Tipo Logradouro: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.testadaPrincipal.face.logradouroBairro.logradouro.tipoLogradouro.descricao}"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="Logradouro: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.testadaPrincipal.face.logradouroBairro.logradouro.nome}"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="Número: "/>
                                        <h:outputText value="#{cadastroImobiliarioControlador.selecionado.numero}"
                                                      styleClass="azulnegrito"/>
                                        <h:outputText value="Complemento (Lote): "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.complemento}"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="Complemento (BCI): "/>
                                        <p:inputText
                                            value="#{cadastroImobiliarioControlador.selecionado.complementoEndereco}"
                                            disabled="#{cadastroImobiliarioControlador.operacaoEditar}"
                                            size="80"
                                            maxlength="80"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="Bairro: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.testadaPrincipal.face.logradouroBairro.bairro.descricao}"
                                            styleClass="azulnegrito"/>
                                        <h:outputText value="CEP: "/>
                                        <h:outputText
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.testadaPrincipal.face.logradouroBairro.cep}"
                                            styleClass="azulnegrito"/>
                                        <h:outputLabel value="Vulnerabilidade Ambiental? "/>
                                        <p:selectBooleanCheckbox
                                            value="#{cadastroImobiliarioControlador.selecionado.lote.vulnerabilidadeAmbiental}"/>
                                        <fc:outputLabelObrigatorio value="Código: "/>
                                        <p:inputText title="Digite o código do Cadastro Imobiliário"
                                                     value="#{cadastroImobiliarioControlador.selecionado.codigo}"
                                                     disabled="true"
                                                     id="codigo" maxlength="30" size="30"/>
                                        <fc:outputLabelObrigatorio value="Inscrição Cadastral: "/>
                                        <p:inputText title="Digite a Inscrição Cadastral do Cadastro Imobiliario"
                                                     value="#{cadastroImobiliarioControlador.selecionado.inscricaoCadastral}"
                                                     id="inscricaoCadastral"
                                                     styleClass="maiusculo"
                                                     disabled="true"
                                                     size="30"/>

                                        <h:outputText value="Área Total Construída (m²):"/>
                                        <h:panelGrid columns="2">
                                            <p:inputText id="areatotal"
                                                         value="#{cadastroImobiliarioControlador.selecionado.areaTotalConstruida}"
                                                         disabled="#{!cadastroImobiliarioControlador.operacaoNovo}"
                                                         size="30">
                                                <f:convertNumber pattern="##,##0.00"/>
                                            </p:inputText>
                                            <p:commandButton id="btAtualizaAreaTotalConstruida"
                                                             actionListener="#{cadastroImobiliarioControlador.atualizaAreaTotalConstruida}"
                                                             rendered="#{cadastroImobiliarioControlador.operacaoNovo}"
                                                             update="@form" icon="ui-icon-refresh"
                                                             title="Clique aqui para atualizar Área Total Construída"/>
                                        </h:panelGrid>
                                    </h:panelGrid>
                                    <br/>
                                    <p:panel id="panelUnidade"
                                             rendered="#{cadastroImobiliarioControlador.mostraUnidadeExterna or cadastroImobiliarioControlador.mostraUnidadeOrganizacional}">
                                        <h:panelGrid columns="2">
                                            <h:outputText value="Secretaria/Órgão vinculado:"/>
                                            <p:autoComplete queryDelay="1000" id="unidadeExterna"
                                                            size="70"
                                                            maxResults="10"
                                                            rendered="#{cadastroImobiliarioControlador.mostraUnidadeExterna}"
                                                            completeMethod="#{cadastroImobiliarioControlador.completaUnidadeExterna}"
                                                            value="#{cadastroImobiliarioControlador.selecionado.unidadeExterna}"
                                                            itemValue="#{uni}"
                                                            converter="#{unidadeExternaControlador.converterGenerico}"
                                                            itemLabel="#{uni.pessoaJuridica.razaoSocial}"
                                                            var="uni"/>

                                            <p:autoComplete queryDelay="1000" id="unidadeOrganizacional"
                                                            size="70"
                                                            maxResults="10"
                                                            rendered="#{cadastroImobiliarioControlador.mostraUnidadeOrganizacional}"
                                                            completeMethod="#{cadastroImobiliarioControlador.completaUnidadeOrganizacional}"
                                                            value="#{cadastroImobiliarioControlador.selecionado.unidadeOrganizacional}"
                                                            itemValue="#{uni}"
                                                            converter="#{unidadeOrganizacionalControlador.converterGenerico}"
                                                            itemLabel="#{uni.descricao}"
                                                            var="uni"/>

                                            <fc:outputLabelObrigatorio value="Identificação Imóvel:"/>
                                            <p:inputText
                                                value="#{cadastroImobiliarioControlador.selecionado.identificacaoPatrimonial}"
                                                size="70"
                                                maxlength="80"/>
                                        </h:panelGrid>
                                    </p:panel>
                                </div>
                                <div class="col-md-4">
                                    <fc:vizualizaAtributosGenericos
                                        atributos="#{cadastroImobiliarioControlador.selecionado.lote.atributos}"
                                        classe="${sistemaControlador.classeLote}"/>
                                </div>
                                <div class="col-md-4">
                                    <div style="overflow-x: auto">
                                        <p:dataTable id="panelTestadasLote"
                                                     emptyMessage="Nenhum registro encontrado"
                                                     rendered="#{cadastroImobiliarioControlador.selecionado.lote != null}"
                                                     value="#{cadastroImobiliarioControlador.selecionado.lote.testadas}"
                                                     var="testada">
                                            <f:facet name="header">
                                                <h:outputText
                                                    value="Faces da Quadra: ${cadastroImobiliarioControlador.selecionado.lote.quadra.descricao}"/>
                                            </f:facet>
                                            <p:column headerText="Código da Face">
                                                <h:outputText value="#{testada.face.codigoFace}"/>
                                                <p:rowToggler/>
                                            </p:column>
                                            <p:column headerText="Face de Quadra">
                                                <h:outputText value="#{testada.face.logradouroBairro.logradouro.nome}"/>
                                            </p:column>
                                            <p:column headerText="Largura (m)">
                                                <h:outputText value="#{testada.face.largura}">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="Testada (m)">
                                                <h:outputText value="#{testada.tamanho}">
                                                    <f:convertNumber pattern="#,##0.00"/>
                                                </h:outputText>
                                            </p:column>
                                            <p:column headerText="Testada Principal">
                                                <h:outputText value="#{testada.principalString}"/>
                                            </p:column>
                                            <p:rowExpansion>
                                                <p:dataTable
                                                    value="#{cadastroImobiliarioControlador.servicosUrbanos(testada.face)}"
                                                    emptyMessage="Nenhum registro encontrado"
                                                    var="servico">
                                                    <f:facet name="header">
                                                        <h:outputText value="Serviços Urbanos"/>
                                                    </f:facet>
                                                    <p:column headerText="Código">
                                                        <h:outputText value="#{servico.servicoUrbano.codigo}"/>
                                                    </p:column>
                                                    <p:column headerText="Descrição">
                                                        <h:outputText value="#{servico.servicoUrbano.nome}"/>
                                                    </p:column>
                                                </p:dataTable>
                                            </p:rowExpansion>
                                        </p:dataTable>
                                    </div>
                                </div>
                            </div>
                        </p:outputPanel>
                    </p:tab>
                    <p:tab id="tabProprietarios" title="Proprietário(s) na Prefeitura">
                        <p:tabView id="tabViewProprietarios">
                            <p:tab title="Proprietário(s) Atual(ais)">
                                <p:panel id="painelProprietarios">
                                    <div style="text-align: center;">
                                        <p:commandButton value="Novo Proprietário"
                                                         icon="ui-icon-circle-plus"
                                                         style="height: 30px"
                                                         update="painelProprietarios"
                                                         rendered="#{cadastroImobiliarioControlador.propriedadeSelecionada eq null and !cadastroImobiliarioControlador.operacaoEditar}"
                                                         actionListener="#{cadastroImobiliarioControlador.novaPropriedade()}"/>
                                    </div>
                                    <h:panelGrid columns="2"
                                                 rendered="#{!cadastroImobiliarioControlador.operacaoEditar and cadastroImobiliarioControlador.propriedadeSelecionada ne null}">
                                        <fc:outputLabelObrigatorio value="Proprietário: "/>
                                        <fc:novoAutocompletePessoa id="proprietario"
                                                                   value="#{cadastroImobiliarioControlador.propriedadeSelecionada.pessoa}"
                                                                   caminhoAtual="#{cadastroImobiliarioControlador.urlAtual}"
                                                                   situacoesPossiveis="#{cadastroImobiliarioControlador.situacoesPesquisaPessoa}"
                                                                   permiteAlterarSituacoes="false"/>

                                        <fc:outputLabelObrigatorio value="Proporção (%): "/>
                                        <p:inputText title="Digite o percentual da proporção"
                                                     value="#{cadastroImobiliarioControlador.propriedadeSelecionada.proporcao}"
                                                     id="proporcao" size="4" maxlength="7">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </p:inputText>

                                        <fc:outputLabelObrigatorio value="Tipo de Proprietário: "/>
                                        <h:selectOneMenu title="Selecione o tipo de proprietário"
                                                         value="#{cadastroImobiliarioControlador.propriedadeSelecionada.tipoProprietario}"
                                                         id="tipoProprietario">
                                            <f:selectItems value="#{cadastroImobiliarioControlador.tipoProprietarios}"/>
                                        </h:selectOneMenu>

                                        <fc:outputLabelObrigatorio value="Início da Vigência: "/>
                                        <p:calendar
                                            value="#{cadastroImobiliarioControlador.propriedadeSelecionada.inicioVigencia}"
                                            navigator="true"
                                            pattern="dd/MM/yyyy" showOn="button" onkeyup="mascara(this, mdata);"
                                            id="inicioVigenciaProprietario"/>

                                        <h:outputText value="Final da Vigência: "/>
                                        <p:calendar
                                            value="#{cadastroImobiliarioControlador.propriedadeSelecionada.finalVigencia}"
                                            navigator="true"
                                            pattern="dd/MM/yyyy" showOn="button" onkeyup="mascara(this, mdata);"
                                            id="finalVigenciaProprietario"/>

                                        <p:commandButton value="Adicionar"
                                                         icon="ui-icon-arrowthickstop-1-s"
                                                         update=":formulario:tabView:tabViewProprietarios:painelProprietarios"
                                                         actionListener="#{cadastroImobiliarioControlador.novoProprietario()}"/>
                                        <p:commandButton value="Cancelar"
                                                         icon="ui-icon-close"
                                                         update="painelProprietarios"
                                                         actionListener="#{cadastroImobiliarioControlador.setPropriedadeSelecionada(null)}"/>
                                    </h:panelGrid>

                                    <br/>
                                    <p:dataTable id="proprietarioTabela"
                                                 emptyMessage="Nenhum registro encontrado"
                                                 value="#{cadastroImobiliarioControlador.propriedades}"
                                                 var="c">
                                        <p:column headerText="Expandir">
                                            <p:rowToggler/>
                                        </p:column>
                                        <p:column headerText="Proprietário">
                                            <h:outputText value="#{c.pessoa.nome}"
                                                          title="Clique para ver os detalhes do proprietário"/>
                                        </p:column>
                                        <p:column headerText="CPF/CNPJ">
                                            <h:outputText value="#{c.pessoa.cpf_Cnpj}"
                                                          title="Clique para ver os detalhes do proprietário"/>
                                        </p:column>
                                        <p:column headerText="Proporção (%)">
                                            <h:outputText value="#{c.proporcao}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Tipo de Proprietário">
                                            <h:outputText value="#{c.tipoProprietario.descricao}"/>
                                        </p:column>
                                        <p:column headerText="Início da Vigência">
                                            <h:outputText value="#{c.inicioVigencia}">
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:column headerText="Final da Vigência">
                                            <h:outputText value="#{c.finalVigencia}">
                                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                                            </h:outputText>
                                        </p:column>
                                        <p:rowExpansion>
                                            <p:dataTable
                                                value="#{cadastroImobiliarioControlador.enderecosPropriedade(c.pessoa)}"
                                                emptyMessage="Nenhum registro encontrado"
                                                var="ender">
                                                <p:column headerText="Endereço(s)">
                                                    <h:outputText escape="false"
                                                                  value="&lt;b&gt;#{ender.tipoEndereco}&lt;/b&gt;, #{ender.logradouro}, #{ender.numero}, #{ender.localidade}, #{ender.uf}"/>
                                                </p:column>
                                            </p:dataTable>
                                        </p:rowExpansion>
                                        <p:column headerText="Operações">
                                            <p:commandButton icon="ui-icon-pencil"
                                                             title="clique para alterar este compromissário"
                                                             id="editarPropriedade"
                                                             process="@this"
                                                             styleClass="botao-transparente"
                                                             disabled="#{cadastroImobiliarioControlador.operacaoEditar}"
                                                             actionListener="#{cadastroImobiliarioControlador.editarPropriedade(c)}"
                                                             update=":formulario:tabView:tabViewProprietarios:painelProprietarios"/>
                                            <p:commandButton icon="ui-icon-trash"
                                                             update=":formulario:tabView:tabViewProprietarios:painelProprietarios"
                                                             process="@this"
                                                             disabled="#{cadastroImobiliarioControlador.operacaoEditar}"
                                                             title="#{cadastroImobiliarioControlador.operacaoEditar ? 'Não foi possível remover um proprietário editando um Cadastro Imobiliário' : ''}"
                                                             actionListener="#{cadastroImobiliarioControlador.removeProprietario(c)}"
                                                             tabindex="-1" styleClass="botao-transparente"/>
                                        </p:column>
                                        <f:facet name="footer">
                                            <h:outputText value="Proporção Total:"/>
                                            <p:spacer width="2px"/>
                                            <h:outputText value="#{cadastroImobiliarioControlador.somaProporcoes}%"
                                                          style="color:#{cadastroImobiliarioControlador.somaProporcoes eq 100.00 ? 'seagreen':'tomato'}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </f:facet>
                                    </p:dataTable>
                                </p:panel>
                            </p:tab>
                            <p:tab id="tabHistoricoProprietarios" title="Proprietário(s) Anterior(es)"
                                   rendered="#{cadastroImobiliarioControlador.operacaoEditar}">
                                <p:dataTable id="historicoProprietariosTable"
                                             value="#{cadastroImobiliarioControlador.selecionado.propriedadeHistorico}"
                                             emptyMessage="Nenhum proprietário anterior"
                                             var="c">
                                    <p:column headerText="Proprietário">
                                        <h:outputText value="#{c.pessoa.nome}"
                                                      title="Clique para ver os detalhes do proprietário"/>
                                    </p:column>
                                    <p:column headerText="Proporção (%)">
                                        <h:outputText value="#{c.proporcao}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Tipo de Proprietário">
                                        <h:outputText value="#{c.tipoProprietario.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Início de Vigência">
                                        <h:outputText value="#{c.inicioVigencia}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Final de Vigência">
                                        <h:outputText value="#{c.finalVigencia}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <f:facet name="footer">
                                        <h:outputText value="Proporção Total:"/>
                                        <p:spacer width="2px"/>
                                        <h:outputText value="#{cadastroImobiliarioControlador.somaProporcoes}%"
                                                      style="color:#{cadastroImobiliarioControlador.somaProporcoes eq 100 ? 'seagreen':'tomato'}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>
                                    </f:facet>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                    </p:tab>
                    <p:tab id="tabProprietarioCartorio" title="Proprietário(s) no Cartório">
                        <p:panel id="painelProprietariosCartorio">
                            <div style="text-align: center;">
                                <p:commandButton value="Novo Proprietário"
                                                 icon="ui-icon-circle-plus"
                                                 style="height: 30px"
                                                 update="painelProprietariosCartorio"
                                                 rendered="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada eq null}"
                                                 actionListener="#{cadastroImobiliarioControlador.novaPropriedadeCartorio()}"/>
                            </div>
                            <h:panelGrid columns="2"
                                         rendered="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada ne null}">
                                <fc:outputLabelObrigatorio value="Proprietário: "/>
                                <fc:novoAutocompletePessoa id="proprietario"
                                                           value="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada.pessoa}"
                                                           caminhoAtual="#{cadastroImobiliarioControlador.urlAtual}"
                                                           situacoesPossiveis="#{cadastroImobiliarioControlador.situacoesPesquisaPessoa}"
                                                           permiteAlterarSituacoes="false"/>

                                <fc:outputLabelObrigatorio value="Proporção (%): "/>
                                <p:inputText title="Digite o percentual da proporção"
                                             value="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada.proporcao}"
                                             id="proporcaoCartorio" size="4" maxlength="7">
                                    <f:convertNumber pattern="#,##0.00"/>
                                </p:inputText>

                                <fc:outputLabelObrigatorio value="Tipo de Proprietário: "/>
                                <h:selectOneMenu title="Selecione o tipo de proprietário"
                                                 value="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada.tipoProprietario}"
                                                 id="tipoProprietarioCartorio">
                                    <f:selectItems value="#{cadastroImobiliarioControlador.tipoProprietarios}"/>
                                </h:selectOneMenu>

                                <fc:outputLabelObrigatorio value="Início da Vigência: "/>
                                <p:calendar
                                    value="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada.inicioVigencia}"
                                    navigator="true"
                                    pattern="dd/MM/yyyy" showOn="button" onkeyup="mascara(this, mdata);"
                                    id="inicioVigenciaProprietarioCartorio"/>

                                <h:outputText value="Final da Vigência: "/>
                                <p:calendar
                                    value="#{cadastroImobiliarioControlador.propriedadeCartorioSelecionada.finalVigencia}"
                                    navigator="true"
                                    pattern="dd/MM/yyyy" showOn="button" onkeyup="mascara(this, mdata);"
                                    id="finalVigenciaProprietarioCartorio"/>

                                <p:commandButton value="Adicionar"
                                                 icon="ui-icon-plus"
                                                 update="painelProprietariosCartorio"
                                                 actionListener="#{cadastroImobiliarioControlador.novoProprietarioCartorio()}"/>

                                <p:commandButton value="Cancelar"
                                                 icon="ui-icon-close"
                                                 update="painelProprietariosCartorio"
                                                 actionListener="#{cadastroImobiliarioControlador.setPropriedadeCartorioSelecionada(null)}"/>
                            </h:panelGrid>

                            <br/>
                            <p:dataTable id="proprietarioCartorioTabela"
                                         emptyMessage="Nenhum registro encontrado"
                                         value="#{cadastroImobiliarioControlador.propriedadesCartorio}"
                                         var="pc">
                                <p:column headerText="Expandir">
                                    <p:rowToggler/>
                                </p:column>
                                <p:column headerText="Proprietário">
                                    <h:outputText value="#{pc.pessoa.nome}"
                                                  title="Clique para ver os detalhes do proprietário"/>
                                </p:column>
                                <p:column headerText="CPF/CNPJ">
                                    <h:outputText value="#{pc.pessoa.cpf_Cnpj}"
                                                  title="Clique para ver os detalhes do proprietário"/>
                                </p:column>
                                <p:column headerText="Proporção (%)">
                                    <h:outputText value="#{pc.proporcao}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Tipo de Proprietário">
                                    <h:outputText value="#{pc.tipoProprietario.descricao}"/>
                                </p:column>
                                <p:column headerText="Início da Vigência">
                                    <h:outputText value="#{pc.inicioVigencia}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Final da Vigência">
                                    <h:outputText value="#{pc.finalVigencia}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Operação">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="clique para alterar este compromissário"
                                                     id="editarPropriedadeCartorio"
                                                     process="@this"
                                                     styleClass="botao-transparente"
                                                     actionListener="#{cadastroImobiliarioControlador.editarPropriedadeCartorio(pc)}"
                                                     update=":formulario:tabView:painelProprietariosCartorio"/>
                                    <p:commandButton icon="ui-icon-trash"
                                                     title="clique para alterar este compromissário"
                                                     id="removerPropriedadeCartorio"
                                                     styleClass="botao-transparente"
                                                     actionListener="#{cadastroImobiliarioControlador.removeProprietarioCartorio(pc)}"
                                                     update=":formulario:tabView:painelProprietariosCartorio"/>
                                </p:column>
                                <p:rowExpansion>
                                    <p:dataTable
                                        value="#{cadastroImobiliarioControlador.enderecosPropriedade(c.pessoa)}"
                                        emptyMessage="Nenhum registro encontrado"
                                        var="ender">
                                        <p:column headerText="Endereço(s)">
                                            <h:outputText escape="false"
                                                          value="&lt;b&gt;#{ender.tipoEndereco}&lt;/b&gt;, #{ender.logradouro}, #{ender.numero}, #{ender.localidade}, #{ender.uf}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:rowExpansion>
                                <f:facet name="footer">
                                    <h:outputText value="Proporção Total:"/>
                                    <p:spacer width="2px"/>
                                    <h:outputText value="#{cadastroImobiliarioControlador.somaProporcoesCartorio}%"
                                                  style="color:#{cadastroImobiliarioControlador.somaProporcoesCartorio eq 100.00 ? 'seagreen':'tomato'}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </h:outputText>
                                </f:facet>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab id="tabCompromissarios" title="Compromissários">
                        <p:panel id="panelComp">
                            <div style="text-align: center;">
                                <p:commandButton value="Novo Compromissário"
                                                 icon="ui-icon-circle-plus"
                                                 style="height: 30px"
                                                 rendered="#{cadastroImobiliarioControlador.compromissarioSelecionado eq null}"
                                                 actionListener="#{cadastroImobiliarioControlador.novoCompromissario()}"
                                                 update="panelComp"/>
                            </div>
                            <h:panelGrid columns="2"
                                         rendered="#{cadastroImobiliarioControlador.compromissarioSelecionado ne null}">
                                <fc:outputLabelObrigatorio value="Compromissario: "/>
                                <fc:novoAutocompletePessoa id="compromi"
                                                           value="#{cadastroImobiliarioControlador.compromissarioSelecionado.compromissario}"
                                                           caminhoAtual="#{cadastroImobiliarioControlador.urlAtual}"
                                                           situacoesPossiveis="#{cadastroImobiliarioControlador.situacoesPesquisaPessoa}"
                                                           permiteAlterarSituacoes="false"/>

                                <fc:outputLabelObrigatorio value="Proporção:"/>
                                <p:inputText
                                    value="#{cadastroImobiliarioControlador.compromissarioSelecionado.proporcao}"
                                    converter="porcentagemConverter"/>

                                <fc:outputLabelObrigatorio value="Início de Vigência:"/>
                                <p:calendar
                                    value="#{cadastroImobiliarioControlador.compromissarioSelecionado.inicioVigencia}"
                                    pattern="dd/MM/yyyy" showOn="button" size="10"
                                    onkeyup="mascara(this, mdata);"/>

                                <h:outputLabel value="Fim de Vigência:"/>
                                <p:calendar
                                    value="#{cadastroImobiliarioControlador.compromissarioSelecionado.fimVigencia}"
                                    pattern="dd/MM/yyyy" showOn="button" size="10"
                                    onkeyup="mascara(this, mdata);"/>

                                <p:commandButton value="Adicionar" icon="ui-icon-plus"
                                                 update="panelComp"
                                                 actionListener="#{cadastroImobiliarioControlador.adicionarCompromissario()}"/>
                                <p:commandButton value="Cancelar" icon="ui-icon-close"
                                                 update="panelComp"
                                                 actionListener="#{cadastroImobiliarioControlador.setCompromissarioSelecionado(null)}"/>

                            </h:panelGrid>

                            <br/>
                            <p:dataTable value="#{cadastroImobiliarioControlador.selecionado.listaCompromissarios}"
                                         id="tabelaCompromissario"
                                         var="compromissario"
                                         emptyMessage="Nenhum compromissário encontrado.">
                                <p:column headerText="Compromissário" style="text-align: left">
                                    <h:outputText value="#{compromissario.compromissario}"/>
                                </p:column>
                                <p:column headerText="Proporção" style="text-align: center">
                                    <h:outputText value="#{compromissario.proporcao}" converter="porcentagemConverter"/>
                                </p:column>
                                <p:column headerText="Início de Vigência" style="text-align: center">
                                    <h:outputText value="#{compromissario.inicioVigencia}"
                                                  converter="javax.faces.DateTime"/>
                                </p:column>
                                <p:column headerText="Fim de Vigência" style="text-align: center">
                                    <h:outputText value="#{compromissario.fimVigencia}"
                                                  converter="javax.faces.DateTime"/>
                                </p:column>
                                <p:column headerText="Operações" style="text-align: center">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="clique para alterar este compromissário"
                                                     id="editarCompromissario"
                                                     process="@this"
                                                     styleClass="botao-transparente"
                                                     actionListener="#{cadastroImobiliarioControlador.editarCompromissario(compromissario)}"
                                                     update=":formulario:tabView:panelComp"/>
                                    <p:commandButton icon="ui-icon-trash"
                                                     title="clique para alterar este compromissário"
                                                     id="removerCompromissario"
                                                     styleClass="botao-transparente"
                                                     actionListener="#{cadastroImobiliarioControlador.removerCompromissario(compromissario)}"
                                                     update="tabelaCompromissario"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab id="tabConstrucoes" title="Construções">
                        <p:panel id="painelConstrucao">
                            <center>
                                <p:commandButton value="Nova Construção"
                                                 icon="ui-icon-circle-plus"
                                                 style="height: 30px"
                                                 rendered="#{!cadastroImobiliarioControlador.operacaoEditar}"
                                                 oncomplete="dialogoConstrucao.show()"
                                                 actionListener="#{cadastroImobiliarioControlador.novaConstrucao()}"
                                                 update=":formConstrucao"/>
                            </center>
                            <p:outputPanel id="pConstrucoes"><br/>
                                <p:dataTable id="construcaoTabela"
                                             value="#{cadastroImobiliarioControlador.selecionado.construcoesAtivas}"
                                             var="c"
                                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}"
                                             rowIndexVar="rowIx"
                                             emptyMessage="Nenhuma construção adicionada">
                                    <p:column headerText="Expandir">
                                        <p:rowToggler/>
                                    </p:column>
                                    <p:column headerText="Código">
                                        <h:outputText value="#{c.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição">
                                        <h:outputText value="#{c.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Data da Construção">
                                        <h:outputText value="#{c.anoConstrucao}" style="text-align: center">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Área (m²)" style="text-align: right">

                                        <h:outputText value="#{c.areaConstruida}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>

                                        <f:facet name="footer">
                                            <h:outputText value="Total (m²): "/>
                                            <h:outputText
                                                id="areaTotal"
                                                value="#{cadastroImobiliarioControlador.somaAreas}">
                                                <f:convertNumber pattern="#,##0.00"/>
                                            </h:outputText>
                                        </f:facet>
                                    </p:column>
                                    <p:column headerText="Englobado">
                                        <h:outputText
                                            value="#{c.englobado != null? c.englobado.descricao: 'Não Englobado'}"/>
                                    </p:column>
                                    <p:column headerText="Nº de Pavimentos" style="text-align: right">
                                        <h:outputText value="#{c.quantidadePavimentos}"/>
                                    </p:column>
                                    <p:column headerText="Valores">
                                        <h:dataTable var="evento" value="#{c.eventos}" style="border:0 !important;">
                                            <h:column>
                                                <h:outputText value="#{evento.eventoCalculo.eventoCalculo.descricao}:"/>
                                            </h:column>
                                            <h:column>
                                                <h:outputText value="#{evento.valorFormatado}"
                                                              styleClass="azulnegrito"/>
                                            </h:column>
                                        </h:dataTable>
                                    </p:column>
                                    <p:column headerText="Operações" style="text-align: center"
                                              rendered="#{!cadastroImobiliarioControlador.operacaoEditar}">
                                        <p:commandButton icon="ui-icon-pencil"
                                                         title="clique para alterar esta construção"
                                                         id="alterarConstrucao"
                                                         styleClass="botao-transparente"
                                                         oncomplete="dialogoConstrucao.show()"
                                                         update=":formConstrucao">
                                            <f:setPropertyActionListener value="#{c}"
                                                                         target="#{cadastroImobiliarioControlador.construcaoSelecionada}"/>
                                        </p:commandButton>
                                        <p:spacer width="5"/>
                                        <p:commandButton icon="ui-icon-closethick"
                                                         title="clique para excluir esta construção"
                                                         update=":formulario:tabView:painelConstrucao"
                                                         process="@this"
                                                         styleClass="botao-transparente"
                                                         actionListener="#{cadastroImobiliarioControlador.removeConstrucao(c)}"
                                                         tabindex="-1">
                                        </p:commandButton>
                                        <p:spacer width="5"/>
                                    </p:column>
                                    <p:rowExpansion>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <h:panelGrid columns="2">
                                                    <h:outputText value="Nº do Habite-se: "/>
                                                    <h:outputText value="#{c.habitese}" id="habitese"/>

                                                    <h:outputText value="Data do Habite-se: "/>
                                                    <h:outputText value="#{c.dataHabitese}" id="dataHabitese">
                                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                    </h:outputText>

                                                    <h:outputText value="Nº do Documento: "/>
                                                    <h:outputText value="#{c.numeroProtocolo}" id="numeroProtocolo"/>

                                                    <h:outputText value="Tipo de Documento: "/>
                                                    <h:outputText value="#{c.tipoProtocolo}" id="tipoProtocolo"/>

                                                    <h:outputText value="Data do Documento: "/>
                                                    <h:outputText value="#{c.dataProtocolo}" id="dataProtocolo">
                                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                    </h:outputText>

                                                    <h:outputText value="Folha do Documento: "/>
                                                    <h:outputText value="#{c.folhaDocumento}" id="folhaDocumento"/>

                                                    <h:outputText value="Livro do Documento: "/>
                                                    <h:outputText value="#{c.livroDocumento}" id="livroDocumento"/>

                                                    <h:outputText value="Nº do Alvará: "/>
                                                    <h:outputText value="#{c.numeroAlvara}"
                                                                  id="numeroAlvaraConstrucao"/>

                                                    <h:outputText value="Data do Alvará:"/>
                                                    <h:outputText value="#{c.dataAlvara}" id="dataAlvara">
                                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                    </h:outputText>

                                                </h:panelGrid>
                                            </div>
                                            <div class="col-md-6">
                                                <p:panel id="panelAtributosConstrucao"
                                                         header="Atributos da Construção ${c.descricao}">
                                                    <fc:vizualizaAtributosGenericos atributos="#{c.atributos}"
                                                                                    classe="${sistemaControlador.classeConstrucao}"/>
                                                </p:panel>
                                            </div>
                                        </div>
                                    </p:rowExpansion>
                                </p:dataTable>
                            </p:outputPanel>
                            <br/>
                        </p:panel>
                    </p:tab>
                    <p:tab id="tabInscricao" title="Inscrições Anteriores">
                        <p:dataTable id="inscricaoAnteriores"
                                     value="#{cadastroImobiliarioControlador.selecionado.inscricoesAnterioes}"
                                     emptyMessage="Nenhum registro encontrado"
                                     var="inscricao">
                            <p:column headerText="Inscrição Anterior">
                                <h:outputText value="#{inscricao.inscricaoAnterior}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab id="tabIsencao" title="Isenções">
                        <p:dataTable value="#{cadastroImobiliarioControlador.selecionado.isencoes}"
                                     style="text-align: center;"
                                     var="isencao"
                                     emptyMessage="Nenhuma isenção foi adicionada a este Cadastro Imobiliário">
                            <f:facet name="header">
                                <h:outputText value="Isenções"/>
                            </f:facet>
                            <p:column headerText="Sequência">
                                <h:outputText value="  ${isencao.sequencia}"/>
                            </p:column>
                            <p:column headerText="Início de Vigência">
                                <h:outputText value="${isencao.inicioVigencia}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Final de Vigência">
                                <h:outputText value="${isencao.finalVigencia}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Tipo de Lançamento">
                                <h:outputText value="${isencao.tipoLancamentoIsencao.descricao}"/>
                            </p:column>
                            <p:column headerText="Situação">
                                <h:outputText value="${isencao.situacao.descricao}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab id="tabMatricula" title="Matrícula">
                        <p:selectOneRadio id="options"
                                          value="#{cadastroImobiliarioControlador.selecionado.tipoMatricula}">
                            <f:selectItem itemLabel="1-Averbação da Escritura"
                                          itemValue="#{cadastroImobiliarioControlador.tipoDeAverbacao}"/>
                            <f:selectItem itemLabel="2-Título Definitivo de Posse"
                                          itemValue="#{cadastroImobiliarioControlador.tipoDePosse}"/>
                            <p:ajax update="panelMatricula" process="@this" event="change"
                                    listener="#{cadastroImobiliarioControlador.atribuiTipoDeMatricula}"/>
                        </p:selectOneRadio>
                        <h:panelGrid columns="2" id="panelMatricula"
                                     rendered="#{cadastroImobiliarioControlador.renderizaPanelMatricula}">
                            <h:outputText value="Cartório: "/>
                            <h:selectOneMenu title="Selecione um cartório"
                                             value="#{cadastroImobiliarioControlador.selecionado.cartorio}"
                                             id="cartorio"
                                             converter="#{cadastroImobiliarioControlador.converterCartorio}">
                                <f:selectItems value="#{cadastroImobiliarioControlador.cartorio}"/>
                            </h:selectOneMenu>
                            <h:outputText value="Número da Matrícula: "
                                          rendered="#{cadastroImobiliarioControlador.renderizaAverbacao}"/>
                            <p:inputText title="Digite o número da Matrícula do Cadastro Imobiliário"
                                         rendered="#{cadastroImobiliarioControlador.renderizaAverbacao}"
                                         value="#{cadastroImobiliarioControlador.selecionado.matriculaRegistro}"
                                         id="matriculaRegistro" maxlength="10" size="10"/>
                            <h:outputText value="Número do Título: "
                                          rendered="#{cadastroImobiliarioControlador.renderizaAverbacao eq false}"/>
                            <p:inputText title="Digite o Número do Título do Cadastro Imobiliário"
                                         rendered="#{cadastroImobiliarioControlador.renderizaAverbacao eq false}"
                                         value="#{cadastroImobiliarioControlador.selecionado.numeroDoTitulo}"
                                         id="matriculaTitulo" maxlength="3" size="10"/>

                            <h:outputText value="Número do Livro: "/>
                            <p:inputText title="Informe o Número do Livro de Registro do Cadastro Imobiliário"
                                         value="#{cadastroImobiliarioControlador.selecionado.livroRegistro}"
                                         id="livroRegistro" maxlength="3" size="10"/>
                            <h:outputText value="Número da Folha de Registro: "/>
                            <p:inputText title="Informe o Número da Folha de Registro do Cadastro Imobiliário"
                                         value="#{cadastroImobiliarioControlador.selecionado.folhaRegistro}"
                                         maxlength="3" size="10"
                                         id="folhaRegistro"/>
                            <h:outputText value="Data do Registro"
                                          rendered="#{cadastroImobiliarioControlador.renderizaAverbacao}"/>
                            <p:calendar value="#{cadastroImobiliarioControlador.selecionado.dataRegistro}"
                                        pattern="dd/MM/yyyy" showOn="button" size="10"
                                        rendered="#{cadastroImobiliarioControlador.renderizaAverbacao}"
                                        onkeyup="mascara(this, mdata);"/>
                            <h:outputText value="Data do Título"
                                          rendered="#{cadastroImobiliarioControlador.renderizaAverbacao eq false}"/>
                            <p:calendar value="#{cadastroImobiliarioControlador.selecionado.dataTitulo}"
                                        rendered="#{cadastroImobiliarioControlador.renderizaAverbacao eq false}"
                                        pattern="dd/MM/yyyy" showOn="button" size="10"
                                        onkeyup="mascara(this, mdata);"/>

                            <h:outputText value="Lei: "/>
                            <p:autoComplete queryDelay="1000" id="lei"
                                            size="50"
                                            maxResults="10"
                                            completeMethod="#{cadastroImobiliarioControlador.completaAtoLegalIsencao}"
                                            value="#{cadastroImobiliarioControlador.selecionado.atoLegalIsencao}"
                                            itemValue="#{ato}"
                                            converter="#{cadastroImobiliarioControlador.converterAtoLegalIsencao}"
                                            itemLabel="#{ato.nome}"
                                            var="ato"
                            />
                            <h:outputText value="Processo / Protocolo: "/>
                            <p:autoComplete queryDelay="1000" id="processo"
                                            size="50"
                                            maxResults="10"
                                            title="Digite o numero ou ano do Processo!"
                                            completeMethod="#{cadastroImobiliarioControlador.completaProcessos}"
                                            value="#{cadastroImobiliarioControlador.selecionado.processo}"
                                            itemValue="#{pro}"
                                            converter="#{cadastroImobiliarioControlador.converterProcesso}"
                                            itemLabel="#{pro.numero} - #{pro.ano} - #{pro.assunto} - #{pro.pessoa}"
                                            var="pro"

                            />
                        </h:panelGrid>
                    </p:tab>

                    <p:tab id="tabArquivos" title="Arquivos">
                        <fc:filesUploadWP selecionado="#{cadastroImobiliarioControlador.selecionado}"/>
                    </p:tab>
                </p:tabView>
                <br/>
                <h:panelGrid columns="3">
                    <h:outputText value="Observações: "/>
                    <p:inputTextarea title="Digite as observações"
                                     value="#{cadastroImobiliarioControlador.selecionado.observacoes.conteudo}"
                                     id="observacoes" cols="80"
                    />
                </h:panelGrid>
            </p:panel>
            <br/>
            <p:outputPanel rendered="#{cadastroImobiliarioControlador.imovelPenhorado}"
                           style="text-align: center !important">
                <div
                    class="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error':'ui-messages-warn'} ui-corner-all textomedio">
                    <div
                        class="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-icon':'ui-messages-warn-icon'} margem-direita-cinco-pixels"/>
                    <h:outputText value="Atenção! "
                                  styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-summary': 'ui-messages-warn-summary'}"/>
                    <h:outputText
                        value="Este imóvel encontra-se penhorado #{cadastroImobiliarioControlador.imovelBloqueado ? 'e bloqueado. Não é permitido alteração ou exclusão.':''}"
                        styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/>
                    <br/><h:outputText
                    value="Processo nº. #{cadastroImobiliarioControlador.ultimaPenhora.numeroProcesso}, em data de #{cadastroImobiliarioControlador.ultimaPenhora.dataPenhora}, pelo Autor #{cadastroImobiliarioControlador.ultimaPenhora.autor.nome}."
                    styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/><br/>
                    <h:outputText
                        value="#{cadastroImobiliarioControlador.ultimaPenhora.bloqueio? 'Com':'Sem'} Bloqueio."
                        styleClass="#{cadastroImobiliarioControlador.imovelBloqueado? 'ui-messages-error-detail': 'ui-messages-warn-detail'}"/>
                </div>
            </p:outputPanel>
            <fc:rodapePretty controlador="#{cadastroImobiliarioControlador}"
                             desabilitaSalvar="#{cadastroImobiliarioControlador.imovelBloqueado}"/>
        </h:form>

        <p:dialog widgetVar="dlgHistorico" modal="true" header="Histórico de modificações" width="1000"
                  resizable="false">
            <h:form id="formDlgHistorico">
                <h:outputText
                    value="Para salvar o registro é necessário que seja inserido algumas informações adicionais."
                    style="font-size: small; color: orange"/>

                <h:panelGrid columns="2">
                    <h:outputText value="Digitador: "/>
                    <p:inputText id="inputDigitador"
                                 value="#{cadastroImobiliarioControlador.historico.digitador.pessoaFisica.nome}"
                                 styleClass="campo-bloqueado" readonly="true"
                                 size="50"/>

                    <h:outputText value="Data de registro: "/>
                    <p:inputText value="#{cadastroImobiliarioControlador.historico.dataRegistro}"
                                 readonly="true"
                                 styleClass="campo-bloqueado"
                                 id="calDataRegistro">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </p:inputText>

                    <h:outputText value="Solicitante: "/>
                    <p:inputText id="inputSolicitante"
                                 value="#{cadastroImobiliarioControlador.historico.solicitante}"
                                 size="50"/>

                    <h:outputText value="Data de solicitação: "/>
                    <p:calendar value="#{cadastroImobiliarioControlador.historico.dataSolicitacao}"
                                id="calDataSolicitacao" pattern="dd/MM/yyyy" navigator="true">
                    </p:calendar>

                    <h:outputText value="Motivo: "/>
                    <p:inputTextarea id="inputMotivo"
                                     value="#{cadastroImobiliarioControlador.historico.motivo}"
                                     autoResize="false"
                                     rows="3" cols="50"/>

                </h:panelGrid>
                <p:panel style="text-align: left">
                    <p:commandButton id="cbConfirmar" value="Confirmar"
                                     actionListener="#{cadastroImobiliarioControlador.salvarHistorico}"
                                     oncomplete="aguarde.hide()"
                                     onclick="aguarde.show()"
                                     styleClass="operacao"
                                     icon="ui-icon-check" update=":formDlgHistorico"/>
                    <p:commandButton id="cbCancelar" value="Cancelar" icon="ui-icon-cancel"
                                     styleClass="operacao"
                                     onclick="dlgHistorico.hide()"/>
                </p:panel>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dialogoConstrucao" modal="true"
                  resizable="false"
                  header="Construção"
                  closable="false"
                  style="width: 70%!important;height: 80%!important;">
            <h:form id="formConstrucao">
                <div style="overflow-y: auto; height: 400px!important;">
                    <h:panelGrid columns="2" id="gridConstrucao1">
                        <fc:outputLabelObrigatorio value="Descrição: "/>
                        <p:inputText title="Digite a Descrição da Construção"
                                     value="#{cadastroImobiliarioControlador.construcaoSelecionada.descricao}"
                                     id="descricaoConstrucao" size="70" maxlength="70"/>

                        <fc:outputLabelObrigatorio value="Código: "/>
                        <p:inputText title="Digite o Código da Construção"
                                     value="#{cadastroImobiliarioControlador.construcaoSelecionada.codigo}"
                                     id="codigoConstrucao" size="10" maxlength="5"/>
                        <fc:outputLabelObrigatorio value="Data da Construção: "/>
                        <p:calendar title="Digite o data da Construção" showOn="button" onkeyup="mascara(this, mdata);"
                                    value="#{cadastroImobiliarioControlador.construcaoSelecionada.anoConstrucao}"
                                    id="anodaConstrucao" size="12" maxlength="10" pattern="dd/MM/yyyy"/>
                        <fc:outputLabelObrigatorio value="Área Construída (m²): "/>
                        <p:inputText title="Digite a área Construída"
                                     value="#{cadastroImobiliarioControlador.construcaoSelecionada.areaConstruida}"
                                     id="areaConstruida" size="20" maxlength="20">
                            <f:convertNumber pattern="###,##0.0000"/>
                        </p:inputText>
                        <h:outputText value="Englobado em: "/>
                        <h:selectOneMenu title="Selecione a construção principal"
                                         value="#{cadastroImobiliarioControlador.construcaoSelecionada.englobado}"
                                         id="englobado"
                                         converter="#{cadastroImobiliarioControlador.converterEnglobado}">
                            <f:selectItems value="#{cadastroImobiliarioControlador.construcoesDesteImovel}"/>
                            <p:ajax event="change" process="@this"/>
                        </h:selectOneMenu>
                        <h:outputText value="N° de Pavimentos:"/>
                        <p:inputText
                            value="#{cadastroImobiliarioControlador.construcaoSelecionada.quantidadePavimentos}"
                            id="numeroPavimentacoes"/>
                        <h:outputText value="Nº do Habite-se:"/>
                        <p:inputText value="#{cadastroImobiliarioControlador.construcaoSelecionada.habitese}"
                                     id="numeroHabitese"/>
                        <h:outputText value="Data do Habite-se:"/>
                        <p:calendar pattern="dd/MM/yyyy"
                                    value="#{cadastroImobiliarioControlador.construcaoSelecionada.dataHabitese}"
                                    id="dataHabitese1" showOn="button" onkeyup="mascara(this, mdata);"/>
                        <h:outputText value="Nº do Protocolo:"/>
                        <p:inputText value="#{cadastroImobiliarioControlador.construcaoSelecionada.numeroProtocolo}"
                                     id="numeroProtocolo1"/>
                        <h:outputText value="Data do Protocolo:"/>
                        <p:calendar pattern="dd/MM/yyyy"
                                    value="#{cadastroImobiliarioControlador.construcaoSelecionada.dataProtocolo}"
                                    id="dataProtocolo1" showOn="button" onkeyup="mascara(this, mdata);"/>
                        <h:outputText value="Nº do Alvará:"/>
                        <p:inputText value="#{cadastroImobiliarioControlador.construcaoSelecionada.numeroAlvara}"
                                     id="numeroAlvara"/>
                        <h:outputText value="Data do Alvará:"/>
                        <p:calendar pattern="dd/MM/yyyy"
                                    value="#{cadastroImobiliarioControlador.construcaoSelecionada.dataAlvara}"
                                    id="dataAlvara1" showOn="button" onkeyup="mascara(this, mdata);"/>
                    </h:panelGrid>
                    <br/>
                    <p:panel id="panelAtributosConstrucao1">
                        <fc:atributosGenericos
                            atributos="#{cadastroImobiliarioControlador.construcaoSelecionada.atributos}"
                            classe="${sistemaControlador.classeConstrucao}"/>
                    </p:panel>
                </div>
                <center>
                    <br/>
                    <p:separator/>
                    <p:commandButton value="Gravar"
                                     style="height: 30px;"
                                     icon="ui-icon-arrowthickstop-1-s"
                                     update=":formulario:tabView:pConstrucoes"
                                     actionListener="#{cadastroImobiliarioControlador.gravaConstrucao()}">
                    </p:commandButton>
                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-cancel"
                                     style="height: 30px;"
                                     actionListener="#{cadastroImobiliarioControlador.setConstrucaoSelecionada(null)}"
                                     update=":formulario:tabView:pConstrucoes"
                                     onclick="dialogoConstrucao.hide()"
                    >
                    </p:commandButton>
                    <br/>
                </center>

            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
