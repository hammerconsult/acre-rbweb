<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui">
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <p:panel header="Cadastro Econômico - C.M.C.">
                <p:panel header="Dados da Pessoa">
                    <h:panelGrid columns="2" styleClass="verticalAlignTop">
                        <h:outputText value="Pessoa: "/>
                        <fc:novoAutocompletePessoa value="#{cadastroEconomicoControlador.selecionado.pessoa}"
                                                   id="pessoa" permiteAlterarSituacoes="false"
                                                   caminhoAtual="#{cadastroEconomicoControlador.urlAtual}"
                                                   listenerNavegacao="#{cadastroEconomicoControlador.poeNaSessao()}"
                                                   listenerItemSelect="#{cadastroEconomicoControlador.atualizarDadosPessoa()}"
                                                   situacoesPossiveis="#{cadastroEconomicoControlador.situacoesPesquisaPessoa}"/>
                    </h:panelGrid>
                    <br/>
                    <p:panel id="panelDadosPessoa" visible="#{cadastroEconomicoControlador.selecionado.pessoa != null}">
                        <p:outputPanel id="panelDadosPessoaJuridica"
                                       rendered="#{cadastroEconomicoControlador.juridica eq true}">
                            <table>
                                <tr>
                                    <td>
                                        <h:outputLabel value="CNPJ" styleClass="negrito"/><br/>
                                        <p:inputText value="#{cadastroEconomicoControlador.selecionado.pessoa.cpf_Cnpj}"
                                                     readonly="true"
                                                     size="20"/>
                                    </td>
                                    <td>
                                        <h:outputLabel value="Razão Social" styleClass="negrito"/><br/>
                                        <p:inputText value="#{cadastroEconomicoControlador.selecionado.pessoa.nome}"
                                                     readonly="true"
                                                     size="90"/>
                                    </td>
                                    <td>
                                        <h:outputLabel value="Nome Reduzido" styleClass="negrito"/><br/>
                                        <p:inputText value="#{cadastroEconomicoControlador.pessoaJuridica.nomeReduzido}"
                                                     readonly="true"
                                                     size="50"/>
                                    </td>
                                </tr>
                            </table>
                            <table>
                                <tr>
                                    <td>
                                        <h:outputLabel value="Nome Fantasia" styleClass="negrito"/><br/>
                                        <p:inputText value="#{cadastroEconomicoControlador.pessoaJuridica.nomeFantasia}"
                                                     readonly="true"
                                                     size="50"/>
                                    </td>
                                    <td>
                                        <h:outputLabel value="Inscrição Estadual" styleClass="negrito"/><br/>
                                        <p:inputText
                                                value="#{cadastroEconomicoControlador.pessoaJuridica.inscricaoEstadual}"
                                                readonly="true" size="20"/>
                                    </td>
                                </tr>
                            </table>
                        </p:outputPanel>
                        <br/>
                        <fc:naturezaJuridicaTipoAutonomo
                                naturezaJuridica="#{cadastroEconomicoControlador.selecionado.naturezaJuridica}"
                                pessoa="#{cadastroEconomicoControlador.selecionado.pessoa}"
                                tipoAutonomo="#{cadastroEconomicoControlador.selecionado.tipoAutonomo}"
                                somenteAutonomo="false"
                                listener="#{cadastroEconomicoControlador.atualizarPainelAutonomo}"/>
                        <p:panel id="panelAutonomo" style="border: none;"
                                 visible="#{cadastroEconomicoControlador.habilitaPanelTipoAutonomo eq true}">
                            <h:panelGrid columns="3">
                                <h:outputText value="Nova Placa: "
                                              rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}"/>
                                <h:panelGroup>
                                    <p:inputMask id="placa" value="#{cadastroEconomicoControlador.placa.placa}"
                                                 onblur="this.value = this.value.toUpperCase();" mask="SSS-9999"
                                                 rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}"/>
                                    <p:spacer width="5"/>
                                    <p:commandButton icon="ui-icon-arrowthick-1-s"
                                                     actionListener="#{cadastroEconomicoControlador.adicionarPlaca()}"
                                                     update="listaPlacas msgPlaca"
                                                     rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}"/>
                                </h:panelGroup>
                                <p:spacer/>

                                <h:outputText value="Placas: "
                                              rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}"/>

                                <h:panelGroup id="listaPlacas"
                                              rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}">
                                    <ui:repeat value="#{cadastroEconomicoControlador.selecionado.placas}" var="placa">
                                        <h:outputText value="#{placa.placa}" styleClass="azulnegrito"/>
                                        <p:spacer width="5"/>
                                        <p:commandButton styleClass="botao-transparente" icon="ui-icon-trash"
                                                         actionListener="#{cadastroEconomicoControlador.removerPlaca(placa)}"
                                                         update=":Formulario:listaPlacas"
                                                         rendered="#{cadastroEconomicoControlador.selecionado.tipoAutonomo != null and cadastroEconomicoControlador.selecionado.tipoAutonomo.necessitaPlacas eq true}"/>
                                        <br/>
                                    </ui:repeat>
                                </h:panelGroup>
                            </h:panelGrid>
                        </p:panel>
                        <p:tabView>
                            <p:tab title="Telefone(s)">
                                <p:dataTable var="telefone"
                                             emptyMessage="Nenhum registro encontrado"
                                             id="tabelaTelefones" value="#{cadastroEconomicoControlador.telefones}">
                                    <f:facet name="header">
                                        <h:outputText value="Telefone(s) da Pessoa"/>
                                    </f:facet>
                                    <p:column headerText="Telefone">
                                        <h:outputText value="#{telefone.telefone}"/>
                                    </p:column>
                                    <p:column headerText="Tipo">
                                        <h:outputText value="#{telefone.tipoFone}"/>
                                    </p:column>

                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                    </p:panel>
                </p:panel>

                <br/>

                    <p:tabView>
                        <p:tab title="Dados do Cadastro">
                            <p:panel>
                                <h:panelGrid columns="2">
                                    <h:panelGrid columns="2" id="panel">
                                        <fc:outputLabelObrigatorio value="Tipo de Contribuinte: "/>
                                        <h:selectOneMenu
                                                value="#{cadastroEconomicoControlador.selecionado.tipoContribuinte}"
                                                id="contribuinte">
                                            <f:selectItems value="#{cadastroEconomicoControlador.tipoContribuinte}"/>
                                        </h:selectOneMenu>

                                        <h:outputText value="Porte: "/>
                                        <h:selectOneMenu value="#{cadastroEconomicoControlador.selecionado.porte}">
                                            <f:selectItems value="#{cadastroEconomicoControlador.tipoPorte}"/>
                                        </h:selectOneMenu>

                                        <h:outputText value="Data de Cadastro na Prefeitura: "/>
                                        <p:calendar navigator="true"
                                                    value="#{cadastroEconomicoControlador.selecionado.dataCadastro}"
                                                    pattern="dd/MM/yyyy" id="dataCadastro" showOn="button"
                                                    onkeyup="mascara(this, mdata)"/>

                                        <h:outputText value="Data de Abertura: "/>
                                        <p:calendar pattern="dd/MM/yyyy"
                                                    value="#{cadastroEconomicoControlador.selecionado.abertura}"
                                                    id="Abertura"
                                                    title="Selecione a Data de Abertura"
                                                    disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}">
                                        </p:calendar>

                                        <fc:outputLabelObrigatorio value="Classificação da Atividade: "/>
                                        <h:selectOneMenu title="Selecione a Classificação da Atividade"
                                                         value="#{cadastroEconomicoControlador.selecionado.classificacaoAtividade}"
                                                         id="classificacaoatividade">
                                            <f:selectItems
                                                    value="#{cadastroEconomicoControlador.classificacaoAtividade}"/>
                                        </h:selectOneMenu>

                                        <h:outputLabel for="areaPublicidade" value="Área de Publicidade (m²): "/>
                                        <p:inputText id="areaPublicidade"
                                                     value="#{cadastroEconomicoControlador.selecionado.areaPublicidade}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </p:inputText>

                                        <fc:outputLabelObrigatorio value="Área de Utilização (m²): "/>
                                        <p:inputText id="areaUtilizacao"
                                                     value="#{cadastroEconomicoControlador.selecionado.areaUtilizacao}">
                                            <f:convertNumber pattern="###,##0.00"/>
                                        </p:inputText>

                                        <h:outputLabel for="dataAlvaraLoc" value="Data do Alvará de Localização : "/>
                                        <p:inputText id="dataAlvaraLoc"
                                                     value="#{cadastroEconomicoControlador.selecionado.dataAlvaraLocalizacao}"
                                                     disabled="true"/>

                                        <h:outputLabel for="dataAlvaraFun" value="Data do Alvará de Funcionamento: "/>
                                        <p:inputText id="dataAlvaraFun"
                                                     value="#{cadastroEconomicoControlador.selecionado.dataAlvaraFuncionamento}"
                                                     disabled="true"/>

                                        <h:outputLabel for="mei" value="MEI - Microempreendedor Individual: "/>
                                        <h:selectBooleanCheckbox id="mei"
                                                                 value="#{cadastroEconomicoControlador.selecionado.mei}"/>
                                    </h:panelGrid>
                                </h:panelGrid>

                                <br/>
                                <h:panelGrid columns="1" width="100%">
                                    <h:outputText value="Observações: "/>
                                    <p:inputTextarea title="Digite as observações"
                                                     value="#{cadastroEconomicoControlador.selecionado.observacoes}"
                                                     id="observacoes"
                                                     style="width: 100%" rows="4" autoResize="false"
                                                     onblur="document.getElementById('Formulario:avancar').focus()"
                                                     maxlength="500"/>
                                </h:panelGrid>
                            </p:panel>
                        </p:tab>
                        <p:tab title="Sócios">
                            <p:panel id="panelsocios">
                                <h:panelGrid columns="2" styleClass="verticalAlignTop">
                                    <h:outputText value="Sócio: "/>
                                    <fc:novoAutocompletePessoa juridica="false"
                                                               value="#{cadastroEconomicoControlador.socio.socio}"
                                                               caminhoAtual="#{cadastroEconomicoControlador.urlAtual}"
                                                               listenerNavegacao="#{cadastroEconomicoControlador.poeNaSessao()}"
                                                               situacoesPossiveis="#{cadastroEconomicoControlador.situacoesPesquisaPessoa}"
                                                               permiteAlterarSituacoes="false"
                                                               id="socio"/>
                                    <h:outputLabel for="proporcao" value="Proporção (%): "/>
                                    <p:inputText id="proporcao" size="10"
                                                 value="#{cadastroEconomicoControlador.socio.proporcao}">
                                        <f:convertNumber pattern="#,##0.00"/>
                                    </p:inputText>

                                    <h:outputLabel for="iniciosocio" value="Data Inicial: "/>
                                    <p:calendar pattern="dd/MM/yyyy" id="iniciosocio" navigator="true"
                                                value="#{cadastroEconomicoControlador.socio.dataInicio}"/>

                                </h:panelGrid>
                                <p:commandButton value="Gravar" icon="ui-icon-circle-arrow-s" id="btNovoSocio"
                                                 actionListener="#{cadastroEconomicoControlador.adicionarSocios}"
                                                 update="panelsocios"/>
                                <br/>
                                <p:dataTable var="socio" id="tabelasocios" emptyMessage="Nenhum registro encontrado"
                                             value="#{cadastroEconomicoControlador.selecionado.sociedadeCadastroEconomico}">

                                    <f:facet name="header">
                                        <h:outputText value="Sócios"/>
                                    </f:facet>

                                    <p:column headerText="Sócio">
                                        <h:outputText value="#{socio.socio}"/>
                                    </p:column>
                                    <p:column headerText="Proporção (%)">
                                        <h:outputText value="#{socio.proporcao}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputText>

                                    </p:column>
                                    <p:column headerText="Data Inicial">
                                        <h:outputText value="#{socio.dataInicio}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>

                                    <p:column headerText="Data Final">
                                        <p:cellEditor>
                                            <f:facet name="output">
                                                <h:outputText value="#{socio.dataFim}">
                                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                                </h:outputText>
                                            </f:facet>
                                            <f:facet name="input">
                                                <p:calendar navigator="true" pattern="dd/MM/yyyy"
                                                            value="#{socio.dataFim}" style="width:100%">
                                                    <p:ajax event="dateSelect" update="tabelasocios"/>
                                                    <p:ajax event="blur" update="tabelasocios"/>
                                                </p:calendar>
                                            </f:facet>
                                        </p:cellEditor>
                                        <p:rowEditor rendered="#{socio.dataFim eq null? true:false}"/>
                                    </p:column>
                                    <p:column headerText="Ações">

                                        <p:commandButton icon="ui-icon-trash"
                                                         title="Pressione este botão para remover o registro"
                                                         actionListener="#{cadastroEconomicoControlador.removerSocios(socio)}"
                                                         update="tabelasocios"/>
                                    </p:column>

                                    <f:facet name="footer">
                                        <h:outputText value="Proporção Total:"/>
                                        <h:outputText value="#{cadastroEconomicoControlador.totalSocios}%"
                                                      style="color:#{cadastroEconomicoControlador.totalSocios eq 100 ? 'seagreen':'tomato'}"/>
                                    </f:facet>
                                </p:dataTable>

                            </p:panel>
                        </p:tab>
                        <p:tab id="tabCaracFunc" title="Características de Funcionamento">
                            <p:panel id="caracFunc">
                                <h:panelGrid columns="2">
                                    <h:outputText value="Característica de Funcionamento: "/>
                                    <h:selectOneMenu id="caracFunci"
                                                     value="#{cadastroEconomicoControlador.bcecf.caracFuncionamento}"
                                                     title="Informe a característica de funcionamento"
                                                     converter="#{cadastroEconomicoControlador.converterCaracteristica}">
                                        <f:selectItems value="#{cadastroEconomicoControlador.caracteristicas}"/>
                                    </h:selectOneMenu>

                                    <h:outputText value="Quantidade: "/>
                                    <p:inputText id="quantidade"
                                                 value="#{cadastroEconomicoControlador.bcecf.quantidade}"
                                                 style="text-align: right" size="8"/>

                                    <h:outputText value="Forma de Pagamento"/>
                                    <h:selectOneMenu value="#{cadastroEconomicoControlador.bcecf.formaPagamento}">
                                        <f:selectItems value="#{cadastroEconomicoControlador.tipoPagamento}"/>
                                    </h:selectOneMenu>

                                    <p:commandButton icon="ui-icon-circle-plus" value="Adicionar"
                                                     title="clique para adicionar o registro"
                                                     update="caracFunc"
                                                     actionListener="#{cadastroEconomicoControlador.adiconaCarcteristica}"/>
                                </h:panelGrid>
                                <p:dataTable id="caracFunciTabela"
                                             value="#{cadastroEconomicoControlador.selecionado.listaBCECaracFuncionamento}"
                                             var="car"
                                             emptyMessage="Nenhuma característica de funcionamento adicionada.">
                                    <f:facet name="header">
                                        <h:outputText value="Características de Funcionamento"/>
                                    </f:facet>
                                    <p:column headerText="Código">
                                        <h:outputText value="#{car.caracFuncionamento.codigo}"/>
                                    </p:column>
                                    <p:column headerText="Descrição">
                                        <h:outputText value="#{car.caracFuncionamento.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Descrição Curta">
                                        <h:outputText value="#{car.caracFuncionamento.descricaoCurta}"/>
                                    </p:column>
                                    <p:column headerText="Tipo">
                                        <h:outputText value="#{car.caracFuncionamento.tipo.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Quantidade" style="text-align: right">
                                        <h:outputText value="#{car.quantidade}"/>
                                    </p:column>
                                    <p:column headerText="Forma de Pagamento" style="text-align: right">
                                        <h:outputText value="#{car.formaPagamento.descricao}"/>
                                    </p:column>
                                    <p:column headerText="Operação" style="text-align: center">
                                        <p:commandButton icon="ui-icon-trash"
                                                         title="Pressione este botão para remover o registro"
                                                         update="caracFunciTabela"
                                                         actionListener="#{cadastroEconomicoControlador.removeCaracteristica(car)}"/>
                                    </p:column>
                                </p:dataTable>

                            </p:panel>
                        </p:tab>
                    </p:tabView>
                    <br/>
                    <p:panel header="Situação Cadastral" id="panelsituacao">
                        <h:panelGrid columns="2" id="gridsituacao">
                            <h:outputText value="Situação Cadastral: "/>
                            <h:selectOneMenu title="Digite a Situação Cadastral do C.M.C."
                                             disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}"
                                             value="#{cadastroEconomicoControlador.situacaoCadastroEconomico.situacaoCadastral}"
                                             id="situacaoCadastral">
                                <f:selectItems value="#{cadastroEconomicoControlador.situacaoCadastral}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Data: "/>
                            <p:calendar pattern="dd/MM/yyyy" navigator="true"
                                        disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}"
                                        title="Digite a data da alteraçao"
                                        id="datasituacao"
                                        value="#{cadastroEconomicoControlador.situacaoCadastroEconomico.dataAlteracao}"/>
                        </h:panelGrid>
                        <p:commandButton id="botaoGravarOficio" value="Gravar" icon="ui-icon-circle-arrow-s"
                                         update=":Formulario:panelsituacao"
                                         disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}"
                                         action="#{cadastroEconomicoControlador.adicionarSituacaoCadastroEconomico}"/>
                        <br/>
                        <p:tabView>
                            <p:tab title="Situação Atual">
                                <p:dataTable var="sit"
                                             id="tabelasituacaoAtual"
                                             value="#{cadastroEconomicoControlador.ultimaSiuacao}"
                                             emptyMessage="Nenhum registro encontrado">
                                    <p:column headerText="Situação Cadastral">
                                        <h:outputText value="#{sit.situacaoCadastral}"/>
                                    </p:column>

                                    <p:column headerText="Data da Última Situação">
                                        <h:outputText value="#{sit.dataAlteracao}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Ações">
                                        <p:commandButton id="botaoRemoverSituacao" icon="ui-icon-trash"
                                                         title="Pressione este botão para remover o registro"
                                                         actionListener="#{cadastroEconomicoControlador.removerSituacaoCadastroEconomico(sit)}"
                                                         update="tabelasituacaoAtual"
                                                         disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Histórico de Situações">
                                <p:dataTable var="sit" id="tabelasituacoes"
                                             emptyMessage="Nenhum registro encontrado"
                                             value="#{cadastroEconomicoControlador.selecionado.situacaoCadastroEconomico}">
                                    <p:column headerText="Situação Cadastral">
                                        <h:outputText value="#{sit.situacaoCadastral}"/>
                                    </p:column>

                                    <p:column headerText="Data">
                                        <h:outputText value="#{sit.dataAlteracao}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Ações">
                                        <p:commandButton id="botaoRemoverSituacaoHistorico" icon="ui-icon-trash"
                                                         title="Pressione este botão para remover o registro"
                                                         actionListener="#{cadastroEconomicoControlador.removerSituacaoCadastroEconomico(sit)}"
                                                         update="tabelasituacoes"
                                                         disabled="#{!cadastroEconomicoControlador.cadastroDeOficio}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                        </p:tabView>
                    </p:panel>
                    <br/>
            </p:panel>
            <br/>
            <p:commandButton title="Clique para Salvar" id="salvar" value="Salvar"
                             actionListener="#{cadastroEconomicoControlador.salvar}"
                             styleClass="operacao prioritario" icon="ui-icon-disk"/>
            <p:commandButton title="Clique para Cancelar" id="cancelar"
                             actionListener="#{cadastroEconomicoControlador.cancelar}" value="Cancelar" ajax="false"
                             immediate="true"
                             styleClass="operacao" icon="ui-icon-cancel"/>
            <p:dialog modal="true" widgetVar="statusDialog" header="Carregando ...."
                      draggable="false" closable="false" resizable="true">
                <p:graphicImage value="/img/ajaxloadingbar.gif"/>
            </p:dialog>
        </h:form>
        <p:dialog widgetVar="dialogServico" modal="true" id="dialogServicoDlg" width="1000"
                  header="Pesquisa de Seviços">
            <h:form id="formularioDialogServico">
                <p:panel id="panelTabelaServico">
                    <p:fieldset legend="Filtros">
                        <h:panelGrid columns="5">
                            <h:outputLabel value="Código" for="servico_codigo"/>
                            <p:inputText id="servico_codigo"
                                         value="#{cadastroEconomicoControlador.servicoFiltro.codigo}"/>
                            <h:outputLabel value="Nome" for="servico_nome"/>
                            <p:inputText id="servico_nome" value="#{cadastroEconomicoControlador.servicoFiltro.nome}"
                                         size="70"/>
                            <p:commandButton value="Filtrar"
                                             actionListener="#{cadastroEconomicoControlador.filtrarServicos}"
                                             update="tabelaID"/>
                        </h:panelGrid>
                    </p:fieldset>
                    <br/>
                    <p:dataTable id="tabelaID" var="objeto"
                                 value="#{cadastroEconomicoControlador.listaServicos}"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,50,100"
                                 widgetVar="tabela">
                        <p:column headerText="Adicionar" style="width: 10%; text-align: center;">
                            <p:commandButton icon="ui-icon-circle-plus" title="Clique para adicionar"
                                             update="@form, :Formulario"
                                             oncomplete="dialogServico.hide()"
                                             actionListener="#{cadastroEconomicoControlador.adicionarServico(objeto)}"/>
                        </p:column>
                        <p:column headerText="Código" style="width: 10%">
                            <h:outputText value="#{objeto.codigo}"/>
                        </p:column>
                        <p:column headerText="Descrição">
                            <h:outputText value="#{objeto.nome}"/>
                        </p:column>
                    </p:dataTable>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dialogoHorarioFuncionamento" header="Horários de Funcionamento" modal="true"
                  id="dialogoHorarioFuncionamentoDlg" width="1000">
            <h:form id="formHorarioFuncionamento">
                <p:panel id="panelTabelaServico">
                    <p:dataTable id="tabela" var="objeto"
                                 value="#{cadastroEconomicoControlador.horarios}"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,50,100"
                                 widgetVar="tabela">
                        <f:facet name="header">
                            <p:outputPanel>
                                <h:outputText value="Busca: "/>
                                <h:inputText id="globalFilter" onkeyup="tabela.filter()" size="70"/>
                            </p:outputPanel>
                        </f:facet>
                        <p:column style="width: 5%">
                            <p:rowToggler/>
                        </p:column>
                        <p:column headerText="Visualizar" style="width: 15%; text-align: center;">
                            <p:commandButton icon="ui-icon-circle-plus" styleClass="botao-transparente"
                                             value="Adicionar"
                                             oncomplete="dialogoHorarioFuncionamento.hide()" update=":Formulario"
                                             actionListener="#{cadastroEconomicoControlador.selecionarHorario(objeto)}"/>
                        </p:column>
                        <p:column headerText="Código" sortBy="#{objeto.codigo}" filterBy="#{objeto.codigo}"
                                  style="width: 20%">
                            <h:outputText value="#{objeto.codigo}"/>
                        </p:column>
                        <p:column headerText="Descrição" sortBy="#{objeto.descricao}" filterBy="#{objeto.descricao}">
                            <h:outputText value="#{objeto.descricao}"/>
                        </p:column>

                        <p:rowExpansion>
                            <p:dataTable id="tabela" value="#{objeto.itens}" var="item"
                                         emptyMessage="Nenhum item adicionado">
                                <p:column headerText="Dia">
                                    <h:outputText value="#{item.dia.descricao}"/>
                                </p:column>
                                <p:column headerText="Entrada">
                                    <h:outputText value="#{item.horarioEntrada}">
                                        <f:convertDateTime pattern="HH:mm"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Saída">
                                    <h:outputText value="#{item.horarioSaida}">
                                        <f:convertDateTime pattern="HH:mm"/>
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>
                        </p:rowExpansion>
                    </p:dataTable>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dlgHistoricoE" id="dialogHistoricoE" modal="true" header="Histórico de Modificações"
                  width="1000"
                  resizable="false">
            <h:form id="formDlgHistorico">
                <h:outputText
                        value="Para salvar o registro é necessário que sejam inseridas algumas informações adicionais."
                        style="font-size: small; color: orange"/>

                <h:panelGrid columns="2">
                    <h:outputText value="Digitador: "/>
                    <p:inputText id="inputDigitador"
                                 value="#{cadastroEconomicoControlador.historico.digitador.pessoaFisica.nome}"
                                 styleClass="campo-bloqueado" readonly="true"
                                 required="true" requiredMessage="É obrigatório o nome do(a) digitador(a)." size="50"/>

                    <h:outputText value="Data de Registro: "/>
                    <p:inputText value="#{cadastroEconomicoControlador.historico.dataRegistro}" readonly="true"
                                 styleClass="campo-bloqueado"
                                 id="calDataRegistro">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </p:inputText>

                    <h:outputText value="Solicitante: "/>
                    <p:inputText id="inputSolicitante" value="#{cadastroEconomicoControlador.historico.solicitante}"
                                 required="true" requiredMessage="É obrigatório o nome do(a) solicitante. " size="50"/>

                    <h:outputText value="Data de Solicitação: "/>
                    <p:calendar value="#{cadastroEconomicoControlador.historico.dataSolicitacao}" navigator="true"
                                pattern="dd/MM/yyyy"
                                id="calDataSolicitacao"
                                required="true"
                                requiredMessage="É obrigatório a data de solicitação."/>

                    <h:outputText value="Motivo: "/>
                    <p:inputTextarea id="inputMotivo" value="#{cadastroEconomicoControlador.historico.motivo}"
                                     autoResize="false"
                                     required="true"
                                     requiredMessage="É obrigatório que seja informado o motivo pelo qual foi solicitado."
                                     rows="3" cols="50"/>
                </h:panelGrid>
                <p:panel style="text-align: left">
                    <p:commandButton id="cbConfirmar" value="Confirmar"
                                     action="#{cadastroEconomicoControlador.salvarHistorico}"
                                     icon="ui-icon-check" update="@form" ajax="false"
                                     styleClass="operacao prioritario"/>
                    <p:commandButton id="cbCancelar" value="Cancelar" onclick="dlgHistorico.hide()"
                                     styleClass="operacao"
                                     icon="ui-icon-cancel"/>
                </p:panel>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dlgHistoricoSucesso" modal="true" header="Sucesso" width="350" resizable="false">
            <h:form id="formSucesso">
                <h:outputText value="Cadastro realizado com sucesso!"/>
                <p:commandButton id="cbOk" value="Ok" onclick="dlgHistoricoSucesso.hide()"/>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="dlgHistoricoFracasso" modal="true" header="Sucesso" width="350" resizable="false">
            <h:form id="formFracasso">
                <h:outputText value="O cadastro realizado não pôde ser concluído!"/>
                <p:commandButton id="cbOk" value="Ok" onclick="dlgHistoricoFracasso.hide()"/>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
