<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
>
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <link rel="stylesheet"
              href="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/lib/codemirror.css"/>
        <script type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/lib/codemirror.js"/>
        <script type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/lib/util/simple-hint.js"/>
        <link rel="stylesheet"
              href="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/lib/util/simple-hint.css"/>
        <script type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/lib/util/javascript-hint.js"/>
        <script type="text/javascript"
                src="#{facesContext.externalContext.requestContextPath}/resources/js/code_edit/mode/javascript/javascript.js"/>
        <style type="text/css">
            .CodeMirror-scroll {
                height: 50%
            }
        </style>

        <p:messages id="msgs" showDetail="true"/>
        <h:form id="Formulario">


            <script type="text/javascript">

                function insertAtCursor(myField, myValue) {
                    //IE support
                    if (document.selection) {
                        myField.focus();
                        sel = document.selection.createRange();
                        sel.text = myValue;
                    }
                    //MOZILLA/NETSCAPE support
                    else if (myField.selectionStart || myField.selectionStart == '0') {
                        var startPos = myField.selectionStart;
                        var endPos = myField.selectionEnd;
                        myField.value = myField.value.substring(0, startPos)
                            + myValue
                            + myField.value.substring(endPos, myField.value.length);
                    } else {
                        myField.value += myValue;
                    }
                    myField.focus();
                }

            </script>
            <div align="right" class="mbot05">
                <p:button href="../../duplicar/#{eventoFPControlador.urlKeyValue}/"
                          value="Duplicar"
                          id="btDuplicar"
                          styleClass="operacao"
                          rendered="#{eventoFPControlador.selecionado.id ne null}"
                          icon="ui-icon-copy"
                          title="Clique para inserir um novo registro"
                          disabled="#{!autorizacao.isPodeEditar(request)}"/>

                <p:button href="../../novo/"
                          value="Novo"
                          id="btNovo"
                          styleClass="operacao"
                          icon="ui-icon-circle-plus"
                          title="Clique para inserir um novo registro"
                          disabled="#{!autorizacao.isPodeEditar(request)}"/>
            </div>
            <p:panel header="Cadastro de EventoFP">
                <h:panelGrid columns="3">
                    <fc:outputLabelObrigatorio value="Código:"/>
                    <p:inputText title="Digite o Código"
                                 value="#{eventoFPControlador.selecionado.codigo}"
                                 id="codigo" maxlength="70"/>
                    <p:message for="codigo" showDetail="true"/>


                    <fc:outputLabelObrigatorio value="Descrição:"/>
                    <p:inputText title="Digite a descrição do Evento FP"
                                 value="#{eventoFPControlador.selecionado.descricao}"
                                 id="descricao" maxlength="70" size="50"/>
                    <p:message for="descricao" showDetail="true"/>
                    <h:outputText value="Descrição Reduzida:"/>
                    <p:inputText value="#{eventoFPControlador.selecionado.descricaoReduzida}"
                                 size="25"
                                 id="descre"
                                 maxlength="23">
                    </p:inputText>
                    <p:message for="descre" showDetail="true"/>

                    <fc:outputLabelObrigatorio value="Tipo de Evento:"/>
                    <h:selectOneMenu id="tipoEventoFP" value="#{eventoFPControlador.selecionado.tipoEventoFP}">
                        <f:selectItems value="#{eventoFPControlador.tipoEventos}"/>
                        <p:ajax update=":Formulario:tab-view-geral:parametrosRelatorio :Formulario:tab-view-geral:configuracoesGerais :Formulario:tab-view-geral:exibirNaFichaRPA"
                                onstart="aguarde.show()"
                                oncomplete="aguarde.hide()"
                                process="@this"/>
                    </h:selectOneMenu>
                    <p:message for="tipoEventoFP" showDetail="true"/>

                    <!--                        <p:commandButton value="Testar Funções" actionListener="{eventoFPControlador.}" update="painelGridTeste"  />-->
                </h:panelGrid>
                <h:panelGrid rendered="false" style="width: 100%" columns="3" id="painelGridTeste">
                    <p:inplace label="Testar Funçoes" style="color: #3399FE" effect="slide">


                        <p:panel>
                            <h:outputText value="VinculoFP:"/>
                            <p:autoComplete queryDelay="1000" rendered="false" value="#{eventoFPControlador.vinculoFP}"
                                            completeMethod="#{eventoFPControlador.completeVinculosFP}"
                                            converter="#{eventoFPControlador.converterVinculoFPs}"
                                            var="v"
                                            itemLabel="#{v.descricao}"
                                            itemValue="#{v.id}"
                                            size="70"
                                            forceSelection="true"/><br/>
                            <p:commandButton value="Testar" actionListener="#{eventoFPControlador.testar}"
                                             update="regraTeste referenciaTeste formulaTeste formulaValorIntegralTeste referenciaTeste valorBaseDeCalculoTeste :msgs"/><!--falta o update-->
                            <br/>
                            <h:outputText value="REGRA:"/><h:outputText id="regraTeste"
                                                                        value="#{eventoFPControlador.resultadoSimulacao.resultadoRegra.valor}"
                                                                        style="color: #3399FE"/><br/>
                            <h:outputText value="FÓRMULA: "/><h:outputText id="formulaTeste"
                                                                           value="#{eventoFPControlador.resultadoSimulacao.resultadoFormula.valor}"
                                                                           style="color: #3399FE"/><br/>
                            <h:outputText value="VALOR INTEGRAL: "/> <h:outputText id="formulaValorIntegralTeste"
                                                                                   value="#{eventoFPControlador.resultadoSimulacao.resultadoValorIntegral.valor}"
                                                                                   style="color: #3399FE"/><br/>
                            <h:outputText value="REFERÊNCIA: "/><h:outputText id="referenciaTeste"
                                                                              value="#{eventoFPControlador.resultadoSimulacao.resultadoReferencia.valor}"
                                                                              style="color: #3399FE"/><br/>
                            <h:outputText value="VALOR BASE DE CÁLCULO: "/><h:outputText id="valorBaseDeCalculoTeste"
                                                                                         value="#{eventoFPControlador.resultadoSimulacao.resultadoValorBaseDeCalculo.valor}"
                                                                                         style="color: #3399FE"/><br/>
                        </p:panel>
                    </p:inplace>
                </h:panelGrid>

                <table>
                    <tr>
                        <td style="width: 20%">
                            <h:outputText value="Funções Folha: "/>
                            <p:inputText size="50"
                                         value="#{eventoFPControlador.filtrosFuncoesFolha.parteFuncaoRegra}">
                                <p:ajax event="keyup"
                                        update="Formulario:listaMetodosRegra"
                                        process="@this"
                                        listener="#{eventoFPControlador.atualizarListaFiltradaMetodosRegra()}"/>
                            </p:inputText>
                        </td>
                        <td style="width: 1%"></td>
                        <td style="width: 20%"><h:outputText value="Regra: "/></td>
                        <td style="width: 9%"></td>
                    </tr>
                    <tr>
                        <td>
                            <c:set var="sizeMetodosRegra" value="#{fn:length(eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosRegra())}" />
                            <h:selectOneListbox id="listaMetodosRegra"
                                                size="#{sizeMetodosRegra gt 1 ? sizeMetodosRegra : 2}"
                                                value="#{eventoFPControlador.metodoRegraSelecionado}"
                                                style="height: 110px;width: 100%">
                                <f:selectItems value="#{eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosRegra()}"/>
                            </h:selectOneListbox>

                        </td>
                        <td>
                            <button id="adicionaRegra"
                                    type="button"
                                    onclick="insertAtCursor(document.getElementById('Formulario:regra'), document.getElementById('Formulario:listaMetodosRegra').value + ' ')">->
                            </button>

                        </td>
                        <td>
                            <p:inputTextarea title="Digite a Regra"
                                             value="#{eventoFPControlador.selecionado.regra}"
                                             id="regra"
                                             style="height:100px;width: 100%">
                            </p:inputTextarea>
                        </td>
                        <td>
                            <p:message for="regra" showDetail="true"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="Funções Folha: "/>
                            <p:inputText size="50"
                                         value="#{eventoFPControlador.filtrosFuncoesFolha.parteFuncaoFormula}">
                                <p:ajax event="keyup"
                                        update="Formulario:listaMetodosFormula"
                                        process="@this"
                                        listener="#{eventoFPControlador.atualizarListaFiltradaMetodosFormula()}"/>
                            </p:inputText>
                        </td>
                        <td></td>
                        <td><h:outputText value="Fórmula: "/></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <c:set var="sizeMetodosFormula" value="#{fn:length(eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosFormula())}" />
                            <h:selectOneListbox id="listaMetodosFormula"
                                                size="#{sizeMetodosFormula gt 1 ? sizeMetodosFormula : 2}"
                                                value="#{eventoFPControlador.metodoFormulaSelecionado}"
                                                style="height: 110px;width: 100%">
                                <f:selectItems value="#{eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosFormula()}"/>
                            </h:selectOneListbox>
                        </td>
                        <td>
                            <button id="adicionaFormula"
                                    type="button"
                                    onclick="insertAtCursor(document.getElementById('Formulario:formula'), document.getElementById('Formulario:listaMetodosFormula').value + ' ')">->
                            </button>
                        </td>
                        <td>
                            <p:inputTextarea title="Digite a Fórmula"
                                             value="#{eventoFPControlador.selecionado.formula}"
                                             id="formula"
                                             style="height:100px;width: 100%">
                            </p:inputTextarea>
                        </td>
                        <td>
                            <p:message for="formula" showDetail="true"/>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <h:outputText value="Funções Folha: "/>
                            <p:inputText size="50"
                                         value="#{eventoFPControlador.filtrosFuncoesFolha.parteFuncaoFormulaValorIntegral}">
                                <p:ajax event="keyup"
                                        update="Formulario:listaMetodosFormulaValorIntegral"
                                        process="@this"
                                        listener="#{eventoFPControlador.atualizarListaFiltradaMetodosFormulaValorIntegral()}"/>
                            </p:inputText>
                        </td>
                        <td></td>
                        <td>
                            <h:outputText value="Fórmula Valor Integral: "/>
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <c:set var="sizeMetodosFormulaValorIntegral" value="#{fn:length(eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosFormulaValorIntegral())}" />
                            <h:selectOneListbox id="listaMetodosFormulaValorIntegral"
                                                size="#{sizeMetodosFormulaValorIntegral gt 1 ? sizeMetodosFormulaValorIntegral : 2}"
                                                value="#{eventoFPControlador.metodoFormulaValorIntegralSelecionado}"
                                                style="height: 110px;width: 100%">
                                <f:selectItems value="#{eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosFormulaValorIntegral()}"/>
                            </h:selectOneListbox>
                        </td>
                        <td>
                            <button id="adicionaFormulaValorIntegral"
                                    type="button"
                                    onclick="insertAtCursor(document.getElementById('Formulario:formulaValorIntegral'), document.getElementById('Formulario:listaMetodosFormulaValorIntegral').value + ' ')">->
                            </button>
                        </td>
                        <td>
                            <p:inputTextarea title="Digite a Fórumla Valor Integral"
                                             value="#{eventoFPControlador.selecionado.formulaValorIntegral}"
                                             id="formulaValorIntegral"
                                             style="height:100px;width: 100%">
                            </p:inputTextarea>
                        </td>
                        <td>
                            <p:message for="formulaValorIntegral" showDetail="true"/>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <h:outputText value="Funções Folha: "/>
                            <p:inputText size="50"
                                         value="#{eventoFPControlador.filtrosFuncoesFolha.parteFuncaoReferencia}">
                                <p:ajax event="keyup"
                                        update="Formulario:listaMetodosReferencia"
                                        process="@this"
                                        listener="#{eventoFPControlador.atualizarListaFiltradaMetodosReferencia()}"/>
                            </p:inputText>
                        </td>
                        <td></td>
                        <td>
                            <h:outputText value="Referência: "/>
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <c:set var="sizeMetodosReferencia" value="#{fn:length(eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosReferencia())}" />
                            <h:selectOneListbox id="listaMetodosReferencia"
                                                size="#{sizeMetodosReferencia gt 1 ? sizeMetodosReferencia : 2}"
                                                value="#{eventoFPControlador.metodoReferenciaSelecionado}"
                                                style="height: 110px;width: 100%">
                                <f:selectItems value="#{eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosReferencia()}"/>
                            </h:selectOneListbox>
                        </td>
                        <td>
                            <button id="adicionaReferencia"
                                    type="button"
                                    onclick="insertAtCursor(document.getElementById('Formulario:referencia'), document.getElementById('Formulario:listaMetodosReferencia').value + ' ')">->
                            </button>
                        </td>
                        <td>
                            <p:inputTextarea title="Digite a Referência"
                                             value="#{eventoFPControlador.selecionado.referencia}"
                                             id="referencia"
                                             style="height:100px;width: 100%">
                            </p:inputTextarea>
                        </td>
                        <td>
                            <p:message for="referencia" showDetail="true"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h:outputText value="Funções Folha: "/>
                            <p:inputText size="50"
                                         value="#{eventoFPControlador.filtrosFuncoesFolha.parteFuncaoValorBaseCalculo}">
                                <p:ajax event="keyup"
                                        update="Formulario:listaMetodosValorBaseDeCalculo"
                                        process="@this"
                                        listener="#{eventoFPControlador.atualizarListaFiltradaMetodosValorBaseDeCalculo()}"/>
                            </p:inputText>
                        </td>
                        <td></td>
                        <td>
                            <h:outputText value="Valor da Base de Cálculo: "/>
                        </td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <c:set var="sizeMetodosValorBaseDeCalculo" value="#{fn:length(eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosValorBaseDeCalculo())}" />
                            <h:selectOneListbox id="listaMetodosValorBaseDeCalculo"
                                                size="#{sizeMetodosValorBaseDeCalculo gt 1 ? sizeMetodosValorBaseDeCalculo : 2}"
                                                value="#{eventoFPControlador.metodoValorBaseDeCalculoSelecionado}"
                                                style="height: 110px;width: 100%">
                                <f:selectItems value="#{eventoFPControlador.filtrosFuncoesFolha.getListaFiltradaMetodosValorBaseDeCalculo()}"/>
                            </h:selectOneListbox>
                        </td>
                        <td>
                            <button id="adicionaValorBaseDeCalculo"
                                    type="button"
                                    onclick="insertAtCursor(document.getElementById('Formulario:valorBaseDeCalculo'), document.getElementById('Formulario:listaMetodosValorBaseDeCalculo').value + ' ')">->
                            </button>
                        </td>
                        <td>
                            <p:inputTextarea title="Digite o Valor da Base de Cálculo"
                                             value="#{eventoFPControlador.selecionado.valorBaseDeCalculo}"
                                             id="valorBaseDeCalculo"
                                             style="height:100px;width: 100%">
                            </p:inputTextarea>
                        </td>
                        <td>
                            <p:message for="valorBaseDeCalculo" showDetail="true"/>
                        </td>
                    </tr>
                </table>
                <br/>

                <p:tabView id="tab-view-geral">
                    <p:tab title="Configurações Gerais">
                        <h:panelGrid columns="2" id="configuracoesGerais">
                            <h:outputText value="Tipo de Base:" rendered="false"/>
                            <h:selectOneMenu value="#{eventoFPControlador.selecionado.tipoBase}" id="tipoBase"
                                             rendered="false">
                                <f:selectItems value="#{eventoFPControlador.tipoBases}"/>
                            </h:selectOneMenu>


                            <h:outputText value="Tipo de Base FP:"/>
                            <p:autoComplete queryDelay="1000" id="tipoBaseFP"
                                            value="#{eventoFPControlador.selecionado.tipoBaseFP}"
                                            completeMethod="#{eventoFPControlador.completaTipoBaseFP}"
                                            converter="#{eventoFPControlador.converterTipoBaseFP}"
                                            var="t"
                                            itemLabel="#{t.descricao}"
                                            itemValue="#{t.id}"
                                            size="70"
                                            forceSelection="true"/>


                            <h:outputText value="Tipo Calculo 13º:"/>
                            <h:selectOneMenu value="#{eventoFPControlador.selecionado.tipoCalculo13}"
                                             id="tipoCalculo13">
                                <f:selectItems value="#{eventoFPControlador.tipoCalculo13}"/>
                                <p:ajax process="@this"
                                        listener="#{eventoFPControlador.desmarcarProporcionalizar13Salario}"
                                        update="proporcionalizarMesesTrabalhados13 calculaDezembro"/>
                            </h:selectOneMenu>

                            <h:outputText value="Ultimo Acumulado Somente em Dezembro:"/>
                            <h:selectBooleanCheckbox
                                disabled="#{eventoFPControlador.selecionado.tipoCalculo13 ne 'ULTIMO_ACUMULADO'}"
                                title="Marque se voce deseja que o sistema busque o valor da somente dezembro."
                                value="#{eventoFPControlador.selecionado.ultimoAcumuladoEmDezembro}"
                                id="calculaDezembro"/>

                            <h:outputText value="Propor. Meses Trab. no 13º:"/>
                            <h:selectBooleanCheckbox
                                disabled="#{eventoFPControlador.selecionado.tipoCalculo13 eq 'NAO'}"
                                title="Marque se voce deseja que o sistema propocionalize os meses trabalhados no ano por essa verba."
                                value="#{eventoFPControlador.selecionado.propMesesTrabalhados}"
                                id="proporcionalizarMesesTrabalhados13"/>


                            <h:outputText value="Ativo:"/>
                            <h:selectBooleanCheckbox title="Marque se o Evento FP está ativo"
                                                     value="#{eventoFPControlador.selecionado.ativo}"
                                                     id="ativo"/>

                            <h:outputText value="Verba Fixa:"/>
                            <h:selectBooleanCheckbox title="Marque se o Evento FP é verba fixa."
                                                     value="#{eventoFPControlador.selecionado.verbaFixa}"
                                                     id="verbafixa"/>

                            <h:outputText value="Automático:"/>
                            <h:selectBooleanCheckbox title="Marque o Evento FP é automático"
                                                     value="#{eventoFPControlador.selecionado.automatico}"
                                                     id="automatico"/>

                            <h:outputText value="Efetuar cálculo retroativo:"/>
                            <h:selectBooleanCheckbox title="Indique se o evento deve ser calculado retroativamente"
                                                     value="#{eventoFPControlador.selecionado.calculoRetroativo}"
                                                     id="calculoRetroativo"/>

                            <h:outputText value="Proporcionalizar Dias Trabalhados: "/>
                            <h:panelGroup>
                                <h:selectBooleanCheckbox
                                    title="Indique se o evento deve proporcionalizar seu valor pelos dias trabalhados."
                                    value="#{eventoFPControlador.selecionado.proporcionalizaDiasTrab}"
                                    id="proporcionalizaDiasTrab">
                                    <p:ajax process="@this"/>
                                </h:selectBooleanCheckbox>
                                <p:commandButton icon="ui-icon-info"
                                                 id="info-proporcionalizar-dias"
                                                 styleClass="mrig05"
                                                 process="@none"
                                                 update="@none"
                                                 style="width: 19px; height: 19px; margin-left: 5px!important; "/>

                                <p:overlayPanel at="right"
                                                for="info-proporcionalizar-dias"
                                                showEvent="mouseover"
                                                hideEvent="mouseout"
                                                dynamic="false"
                                                style="width: 500px;">
                                    <h:outputText
                                        value="Opção válida apenas para Lançamentos FP. Proporcionaliza o valor final calculado pelos dias trabalhados, tanto para lançamentos em Valor como em Referência. Atentar que, caso exista uma proporcionalização pelos dias trabalhados na fórmula, será aplicado o procedimento duas vezes. Não considera dias de gozo de férias ou licença prêmio."
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>

                            <h:outputText value="Verba de Remuneração Principal: "/>
                            <h:selectBooleanCheckbox
                                title="Indique se o evento é a remuneração principal."
                                disabled="#{eventoFPControlador.selecionado.tipoEventoFP ne 'VANTAGEM'}"
                                value="#{eventoFPControlador.selecionado.remuneracaoPrincipal}"
                                id="verbaRemuneracaoPrincipal"/>

                            <h:outputText value="Arredondar Valor: "/>
                            <h:selectBooleanCheckbox
                                title="Indique se o evento deve proporcionalizar seu valor pelos dias trabalhados."
                                value="#{eventoFPControlador.selecionado.arredondarValor}"
                                id="arredondarValor">
                                <p:ajax process="@this"/>
                            </h:selectBooleanCheckbox>

                            <h:outputText value="Controle por Cargo ou Lotação Funcional: "/>
                            <h:selectBooleanCheckbox value="#{eventoFPControlador.selecionado.controleCargoLotacao}"/>

                            <h:outputText value="Unidade de Referência:"/>
                            <p:inputText title="descreva o unidade de Referencia"
                                         value="#{eventoFPControlador.selecionado.unidadeReferencia}" size="70"
                                         id="unidadeReferencia"/>

                            <h:outputText rendered="false" value="Estorno Férias: "/>
                            <h:selectBooleanCheckbox rendered="false"
                                                     title="Indique se o evento pode ocorrer o estorno do valor no calculo retroativo."
                                                     value="#{eventoFPControlador.selecionado.estornoFerias}"
                                                     id="estornoFerias">
                                <p:ajax process="@this"/>
                            </h:selectBooleanCheckbox>


                            <h:outputText value="Não Permite Lançamento: "/>
                            <h:selectBooleanCheckbox title="Indique se o evento não pode ocorrer lançamento."
                                                     value="#{eventoFPControlador.selecionado.naoPermiteLancamento}"
                                                     id="naoPermiteLancamento">
                                <p:ajax process="@this" update="tipoLancamentoFP quantificacao" event="change"/>
                            </h:selectBooleanCheckbox>


                            <h:outputText value="Apuração de IR: "/>
                            <h:selectBooleanCheckbox
                                title="Indique se o evento tem apuração de IR (informação usada no e-social evento S-1200)"
                                value="#{eventoFPControlador.selecionado.apuracaoIR}"
                                id="apuracaoIR">
                                <p:ajax process="@this" event="change"/>
                            </h:selectBooleanCheckbox>

                            <fc:outputLabelObrigatorio  value="Tipo de Lançamento:"/>
                            <h:selectOneMenu title="Informe o Tipo de Lançamento"
                                             value="#{eventoFPControlador.selecionado.tipoLancamentoFP}"
                                             id="tipoLancamentoFP"
                                             disabled="#{eventoFPControlador.selecionado.naoPermiteLancamento}">
                                <f:selectItems value="#{eventoFPControlador.tipoLancamentoFP}"/>
                            </h:selectOneMenu>


                            <h:outputText value="Quantificação Padrão:"/>
                            <p:inputText title="Informe a quantificação Ex.: 5.450.682,553"
                                         value="#{eventoFPControlador.selecionado.quantificacao}"
                                         disabled="#{eventoFPControlador.selecionado.naoPermiteLancamento}"
                                         converter="#{eventoFPControlador.moneyConverter}"
                                         id="quantificacao" maxlength="20" size="20"/>

                            <h:outputText value="Valor Máximo Permitido em Lançamento FP:"/>
                            <p:inputText title="Valor máximo permitido por lançamento FP."
                                         value="#{eventoFPControlador.selecionado.valorMaximoLancamento}"
                                         disabled="#{eventoFPControlador.selecionado.naoPermiteLancamento}"
                                         converter="#{eventoFPControlador.moneyConverter}"
                                         id="valorMaximoLancamento" maxlength="19" size="20"/>


                            <h:outputLabel value="Para servidores em férias esse evento é: "/>
                            <h:panelGroup>
                                <h:selectOneMenu id="blocFerias"
                                                 value="#{eventoFPControlador.selecionado.bloqueioFerias}">
                                    <f:selectItems value="#{eventoFPControlador.bloqueioFerias}"/>
                                </h:selectOneMenu>
                                <p:commandButton icon="ui-icon-info"
                                                 id="info-servidores-ferias"
                                                 styleClass="mrig05"
                                                 process="@none"
                                                 update="@none"
                                                 style="width: 20px; height: 20px; margin-left: 5px!important; "/>

                                <p:overlayPanel at="right"
                                                for="info-servidores-ferias"
                                                appendToBody="true"
                                                showEvent="mouseover"
                                                hideEvent="mouseout"
                                                dynamic="false"
                                                style="width: 420px;">
                                    <h:outputText
                                        value="&lt;ul>
                                              &lt;li>
                                                &lt;b>Não Calculável: &lt;/b>Proporcionalizará o valor final calculado pelos dias trabalhados considerando, inclusive, os dias de gozo de férias.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Não Lançável: &lt;/b>O sistema não permitirá o Lançamento FP da verba.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Não Calculável/Não Lançável: &lt;/b>O sistema não permitirá o Lançamento FP da verba, mas caso já esteja lançada, proporcionalizará o valor final calculado pelos dias trabalhados considerando, inclusive, os dias de gozo de férias.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Sem Efeito: &lt;/b>Nenhum dos critérios anteriores é aplicado. O sistema adota os padrões normais de cálculo. Equivale a não escolher nenhuma opção para o campo.&lt;/b>
                                              &lt;/li>
                                      &lt;/ul>"
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>

                            <h:outputLabel value="Para servidores em Licença Prêmio esse evento é: "/>
                            <h:panelGroup>
                            <h:selectOneMenu id="blocLicenca" value="#{eventoFPControlador.selecionado.bloqueioLicencaPremio}">
                                <f:selectItems value="#{eventoFPControlador.bloqueioFerias}"/>
                            </h:selectOneMenu>
                                <p:commandButton icon="ui-icon-info"
                                                 id="info-servidores-licenca"
                                                 styleClass="mrig05"
                                                 process="@none"
                                                 update="@none"
                                                 style="width: 20px; height: 20px; margin-left: 5px!important; "/>

                                <p:overlayPanel at="right"
                                                for="info-servidores-licenca"
                                                appendToBody="true"
                                                showEvent="mouseover"
                                                hideEvent="mouseout"
                                                dynamic="false"
                                                style="width: 420px;">
                                    <h:outputText
                                        value="&lt;ul>
                                              &lt;li>
                                                &lt;b>Não Calculável: &lt;/b>Proporcionalizará o valor final calculado pelos dias trabalhados considerando, inclusive, os dias de gozo de licença prêmio.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Não Lançável: &lt;/b>O sistema não permitirá o Lançamento FP da verba.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Não Calculável/Não Lançável: &lt;/b>O sistema não permitirá o Lançamento FP da verba, mas caso já esteja lançada, proporcionalizará o valor final calculado pelos dias trabalhados considerando, inclusive, os dias de gozo de licença prêmio.&lt;/b>
                                              &lt;/li>
                                              &lt;li>
                                                &lt;b>Sem Efeito: &lt;/b>Nenhum dos critérios anteriores é aplicado. O sistema adota os padrões normais de cálculo. Equivale a não escolher nenhuma opção para o campo.&lt;/b>
                                              &lt;/li>
                                      &lt;/ul>"
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>


                            <h:outputText value="Ordem de Processamento:"/>
                            <p:inputText value="#{eventoFPControlador.selecionado.ordemProcessamento}"
                                         id="ordemProcessamento" size="4"
                                         maxlength="4"/>


                            <h:outputText value="Natureza Referência Cálculo:"/>
                            <h:selectOneMenu title="Informe a natureza da referência"
                                             value="#{eventoFPControlador.selecionado.naturezaRefenciaCalculo}"
                                             id="naturezaReferência">
                                <f:selectItems value="#{eventoFPControlador.tiposNaturezaReferencia()}"/>
                            </h:selectOneMenu>

                            <h:outputLabel value="Tipo de execução: "/>
                            <h:selectOneMenu id="tipoExecucao" value="#{eventoFPControlador.tipoExecucaoEP}">
                                <f:selectItems value="#{eventoFPControlador.tiposExecucao()}"/>
                                <p:ajax event="valueChange" process="@this" update=":Formulario:tab-view-geral:exibirNaFichaRPA"/>
                            </h:selectOneMenu>

                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Consignação">
                        <h:panelGrid columns="2">
                            <h:outputText value="Consignação: "/>
                            <h:selectBooleanCheckbox title="Indique se o evento é de consignação ou não"
                                                     value="#{eventoFPControlador.selecionado.consignacao}"
                                                     id="consignacao">
                                <p:ajax process="@this"
                                        listener="#{eventoFPControlador.aplicarEventoAgrupador}"
                                        onstart="aguarde.show();"
                                        oncomplete="aguarde.hide();"
                                        update="agrupador"/>
                            </h:selectBooleanCheckbox>

                            <h:outputText value="Agrupar Em:"/>
                            <h:panelGroup>
                                <h:selectOneMenu disabled="#{eventoFPControlador.selecionado.consignacao eq false}"
                                                 converter="#{eventoFPControlador.converterEventoAgrupador}"
                                                 value="#{eventoFPControlador.selecionado.eventoFPAgrupador}"
                                                 id="agrupador">
                                    <f:selectItems value="#{eventoFPControlador.eventosComOpcaoNull}"/>
                                </h:selectOneMenu>

                                <p:commandButton icon="ui-icon-info"
                                                 id="info-ir"
                                                 styleClass="mrig05"
                                                 process="@none"
                                                 update="@none"
                                                 style="width: 20px; height: 20px; margin-left: 5px!important; "/>

                                <p:overlayPanel at="right"
                                                for="info-ir"
                                                showEvent="mouseover"
                                                dynamic="false"
                                                style="width: 250px;">
                                    <h:outputText
                                        value="Alguns relatórios irão adotar a configuração de 'Taxa de Consignação' da verba cadastrada no campo 'Agrupar Em'. Exemplo: relatório Resumo de Empenho por Órgão."
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>

                            <h:outputText value="Identificação EventoFP:"/>
                            <h:selectOneMenu value="#{eventoFPControlador.selecionado.identificacaoEventoFP}"
                                             id="identificacao-evento">
                                <f:selectItems value="#{eventoFPControlador.identificadorEventos}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Tipo De Consignação:"/>
                            <h:selectOneMenu value="#{eventoFPControlador.selecionado.tipoDeConsignacao}"
                                             id="tipoDeConsignacao">
                                <f:selectItems value="#{eventoFPControlador.tipoDeConsignacoes}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Taxa de Consignações: "/>
                            <p:autoComplete queryDelay="1000" id="referenciaFP"
                                            value="#{eventoFPControlador.selecionado.referenciaFP}"
                                            completeMethod="#{eventoFPControlador.completaReferenciaFP}"
                                            converter="#{eventoFPControlador.converterReferenciaFP}"
                                            var="r"
                                            itemLabel="#{r.codigo} - #{r.descricao}"
                                            itemValue="#{r.id}"
                                            size="70"
                                            forceSelection="true"/>

                            <h:outputText value="Classificação:"/>
                            <h:selectOneMenu value="#{eventoFPControlador.selecionado.tipoClassificacaoConsignacao}"
                                             id="tipoDeClassificacaoConsignacao">
                                <f:selectItems value="#{eventoFPControlador.tipoClassificacaoConsignacao}"/>
                            </h:selectOneMenu>

                        </h:panelGrid>

                    </p:tab>

                    <p:tab title="Incidências">
                        <p:panel header="Incidências">
                            <h:panelGrid columns="3">
                                <h:outputText value="Base de Cálculo:"/>
                                <h:selectOneMenu title="Selecione a Base"
                                                 value="#{eventoFPControlador.itemBaseFP.baseFP}"
                                                 id="baseFP"
                                                 converter="#{eventoFPControlador.converterBaseFP}">
                                    <f:selectItems value="#{eventoFPControlador.baseFP}"/>
                                </h:selectOneMenu>
                                <p:message for="baseFP" showDetail="true"/>

                                <h:outputText value="Operação:"/>
                                <h:selectOneMenu title="Selecione a Operação Fórmula"
                                                 value="#{eventoFPControlador.itemBaseFP.operacaoFormula}"
                                                 id="operacaoFormula">
                                    <f:selectItems value="#{eventoFPControlador.operacaoFormula}"/>
                                </h:selectOneMenu>
                                <p:message for="operacaoFormula" showDetail="true"/>

                                <h:outputText value="Tipo Valor:"/>
                                <h:selectOneMenu
                                    title="Selecione a Tipo de valor(Normal é o valor respeitando os dias trabalhados.. já o valor intregal, considera todos os dias do mês)."
                                    value="#{eventoFPControlador.itemBaseFP.tipoValor}"
                                    id="tipoValor">
                                    <f:selectItems value="#{baseFPControlador.tipoValores}"/>
                                    <p:ajax event="valueChange" process="@this"/>
                                </h:selectOneMenu>
                                <p:spacer/>
                                <h:outputText
                                    title="Quando marcado, duranto o calculo da folha, caso tenha valores retroativos do evento, será agregado ao valor da base."
                                    value="Soma Valor Retroativo:"/>
                                <p:selectBooleanCheckbox
                                    value="#{eventoFPControlador.itemBaseFP.somaValorRetroativo}"
                                    id="somaValorRetroativo"/>
                                <p:spacer/>
                            </h:panelGrid>
                            <p:commandButton id="adicionarItemBaseFP" value="Adicionar"
                                             actionListener="#{eventoFPControlador.addItemBaseFP}"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             update="tabelaItemBaseFP :msgs"/>
                            <p:message for="adicionarItemBaseFP" showDetail="true"/>
                            <p:dataTable id="tabelaItemBaseFP" value="#{eventoFPControlador.selecionado.itensBasesFPs}"
                                         var="item">
                                <p:column headerText="Base de Cálculo">
                                    <p:commandLink value="#{item.baseFP.codigo}"
                                                   onclick="window.open('#{request.contextPath}/basefp/editar/#{item.baseFP.id}','_blank')"/>
                                    <h:outputText value=" - #{item.baseFP.descricao}"/>
                                </p:column>
                                <p:column headerText="Operação" styleClass="centralizado">
                                    <h:outputText value="#{item.operacaoFormula}"/>
                                </p:column>
                                <p:column headerText="Tipo Valor" styleClass="centralizado">
                                    <h:outputText value="#{item.tipoValor}"/>
                                </p:column>
                                <p:column headerText="Soma Valor Retroativo" styleClass="centralizado">
                                    <h:outputText value="#{item.somaValorRetroativo? 'Sim' : 'Não'}"/>
                                </p:column>
                                <p:column headerText="Remover" styleClass="centralizado">
                                    <p:commandLink value="Remover"
                                                   onclick="aguarde.show()"
                                                   oncomplete="aguarde.hide()"
                                                   actionListener="#{eventoFPControlador.removeItemBaseFP}"
                                                   update="@form">
                                        <f:attribute value="#{item}" name="objeto"/>
                                    </p:commandLink>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                    <p:tab title="Tipos de Folha" id="tab-evento">
                        <p:outputPanel id="output">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio for="tipoFolhaDePagamento"
                                                           value="Tipo de Folha de Pagamento:"/>
                                <h:selectOneMenu title="Selecione o Tipo de Folha de Pagamento"
                                                 value="#{eventoFPControlador.eventoFPTipoFolha.tipoFolhaDePagamento}"
                                                 id="tipoFolhaDePagamento">
                                    <f:selectItems value="#{calculoFolhaDePagamentoControlador.tipoFolhaDePagamento}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>

                            <p:commandButton value="Confirmar"
                                             id="adicionar-tipo-folha"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="mrig05 mtop10"
                                             update=":Formulario:tab-view-geral:output"
                                             actionListener="#{eventoFPControlador.adicionarEventoFPTipoFolha()}"
                                             title="clique apara a adicionar."
                                             icon="ui-icon-check"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             id="btn-cancelar-evento"
                                             styleClass="mtop10"
                                             actionListener="#{eventoFPControlador.cancelarEventoTipoFolha}"
                                             title="clique para cancelar."
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             process="@this"
                                             update=":Formulario:tab-view-geral:output"/>

                            <p:dataTable paginator="true"
                                         id="tabela-evento"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         value="#{eventoFPControlador.selecionado.tiposFolha}"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Tipos de Folha&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,25,50,100"
                                         var="evento">
                                <p:column headerText="Ações" style="text-align: center; width: 90px;">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="Clique para alterar este registro."
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide();"
                                                     process="@this"
                                                     actionListener="#{eventoFPControlador.selecionarEvento(evento)}"
                                                     update=":Formulario:tab-view-geral:output"
                                                     styleClass="mrig05"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     process="@this"
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{eventoFPControlador.removerEvento(evento)}"
                                                     title="Clique para remover este registro."
                                                     update="tabela-evento"/>
                                </p:column>
                                <p:column headerText="Tipo de Folha">
                                    <h:outputText value="#{evento.tipoFolhaDePagamento.descricao}"/>
                                </p:column>
                            </p:dataTable>

                        </p:outputPanel>
                    </p:tab>


                    <p:tab title="Bloqueios da Verba" id="tab-bloqueio">
                        <p:outputPanel id="output-bloqueio">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio for="tipoFuncionliadadeRH"
                                                           value="Tipo de Funcionalidade:"/>
                                <h:selectOneMenu title="Selecione a funcionalidade do qual deseja bloquear"
                                                 value="#{eventoFPControlador.bloqueioFuncionalidade.tipoFuncionalidadeRH}"
                                                 id="tipoFuncionliadadeRH">
                                    <f:selectItems value="#{eventoFPControlador.tiposFuncionalidade}"/>
                                </h:selectOneMenu>
                            </h:panelGrid>

                            <p:commandButton value="Confirmar"
                                             id="adicionar-bloqueio"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             styleClass="mrig05 mtop10"
                                             update=":Formulario:tab-view-geral:output-bloqueio"
                                             actionListener="#{eventoFPControlador.adicionarBloqueioFuncionalidade()}"
                                             title="clique apara a adicionar."
                                             icon="ui-icon-check"/>

                            <p:commandButton value="Cancelar"
                                             icon="ui-icon-cancel"
                                             id="btn-cancelar-bloqueio"
                                             styleClass="mtop10"
                                             actionListener="#{eventoFPControlador.cancelarEventoBloqueio}"
                                             title="clique para cancelar."
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             process="@this"
                                             update=":Formulario:tab-view-geral:output-bloqueio"/>

                            <p:dataTable paginator="true"
                                         id="tabela-bloqueio"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         value="#{eventoFPControlador.selecionado.bloqueiosFuncionalidade}"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>A verba estará bloqueada durante os períodos&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,25,50,100"
                                         var="evento">
                                <p:column headerText="Ações" style="text-align: center; width: 90px;">
                                    <p:commandButton icon="ui-icon-pencil"
                                                     title="Clique para alterar este registro."
                                                     onclick="aguarde.show()"
                                                     oncomplete="aguarde.hide();"
                                                     process="@this"
                                                     actionListener="#{eventoFPControlador.selecionarBloqueio(evento)}"
                                                     update=":Formulario:tab-view-geral:output-bloqueio"
                                                     styleClass="mrig05"/>

                                    <p:commandButton icon="ui-icon-trash"
                                                     process="@this"
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     oncomplete="aguarde.hide()"
                                                     actionListener="#{eventoFPControlador.removerBloqueio(evento)}"
                                                     title="Clique para remover este registro."
                                                     update="tabela-bloqueio"/>
                                </p:column>
                                <p:column headerText="Tipo de Bloqueio Para a Verba">
                                    <h:outputText value="#{evento.tipoFuncionalidadeRH.descricao}"/>
                                </p:column>
                            </p:dataTable>

                        </p:outputPanel>
                    </p:tab>
                    <p:tab title="E-Social" id="tab-esocial">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="CNPJ/Entidade: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.entidade}"
                                             converter="#{entidadeControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.entidade}"/>
                                <p:ajax update="panelEntidade" event="change" onstart="aguarde.show()"
                                        oncomplete="aguarde.hide()"/>
                            </h:selectOneMenu>
                            <p:spacer/>
                            <h:panelGroup id="panelEntidade">
                                <h:outputText value="CNPJ: " styleClass="negrito"
                                              rendered="#{eventoFPControlador.eventoFPEmpregador.entidade ne null}"/>
                                <h:outputText
                                    value="#{eventoFPControlador.eventoFPEmpregador.entidade.pessoaJuridica.cnpj}"
                                    styleClass="negrito"
                                    rendered="#{eventoFPControlador.eventoFPEmpregador.entidade ne null}"/>
                            </h:panelGroup>
                            <fc:outputLabelObrigatorio value="Identificação da Tabela: "/>
                            <p:inputText value="#{eventoFPControlador.eventoFPEmpregador.identificacaoTabela}"
                                         maxlength="8"
                                         size="15"/>
                            <fc:outputLabelObrigatorio value="Inicio de vigência: "/>
                            <h:panelGroup>
                                <p:calendar value="#{eventoFPControlador.eventoFPEmpregador.inicioVigencia}"
                                            onkeypress="mascara(this,mdataMesAno)"
                                            navigator="true"
                                            showOn="false"
                                            size="10"
                                            pattern="MM/yyyy"/>
                                <h:outputText value="Ex: mm/yyyy" styleClass="negrito mlef03"/>
                            </h:panelGroup>
                            <h:outputText value="Final de vigência: "/>
                            <h:panelGroup>
                                <p:calendar value="#{eventoFPControlador.eventoFPEmpregador.fimVigencia}"
                                            onkeypress="mascara(this,mdataMesAno)"
                                            navigator="true"
                                            showOn="false"
                                            size="10"
                                            pattern="MM/yyyy"/>
                                <h:outputText value="Ex: mm/yyyy" styleClass="negrito mlef03"/>
                            </h:panelGroup>
                            <fc:outputLabelObrigatorio value="Natureza da Rubricas: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.naturezaRubrica}"
                                             converter="#{naturezaRubricaControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.naturezaRubrica}"/>
                            </h:selectOneMenu>
                            <fc:outputLabelObrigatorio value="Incidência Tributária para a Previdência Social: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.incidenciaPrevidencia}"
                                             converter="#{incidenciaTributariaPrevidenciaControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.incidenciaTributariaPrevidenciaSocial}"/>
                            </h:selectOneMenu>
                            <fc:outputLabelObrigatorio value="Incidência Tributária para IRRF: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.incidenciaTributariaIRRF}"
                                             converter="#{incidenciaTributariaIRRFControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.incidenciaTributariaIRRF}"/>
                            </h:selectOneMenu>
                            <fc:outputLabelObrigatorio value="Incidência Tributária para FGTS: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.incidenciaTributariaFGTS}"
                                             converter="#{incidenciaTributariaFGTSControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.incidenciaTributariaFGTS}"/>
                            </h:selectOneMenu>
                            <fc:outputLabelObrigatorio value="Incidência Tributária para o RPPS: "/>
                            <h:selectOneMenu value="#{eventoFPControlador.eventoFPEmpregador.incidenciaTributariaRPPS}"
                                             converter="#{incidenciaTributariaRPPSControlador.converterGenerico}">
                                <f:selectItems value="#{eventoFPControlador.incidenciaContribuicaoSindical}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Teto Remuneratório: "/>
                            <p:selectBooleanCheckbox
                                value="#{eventoFPControlador.eventoFPEmpregador.tetoRemuneratorio}"/>

                            <p:commandButton value="Adicionar"
                                             styleClass="operacao"
                                             icon="ui-icon-plus"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{eventoFPControlador.adicionarEmpregadorEsocial}"
                                             update=":Formulario tabela-evento-esocial"/>
                        </h:panelGrid>


                        <p:dataTable paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     id="tabela-evento-esocial"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{eventoFPControlador.selecionado.itensEventoFPEmpregador}"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>EMPREGADORES&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     var="itemEvento">

                            <p:column style="width: 10%; text-align: center;" headerText="Ações">
                                <p:commandButton icon="ui-icon-pencil"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 actionListener="#{eventoFPControlador.editarEventoEmpregador(itemEvento)}"
                                                 update=":Formulario:tab-view-geral:tab-esocial"/>
                                <p:commandButton icon="ui-icon-trash"
                                                 onclick="aguarde.show()"
                                                 oncomplete="aguarde.hide()"
                                                 actionListener="#{eventoFPControlador.removerEventoEmpregador(itemEvento)}"
                                                 update="tabela-evento-esocial"/>

                                <p:commandButton icon="ui-icon-blue-document-copy"
                                                 onclick="aguarde.show()"
                                                 title="Clique para duplicar essa configuração."
                                                 oncomplete="aguarde.hide(); dialogCopiarConfig.show()"
                                                 actionListener="#{eventoFPControlador.carregarEmpregadoresQueNaoEstaoNaConfiguracao(itemEvento)}"
                                                 update="tabela-evento-esocial"/>
                            </p:column>
                            <p:column headerText="Entidade" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.entidade}"/>
                            </p:column>
                            <p:column headerText="Ident. da Tabela" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.identificacaoTabela}"/>
                            </p:column>
                            <p:column headerText="Inicio de vigência" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.inicioVigencia}">
                                    <f:convertDateTime pattern="MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Final de vigência" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.fimVigencia}">
                                    <f:convertDateTime pattern="MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Natureza" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.naturezaRubrica}"/>
                            </p:column>
                            <p:column headerText="Inci. Trib. para a Prev. Social"
                                      styleClass="alinhamentoCentralizado" style="width:30px; ">
                                <h:outputText value="#{itemEvento.incidenciaPrevidencia}"/>
                            </p:column>
                            <p:column headerText="Inci. Trib. para IRRF"
                                      styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.incidenciaTributariaIRRF}"/>
                            </p:column>
                            <p:column headerText="Inci. Trib. para FGTS"
                                      styleClass="alinhamentoCentralizado.">
                                <h:outputText value="#{itemEvento.incidenciaTributariaFGTS}"/>
                            </p:column>
                            <p:column headerText="Incidência Tributária para o RPPS"
                                      styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{itemEvento.incidenciaTributariaRPPS}"/>
                            </p:column>
                            <p:column headerText="Teto Remuneratório">
                                <h:outputText value="#{itemEvento.tetoRemuneratorio ? 'Sim' : 'Não'}"/>
                            </p:column>

                        </p:dataTable>

                    </p:tab>


                    <p:tab title="Histórico eventos E-Social">
                        <p:dataTable paginator="true"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{eventoFPControlador.selecionado.eventosEsocial}"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>EVENTOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     var="evento">
                            <p:column headerText="Tipo" styleClass="alinhamentoEsquerda">
                                <h:outputText value="#{evento.tipoArquivo}"
                                              title="#{evento.id}"
                                              styleClass="preformatted-fonte-padrao"/>
                            </p:column>
                            <p:column headerText="Grupo" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.grupo}"
                                              title="#{evento.idESocial}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Situação" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.situacao}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Código Resposta" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.codigoResposta}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Descriçao Resposta" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.descricaoResposta}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Operação" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.operacao}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Recibo" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.reciboEntrega}"
                                              styleClass="preformatted-fonte-padrao">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Data Registro" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{evento.dataOperacao}"
                                              styleClass="preformatted-fonte-padrao">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="XML" styleClass="alinhamentoCentralizado">
                                <p:commandButton
                                    icon="ui-icon-search"
                                    oncomplete="dialogXml.show(); aguarde.hide()"
                                    update=":FormDialog"
                                    process="@this"
                                    onclick="aguarde.show()"
                                    styleClass="vinteLarguraVinteAltura icone_branco botao_verde"
                                    actionListener="#{contratoFPControlador.setXml(evento.XML)}">
                                </p:commandButton>
                            </p:column>
                            <p:column headerText="Ocorrências" styleClass="alinhamentoCentralizado">
                                <p:commandButton
                                    id="btn-ocorrencias"
                                    icon="ui-icon-search"
                                    oncomplete="dialogOcorrencia.show();"
                                    update=":formDialogOcorrencia"
                                    process="@this"
                                    styleClass="vinteLarguraVinteAltura icone_branco botao_verde"
                                    actionListener="#{eventoFPControlador.setOcorrencias(evento.ocorrencias)}">
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Lotação Funcional" id="tab-lotacao">
                        <p:outputPanel id="panelLotacao">
                            <h:panelGrid columns="2" id="grid-lotacao">
                                <h:outputText value="Lotação Funcional: "/>
                                <p:autoComplete id="orgao"
                                                queryDelay="1000"
                                                value="#{eventoFPControlador.hierarquiaOrganizacional}"
                                                completeMethod="#{eventoFPControlador.completarHierarquia}"
                                                converter="#{eventoFPControlador.converterHierarquia}"
                                                forceSelection="true"
                                                var="h"
                                                itemLabel="#{h}"
                                                itemValue="#{h.id}"
                                                maxResults="10"
                                                size="70">
                                </p:autoComplete>
                                <p:commandButton value="Adicionar"
                                                 icon="ui-icon-plus"
                                                 styleClass="mrig05 mtop10"
                                                 actionListener="#{eventoFPControlador.adicionarLotacao}"
                                                 update=":Formulario:tab-view-geral:tabela-lotacao :Formulario:tab-view-geral:grid-lotacao"
                                                 onclick="aguarde.show()" oncomplete="aguarde.hide()"/>
                            </h:panelGrid>

                            <p:dataTable paginator="true"
                                         id="tabela-lotacao"
                                         rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                         rowIndexVar="rowIx"
                                         styleClass="mtop05"
                                         emptyMessage="Não foram localizados registros para serem apresentados"
                                         value="#{eventoFPControlador.selecionado.eventoFPUnidade}"
                                         rows="10"
                                         paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>Lotação Funcional&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                         rowsPerPageTemplate="10,25,50,100"
                                         var="lotacao">
                                <p:column headerText="Ações" style="text-align: center; width: 90px;">
                                    <p:commandButton icon="ui-icon-trash"
                                                     process="@this"
                                                     onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                     oncomplete="aguarde.hide()"
                                                     update="tabela-lotacao"
                                                     actionListener="#{eventoFPControlador.removerLotacao(lotacao)}"
                                                     title="Clique para remover este registro."/>
                                </p:column>
                                <p:column headerText="Lotação Funcional">
                                    <h:outputText value="#{lotacao.unidadeOrganizacional}"/>
                                </p:column>
                            </p:dataTable>
                        </p:outputPanel>
                    </p:tab>
                    <p:tab title="Sicap">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio styleAsterisco="color: blue !important" value="Classificação da Verba:"/>
                            <fc:autoComplete value="#{eventoFPControlador.selecionado.classificacaoVerba}"
                                             converter="#{classificacaoVerbaControlador.converterGenerico}"
                                             completeMethod="#{eventoFPControlador.completarClassificacoesVerbas}"
                                             maxResults="1000"
                                             id="class"
                                             disabled="#{eventoFPControlador.selecionado.naoEnviarVerbaSicap}"/>
                            <h:outputText value="Não enviar para SICAP:"/>
                            <p:selectBooleanCheckbox value="#{eventoFPControlador.selecionado.naoEnviarVerbaSicap}">
                                <p:ajax event="change" update=":Formulario:tab-view-geral:class:class" process="@this" onstart="aguarde.show()"
                                        listener="#{eventoFPControlador.limparClassificacaoVerba()}"
                                        oncomplete="aguarde.hide()"/>
                            </p:selectBooleanCheckbox>
                        </h:panelGrid>
                    </p:tab>
                    <p:tab title="Parâmetros de Exibição">
                        <h:panelGrid columns="2" id="parametrosRelatorio">
                            <h:outputText value="Exibir na ficha financeira: "
                                          rendered="#{eventoFPControlador.selecionado.tipoEventoFP eq 'INFORMATIVO'}"/>
                            <h:selectBooleanCheckbox
                                rendered="#{eventoFPControlador.selecionado.tipoEventoFP eq 'INFORMATIVO'}"
                                value="#{eventoFPControlador.selecionado.exibirNaFichaFinanceira}"
                                id="exibirNaFichaFinanceira"/>

                            <h:outputText value="Exibir na Ficha RPA: "/>
                            <h:selectBooleanCheckbox
                                disabled="#{!eventoFPControlador.habilitarExibirFichaRPA()}"
                                value="#{eventoFPControlador.selecionado.exibirNaFichaRPA}"
                                id="exibirNaFichaRPA"/>
                        </h:panelGrid>
                    </p:tab>

                    <p:tab title="Previdência Complementar">
                        <h:panelGrid columns="2" id="previdenciaComplementar">

                            <h:outputText value="Tipo de Contribuição:"/>
                            <h:selectOneMenu
                                id="tipoContribuicao"
                                value="#{eventoFPControlador.selecionado.tipoContribuicaoBBPrev}">
                                <f:selectItems value="#{eventoFPControlador.tiposContribuicaoBBPrev}"/>
                            </h:selectOneMenu>

                            <h:outputText value="Código de Contribuição BBPrev:"/>
                            <p:inputText value="#{eventoFPControlador.selecionado.codigoContribuicaoBBPrev}"
                                         id="codigoContribuicaoBBPrev" size="40" maxlength="2"/>
                        </h:panelGrid>
                    </p:tab>
                </p:tabView>
                <br/>
            </p:panel>
            <fc:rodapePretty controlador="#{eventoFPControlador}"/>
        </h:form>
        <p:dialog widgetVar="dialogOcorrencia"
                  position="center"
                  closable="true"
                  resizable="true"
                  modal="true"
                  draggable="true"
                  hideEffect="fade"
                  dynamic="true"
                  header="Ocorrências">
            <h:form id="formDialogOcorrencia">
                <div style="overflow: auto; max-height: 300px; max-width: 900px">
                    <p:dataTable paginator="true"
                                 id="tabela-ocorrencia"
                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                                 rowIndexVar="rowIx"
                                 styleClass="mtop05"
                                 emptyMessage="Não foram localizados registros para serem apresentados"
                                 value="#{eventoFPControlador.ocorrencias}"
                                 rows="10"
                                 paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>OCORRÊNCIAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                 rowsPerPageTemplate="10,25,50,100"
                                 var="evento">

                        <p:column headerText="Código Resposta" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{evento.codigo}"
                                          styleClass="preformatted-fonte-padrao">
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Descrição" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{evento.descricao}"
                                          styleClass="preformatted-fonte-padrao">
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Recibo" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{evento.tipo}"
                                          styleClass="preformatted-fonte-padrao">
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Recibo" styleClass="alinhamentoCentralizado">
                            <h:outputText value="#{evento.localizacao}"
                                          styleClass="preformatted-fonte-padrao">
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dialogXml"
                  position="center"
                  closable="true"
                  resizable="true"
                  modal="true"
                  id="dialog"
                  draggable="true"
                  hideEffect="fade"
                  dynamic="true"
                  header="Xml">
            <h:form id="FormDialog">
                <div style="overflow: auto; max-height: 300px; max-width: 900px">
                    <h:inputHidden id="inputEscondido"
                                   value="#{contratoFPControlador.xml}"/>
                    <textarea id="code" name="code"/>
                    <script type="text/javascript">
                        var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
                            lineNumbers: true,
                            mode: "xml"
                        });
                        var conteudoHidden = document.getElementById('FormDialog:inputEscondido').value;
                        editor.setValue(formatXml(conteudoHidden));


                    </script>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dialogCopiarConfig"
                  position="center"
                  resizable="true"
                  closable="false"
                  modal="true"
                  id="dialogEntidades"
                  hideEffect="fade"
                  dynamic="true"
                  header="Copiar configuração do Empregador">
            <h:form id="FormDialogEmpregador">
                <p:panel header="Empregador">
                    <h:panelGrid columns="2">
                        <h:outputText value="Empregador para copiar:"/>
                        <h:outputText value="#{eventoFPControlador.eventoFPEmpregadorSelecionado.entidade}"
                                      styleClass="negrito"/>
                    </h:panelGrid>
                </p:panel>

                <p:dataTable id="tabelaEmpregadores"
                             selection=""
                             value="#{eventoFPControlador.empregadorSemConfiguracao}"
                             var="empregador"
                             styleClass="mtop03"
                             rowStyleClass="#{empty rowlx or rowlx mod 2 ne 0 ? 'linha-selecionada' : 'trintaAltura'}"
                             paginator="true"
                             rows="10"
                             paginatorTemplate="{CurrentPageReport} &lt;span class='titulo-tabela mrig10'>EMPREGADORES&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages}"
                             emptyMessage="Não foram localizados registros para serem apresentados."
                             rowIndexVar="rowlx">
                    <p:column>
                        <p:commandButton icon="ui-icon-check"
                                         styleClass="vinteLarguraVinteAltura"
                                         update="tabelaEmpregadores"
                                         process="@this"
                                         onstart="aguarde.show();"
                                         rendered="#{!eventoFPControlador.mostrarBotaoSelecionarEmpregadores(empregador)}"
                                         oncomplete="aguarde.hide();"
                                         actionListener="#{eventoFPControlador.removerConfiguracaoEmpregador(empregador)}"
                        />
                        <p:commandButton styleClass="vinteLarguraVinteAltura botao-select-desmarcado"
                                         value=""
                                         process="@this"
                                         update="tabelaEmpregadores"
                                         onstart="aguarde.show();"
                                         rendered="#{eventoFPControlador.mostrarBotaoSelecionarEmpregadores(empregador)}"
                                         oncomplete="aguarde.hide();"
                                         actionListener="#{eventoFPControlador.adicionarConfiguracaoEmpregador(empregador)}"
                        />
                    </p:column>
                    <p:column headerText="Entidade" styleClass="alinhamentoCentralizado">
                        <h:outputText value="${empregador.entidade}"/>
                    </p:column>
                    <p:column headerText="Identificação Tabela" styleClass="alinhamentoCentralizado">
                        <p:inputText value="${empregador.identificacaoTabela}"
                                     disabled="#{eventoFPControlador.mostrarBotaoSelecionarEmpregadores(empregador)}"
                                     maxlength="255">
                            <p:ajax event="blur" process="@this"/>
                        </p:inputText>
                    </p:column>
                </p:dataTable>

                <h:panelGrid columns="2">
                    <p:commandButton value="Confirmar"
                                     onclick="aguarde.show()"
                                     actionListener="#{eventoFPControlador.confirmarEmpregadoresParaConfigurar()}"
                                     oncomplete="aguarde.hide()"
                                     styleClass="mrig05 mtop10"
                                     title="clique para confirmar e criar as configurações."
                                     update=":Formulario:tab-view-geral:tabela-evento-esocial"
                                     icon="ui-icon-check"/>

                    <p:commandButton value="Cancelar"
                                     onclick="aguarde.show()"
                                     oncomplete="aguarde.hide(); dialogCopiarConfig.hide()"
                                     styleClass="mrig05 mtop10"
                                     title="clique para cancelar."
                                     icon="ui-icon-cancel"/>
                </h:panelGrid>

            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>
</html>
