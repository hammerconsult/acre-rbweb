<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:fc="http://java.sun.com/jsf/composite/components"
      xmlns:p="http://primefaces.org/ui">
<ui:composition template="/corpo.xhtml">
    <ui:define name="body">
        <h:form id="Formulario">
            <fc:cabecalhoPretty controlador="#{faseConcursoControlador}"
                                origem="#{faseConcursoControlador.caminhoPadrao}novo/"/>
            <p:panel header="Fases e Provas">
                <h:panelGrid columns="2">
                    <fc:outputLabelObrigatorio value="Concurso:"/>
                    <h:panelGroup>
                        <h:outputText value="#{faseConcursoControlador.selecionado}"
                                      styleClass="mrig05 azulnegrito"
                                      rendered="#{!faseConcursoControlador.isOperacaoNovo()}"/>

                        <h:selectOneMenu title="Selecione concurso para criar as fases"
                                         styleClass="mrig05"
                                         style="min-width: 400px;"
                                         rendered="#{faseConcursoControlador.isOperacaoNovo()}"
                                         converter="#{faseConcursoControlador.converterConcurso}"
                                         value="#{faseConcursoControlador.selecionado}">
                            <f:selectItems value="#{faseConcursoControlador.concursos}"/>
                            <p:ajax event="valueChange"
                                    onstart="aguardeMensagemUsuario.show()"
                                    oncomplete="aguardeMensagemUsuario.hide()"
                                    process="@this"
                                    update="bt-ver-concurso panel-geral-fase"/>
                        </h:selectOneMenu>

                        <p:commandButton process="@none"
                                         id="bt-ver-concurso"
                                         icon="ui-icon-lupa"
                                         styleClass="icone-20 mrig05"
                                         disabled="#{faseConcursoControlador.selecionado eq null}"
                                         update="@none"
                                         onclick="window.open('#{request.contextPath}/concurso/ver/#{faseConcursoControlador.selecionado.id}/','_blank');"/>

                        <p:commandButton process="@none"
                                         update="@none"
                                         id="bt-informacao"
                                         rendered="#{faseConcursoControlador.isOperacaoNovo()}"
                                         styleClass="icone-20 mrig05"
                                         icon="ui-icon-info"/>

                        <p:overlayPanel for="bt-informacao"
                                        style="border : solid black 1px;"
                                        styleClass="semSombra"
                                        showEvent="mouseover"
                                        hideEvent="mouseout">
                            <h:outputText value="Listando somente os concursos que já possuem publicações."
                                          escape="false"/>
                        </p:overlayPanel>
                    </h:panelGroup>
                </h:panelGrid>

                <p:separator styleClass="mtop10 mbot05"/>

                <p:outputPanel id="panel-geral-fase">
                    <h:panelGrid columns="2"
                                 cellpadding="0"
                                 cellspacing="0"
                                 id="grid-botao-novo-fase">
                        <p:commandButton value="Nova Fase"
                                         icon="ui-icon-circle-plus"
                                         process="@this"
                                         rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                         disabled="#{faseConcursoControlador.selecionado eq null}"
                                         update="panel-novo-fase"
                                         actionListener="#{faseConcursoControlador.novaFase()}"/>
                        <h:outputText value="Selecione um concurso para poder adicionar fases"
                                      rendered="#{faseConcursoControlador.selecionado eq null}"
                                      styleClass="azul"
                            />
                    </h:panelGrid>


                    <p:outputPanel id="panel-novo-fase">
                        <p:panel header="Nova Fase"
                                 styleClass="mtop05"
                                 rendered="#{faseConcursoControlador.faseSelecionada ne null}">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="Ordem:"/>
                                <p:inputText value="#{faseConcursoControlador.faseSelecionada.ordem}"
                                             size="3"/>

                                <fc:outputLabelObrigatorio value="Descrição:"/>
                                <p:inputText value="#{faseConcursoControlador.faseSelecionada.descricao}"
                                             size="50"/>

                                <h:outputLabel value="Observações:"/>
                                <h:panelGrid columns="2"
                                             cellpadding="0"
                                             cellspacing="0">
                                    <p:inputTextarea title="Digite as observações da fase"
                                                     value="#{faseConcursoControlador.faseSelecionada.observacoes}"
                                                     cols="70"
                                                     maxlength="3000"
                                                     autoResize="true"
                                                     counterTemplate="{0} Caracteres Restantes."
                                                     counter="counter-obs-fase"/>
                                    <h:outputText id="counter-obs-fase"
                                                  style="color: #497692"
                                                  styleClass="mlef05"/>
                                </h:panelGrid>


                            </h:panelGrid>

                            <p:commandButton value="Confirmar"
                                             styleClass="mrig05 mtop05"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             process="panel-geral-fase"
                                             update="panel-geral-fase"
                                             actionListener="#{faseConcursoControlador.confirmarFase()}"
                                             icon="ui-icon-check"/>

                            <p:commandButton value="Cancelar"
                                             process="@this"
                                             styleClass="mtop05"
                                             onclick="aguarde.show(); "
                                             immediate="true"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{faseConcursoControlador.cancelarFase()}"
                                             update="panel-novo-fase"
                                             icon="ui-icon-cancel"/>
                        </p:panel>
                    </p:outputPanel>

                    <p:dataTable paginator="true"
                                 id="tabela-fases"
                                 rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                 rowIndexVar="rowIx"
                                 styleClass="mtop05"
                                 emptyMessage="Não foram localizados registros para serem apresentados"
                                 value="#{faseConcursoControlador.selecionado.fasesOrdenadas}"
                                 rows="10"
                                 paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>FASES&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                 rowsPerPageTemplate="10,25,50,100"
                                 var="fase">

                        <p:column headerText="Ações"
                                  rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                  style="text-align: center; width: 90px;">
                            <p:commandButton icon="ui-icon-pencil"
                                             process="@this"
                                             onclick="aguarde.show()"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{faseConcursoControlador.selecionarFase(fase)}"
                                             title="Clique para poder editar este registro."
                                             update=":Formulario:panel-novo-fase"
                                             styleClass="mrig05"/>

                            <p:commandButton icon="ui-icon-trash"
                                             process="@this"
                                             onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                             oncomplete="aguarde.hide()"
                                             actionListener="#{faseConcursoControlador.removerFase(fase)}"
                                             title="Clique para remover este registro."
                                             update="tabela-fases"
                                             styleClass="mrig05"/>
                        </p:column>

                        <p:column headerText="Provas" styleClass="alinhamentoCentralizado" style="width: 90px">
                            <p:commandButton icon="ui-icon-circle-plus"
                                             process="@this"
                                             onclick="aguarde.show()"
                                             rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                             update=":form-dialog-prova"
                                             oncomplete="aguarde.hide(); dialogNovaProva.show()"
                                             actionListener="#{faseConcursoControlador.novaProva(fase)}"
                                             title="Clique adicionar provas à esta fase."
                                             styleClass="mrig05"/>

                            <p:commandButton icon="ui-icon-lupa"
                                             process="@this"
                                             onclick="aguarde.show()"
                                             update=":form-dialog-visualizacao-provas"
                                             oncomplete="visualizacaoProvasDialog.show(); aguarde.hide();"
                                             actionListener="#{faseConcursoControlador.selecionarFase(fase)}"
                                             title="Clique para visualizar as provas desta fase."
                                             styleClass="mrig05"/>
                        </p:column>
                        <p:column headerText="Anexos" styleClass="alinhamentoCentralizado" style="width: 90px">
                            <p:commandButton icon="ui-icon-circle-plus"
                                             process="@this"
                                             onclick="aguarde.show()"
                                             rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                             update=":form-dialog-anexo"
                                             oncomplete="aguarde.hide(); dialogNovoAnexo.show()"
                                             actionListener="#{faseConcursoControlador.selecionarFase(fase)}"
                                             title="Clique adicionar anexos à esta fase."
                                             styleClass="mrig05"/>

                            <p:commandButton icon="ui-icon-lupa"
                                             process="@this"
                                             onclick="aguarde.show()"
                                             update=":form-dialog-visualizacao-anexos"
                                             oncomplete="visualizacaoAnexosDialog.show(); aguarde.hide();"
                                             actionListener="#{faseConcursoControlador.selecionarFase(fase)}"
                                             title="Clique para visualizar os anexos desta fase."
                                             styleClass="mrig05"/>
                        </p:column>
                        <p:column headerText="Ordem" styleClass="alinhamentoCentralizado" style="width: 30px!important">
                            <h:outputText value="#{fase.ordem}"/>
                        </p:column>

                        <p:column headerText="Descrição" styleClass="alinhamentoEsquerda">
                            <h:outputText value="#{fase.descricao}"/>
                        </p:column>

                        <p:column headerText="Observações" styleClass="alinhamentoCentralizado">
                            <h:outputText value="[PARE O MOUSE AQUI]"
                                          id="label-obs-fase"/>

                            <p:tooltip for="label-obs-fase"
                                       style="border : solid black 1px;">
                                <h:outputText
                                    rendered="#{fase.observacoes ne null and !fase.observacoes.trim().isEmpty()}"
                                    value="#{fase.observacoes}"/>
                                <h:outputText
                                    rendered="#{fase.observacoes eq null or fase.observacoes.trim().isEmpty()}"
                                    value="** Sem Obsevações **"/>
                            </p:tooltip>
                        </p:column>
                    </p:dataTable>
                </p:outputPanel>
            </p:panel>
            <p:commandButton value="Salvar"
                             id="cbSalvar"
                             styleClass="mtop10 mrig05 prioritario"
                             style="height: 30px;"
                             icon="ui-icon-disk"
                             title="Clique para salvar o registro"
                             rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                             process="@this"
                             actionListener="#{faseConcursoControlador.salvar()}"
                             onclick="aguarde.show()"
                             oncomplete="aguarde.hide()"
                />

            <p:commandButton value="Cancelar"
                             id="cbCancelar"
                             style="height: 30px;"
                             styleClass="mtop10"
                             icon="ui-icon-cancel"
                             onclick="aguarde.show()"
                             oncomplete="aguarde.hide()"
                             title="Clique para cancelar e retornar a página anterior"
                             actionListener="#{faseConcursoControlador.cancelar()}"
                             immediate="true"/>
        </h:form>


        <p:dialog widgetVar="dialogNovaProva"
                  header="Prova"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  closable="false">
            <h:form id="form-dialog-prova">
                <h:panelGrid columns="2">
                    <h:outputText value="Prova Selecionada:"/>
                    <h:outputText value="#{faseConcursoControlador.provaSelecionada}" styleClass="negrito"/>
                </h:panelGrid>

                <p:separator styleClass="mtop05 mbot05"/>

                <p:tabView style="min-width: 600px; min-height: 240px;">
                    <p:tab title="Dados Gerais">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Cargo:"/>
                            <h:panelGroup>
                                <h:selectOneMenu title="Selecione o cargo desta prova"
                                                 styleClass="mrig05"
                                                 style="min-width: 400px;"
                                                 disabled="#{faseConcursoControlador.provaSelecionada.temAvaliacao()}"
                                                 rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                                 converter="#{faseConcursoControlador.converterCargoConcurso}"
                                                 value="#{faseConcursoControlador.provaSelecionada.cargoConcurso}">
                                    <f:selectItems value="#{faseConcursoControlador.selecionado.cargos}"/>
                                </h:selectOneMenu>

                                <p:commandButton process="@none"
                                                 update="@none"
                                                 id="bt-info-cargo"
                                                 styleClass="icone-20 mrig05"
                                                 icon="ui-icon-info"/>

                                <p:overlayPanel for="bt-info-cargo"
                                                style="border : solid black 1px;"
                                                styleClass="semSombra"
                                                showEvent="mouseover"
                                                hideEvent="mouseout">
                                    <h:outputText
                                        value="&lt;b>Este campo será desabilidato após a avaliação desta prova e cargo.&lt;b/>"
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>

                            <fc:outputLabelObrigatorio value="Nome:"/>
                            <p:inputText value="#{faseConcursoControlador.provaSelecionada.nome}"
                                         size="50"/>

                            <fc:outputLabelObrigatorio value="Método de Avaliação:"/>
                            <h:panelGroup>
                                <h:selectOneMenu title="Selecione o método de avaliação"
                                                 styleClass="mrig05"
                                                 disabled="#{faseConcursoControlador.provaSelecionada.temAvaliacao()}"
                                                 rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                                 value="#{faseConcursoControlador.provaSelecionada.metodoAvaliacao}">
                                    <f:selectItems value="#{faseConcursoControlador.metodosDeAvaliacao}"/>
                                    <f:ajax event="valueChange"
                                            execute="@this"
                                            listener="#{faseConcursoControlador.atribuirNotaMinimaPeloTipoDeAvaliacaoDaProva}"
                                            render="panel-nota-minima"/>
                                </h:selectOneMenu>

                                <p:commandButton process="@none"
                                                 update="@none"
                                                 id="bt-info-metodo-avaliacao"
                                                 styleClass="icone-20 mrig05"
                                                 icon="ui-icon-info"/>

                                <p:overlayPanel for="bt-info-metodo-avaliacao"
                                                style="border : solid black 1px;"
                                                styleClass="semSombra"
                                                showEvent="mouseover"
                                                hideEvent="mouseout">
                                    <h:outputText
                                        value="&lt;b>Este campo será desabilidato após a avaliação desta prova e cargo.&lt;b/>"
                                        escape="false"/>
                                </p:overlayPanel>
                            </h:panelGroup>

                            <fc:outputLabelObrigatorio value="Nota Mínima:"
                                                       id="label-nota-minima"/>
                            <h:panelGrid cellpadding="0"
                                         cellspacing="0"
                                         columnClasses="altura-25"
                                         id="panel-nota-minima">
                                <h:panelGrid columns="2"
                                             cellspacing="0"
                                             cellpadding="0"
                                             rendered="#{faseConcursoControlador.provaSelecionada.metodoAvaliacao eq 'POR_NOTA'}">
                                    <p:inputText value="#{faseConcursoControlador.provaSelecionada.notaMinima}"
                                                 disabled="#{faseConcursoControlador.provaSelecionada.temAvaliacao()}"
                                                 id="input-nota-minima"/>

                                    <p:commandButton process="@none"
                                                     update="@none"
                                                     id="bt-info-nota-minima"
                                                     styleClass="icone-20 mrig05 mlef05"
                                                     icon="ui-icon-info"/>

                                    <p:overlayPanel for="bt-info-nota-minima"
                                                    style="border : solid black 1px;"
                                                    styleClass="semSombra"
                                                    showEvent="mouseover"
                                                    hideEvent="mouseout">
                                        <h:outputText value="Informe a nota de 0 a 10."
                                                      escape="false"/>
                                    </p:overlayPanel>
                                </h:panelGrid>

                                <h:outputText value="Definida automaticamente"
                                              styleClass="azulnegrito mtop10"
                                              rendered="#{faseConcursoControlador.provaSelecionada.metodoAvaliacao eq 'POR_OBJETIVO'}"/>
                            </h:panelGrid>

                            <h:outputLabel value="Observações:"/>
                            <h:panelGrid columns="2"
                                         cellpadding="0"
                                         cellspacing="0">
                                <p:inputTextarea title="Digite as observações da prova"
                                                 value="#{faseConcursoControlador.provaSelecionada.observacoes}"
                                                 cols="40"
                                                 maxlength="3000"
                                                 autoResize="true"
                                                 counterTemplate="{0} Caracteres Restantes."
                                                 counter="counter-obs-prova"/>
                                <h:outputText id="counter-obs-prova"
                                              style="color: #497692"
                                              styleClass="mlef05"/>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:tab>

                    <p:tab title="Endereço">
                        <p:outputPanel id="panel-endereco">
                            <h:panelGrid columns="2">
                                <fc:outputLabelObrigatorio value="CEP:"/>
                                <p:inputMask mask="99999-999"
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.cep}"
                                             title="Informe o CEP">
                                    <p:ajax event="valueChange"
                                            process="@this"
                                            listener="#{faseConcursoControlador.atualizaLogradouros()}"
                                            update="panel-endereco"/>
                                </p:inputMask>


                                <fc:outputLabelObrigatorio value="Estado:"/>
                                <h:selectOneMenu id="estado-endereco"
                                                 title="Informe o estado."
                                                 value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.uf}">
                                    <f:selectItems value="#{pessoaTributarioControlador.listaUF}"
                                                   var="uf" itemLabel="#{uf.nome}" itemValue="#{uf.sigla}"/>
                                </h:selectOneMenu>


                                <fc:outputLabelObrigatorio value="Cidade:"/>
                                <p:inputText id="cidade-endereco"
                                             title="Digite a cidade."
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.localidade}"
                                             maxlength="255"
                                             size="70"/>


                                <fc:outputLabelObrigatorio value="Bairro:"/>
                                <p:inputText id="bairro-endereco"
                                             title="Digite o bairro."
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.bairro}"
                                             maxlength="255"
                                             size="70"/>


                                <fc:outputLabelObrigatorio value="Logradouro:"/>
                                <p:inputText id="logradouro-endereco"
                                             title="Digite o logradouro."
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.logradouro}"
                                             maxlength="255"
                                             size="70"/>


                                <h:outputText value="Complemento:"/>
                                <p:inputText id="complemento-endereco"
                                             title="Digite o complemento."
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.complemento}"
                                             maxlength="255"
                                             size="70"/>


                                <fc:outputLabelObrigatorio value="Número:"/>
                                <p:inputText id="numero-endereco"
                                             title="Digite o número."
                                             value="#{faseConcursoControlador.provaSelecionada.enderecoCorreio.numero}"
                                             maxlength="255"
                                             size="12"/>
                            </h:panelGrid>
                        </p:outputPanel>
                    </p:tab>

                    <p:tab title="Horários">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Data e Horário Inicial:"/>
                            <p:calendar id="inicio-prova"
                                        title="Informe o início de vigência do concurso."
                                        value="#{faseConcursoControlador.provaSelecionada.inicio}"
                                        onkeypress="mascara(this, mDataHora)"
                                        maxlength="16"
                                        size="20"
                                        style="text-align: right"
                                        autocomplete="off"
                                        locale="pt_BR" navigator="true" pattern="dd/MM/yyyy HH:mm"/>

                            <fc:outputLabelObrigatorio value="Data e Horário Final:"/>
                            <p:calendar id="fim-prova"
                                        title="Informe o início de vigência do concurso."
                                        value="#{faseConcursoControlador.provaSelecionada.fim}"
                                        onkeypress="mascara(this, mDataHora)"
                                        maxlength="16"
                                        size="20"
                                        style="text-align: right"
                                        autocomplete="off"
                                        locale="pt_BR" navigator="true" pattern="dd/MM/yyyy HH:mm"/>
                        </h:panelGrid>
                    </p:tab>
                </p:tabView>

                <div class="alinhamentoCentralizado mtop05">
                    <p:commandButton value="Confirmar"
                                     icon="ui-icon-check"
                                     styleClass="prioritario operacao mrig05"
                                     process="form-dialog-prova"
                                     update=":form-dialog-visualizacao-provas"
                                     actionListener="#{faseConcursoControlador.confirmarProva()}"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide();"/>

                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-close"
                                     styleClass="operacao"
                                     process="@this"
                                     update="@none"
                                     onclick="dialogNovaProva.hide();"/>
                </div>
            </h:form>
        </p:dialog>
        <p:dialog widgetVar="dialogNovoAnexo"
                  header="Anexo"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  closable="false">
            <h:form id="form-dialog-anexo">
                <h:panelGrid columns="2">
                    <h:outputText value="Fase Selecionada:"/>
                    <h:outputText value="#{faseConcursoControlador.faseSelecionada}" styleClass="negrito"/>
                </h:panelGrid>

                <p:separator styleClass="mtop05 mbot05"/>

                <p:tabView style="min-width: 800px; min-height: 240px;">
                    <p:tab title="Dados Gerais">
                        <h:panelGrid columns="2">
                            <fc:outputLabelObrigatorio value="Arquivo:"/>
                            <h:panelGroup>
                                <p:fileUpload mode="advanced"
                                              auto="true"
                                              update="tabela-anexos-fase"
                                              label="Selecionar"
                                              id="bt-upload-arquivo"
                                              styleClass="somenteBotao mrig02"
                                              sizeLimit="15728640"
                                              multiple="true"
                                              allowTypes="/(\.|\/)(doc|docx|pdf)$/"
                                              invalidSizeMessage="O tamanho do arquivo é inválido, o tamanho do arquivo não pode ser superior a 10Mb."
                                              invalidFileMessage="O tipo do arquivo é inválido."
                                              style="z-index : 0;"
                                              fileUploadListener="#{faseConcursoControlador.enviarArquivo}">
                                </p:fileUpload>

                            </h:panelGroup>


                        </h:panelGrid>

                        <p:dataTable paginator="true"
                                     id="tabela-anexos-fase"
                                     rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                                     rowIndexVar="rowIx"
                                     styleClass="mtop05"
                                     emptyMessage="Não foram localizados registros para serem apresentados"
                                     value="#{faseConcursoControlador.anexosFase}"
                                     rows="10"
                                     paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ANEXOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                                     rowsPerPageTemplate="10,25,50,100"
                                     var="anexo">

                            <p:column headerText="Ações"
                                      rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                                      style="text-align: center; width: 90px;">
                                <p:commandButton icon="ui-icon-trash"
                                                 process="@this"
                                                 onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                                 oncomplete="aguarde.hide()"
                                                 actionListener="#{faseConcursoControlador.removerAnexoFase(anexo)}"
                                                 title="Clique para remover este registro."
                                                 update="tabela-anexos-fase"
                                                 styleClass="mrig05"/>
                            </p:column>

                            <p:column headerText="Arquivo" styleClass="alinhamentoCentralizado">
                                <h:outputText value="#{anexo.arquivo}"
                                              styleClass="negrito"/>
                            </p:column>
                            <p:column headerText="">
                                <p:commandButton icon="ui-icon-circle-arrow-s"
                                                 ajax="false"
                                                 styleClass="icone_azul mrig05"
                                                 disabled="#{anexo.arquivo eq null}"
                                                 action="log"
                                                 onclick="PrimeFaces.monitorDownload(start, stop)">
                                    <p:fileDownload
                                        value="#{faseConcursoControlador.baixarAnexo(anexo.arquivo)}"/>
                                </p:commandButton>

                            </p:column>
                        </p:dataTable>

                    </p:tab>
                </p:tabView>

                <div class="alinhamentoCentralizado mtop05">
                    <p:commandButton value="Confirmar"
                                     icon="ui-icon-check"
                                     styleClass="prioritario operacao mrig05"
                                     process="form-dialog-anexo"
                                     update=":form-dialog-anexo"
                                     actionListener="#{faseConcursoControlador.confirmarAnexos}"
                                     onclick="aguarde.show();"
                                     oncomplete="aguarde.hide();dialogNovoAnexo.hide();"/>

                    <p:commandButton value="Cancelar"
                                     icon="ui-icon-close"
                                     styleClass="operacao"
                                     process="@this"
                                     update="@none"
                                     onclick="dialogNovoAnexo.hide();"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="visualizacaoProvasDialog"
                  header="Visualização de Provas"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  closable="false">
            <h:form id="form-dialog-visualizacao-provas">
                <h:panelGrid columns="2">
                    <h:outputText value="Fase Selecionada:"/>
                    <h:outputText value="#{faseConcursoControlador.faseSelecionada}" styleClass="negrito"/>
                </h:panelGrid>

                <p:separator styleClass="mtop05 mbot05"/>

                <h:outputText value="*Observação: Só é permitido remover provas não avaliadas."
                              styleClass="negrito mtop10"/>

                <p:dataTable paginator="true"
                             id="tabela-provas"
                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                             rowIndexVar="rowIx"
                             styleClass="mtop05"
                             emptyMessage="Não foram localizados registros para serem apresentados"
                             value="#{faseConcursoControlador.faseSelecionada.provasOrdenadas}"
                             rows="10"
                             paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>PROVAS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                             rowsPerPageTemplate="10,25,50,100"
                             var="prova">

                    <p:column headerText="Ações"
                              rendered="#{faseConcursoControlador.isOperacaoNovo() or faseConcursoControlador.isOperacaoEditar()}"
                              style="text-align: center; width: 90px;">
                        <p:commandButton icon="ui-icon-pencil"
                                         process="@this"
                                         update=":form-dialog-prova"
                                         onclick="aguarde.show()"
                                         oncomplete="dialogNovaProva.show(); aguarde.hide();"
                                         actionListener="#{faseConcursoControlador.selecionarProva(prova)}"
                                         title="Clique para poder editar este registro."
                                         styleClass="mrig05"/>

                        <p:commandButton icon="ui-icon-trash"
                                         process="@this"
                                         onclick="if (!confirm('Tem certeza que deseja remover este registro?')) {return false; } else {aguarde.show();}"
                                         oncomplete="aguarde.hide()"
                                         disabled="#{prova.temAvaliacao()}"
                                         actionListener="#{faseConcursoControlador.removerProva(prova)}"
                                         title="Clique para remover este registro."
                                         update="tabela-provas"
                                         styleClass="mrig05"/>
                    </p:column>

                    <p:column headerText="Avaliada?" styleClass="alinhamentoCentralizado" style="width: 60px;">
                        <h:outputText value="#{faseConcursoControlador.getValueColunaAvaliada(prova)}"
                                      styleClass="negrito"/>
                    </p:column>

                    <p:column headerText="Prova" styleClass="alinhamentoEsquerda" style="width: 150px;">
                        <h:outputText value="#{prova.nome}"/>
                    </p:column>

                    <p:column headerText="Cargo" styleClass="alinhamentoEsquerda" style="width: 150px;">
                        <h:outputText value="#{prova.cargoConcurso.cargo}"/>
                    </p:column>

                    <p:column headerText="Inicio" styleClass="alinhamentoCentralizado">
                        <h:outputText value="#{prova.inicio}">
                            <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Fim" styleClass="alinhamentoCentralizado">
                        <h:outputText value="#{prova.fim}">
                            <f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Endereço" styleClass="alinhamentoCentralizado" style="width: 150px;">
                        <h:outputText value="[PARE O MOUSE AQUI]"
                                      id="label-endereco"/>

                        <p:tooltip for="label-endereco"
                                   style="border : solid black 1px;">
                            <h:panelGrid columns="2">
                                <h:outputText value="CEP:"/>
                                <h:outputText value="#{prova.enderecoCorreio.cep}"/>

                                <h:outputText value="Estado:"/>
                                <h:outputText value="#{prova.enderecoCorreio.uf}"/>

                                <h:outputText value="Cidade:"/>
                                <h:outputText value="#{prova.enderecoCorreio.localidade}"/>

                                <h:outputText value="Bairro:"/>
                                <h:outputText value="#{prova.enderecoCorreio.bairro}"/>

                                <h:outputText value="Logradouro:"/>
                                <h:outputText value="#{prova.enderecoCorreio.logradouro}"/>

                                <h:outputText value="Complemento:"/>
                                <h:outputText value="#{prova.enderecoCorreio.complemento}"/>

                                <h:outputText value="Número:"/>
                                <h:outputText value="#{prova.enderecoCorreio.numero}"/>
                            </h:panelGrid>
                        </p:tooltip>
                    </p:column>

                    <p:column headerText="Observações" styleClass="alinhamentoCentralizado" style="width: 150px;">
                        <h:outputText value="[PARE O MOUSE AQUI]"
                                      id="label-obs-prova"/>

                        <p:tooltip for="label-obs-prova"
                                   style="border : solid black 1px;">
                            <h:outputText
                                rendered="#{prova.observacoes ne null and !prova.observacoes.trim().isEmpty()}"
                                value="#{prova.observacoes}"/>
                            <h:outputText rendered="#{prova.observacoes eq null or prova.observacoes.trim().isEmpty()}"
                                          value="** Sem Obsevações **"/>
                        </p:tooltip>
                    </p:column>
                </p:dataTable>

                <div class="alinhamentoCentralizado mtop05">
                    <p:commandButton value="Ok"
                                     icon="ui-icon-check"
                                     styleClass="prioritario operacao mrig05"
                                     process="@this"
                                     immediate="true"
                                     update="@none"
                                     actionListener="#{faseConcursoControlador.cancelarFase()}"
                                     onclick="aguarde.show();"
                                     oncomplete="visualizacaoProvasDialog.hide(); aguarde.hide();"/>
                </div>
            </h:form>
        </p:dialog>

        <p:dialog widgetVar="visualizacaoAnexosDialog"
                  header="Visualização de Anexos"
                  modal="true"
                  dynamic="true"
                  position="center"
                  style="position: fixed !important;"
                  resizable="false"
                  closable="false">
            <h:form id="form-dialog-visualizacao-anexos">
                <h:panelGrid columns="2">
                    <h:outputText value="Fase Selecionada:"/>
                    <h:outputText value="#{faseConcursoControlador.faseSelecionada}" styleClass="negrito"/>
                </h:panelGrid>

                <p:separator styleClass="mtop05 mbot05"/>


                <p:dataTable paginator="true"
                             id="tabela-anexos-fase-view"
                             rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'linha-selecionada trintaAltura' : 'trintaAltura'}"
                             rowIndexVar="rowIx"
                             styleClass="mtop05"
                             emptyMessage="Não foram localizados registros para serem apresentados"
                             value="#{faseConcursoControlador.anexosFase}"
                             rows="10"
                             paginatorTemplate="{CurrentPageReport}  &lt;span class='titulo-tabela mrig10'>ANEXOS&lt;/span> {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="({startRecord} - {endRecord} de {totalRecords}, Página: {currentPage}/{totalPages})"
                             rowsPerPageTemplate="10,25,50,100"
                             var="anexo">
                    <p:column headerText="Arquivo" styleClass="alinhamentoCentralizado">
                        <h:outputText value="#{anexo.arquivo}"
                                      styleClass="negrito"/>
                    </p:column>
                    <p:column headerText="">
                        <p:commandButton icon="ui-icon-circle-arrow-s"
                                         ajax="false"
                                         styleClass="icone_azul mrig05"
                                         disabled="#{anexo.arquivo eq null}"
                                         action="log"
                                         onclick="PrimeFaces.monitorDownload(start, stop)">
                            <p:fileDownload
                                value="#{faseConcursoControlador.baixarAnexo(anexo.arquivo)}"/>
                        </p:commandButton>

                    </p:column>
                </p:dataTable>


                <div class="alinhamentoCentralizado mtop05">
                    <p:commandButton value="Ok"
                                     icon="ui-icon-check"
                                     styleClass="prioritario operacao mrig05"
                                     process="@this"
                                     update="@none"
                                     actionListener="#{faseConcursoControlador.cancelarFase()}"
                                     onclick="aguarde.show();"
                                     oncomplete="visualizacaoAnexosDialog.hide(); aguarde.hide();"/>
                </div>
            </h:form>
        </p:dialog>

        <fc:aguarde widgetVar="aguardeMensagemUsuario"
                    texto="Por favor aguarde, recuperando fases do concurso selecionado."/>
    </ui:define>
</ui:composition>
</html>
