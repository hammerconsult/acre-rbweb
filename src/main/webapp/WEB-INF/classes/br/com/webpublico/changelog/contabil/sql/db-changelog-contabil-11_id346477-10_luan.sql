DECLARE
texto CLOB := '{"consulta":"select\r\n    c.numeroContrato as numeroContrato,\r\n    c.numeroProcesso as numeroProcesso,\r\n    ex.ano as exercicio,\r\n    coalesce(pf.nome, pj.razaosocial) as fornecedor,\r\n    c.objeto as objeto,\r\n    trunc(c.dataAssinatura) as dataAssinatura,\r\n    case\r\n        when disp.modalidade is not null then disp.modalidade\r\n        when regExt.modalidadeCarona is not null then regExt.modalidadeCarona\r\n        when lic.modalidadeLicitacao is not null then lic.modalidadeLicitacao\r\n        when cv.modalidade is not null then cv.modalidade\r\n    end as modalidade,\r\n    vwAdm.codigo || '' - '' || vwAdm.descricao as secretaria,\r\n    c.valorTotal as valor,\r\n    trunc(c.terminoVigenciaAtual) as prazoVigencia,\r\n    c.localEntrega as localEntrega,\r\n    case\r\n        when lic.id is not null then lic.numeroLicitacao || ''/'' || exLic.ano || '' - '' || lic.resumoDoObjeto\r\n        when disp.id is not null then disp.numeroDaDispensa || ''/'' || exDisp.ano || '' - '' || disp.resumoDoObjeto\r\n        when regExt.id is not null then regExt.numeroRegistro || ''/'' || exRegExt.ano || '' - '' || regExt.objeto\r\n    end as processoLicitatorio,\r\n    coalesce(lic.id, disp.id, regExt.id) as idProcessoLicitatorio\r\nfrom contrato c\r\n    inner join exercicio ex on ex.id = c.exercicioContrato_id\r\n    inner join pessoa p on p.id = c.contratado_id\r\n    left join unidadecontrato uc on uc.contrato_id = c.id\r\n          and trunc(terminoVigencia) between trunc(uc.iniciovigencia) and coalesce(trunc(uc.fimvigencia), trunc(terminoVigencia))\r\n    left join UnidadeOrganizacional uo on uo.id = uc.unidadeAdministrativa_id\r\n    left join entidade ent on ent.id = uo.entidade_id\r\n    left join vwhierarquiaadministrativa vwAdm on vwAdm.subordinada_id = uo.id\r\n          and trunc(terminoVigencia) between trunc(vwAdm.iniciovigencia) and coalesce(trunc(vwAdm.fimvigencia), trunc(terminoVigencia))\r\n    left join pessoafisica pf on p.id = pf.id\r\n    left join pessoajuridica pj on p.id = pj.id\r\n    left join conlicitacao conlic on c.id = conlic.CONTRATO_ID\r\n    left join licitacao lic on conlic.licitacao_id = lic.id\r\n    left join exercicio exLic on exLic.id = lic.exercicio_id\r\n    left join condispensalicitacao conDisp on condisp.contrato_id = c.id\r\n    left join dispensadelicitacao disp on disp.id = condisp.dispensadelicitacao_id\r\n    left join exercicio exDisp on exDisp.id = disp.exercicioDaDispensa_id\r\n    left join CONREGPRECOEXTERNO conReg on conreg.contrato_id = c.id\r\n    left join REGISTROSOLMATEXT regExt on regExt.id = conreg.regsolmatext_id\r\n    left join exercicio exRegExt on exRegExt.id = regExt.exercicioRegistro_id\r\n    left join ContratosVigente cv on cv.contrato_id = c.id\r\nwhere ex.ano = $ANO $WHERE\r\norder by to_number(c.numerocontrato)\r\n","count":"select count (1)\r\nfrom contrato c\r\n    inner join exercicio ex on ex.id = c.exercicioContrato_id\r\n    inner join pessoa p on p.id = c.contratado_id\r\n    left join unidadecontrato uc on uc.contrato_id = c.id\r\n          and trunc(terminoVigencia) between trunc(uc.iniciovigencia) and coalesce(trunc(uc.fimvigencia), trunc(terminoVigencia))\r\n    left join UnidadeOrganizacional uo on uo.id = uc.unidadeAdministrativa_id\r\n    left join entidade ent on ent.id = uo.entidade_id\r\n    left join vwhierarquiaadministrativa vwAdm on vwAdm.subordinada_id = uo.id\r\n          and trunc(terminoVigencia) between trunc(vwAdm.iniciovigencia) and coalesce(trunc(vwAdm.fimvigencia), trunc(terminoVigencia))\r\n    left join pessoafisica pf on p.id = pf.id\r\n    left join pessoajuridica pj on p.id = pj.id\r\n    left join conlicitacao conlic on c.id = conlic.CONTRATO_ID\r\n    left join licitacao lic on conlic.licitacao_id = lic.id\r\n    left join exercicio exLic on exLic.id = lic.exercicio_id\r\n    left join condispensalicitacao conDisp on condisp.contrato_id = c.id\r\n    left join dispensadelicitacao disp on disp.id = condisp.dispensadelicitacao_id\r\n    left join exercicio exDisp on exDisp.id = disp.exercicioDaDispensa_id\r\n    left join CONREGPRECOEXTERNO conReg on conreg.contrato_id = c.id\r\n    left join REGISTROSOLMATEXT regExt on regExt.id = conreg.regsolmatext_id\r\n    left join exercicio exRegExt on exRegExt.id = regExt.exercicioRegistro_id\r\n    left join ContratosVigente cv on cv.contrato_id = c.id\r\nwhere ex.ano = $ANO $WHERE","totalRegistros":0,"fields":[{"posicao":1,"descricao":"Número do Contrato","columnName":"NUMEROCONTRATO","columnValue":"NUMEROCONTRATO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Número do Processo","columnName":"NUMEROPROCESSO","columnValue":"NUMEROPROCESSO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Exercício","columnName":"EXERCICIO","columnValue":"EXERCICIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Fornecedor","columnName":"FORNECEDOR","columnValue":"FORNECEDOR","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"pessoa-ver","columnOrigem":"FORNECEDOR","columnDestino":"coalesce(pf.nome, pj.razaosocial)"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"Objeto","columnName":"OBJETO","columnValue":"OBJETO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"Data de Assinatura","columnName":"DATAASSINATURA","columnValue":"DATAASSINATURA","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":7,"descricao":"Modalidade","columnName":"MODALIDADE","columnValue":"MODALIDADE","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"ENUM","tipoEnum":"br.com.webpublico.enums.ModalidadeLicitacao","valorPadrao":[null,"CONVITE","TOMADA_PRECO","CONCORRENCIA_PUBLICA","CONCURSO","PREGAO","DISPENSA_LICITACAO","INEXIGIBILIDADE","RDC"],"escondido":false},{"posicao":8,"descricao":"Secretaria","columnName":"SECRETARIA","columnValue":"SECRETARIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"unidade-ver","columnOrigem":"SECRETARIA","columnDestino":"ho.codigo || '' - '' || ho.descricao"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":9,"descricao":"Valor","columnName":"VALOR","columnValue":"VALOR","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":10,"descricao":"Prazo de Vigência","columnName":"PRAZOVIGENCIA","columnValue":"PRAZOVIGENCIA","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":11,"descricao":"Local Entrega/Execução","columnName":"LOCALENTREGA","columnValue":"LOCALENTREGA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":12,"descricao":"Processo Licitatório","columnName":"PROCESSOLICITATORIO","columnValue":"PROCESSOLICITATORIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":{"chaveDestino":"processo-licitatorio-ver","columnOrigem":"IDPROCESSOLICITATORIO","columnDestino":"dados.idProcessoLicitatorio"},"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":13,"descricao":"IDPROCESSOLICITATORIO","columnName":"IDPROCESSOLICITATORIO","columnValue":"IDPROCESSOLICITATORIO","tipoAlinhamento":"CENTRO","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":true}],"pesquisaveis":[{"descricao":"Modalidade","columnName":"(case         when disp.modalidade is not null then disp.modalidade         when regExt.modalidadeCarona is not null then regExt.modalidadeCarona         when lic.modalidadeLicitacao is not null then lic.modalidadeLicitacao         when cv.modalidade is not null then cv.modalidade     end)","columnValue":null,"tipo":"ENUM","operacaoPadrao":null,"tipoEnum":"br.com.webpublico.enums.ModalidadeLicitacao","valorPadrao":[null,"CONVITE","TOMADA_PRECO","CONCORRENCIA_PUBLICA","CONCURSO","PREGAO","DISPENSA_LICITACAO","INEXIGIBILIDADE","RDC"],"tipoMultiSelect":null},{"descricao":"Secretaria","columnName":"vwAdm.subordinada_id","columnValue":null,"tipo":"MULTI_SELECT","operacaoPadrao":null,"tipoEnum":null,"valorPadrao":"","tipoMultiSelect":"UNIDADE_ADMINISTRATIVA"},{"descricao":"Objeto","columnName":"c.objeto","columnValue":null,"tipo":"STRING","operacaoPadrao":null,"tipoEnum":null,"valorPadrao":"","tipoMultiSelect":null}],"tabs":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Contrato' and CHAVE = 'contrato';
END;
