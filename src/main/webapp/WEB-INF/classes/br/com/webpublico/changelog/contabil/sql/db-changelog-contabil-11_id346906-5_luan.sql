DECLARE
texto CLOB := '{"consulta":"select\r\n    vw.codigo || '' - '' || vw.descricao as unidade,\r\n    coalesce(b.descricao, obj.descricao) as descricao,\r\n    obj.TIPOAQUISICAOOBJETOFROTA       as tipoAquisicaoOF,\r\n    obj.DATAFINALGARANTIA              as dataFinalGarantia,\r\n    case when coalesce(obj.cedido, 0) = 0 then ''Não'' else ''Sim'' end as cedido,\r\n    v.PLACA                            as placa,\r\n    v.ANOFABRICACAO                    as anoFabricacao,\r\n    v.KMAQUISICAO                      as kmAquisicao,\r\n    v.KMFIMGARANTIA                    as kmFimGarantia,\r\n    ct.numerotermo                     as contrato_numero\r\nfrom veiculo v\r\n         inner join objetofrota obj on obj.id = v.id\r\n         inner join unidadeobjetofrota ubf on ubf.objetofrota_id = obj.id\r\n         inner join vwhierarquiaadministrativa vw on vw.subordinada_id = ubf.unidadeorganizacional_id\r\n         left join bem b on obj.bem_id = b.id\r\n         left join contrato ct on obj.contrato_id = ct.id\r\n         left join cor c on v.cor_id = c.id\r\nwhere sysdate between vw.inicioVigencia and coalesce(vw.fimVigencia, sysdate)\r\n  and sysdate between trunc(ubf.inicioVigencia) and coalesce(trunc(ubf.fimVigencia), sysdate)\r\n  $WHERE","count":"select count(v.id)\r\nfrom veiculo v\r\n         inner join objetofrota obj on obj.id = v.id\r\n         inner join unidadeobjetofrota ubf on ubf.objetofrota_id = obj.id\r\n         inner join vwhierarquiaadministrativa vw on vw.subordinada_id = ubf.unidadeorganizacional_id\r\n         left join bem b on obj.bem_id = b.id\r\n         left join contrato ct on obj.contrato_id = ct.id\r\n         left join cor c on v.cor_id = c.id\r\nwhere sysdate between vw.inicioVigencia and coalesce(vw.fimVigencia, sysdate)\r\n  and sysdate between trunc(ubf.inicioVigencia) and coalesce(trunc(ubf.fimVigencia), sysdate)\r\n  $WHERE","totalRegistros":12,"fields":[{"posicao":1,"descricao":"Unidade","columnName":"UNIDADE","columnValue":"UNIDADE","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Descrição","columnName":"DESCRICAO","columnValue":"DESCRICAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Tipo Aquisição","columnName":"TIPOAQUISICAOOF","columnValue":"TIPOAQUISICAOOF","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"ENUM","tipoEnum":"br.com.webpublico.enums.TipoAquisicaoObjetoFrota","valorPadrao":[null,"PROPRIO","ALUGADO"],"escondido":false,"agrupador":false},{"posicao":4,"descricao":"Data Final da Garantia","columnName":"DATAFINALGARANTIA","columnValue":"DATAFINALGARANTIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":5,"descricao":"Cedido","columnName":"CEDIDO","columnValue":"CEDIDO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":6,"descricao":"Placa","columnName":"PLACA","columnValue":"PLACA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":7,"descricao":"Ano Fabricação","columnName":"ANOFABRICACAO","columnValue":"ANOFABRICACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":8,"descricao":"KM Aquisição","columnName":"KMAQUISICAO","columnValue":"KMAQUISICAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DECIMAL","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":9,"descricao":"KM Fim Garantia","columnName":"KMFIMGARANTIA","columnValue":"KMFIMGARANTIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DECIMAL","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":10,"descricao":"Número Contrato","columnName":"CONTRATO_NUMERO","columnValue":"CONTRATO_NUMERO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}],"pesquisaveis":[],"tabs":[{"titulo":"Revisões","subTitulo":"","consulta":"select\r\n    revisao.REALIZADOEM as realizadaEm,\r\n    revisao.PROGRAMADAPARA as programadaPara,\r\n    coalesce(pf.cpf, pj.cnpj)||'' - ''||coalesce(pf.nome, pj.razaoSocial) as pessoaQueRevisou,\r\n    revisao.MANUTENCAOOBJETOFROTA_ID as manutencao\r\nfrom revisaoobjetofrota revisao\r\n         inner join veiculo v on v.id = revisao.objetofrota_id\r\n         left join pessoafisica pf on revisao.revisadopor_id = pf.id\r\n         left join pessoajuridica pj on revisao.revisadopor_id = pj.id\r\n$WHERE","count":"select count(revisao.id)\r\nfrom revisaoobjetofrota revisao\r\n         inner join veiculo v on v.id = revisao.objetofrota_id\r\n         left join pessoafisica pf on revisao.revisadopor_id = pf.id\r\n         left join pessoajuridica pj on revisao.revisadopor_id = pj.id\r\n$WHERE","totalRegistros":null,"ordem":1,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Realizado em","columnName":"REALIZADAEM","columnValue":"REALIZADAEM","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Programada Para","columnName":"PROGRAMADAPARA","columnValue":"PROGRAMADAPARA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Pessoa que Revisou","columnName":"PESSOAQUEREVISOU","columnValue":"PESSOAQUEREVISOU","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":4,"descricao":"Manutenção","columnName":"MANUTENCAO","columnValue":"MANUTENCAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}]},{"titulo":"Manutenções","subTitulo":"","consulta":"select\r\n    manutencao.realizadaem as realizadaem,\r\n    manutencao.descricao as descricao,\r\n    coalesce((select man_lub.quantidade from manutencaoobjlubrificacao man_lub\r\n              where man_lub.manutencaoobjetofrota_id = manutencao.id), 0) ||'' Litro(s)'' as lubrifricacao\r\nfrom manutencaoobjetofrota manutencao\r\n         inner join veiculo v on v.id = manutencao.objetofrota_id\r\nwhere v.id is not null\r\n$WHERE","count":"select count(manutencao.id)\r\nfrom manutencaoobjetofrota manutencao\r\n         inner join veiculo v on v.id = manutencao.objetofrota_id\r\nwhere v.id is not null\r\n$WHERE","totalRegistros":null,"ordem":2,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Realizada em","columnName":"REALIZADAEM","columnValue":"REALIZADAEM","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Descrição","columnName":"DESCRICAO","columnValue":"DESCRICAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Lubrificação","columnName":"LUBRIFRICACAO","columnValue":"LUBRIFRICACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}]},{"titulo":"Taxas","subTitulo":"","consulta":"select distinct \r\n    ltv.ano as ano,\r\n    case when iltv.foipaga = 1 then ''Sim'' else ''Não'' end as foipaga,\r\n    iltv.datavencimento as datavencimento,\r\n    tv.descricao as descricaotaxa\r\nfrom lancamentotaxaveiculo ltv\r\ninner join itemlancamentotaxaveiculo iltv on iltv.lancamentotaxaveiculo_id = ltv.id\r\ninner join taxaveiculo tv on iltv.taxaveiculo_id = tv.id\r\ninner join veiculo v on v.id = ltv.veiculo_id\r\nwhere v.id is not null\r\n$WHERE\r\norder by ltv.ano desc, iltv.foipaga desc","count":"select count(iltv.id)\r\nfrom lancamentotaxaveiculo ltv\r\ninner join itemlancamentotaxaveiculo iltv on iltv.lancamentotaxaveiculo_id = ltv.id\r\ninner join taxaveiculo tv on iltv.taxaveiculo_id = tv.id\r\ninner join veiculo v on v.id = ltv.veiculo_id\r\nwhere v.id is not null\r\n$WHERE","totalRegistros":null,"ordem":3,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Ano","columnName":"ANO","columnValue":"ANO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Foi Paga","columnName":"FOIPAGA","columnValue":"FOIPAGA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Vencimento","columnName":"DATAVENCIMENTO","columnValue":"DATAVENCIMENTO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":4,"descricao":"Descrição","columnName":"DESCRICAOTAXA","columnValue":"DESCRICAOTAXA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}]},{"titulo":"Multas","subTitulo":"","consulta":"select\r\n    multa.emitidaEm as dataEmissao,\r\n    multa.valor as valor,\r\n    pf.cpf ||'' - ''|| pf.nome as motorista,\r\n    tmv.descricao as tipomulta_descricao,\r\n    multa.teveContestacao as contestacao,\r\n    multa.datacontestacao as dataContestacao\r\nfrom multaveiculo multa\r\n         inner join motorista mot on multa.motorista_id = mot.id\r\n         inner join pessoafisica pf on mot.pessoafisica_id = pf.id\r\n         inner join tipomultaveiculo tmv on multa.tipomulta_id = tmv.id\r\n         inner join veiculo v on v.id = multa.veiculo_id\r\nwhere v.id is not null\r\n$WHERE","count":"select count(multa.id)\r\nfrom multaveiculo multa\r\n         inner join motorista mot on multa.motorista_id = mot.id\r\n         inner join pessoafisica pf on mot.pessoafisica_id = pf.id\r\n         inner join tipomultaveiculo tmv on multa.tipomulta_id = tmv.id\r\n         inner join veiculo v on v.id = multa.veiculo_id\r\nwhere v.id is not null\r\n$WHERE","totalRegistros":null,"ordem":4,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Emissão","columnName":"DATAEMISSAO","columnValue":"DATAEMISSAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Valor","columnName":"VALOR","columnValue":"VALOR","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Motorista","columnName":"MOTORISTA","columnValue":"MOTORISTA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":4,"descricao":"Descrição","columnName":"TIPOMULTA_DESCRICAO","columnValue":"TIPOMULTA_DESCRICAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":5,"descricao":"Contestação","columnName":"CONTESTACAO","columnValue":"CONTESTACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":6,"descricao":"Data da Contestação","columnName":"DATACONTESTACAO","columnValue":"DATACONTESTACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}]},{"titulo":"Ocorrências","subTitulo":"","consulta":"select\r\n    ocorrencia.dataocorrencia as dataOcorrencia,\r\n    ocorrencia.localocorrencia as localOcorrencia,\r\n    tipo.descricao as tipo\r\nfrom ocorrenciaobjetofrota ocorrencia\r\n         left join tipoocorrenciaobjetofrota tipo on tipo.id = ocorrencia.tipoocorrenciaobjetofrota_id\r\n         inner join veiculo v on v.id = ocorrencia.objetofrota_id\r\nwhere v.id is not null\r\n$WHERE","count":"select count(ocorrencia.id)\r\nfrom ocorrenciaobjetofrota ocorrencia\r\n         left join tipoocorrenciaobjetofrota tipo on tipo.id = ocorrencia.tipoocorrenciaobjetofrota_id\r\n         inner join veiculo v on v.id = ocorrencia.objetofrota_id\r\nwhere v.id is not null\r\n$WHERE","totalRegistros":null,"ordem":5,"pesquisaveis":[],"fields":[{"posicao":1,"descricao":"Data","columnName":"DATAOCORRENCIA","columnValue":"DATAOCORRENCIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":2,"descricao":"Local","columnName":"LOCALOCORRENCIA","columnValue":"LOCALOCORRENCIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false},{"posicao":3,"descricao":"Tipo","columnName":"TIPO","columnValue":"TIPO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false,"agrupador":false}]}],"paineis":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL
set CONTEUDO = texto
where NOME = 'Detalhes do Veículo'
  and CHAVE = 'veiculo-ver';
END;
