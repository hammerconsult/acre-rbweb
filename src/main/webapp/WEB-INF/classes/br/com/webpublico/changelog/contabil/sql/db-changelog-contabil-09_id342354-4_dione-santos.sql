DECLARE
texto CLOB := '{"consulta":"select matricula,\r\n       servidor,\r\n       cargo,\r\n       unidade,\r\n       recurso,\r\n       case\r\n           when pensionista is not null then ''PENSIONISTA''\r\n           when aposentado is not null then ''APOSENTADO''\r\n           when estagiario is not null then ''ESTAGIÁRIO''\r\n           else modalidade end                                                     as vinculo,\r\n       mes,\r\n       ano,\r\n       tipodefolha,\r\n       cargahorario                                                                as ch,\r\n       dataadmissao,\r\n       coalesce(sum(vencimentobase), 0)                                            as vencimentobase,\r\n       coalesce(sum(valorbruto), 0) - coalesce(sum(vencimentobase), 0)             as outrasverbas,\r\n       coalesce(sum(valorbruto), 0)                                                as salariobruto,\r\n       coalesce(sum(valordesconto), 0)                                             as descontos,\r\n       coalesce(sum(coalesce(valorbruto, 0)) - sum(coalesce(valordesconto, 0)), 0) as salarioliquido,\r\n       coalesce(sum(valorir), 0)                                                   as impostorenda,\r\n       coalesce(sum(valorprevidencia), 0)                                          as previdencia,\r\n       coalesce(sum(valorabateteto), 0)                                            as abateteto,\r\n       coalesce(sum(valordesconto), 0) - coalesce(sum(valorir), 0) - coalesce(sum(valorprevidencia), 0) -\r\n       coalesce(sum(valorabateteto), 0)                                            as outrosdescontos,\r\n       case when gratificada is null then ''Nenhuma'' else gratificada end as gratificada\r\nfrom (select mat.matricula || ''/'' || v.numero                                                                     as matricula,\r\n             pf.nome                                                                                              as servidor,\r\n             cedencia.tipocontratocedenciafp                                                                      as modalidade,\r\n             folha.mes                                                                                            as mes,\r\n             folha.ano                                                                                            as ano,\r\n             folha.tipofolhadepagamento                                                                           as tipodefolha,\r\n             to_char(cfp.dataadmissao, ''dd/MM/yyyy'')                                                              as dataadmissao,\r\n             cargo.codigodocargo || '' - '' || cargo.descricao                                                      as cargo,\r\n             cargo.cargahoraria                                                                                   as cargahorario,\r\n             mcfp.descricao                                                                                       as vinculo,\r\n             ho.descricao                                                                                         as unidade,\r\n             recfp.descricao                                                                                      as recurso,\r\n             fg.descricao                                                                                         as gratificada,\r\n             pens.id                                                                                              as pensionista,\r\n             aposent.id                                                                                           as aposentado,\r\n             estag.id                                                                                             as estagiario,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join itembasefp itembase on itembase.eventofp_id = item.eventofp_id\r\n                       inner join basefp b on b.id = itembase.basefp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and itemficha.id = item.id\r\n                and item.tipoeventofp = ''VANTAGEM''\r\n                and b.codigo = (select conf.vencimentobaseportal\r\n                                from configuracaorh conf\r\n                                where to_date(''01/01/$ANO'', ''dd/MM/yyyy'')\r\n                                          between conf.iniciovigencia\r\n                                          and coalesce(conf.finalvigencia, to_date(''01/01/$ANO'', ''dd/MM/yyyy'')))) as vencimentobase,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.identificacaoeventofp in (''RPPS'', ''INSS''))                                                  as valorprevidencia,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.codigo in (635))                                                                            as valorabateteto,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.identificacaoeventofp = ''IMPOSTO_RENDA'')                                                    as valorir,\r\n\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''VANTAGEM'')                                                               as valorbruto,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO'')                                                               as valordesconto\r\n      from vinculofp v\r\n               inner join matriculafp mat on mat.id = v.matriculafp_id\r\n               inner join pessoafisica pf on pf.id = mat.pessoa_id\r\n               left join pessoajuridica pj on mat.pessoa_id = pj.id\r\n               inner join fichafinanceirafp ff on ff.vinculofp_id = v.id\r\n               inner join folhadepagamento folha on folha.id = ff.folhadepagamento_id\r\n               inner join itemfichafinanceirafp itemficha on itemficha.fichafinanceirafp_id = ff.id\r\n               inner join unidadeorganizacional uo on uo.id = ff.unidadeorganizacional_id\r\n               inner join recursofp recfp on recfp.id = ff.recursofp_id\r\n               inner join vwhierarquiaadministrativa ho on ho.subordinada_id = uo.id\r\n               left join cedenciacontratofp cedencia on cedencia.contratofp_id = v.id\r\n               left join aposentadoria aposent on aposent.id = v.id\r\n               left join pensionista pens on pens.id = v.id\r\n               left join entidade ent on ent.id = uo.entidade_id\r\n               left join pensao pen on pen.id = pens.pensao_id\r\n               left join estagiario estag on estag.id = v.id\r\n               left join contratofp cfp on cfp.id = coalesce(aposent.contratofp_id, pen.contratofp_id, estag.id, v.id)\r\n               left join cargo on cfp.cargo_id = cargo.id\r\n               left join modalidadecontratofp mcfp on cfp.modalidadecontratofp_id = mcfp.id\r\n               left join funcaogratificada fg on cfp.id = fg.contratofp_id\r\n      where trunc(folha.efetivadaem) between to_date(''01/01/$ANO'', ''dd/MM/yyyy'') and to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n        and uo.id in (select unidade_id from unidadeprefeituraportal where prefeitura_id = $PREFEITURAPORTAL_ID)\r\n        and trunc(folha.efetivadaem) between ho.iniciovigencia and coalesce(ho.fimvigencia, trunc(folha.efetivadaem))\r\n        and folha.ano = $ANO\r\n          $WHERE) dados\r\ngroup by servidor, cargo, vinculo, cargahorario, matricula, modalidade, mes, ano, tipodefolha, dataadmissao, unidade, pensionista, aposentado, estagiario,\r\n         recurso, gratificada\r\norder by servidor","count":"select count(1) from (\r\nselect matricula,\r\n       servidor,\r\n       cargo,\r\n       unidade,\r\n       recurso,\r\n       vinculo,\r\n       mes,\r\n       ano,\r\n       tipodefolha,\r\n       cargahorario                                                                as ch,\r\n       dataadmissao,\r\n       coalesce(sum(vencimentobase), 0)                                            as vencimentobase,\r\n       coalesce(sum(valorbruto), 0) - coalesce(sum(vencimentobase), 0)             as outrasverbas,\r\n       coalesce(sum(valorbruto), 0)                                                as salariobruto,\r\n       coalesce(sum(valordesconto), 0)                                             as descontos,\r\n       coalesce(sum(coalesce(valorbruto, 0)) - sum(coalesce(valordesconto, 0)), 0) as salarioliquido,\r\n       coalesce(sum(valorir), 0)                                                   as impostorenda,\r\n       coalesce(sum(valorprevidencia), 0)                                          as previdencia,\r\n       coalesce(sum(valorabateteto), 0)                                            as abateteto,\r\n       coalesce(sum(valordesconto), 0) - coalesce(sum(valorir), 0) - coalesce(sum(valorprevidencia), 0) -\r\n       coalesce(sum(valorabateteto), 0)                                            as outrosdescontos,\r\n       gratificada\r\nfrom (select mat.matricula || ''/'' || v.numero                                                                     as matricula,\r\n             pf.nome                                                                                              as servidor,\r\n             cedencia.tipocontratocedenciafp                                                                      as modalidade,\r\n             folha.mes                                                                                            as mes,\r\n             folha.ano                                                                                            as ano,\r\n             folha.tipofolhadepagamento                                                                           as tipodefolha,\r\n             to_char(cfp.dataadmissao, ''dd/MM/yyyy'')                                                              as dataadmissao,\r\n             cargo.codigodocargo || '' - '' || cargo.descricao                                                      as cargo,\r\n             cargo.cargahoraria                                                                                   as cargahorario,\r\n             mcfp.descricao                                                                                       as vinculo,\r\n             ho.descricao                                                                                         as unidade,\r\n             recfp.descricao                                                                                      as recurso,\r\n             fg.descricao                                                                                         as gratificada,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join itembasefp itembase on itembase.eventofp_id = item.eventofp_id\r\n                       inner join basefp b on b.id = itembase.basefp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and itemficha.id = item.id\r\n                and item.tipoeventofp = ''VANTAGEM''\r\n                and b.codigo = (select conf.vencimentobaseportal\r\n                                from configuracaorh conf\r\n                                where to_date(''01/01/$ANO'', ''dd/MM/yyyy'')\r\n                                          between conf.iniciovigencia\r\n                                          and coalesce(conf.finalvigencia, to_date(''01/01/$ANO'', ''dd/MM/yyyy'')))) as vencimentobase,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.identificacaoeventofp in (''RPPS'', ''INSS''))                                                  as valorprevidencia,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.codigo in (635))                                                                            as valorabateteto,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n                       inner join eventofp e on e.id = item.eventofp_id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO''\r\n                and e.identificacaoeventofp = ''IMPOSTO_RENDA'')                                                    as valorir,\r\n\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''VANTAGEM'')                                                               as valorbruto,\r\n             (select sum(item.valor)\r\n              from folhadepagamento folha\r\n                       inner join fichafinanceirafp ficha on ficha.folhadepagamento_id = folha.id\r\n                       inner join itemfichafinanceirafp item on item.fichafinanceirafp_id = ficha.id\r\n              where ficha.vinculofp_id = v.id\r\n                and item.id = itemficha.id\r\n                and item.tipoeventofp = ''DESCONTO'')                                                               as valordesconto\r\n      from vinculofp v\r\n               inner join matriculafp mat on mat.id = v.matriculafp_id\r\n               inner join pessoafisica pf on pf.id = mat.pessoa_id\r\n               left join pessoajuridica pj on mat.pessoa_id = pj.id\r\n               inner join fichafinanceirafp ff on ff.vinculofp_id = v.id\r\n               inner join folhadepagamento folha on folha.id = ff.folhadepagamento_id\r\n               inner join itemfichafinanceirafp itemficha on itemficha.fichafinanceirafp_id = ff.id\r\n               inner join unidadeorganizacional uo on uo.id = ff.unidadeorganizacional_id\r\n               inner join recursofp recfp on recfp.id = ff.recursofp_id\r\n               inner join vwhierarquiaadministrativa ho on ho.subordinada_id = uo.id\r\n               left join cedenciacontratofp cedencia on cedencia.contratofp_id = v.id\r\n               left join aposentadoria aposent on aposent.id = v.id\r\n               left join pensionista pens on pens.id = v.id\r\n               left join entidade ent on ent.id = uo.entidade_id\r\n               left join pensao pen on pen.id = pens.pensao_id\r\n               left join estagiario estag on estag.id = v.id\r\n               left join contratofp cfp on cfp.id = coalesce(aposent.contratofp_id, pen.contratofp_id, estag.id, v.id)\r\n               left join cargo on cfp.cargo_id = cargo.id\r\n               left join modalidadecontratofp mcfp on cfp.modalidadecontratofp_id = mcfp.id\r\n               left join funcaogratificada fg on cfp.id = fg.contratofp_id\r\n      where trunc(folha.efetivadaem) between to_date(''01/01/$ANO'', ''dd/MM/yyyy'') and to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n        and uo.id in (select unidade_id from unidadeprefeituraportal where prefeitura_id = $PREFEITURAPORTAL_ID)\r\n        and trunc(folha.efetivadaem) between ho.iniciovigencia and coalesce(ho.fimvigencia, trunc(folha.efetivadaem))\r\n        and folha.ano = $ANO\r\n          $WHERE) dados\r\ngroup by servidor, cargo, vinculo, cargahorario, matricula, modalidade, mes, ano, tipodefolha, dataadmissao, unidade,\r\n         recurso, gratificada\r\norder by servidor)","totalRegistros":23906,"fields":[{"posicao":1,"descricao":"MATRìCULA/CONTRATO","columnName":"matricula","columnValue":"MATRICULA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"SERVIDOR","columnName":"servidor","columnValue":"SERVIDOR","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"CARGO","columnName":"cargo","columnValue":"CARGO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"LOTAÇÃO","columnName":"unidade","columnValue":"LOTACAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"RECURSO","columnName":"RECURSO","columnValue":"RECURSO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"VINCULO","columnName":"VINCULO","columnValue":"VINCULO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":7,"descricao":"MÊS","columnName":"MES","columnValue":"MES","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":8,"descricao":"EXERCÍCIO","columnName":"ano","columnValue":"EXERCICIO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":9,"descricao":"TIPO DE FOLHA","columnName":"TIPODEFOLHA","columnValue":"TIPODEFOLHA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"ENUM","tipoEnum":"br.com.webpublico.enums.TipoFolhaDePagamento","valorPadrao":[null,"NORMAL","COMPLEMENTAR","FERIAS","SALARIO_13","RESCISAO","ADIANTAMENTO_NORMAL","ADIANTAMENTO_FERIAS","ADIANTAMENTO_13_SALARIO","RESCISAO_COMPLEMENTAR","MANUAL"],"escondido":false},{"posicao":10,"descricao":"CARGA HORÁRIA","columnName":"ch","columnValue":"CARGAHORARIA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"INTEGER","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":11,"descricao":"ADMISSÃO","columnName":"dataadmissao","columnValue":"ADMISSAO","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"DATE","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":12,"descricao":"VENCIMENTOS","columnName":"vencimentobase","columnValue":"VENCIMENTO","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":13,"descricao":"OUTRAS VERBAS","columnName":"OUTRASVERBAS","columnValue":"OUTRASVERBAS","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":14,"descricao":"SALÁRIO BRUTO","columnName":"SALARIOBRUTO","columnValue":"SALARIOBRUTO","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":15,"descricao":"DESCONTOS","columnName":"DESCONTOS","columnValue":"DESCONTOS","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":16,"descricao":"SALÁRIO LIQUÍDO","columnName":"SALARIOLIQUIDO","columnValue":"SALARIOLIQUIDO","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":17,"descricao":"IMPOSTO DE RENDA","columnName":"impostorenda","columnValue":"IMPOSTODERENDA","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":18,"descricao":"PREVIDÊNCIA","columnName":"PREVIDENCIA","columnValue":"PREVIDENCIA","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":19,"descricao":"ABATE TETO","columnName":"ABATETETO","columnValue":"ABATETETO","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":20,"descricao":"OUTROS DESCONTOS","columnName":"OUTROSDESCONTOS","columnValue":"OUTROSDESCONTOS","tipoAlinhamento":"ESQUERDA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":21,"descricao":"FUNÇÃO GRATIFICADA","columnName":"gratificada","columnValue":"gratificada","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false}],"pesquisaveis":[],"tabs":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Ver Pessoal';
END;
