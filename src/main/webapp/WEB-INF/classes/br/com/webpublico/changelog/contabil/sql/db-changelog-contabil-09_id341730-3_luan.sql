DECLARE
texto CLOB := '{"consulta":"select cDesp.codigo || '' - '' || cDesp.descricao as contaDespesa,\r\n       sum(orcado) as orcado,\r\n       sum(atualizado) as atualizado,\r\n       sum(empenhado) as empenhado,\r\n       sum(liquidado) as liquidado,\r\n       sum(pago) as pago\r\nfrom (select pro.contadedespesa_id as idContaDeDespesa,\r\n             pro.unidadeOrganizacional_id as idUnidade,\r\n             sum(proFonte.valor) as orcado,\r\n             sum(proFonte.valor) as atualizado,\r\n             0                   as empenhado,\r\n             0                   as liquidado,\r\n             0                   as pago\r\n      from provisaoPPAFonte proFonte\r\n               inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n               inner join subacaoppa sub ON sub.id = pro.subacaoppa_id\r\n               inner join PROVISAOPPA provPpa ON sub.PROVISAOPPA_ID = provPpa.ID\r\n               inner join exercicio ex ON provPpa.exercicio_id = ex.ID\r\n      where ex.ano = $ANO\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(supOrc.valor) as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from suplementacaoorc supOrc\r\n          inner join fonteDespesaORC fdOrc on supOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join alteracaoORC alt on supOrc.alteracaoORC_id = alt.id\r\n      where trunc(alt.dataAlteracao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(anuOrc.valor)*-1 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from anulacaoorc anuOrc\r\n          inner join fonteDespesaORC fdOrc on anuOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join alteracaoORC alt on anuOrc.alteracaoORC_id = alt.id\r\n      where trunc(alt.dataAlteracao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(supOrc.valor)*-1 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from estornoSuplementacaoOrc est\r\n          inner join suplementacaoorc supOrc on est.suplementacaoorc_id = supOrc.id\r\n          inner join fonteDespesaORC fdOrc on supOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join estornoAlteracaoOrc estAlt on est.estornoAlteracaoOrc_id = estAlt.id\r\n      where trunc(estAlt.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(anuOrc.valor) as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from estornoAnulacaoOrc est\r\n          inner join anulacaoorc anuOrc on est.anulacaoorc_id = anuOrc.id\r\n          inner join fonteDespesaORC fdOrc on anuOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join estornoAlteracaoOrc estAlt on est.estornoAlteracaoOrc_id = estAlt.id\r\n      where trunc(estAlt.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          emp.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          sum(emp.valor) as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from empenho emp\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where emp.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(emp.dataEmpenho) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, emp.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          sum(est.valor *-1) as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from empenhoestorno est\r\n          inner join empenho emp on est.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where emp.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          liq.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          sum(liq.valor) as liquidado,\r\n          0 as pago\r\n      from liquidacao liq\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where liq.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(liq.dataLiquidacao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, liq.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          sum(est.valor *-1) as liquidado,\r\n          0 as pago\r\n      from liquidacaoestorno est\r\n          inner join liquidacao liq on est.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where liq.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          pag.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          sum(pag.valor) as pago\r\n      from pagamento pag\r\n          inner join liquidacao liq on pag.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where pag.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(pag.dataPagamento) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, pag.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          sum(est.valor *-1) as pago\r\n      from pagamentoestorno est\r\n          inner join pagamento pag on est.pagamento_id = pag.id\r\n          inner join liquidacao liq on pag.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where pag.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n     ) dados\r\n         inner join vwhierarquiaorcamentaria vw ON dados.idUnidade = vw.subordinada_id\r\n         inner join conta cDesp ON dados.idContaDeDespesa = cDesp.id\r\nwhere dados.idUnidade in (select UNIDADE_ID from UNIDADEPREFEITURAPORTAL where PREFEITURA_ID = $PREFEITURAPORTAL_ID)\r\n  and to_date(''01/01/$ANO'', ''dd/MM/yyyy'') BETWEEN vw.iniciovigencia and coalesce(vw.fimvigencia, to_date(''01/01/$ANO'', ''dd/MM/yyyy''))\r\n    $WHERE\r\ngroup by cDesp.codigo || '' - '' || cDesp.descricao\r\norder by cDesp.codigo || '' - '' || cDesp.descricao","count":"select count(1) from (\r\nselect cDesp.codigo || '' - '' || cDesp.descricao as contaDespesa,\r\n       sum(orcado) as orcado,\r\n       sum(atualizado) as atualizado,\r\n       sum(empenhado) as empenhado,\r\n       sum(liquidado) as liquidado,\r\n       sum(pago) as pago\r\nfrom (select pro.contadedespesa_id as idContaDeDespesa,\r\n             pro.unidadeOrganizacional_id as idUnidade,\r\n             sum(proFonte.valor) as orcado,\r\n             sum(proFonte.valor) as atualizado,\r\n             0                   as empenhado,\r\n             0                   as liquidado,\r\n             0                   as pago\r\n      from provisaoPPAFonte proFonte\r\n               inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n               inner join subacaoppa sub ON sub.id = pro.subacaoppa_id\r\n               inner join PROVISAOPPA provPpa ON sub.PROVISAOPPA_ID = provPpa.ID\r\n               inner join exercicio ex ON provPpa.exercicio_id = ex.ID\r\n      where ex.ano = $ANO\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(supOrc.valor) as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from suplementacaoorc supOrc\r\n          inner join fonteDespesaORC fdOrc on supOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join alteracaoORC alt on supOrc.alteracaoORC_id = alt.id\r\n      where trunc(alt.dataAlteracao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(anuOrc.valor)*-1 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from anulacaoorc anuOrc\r\n          inner join fonteDespesaORC fdOrc on anuOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join alteracaoORC alt on anuOrc.alteracaoORC_id = alt.id\r\n      where trunc(alt.dataAlteracao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(supOrc.valor)*-1 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from estornoSuplementacaoOrc est\r\n          inner join suplementacaoorc supOrc on est.suplementacaoorc_id = supOrc.id\r\n          inner join fonteDespesaORC fdOrc on supOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join estornoAlteracaoOrc estAlt on est.estornoAlteracaoOrc_id = estAlt.id\r\n      where trunc(estAlt.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select pro.contadedespesa_id as idContaDeDespesa,\r\n          pro.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          sum(anuOrc.valor) as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from estornoAnulacaoOrc est\r\n          inner join anulacaoorc anuOrc on est.anulacaoorc_id = anuOrc.id\r\n          inner join fonteDespesaORC fdOrc on anuOrc.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join provisaoPPADespesa pro on proFonte.provisaoPPADespesa_id = pro.id\r\n          inner join estornoAlteracaoOrc estAlt on est.estornoAlteracaoOrc_id = estAlt.id\r\n      where trunc(estAlt.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by pro.contadedespesa_id, pro.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          emp.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          sum(emp.valor) as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from empenho emp\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where emp.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(emp.dataEmpenho) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, emp.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          sum(est.valor *-1) as empenhado,\r\n          0 as liquidado,\r\n          0 as pago\r\n      from empenhoestorno est\r\n          inner join empenho emp on est.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where emp.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          liq.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          sum(liq.valor) as liquidado,\r\n          0 as pago\r\n      from liquidacao liq\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where liq.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(liq.dataLiquidacao) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, liq.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          sum(est.valor *-1) as liquidado,\r\n          0 as pago\r\n      from liquidacaoestorno est\r\n          inner join liquidacao liq on est.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where liq.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          pag.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          sum(pag.valor) as pago\r\n      from pagamento pag\r\n          inner join liquidacao liq on pag.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where pag.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(pag.dataPagamento) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, pag.unidadeOrganizacional_id\r\n\r\n      union all\r\n      select prov.contadedespesa_id as idContaDeDespesa,\r\n          est.unidadeOrganizacional_id as idUnidade,\r\n          0 as orcado,\r\n          0 as atualizado,\r\n          0 as empenhado,\r\n          0 as liquidado,\r\n          sum(est.valor *-1) as pago\r\n      from pagamentoestorno est\r\n          inner join pagamento pag on est.pagamento_id = pag.id\r\n          inner join liquidacao liq on pag.liquidacao_id = liq.id\r\n          inner join empenho emp on liq.empenho_id = emp.id\r\n          inner join fonteDespesaORC fdOrc on emp.fonteDespesaORC_id = fdOrc.id\r\n          inner join provisaoPPAFonte proFonte on fdOrc.provisaoPPAFonte_id = proFonte.id\r\n          inner join despesaorc desp ON emp.despesaorc_id = desp.id\r\n          inner join provisaoppadespesa prov ON desp.provisaoppadespesa_id = prov.id\r\n          inner join conta c ON prov.contadedespesa_id = c.id\r\n      where pag.categoriaorcamentaria = ''NORMAL''\r\n        and trunc(est.dataEstorno) BETWEEN to_date(''01/01/$ANO'', ''dd/MM/yyyy'') AND to_date(''31/12/$ANO'', ''dd/MM/yyyy'')\r\n      group by prov.contadedespesa_id, est.unidadeOrganizacional_id\r\n     ) dados\r\n         inner join vwhierarquiaorcamentaria vw ON dados.idUnidade = vw.subordinada_id\r\n         inner join conta cDesp ON dados.idContaDeDespesa = cDesp.id\r\nwhere dados.idUnidade in (select UNIDADE_ID from UNIDADEPREFEITURAPORTAL where PREFEITURA_ID = $PREFEITURAPORTAL_ID)\r\n  and to_date(''01/01/$ANO'', ''dd/MM/yyyy'') BETWEEN vw.iniciovigencia and coalesce(vw.fimvigencia, to_date(''01/01/$ANO'', ''dd/MM/yyyy''))\r\n    $WHERE\r\ngroup by cDesp.codigo || '' - '' || cDesp.descricao\r\norder by cDesp.codigo || '' - '' || cDesp.descricao\r\n)","totalRegistros":41,"fields":[{"posicao":1,"descricao":"Natureza de Despesa","columnName":"CONTADESPESA","columnValue":"CONTADESPESA","tipoAlinhamento":"ESQUERDA","totalizar":false,"link":null,"tipo":"STRING","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":2,"descricao":"Orçado (R$)","columnName":"ORCADO","columnValue":"ORCADO","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":3,"descricao":"Atualizado (R$)","columnName":"ATUALIZADO","columnValue":"ATUALIZADO","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":4,"descricao":"Empenhado (R$)","columnName":"EMPENHADO","columnValue":"EMPENHADO","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":5,"descricao":"Liquidado (R$)","columnName":"LIQUIDADO","columnValue":"LIQUIDADO","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false},{"posicao":6,"descricao":"Pago (R$)","columnName":"PAGO","columnValue":"PAGO","tipoAlinhamento":"DIREITA","totalizar":true,"link":null,"tipo":"MONETARIO","tipoEnum":null,"valorPadrao":null,"escondido":false}],"pesquisaveis":[{"descricao":"Unidade","columnName":"vw.subordinada_id","columnValue":null,"tipo":"MULTI_SELECT","operacaoPadrao":null,"tipoEnum":null,"valorPadrao":"","tipoMultiSelect":"UNIDADE_ORCAMENTARIA"},{"descricao":"Natureza de Despesa","columnName":"cDesp.codigo","columnValue":null,"tipo":"MULTI_SELECT","operacaoPadrao":null,"tipoEnum":null,"valorPadrao":"","tipoMultiSelect":"NATUREZA_DA_DESPESA"}],"tabs":[]}';
BEGIN
update PAGINAPREFEITURAPORTAL set CONTEUDO = texto where NOME = 'Despesa por Natureza da Despesa';
END;
